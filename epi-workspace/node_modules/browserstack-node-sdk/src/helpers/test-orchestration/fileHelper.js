const a128_0x25fa94=a128_0x474e;function a128_0xf43d(){const _0x4c7a22=['code','28587110riImNm','mniMK','from','isArray','readFileSync','uniqueFailedTests','stringify','releaseLock','fullName','failFastConfig','warn','updateAPIFailedCount','message','6jkZSXy','BjORk','YHHIc','stack','readState',']\x20Error\x20reading\x20state\x20file:\x20','acquireLock','error','recordTestResult','UNjjw','662270WswWXt','iterator',']\x20Could\x20not\x20acquire\x20lock\x20to\x20record\x20test\x20result.\x20State\x20may\x20be\x20stale.','function','parse','76DiJPgR','1935VRSSqr','SaKzX','159045YnYglZ','40408aCNqcD','unlinkSync','OdPcu','1320543YZsYvE','add','VfHNc','lastAPIFailedCount','failedTests','status',']\x20Error\x20releasing\x20lock:\x20','esVFx','stateFilePath','writeState','newState','exports','totalTests','writeFileSync',']\x20Error\x20creating\x20state\x20file:\x20','0|1|4|2|3','defaultState','has','existsSync',']\x20Error\x20writing\x20state\x20file:\x20',']\x20Could\x20not\x20acquire\x20lock\x20to\x20update\x20API\x20failed\x20count.\x20State\x20may\x20be\x20stale.','lockFilePath','11ivfYQf','908900GwHABP','utf8','2396682NoqLvj','XBfCD','winstonLogger','EEXIST'];a128_0xf43d=function(){return _0x4c7a22;};return a128_0xf43d();}function a128_0x474e(_0x2370c8,_0x30ae7b){const _0xf43dff=a128_0xf43d();return a128_0x474e=function(_0x474eb4,_0x20338f){_0x474eb4=_0x474eb4-0x1d3;let _0x4e1d8d=_0xf43dff[_0x474eb4];return _0x4e1d8d;},a128_0x474e(_0x2370c8,_0x30ae7b);}(function(_0x2eba7d,_0x3e99fc){const _0x393e2c=a128_0x474e,_0x2fcca4=_0x2eba7d();while(!![]){try{const _0x540593=-parseInt(_0x393e2c(0x1e5))/0x1+parseInt(_0x393e2c(0x1e7))/0x2+parseInt(_0x393e2c(0x20b))/0x3*(-parseInt(_0x393e2c(0x208))/0x4)+-parseInt(_0x393e2c(0x203))/0x5*(parseInt(_0x393e2c(0x1f9))/0x6)+-parseInt(_0x393e2c(0x20f))/0x7+parseInt(_0x393e2c(0x20c))/0x8*(-parseInt(_0x393e2c(0x209))/0x9)+-parseInt(_0x393e2c(0x1ec))/0xa*(-parseInt(_0x393e2c(0x1e4))/0xb);if(_0x540593===_0x3e99fc)break;else _0x2fcca4['push'](_0x2fcca4['shift']());}catch(_0x26c624){_0x2fcca4['push'](_0x2fcca4['shift']());}}}(a128_0xf43d,0xb3267));const fs=require('fs'),logger=require('../logger')[a128_0x25fa94(0x1e9)],TAG='FailFastFileHelper';class FileHelper{constructor(_0x199992,_0x24a6e7,_0x1a63f8,_0x61c57b){const _0x5b17d5=a128_0x25fa94,_0x18498f={};_0x18498f[_0x5b17d5(0x1e8)]=_0x5b17d5(0x1dd),_0x18498f[_0x5b17d5(0x1fa)]=_0x5b17d5(0x1e6);const _0x4361f0=_0x18498f,_0x20ff81=_0x4361f0[_0x5b17d5(0x1e8)]['split']('|');let _0x381ad4=0x0;while(!![]){switch(_0x20ff81[_0x381ad4++]){case'0':this[_0x5b17d5(0x1f5)]=_0x199992;continue;case'1':this[_0x5b17d5(0x1d6)]=_0x24a6e7;continue;case'2':this[_0x5b17d5(0x1de)]=_0x61c57b;continue;case'3':if(!fs[_0x5b17d5(0x1e0)](this['stateFilePath']))try{fs[_0x5b17d5(0x1db)](this[_0x5b17d5(0x1d6)],'{}',_0x4361f0['BjORk']);}catch(_0x1c8306){logger['error']('['+TAG+_0x5b17d5(0x1dc)+_0x1c8306[_0x5b17d5(0x1f8)]+'\x20'+_0x1c8306['stack']);}continue;case'4':this[_0x5b17d5(0x1e3)]=_0x1a63f8;continue;}break;}}async[a128_0x25fa94(0x1ff)](){const _0x24ea4a=a128_0x25fa94,_0x2d31a3={};_0x2d31a3[_0x24ea4a(0x1fb)]=function(_0x414a40,_0x15254e){return _0x414a40===_0x15254e;},_0x2d31a3['UNjjw']=_0x24ea4a(0x1ea);const _0x466665=_0x2d31a3;let _0x1ed782;try{return _0x1ed782=fs['openSync'](this[_0x24ea4a(0x1e3)],'wx'),_0x1ed782;}catch(_0xd8e0fa){if(_0x466665[_0x24ea4a(0x1fb)](_0xd8e0fa[_0x24ea4a(0x1eb)],_0x466665[_0x24ea4a(0x202)]))return null;throw _0xd8e0fa;}}async[a128_0x25fa94(0x1f3)](_0x5eade8){const _0x28d4a2=a128_0x25fa94;if(_0x5eade8)try{fs['closeSync'](_0x5eade8),fs[_0x28d4a2(0x20d)](this[_0x28d4a2(0x1e3)]);}catch(_0x448d6d){logger[_0x28d4a2(0x200)]('['+TAG+_0x28d4a2(0x1d4)+_0x448d6d[_0x28d4a2(0x1f8)]+'\x20'+_0x448d6d[_0x28d4a2(0x1fc)]);}}[a128_0x25fa94(0x1fd)](){const _0x5cc6bb=a128_0x25fa94,_0x43cef3={};_0x43cef3[_0x5cc6bb(0x211)]=_0x5cc6bb(0x1e6);const _0x3d8705=_0x43cef3;try{const _0x1519e9=fs[_0x5cc6bb(0x1f0)](this[_0x5cc6bb(0x1d6)],_0x3d8705['VfHNc']);return JSON['parse'](_0x1519e9);}catch(_0x26a9bd){return logger[_0x5cc6bb(0x200)]('['+TAG+_0x5cc6bb(0x1fe)+_0x26a9bd['message']+'\x20'+_0x26a9bd[_0x5cc6bb(0x1fc)]),null;}}async[a128_0x25fa94(0x1d7)](_0x1891fb){const _0x294f49=a128_0x25fa94,_0x74f44d={..._0x1891fb,'uniqueFailedTests':Array[_0x294f49(0x1ef)](_0x1891fb[_0x294f49(0x1f1)])?_0x1891fb['uniqueFailedTests']:Array[_0x294f49(0x1ee)](_0x1891fb[_0x294f49(0x1f1)]||[])};try{fs[_0x294f49(0x1db)](this['stateFilePath'],JSON[_0x294f49(0x1f2)](_0x74f44d,null,0x2));}catch(_0x30ec0d){logger[_0x294f49(0x200)]('['+TAG+_0x294f49(0x1e1)+_0x30ec0d['message']+'\x20'+_0x30ec0d[_0x294f49(0x1fc)]);throw _0x30ec0d;}}async[a128_0x25fa94(0x201)](_0x37c645,_0x5f1f0f){const _0xd3b0e1=a128_0x25fa94,_0x28dd66={};_0x28dd66['SaKzX']=function(_0x470452,_0x24c87d){return _0x470452!==_0x24c87d;},_0x28dd66[_0xd3b0e1(0x1ed)]=_0xd3b0e1(0x206),_0x28dd66[_0xd3b0e1(0x1d5)]=function(_0x230113,_0x36fc78){return _0x230113===_0x36fc78;},_0x28dd66['OdPcu']='failed';const _0x42d1b5=_0x28dd66,_0x1d2d06=await this[_0xd3b0e1(0x1ff)]();if(!_0x1d2d06)return logger[_0xd3b0e1(0x1f6)]('['+TAG+_0xd3b0e1(0x205)),{'newState':this[_0xd3b0e1(0x1fd)]()||this['defaultState'],'isNewFailure':![]};try{let _0x15d395=this['readState']();!_0x15d395&&(_0x15d395=JSON[_0xd3b0e1(0x207)](JSON[_0xd3b0e1(0x1f2)](this[_0xd3b0e1(0x1de)])));if(!_0x15d395['uniqueFailedTests']||_0x42d1b5[_0xd3b0e1(0x20a)](typeof _0x15d395[_0xd3b0e1(0x1f1)][Symbol[_0xd3b0e1(0x204)]],_0x42d1b5[_0xd3b0e1(0x1ed)]))_0x15d395[_0xd3b0e1(0x1f1)]=new Set();else Array['isArray'](_0x15d395[_0xd3b0e1(0x1f1)])&&(_0x15d395[_0xd3b0e1(0x1f1)]=new Set(_0x15d395[_0xd3b0e1(0x1f1)]));_0x15d395[_0xd3b0e1(0x1da)]=_0x5f1f0f;let _0x232318=![];_0x42d1b5[_0xd3b0e1(0x1d5)](_0x37c645[_0xd3b0e1(0x1d3)],_0x42d1b5[_0xd3b0e1(0x20e)])&&(_0x15d395[_0xd3b0e1(0x213)]+=0x1,!_0x15d395[_0xd3b0e1(0x1f1)][_0xd3b0e1(0x1df)](_0x37c645[_0xd3b0e1(0x1f4)])&&(_0x15d395[_0xd3b0e1(0x1f1)][_0xd3b0e1(0x210)](_0x37c645['fullName']),_0x232318=!![]));await this[_0xd3b0e1(0x1d7)](_0x15d395);const _0x15a7a4={};return _0x15a7a4[_0xd3b0e1(0x1d8)]=_0x15d395,_0x15a7a4['isNewFailure']=_0x232318,_0x15a7a4;}finally{await this[_0xd3b0e1(0x1f3)](_0x1d2d06);}}async[a128_0x25fa94(0x1f7)](_0x2b040b){const _0x2fcbc8=a128_0x25fa94,_0x3c27cf=await this[_0x2fcbc8(0x1ff)]();if(!_0x3c27cf)return logger[_0x2fcbc8(0x1f6)]('['+TAG+_0x2fcbc8(0x1e2)),this[_0x2fcbc8(0x1fd)]()||this[_0x2fcbc8(0x1de)];try{let _0x6fc737=this['readState']();return!_0x6fc737&&(_0x6fc737=JSON[_0x2fcbc8(0x207)](JSON[_0x2fcbc8(0x1f2)](this[_0x2fcbc8(0x1de)]))),_0x6fc737[_0x2fcbc8(0x212)]=_0x2b040b,await this[_0x2fcbc8(0x1d7)](_0x6fc737),_0x6fc737;}finally{await this['releaseLock'](_0x3c27cf);}}}module[a128_0x25fa94(0x1d9)]=FileHelper;