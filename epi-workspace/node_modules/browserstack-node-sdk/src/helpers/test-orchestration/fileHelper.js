const a120_0xa057bd=a120_0x4c92;function a120_0x22d8(){const _0x4aa13e=['utf8','uniqueFailedTests','21760beNike','68oVGwkT','10xPyMkz','message','writeFileSync','218382FggIkQ','parse','5235390KcSVqM','from','isNewFailure','function','exports','ISWLS','gHatz','oDjuE',']\x20Error\x20writing\x20state\x20file:\x20','winstonLogger','yaYxn','stack','acquireLock','releaseLock','3|2|1|4|0','7gEMIip',']\x20Error\x20releasing\x20lock:\x20','totalTests','EEXIST','writeState','isArray','ewrbl',']\x20Could\x20not\x20acquire\x20lock\x20to\x20record\x20test\x20result.\x20State\x20may\x20be\x20stale.',']\x20Error\x20reading\x20state\x20file:\x20','stringify','openSync','error','lockFilePath','status','ZmnGs','failFastConfig','mOPSB','warn','newState','165861DCEQvW','failedTests','code','fullName','stateFilePath','add','926552uNNsiu',']\x20Could\x20not\x20acquire\x20lock\x20to\x20update\x20API\x20failed\x20count.\x20State\x20may\x20be\x20stale.','defaultState','readState','697188zgNDtS','258467HoijjK','oWxoN'];a120_0x22d8=function(){return _0x4aa13e;};return a120_0x22d8();}function a120_0x4c92(_0x5b4159,_0x560de2){const _0x22d896=a120_0x22d8();return a120_0x4c92=function(_0x4c92ec,_0x3c1cb4){_0x4c92ec=_0x4c92ec-0x16d;let _0x1e94e8=_0x22d896[_0x4c92ec];return _0x1e94e8;},a120_0x4c92(_0x5b4159,_0x560de2);}(function(_0x16371d,_0x304c2b){const _0x1e015=a120_0x4c92,_0x30549e=_0x16371d();while(!![]){try{const _0x12094b=-parseInt(_0x1e015(0x18f))/0x1+parseInt(_0x1e015(0x198))/0x2+-parseInt(_0x1e015(0x184))/0x3+-parseInt(_0x1e015(0x194))/0x4*(-parseInt(_0x1e015(0x193))/0x5)+parseInt(_0x1e015(0x18e))/0x6*(-parseInt(_0x1e015(0x171))/0x7)+-parseInt(_0x1e015(0x18a))/0x8+parseInt(_0x1e015(0x19a))/0x9*(parseInt(_0x1e015(0x195))/0xa);if(_0x12094b===_0x304c2b)break;else _0x30549e['push'](_0x30549e['shift']());}catch(_0x4e9680){_0x30549e['push'](_0x30549e['shift']());}}}(a120_0x22d8,0x357ea));const fs=require('fs'),logger=require('../logger')[a120_0xa057bd(0x1a3)],TAG='FailFastFileHelper';class FileHelper{constructor(_0x8a88ba,_0x12bd95,_0x46398a,_0x16bf3f){const _0x1e8a92=a120_0xa057bd,_0x248675={};_0x248675['ZmnGs']=_0x1e8a92(0x170),_0x248675[_0x1e8a92(0x181)]=_0x1e8a92(0x191);const _0x1a57f4=_0x248675,_0x5668a2=_0x1a57f4[_0x1e8a92(0x17f)]['split']('|');let _0x4466e3=0x0;while(!![]){switch(_0x5668a2[_0x4466e3++]){case'0':if(!fs['existsSync'](this[_0x1e8a92(0x188)]))try{fs[_0x1e8a92(0x197)](this['stateFilePath'],'{}',_0x1a57f4[_0x1e8a92(0x181)]);}catch(_0x5835d0){logger[_0x1e8a92(0x17c)]('['+TAG+']\x20Error\x20creating\x20state\x20file:\x20'+_0x5835d0[_0x1e8a92(0x196)]+'\x20'+_0x5835d0[_0x1e8a92(0x16d)]);}continue;case'1':this[_0x1e8a92(0x17d)]=_0x46398a;continue;case'2':this[_0x1e8a92(0x188)]=_0x12bd95;continue;case'3':this[_0x1e8a92(0x180)]=_0x8a88ba;continue;case'4':this[_0x1e8a92(0x18c)]=_0x16bf3f;continue;}break;}}async[a120_0xa057bd(0x16e)](){const _0xc81f86=a120_0xa057bd,_0x1ef126={};_0x1ef126[_0xc81f86(0x19f)]=function(_0x4fe56c,_0x531677){return _0x4fe56c===_0x531677;},_0x1ef126[_0xc81f86(0x190)]=_0xc81f86(0x174);const _0x4f8bbf=_0x1ef126;let _0x531fa3;try{return _0x531fa3=fs[_0xc81f86(0x17b)](this[_0xc81f86(0x17d)],'wx'),_0x531fa3;}catch(_0x20bd8b){if(_0x4f8bbf['ISWLS'](_0x20bd8b[_0xc81f86(0x186)],_0x4f8bbf['oWxoN']))return null;throw _0x20bd8b;}}async[a120_0xa057bd(0x16f)](_0x3458c7){const _0x1f5f1f=a120_0xa057bd;if(_0x3458c7)try{fs['closeSync'](_0x3458c7),fs['unlinkSync'](this[_0x1f5f1f(0x17d)]);}catch(_0x510615){logger['error']('['+TAG+_0x1f5f1f(0x172)+_0x510615[_0x1f5f1f(0x196)]+'\x20'+_0x510615[_0x1f5f1f(0x16d)]);}}['readState'](){const _0x86f0e5=a120_0xa057bd,_0x476809={};_0x476809[_0x86f0e5(0x1a4)]=_0x86f0e5(0x191);const _0x5234fd=_0x476809;try{const _0x7c5bd4=fs['readFileSync'](this[_0x86f0e5(0x188)],_0x5234fd[_0x86f0e5(0x1a4)]);return JSON['parse'](_0x7c5bd4);}catch(_0x5ada85){return logger[_0x86f0e5(0x17c)]('['+TAG+_0x86f0e5(0x179)+_0x5ada85['message']+'\x20'+_0x5ada85[_0x86f0e5(0x16d)]),null;}}async[a120_0xa057bd(0x175)](_0x5b0b4e){const _0x2ca394=a120_0xa057bd,_0x5ddf71={..._0x5b0b4e,'uniqueFailedTests':Array['isArray'](_0x5b0b4e['uniqueFailedTests'])?_0x5b0b4e['uniqueFailedTests']:Array[_0x2ca394(0x19b)](_0x5b0b4e['uniqueFailedTests']||[])};try{fs['writeFileSync'](this[_0x2ca394(0x188)],JSON['stringify'](_0x5ddf71,null,0x2));}catch(_0x23018d){logger[_0x2ca394(0x17c)]('['+TAG+_0x2ca394(0x1a2)+_0x23018d['message']+'\x20'+_0x23018d['stack']);throw _0x23018d;}}async['recordTestResult'](_0xbdf558,_0x4d6e37){const _0x2da4fc=a120_0xa057bd,_0xcb2c68={};_0xcb2c68[_0x2da4fc(0x1a0)]=function(_0x1fd047,_0x42a8d8){return _0x1fd047!==_0x42a8d8;},_0xcb2c68['CaHRn']=_0x2da4fc(0x19d),_0xcb2c68[_0x2da4fc(0x1a1)]=function(_0x34fbb0,_0x112d7e){return _0x34fbb0===_0x112d7e;},_0xcb2c68[_0x2da4fc(0x177)]='failed';const _0x8e78e7=_0xcb2c68,_0x196e4c=await this[_0x2da4fc(0x16e)]();if(!_0x196e4c)return logger[_0x2da4fc(0x182)]('['+TAG+_0x2da4fc(0x178)),{'newState':this[_0x2da4fc(0x18d)]()||this['defaultState'],'isNewFailure':![]};try{let _0x2b6d78=this[_0x2da4fc(0x18d)]();!_0x2b6d78&&(_0x2b6d78=JSON[_0x2da4fc(0x199)](JSON[_0x2da4fc(0x17a)](this[_0x2da4fc(0x18c)])));if(!_0x2b6d78[_0x2da4fc(0x192)]||_0x8e78e7[_0x2da4fc(0x1a0)](typeof _0x2b6d78[_0x2da4fc(0x192)][Symbol['iterator']],_0x8e78e7['CaHRn']))_0x2b6d78['uniqueFailedTests']=new Set();else Array[_0x2da4fc(0x176)](_0x2b6d78[_0x2da4fc(0x192)])&&(_0x2b6d78[_0x2da4fc(0x192)]=new Set(_0x2b6d78[_0x2da4fc(0x192)]));_0x2b6d78[_0x2da4fc(0x173)]=_0x4d6e37;let _0x16e870=![];_0x8e78e7['oDjuE'](_0xbdf558[_0x2da4fc(0x17e)],_0x8e78e7[_0x2da4fc(0x177)])&&(_0x2b6d78[_0x2da4fc(0x185)]+=0x1,!_0x2b6d78['uniqueFailedTests']['has'](_0xbdf558[_0x2da4fc(0x187)])&&(_0x2b6d78[_0x2da4fc(0x192)][_0x2da4fc(0x189)](_0xbdf558[_0x2da4fc(0x187)]),_0x16e870=!![]));await this[_0x2da4fc(0x175)](_0x2b6d78);const _0x11998d={};return _0x11998d[_0x2da4fc(0x183)]=_0x2b6d78,_0x11998d[_0x2da4fc(0x19c)]=_0x16e870,_0x11998d;}finally{await this[_0x2da4fc(0x16f)](_0x196e4c);}}async['updateAPIFailedCount'](_0x2689f0){const _0x315c4a=a120_0xa057bd,_0x2ed42c=await this[_0x315c4a(0x16e)]();if(!_0x2ed42c)return logger[_0x315c4a(0x182)]('['+TAG+_0x315c4a(0x18b)),this[_0x315c4a(0x18d)]()||this['defaultState'];try{let _0x182632=this[_0x315c4a(0x18d)]();return!_0x182632&&(_0x182632=JSON['parse'](JSON['stringify'](this['defaultState']))),_0x182632['lastAPIFailedCount']=_0x2689f0,await this['writeState'](_0x182632),_0x182632;}finally{await this[_0x315c4a(0x16f)](_0x2ed42c);}}}module[a120_0xa057bd(0x19e)]=FileHelper;