const a132_0x1e7f1b=a132_0x2bd6;(function(_0x24e8ec,_0x1d4cd6){const _0x5d89dc=a132_0x2bd6,_0xfded7e=_0x24e8ec();while(!![]){try{const _0x58a2b0=parseInt(_0x5d89dc(0xf0))/0x1+-parseInt(_0x5d89dc(0xe6))/0x2+-parseInt(_0x5d89dc(0xd6))/0x3*(parseInt(_0x5d89dc(0xc6))/0x4)+-parseInt(_0x5d89dc(0xbd))/0x5*(parseInt(_0x5d89dc(0xdd))/0x6)+-parseInt(_0x5d89dc(0xf1))/0x7+parseInt(_0x5d89dc(0xbc))/0x8*(parseInt(_0x5d89dc(0xd7))/0x9)+parseInt(_0x5d89dc(0xcb))/0xa;if(_0x58a2b0===_0x1d4cd6)break;else _0xfded7e['push'](_0xfded7e['shift']());}catch(_0x362ed8){_0xfded7e['push'](_0xfded7e['shift']());}}}(a132_0x5865,0x23dba));function a132_0x2bd6(_0x1228ca,_0x1da634){const _0x5865d0=a132_0x5865();return a132_0x2bd6=function(_0x2bd68d,_0x4987e4){_0x2bd68d=_0x2bd68d-0xbc;let _0xdaf636=_0x5865d0[_0x2bd68d];return _0xdaf636;},a132_0x2bd6(_0x1228ca,_0x1da634);}const fs=require('fs'),logger=require('../logger')[a132_0x1e7f1b(0xee)],TAG='FailFastFileHelper';class FileHelper{constructor(_0x436a02,_0x3cd6f4,_0x4716eb,_0x2ab74f){const _0x13f5cd=a132_0x1e7f1b,_0xfb8131={};_0xfb8131[_0x13f5cd(0xda)]=_0x13f5cd(0xf3),_0xfb8131[_0x13f5cd(0xef)]=_0x13f5cd(0xe3);const _0x4fbdba=_0xfb8131,_0x523cc3=_0x4fbdba[_0x13f5cd(0xda)]['split']('|');let _0x230d72=0x0;while(!![]){switch(_0x523cc3[_0x230d72++]){case'0':this[_0x13f5cd(0xf2)]=_0x3cd6f4;continue;case'1':this['defaultState']=_0x2ab74f;continue;case'2':if(!fs[_0x13f5cd(0xec)](this[_0x13f5cd(0xf2)]))try{fs[_0x13f5cd(0xe1)](this[_0x13f5cd(0xf2)],'{}',_0x4fbdba['wexRY']);}catch(_0xa764b7){logger[_0x13f5cd(0xe9)]('['+TAG+']\x20Error\x20creating\x20state\x20file:\x20'+_0xa764b7[_0x13f5cd(0xcc)]+'\x20'+_0xa764b7[_0x13f5cd(0xc0)]);}continue;case'3':this[_0x13f5cd(0xd2)]=_0x436a02;continue;case'4':this[_0x13f5cd(0xe0)]=_0x4716eb;continue;}break;}}async[a132_0x1e7f1b(0xe2)](){const _0x50de2f=a132_0x1e7f1b,_0x28e743={};_0x28e743[_0x50de2f(0xdb)]=function(_0x10d971,_0x30a050){return _0x10d971===_0x30a050;},_0x28e743[_0x50de2f(0xca)]=_0x50de2f(0xe4);const _0x47cf61=_0x28e743;let _0xbff1e1;try{return _0xbff1e1=fs[_0x50de2f(0xce)](this[_0x50de2f(0xe0)],'wx'),_0xbff1e1;}catch(_0x1857a0){if(_0x47cf61[_0x50de2f(0xdb)](_0x1857a0[_0x50de2f(0xed)],_0x47cf61[_0x50de2f(0xca)]))return null;throw _0x1857a0;}}async[a132_0x1e7f1b(0xd1)](_0x4f3b0b){const _0xfa0611=a132_0x1e7f1b;if(_0x4f3b0b)try{fs[_0xfa0611(0xe7)](_0x4f3b0b),fs['unlinkSync'](this['lockFilePath']);}catch(_0x46ffce){logger['error']('['+TAG+_0xfa0611(0xc9)+_0x46ffce[_0xfa0611(0xcc)]+'\x20'+_0x46ffce[_0xfa0611(0xc0)]);}}[a132_0x1e7f1b(0xc4)](){const _0x6aeb65=a132_0x1e7f1b,_0x2237c6={};_0x2237c6['SExpP']=_0x6aeb65(0xe3);const _0x12c275=_0x2237c6;try{const _0x490178=fs[_0x6aeb65(0xde)](this[_0x6aeb65(0xf2)],_0x12c275[_0x6aeb65(0xe5)]);return JSON[_0x6aeb65(0xbe)](_0x490178);}catch(_0x49a0bb){return logger[_0x6aeb65(0xe9)]('['+TAG+']\x20Error\x20reading\x20state\x20file:\x20'+_0x49a0bb[_0x6aeb65(0xcc)]+'\x20'+_0x49a0bb[_0x6aeb65(0xc0)]),null;}}async[a132_0x1e7f1b(0xe8)](_0x56c727){const _0x4d51ba=a132_0x1e7f1b,_0x1def7e={..._0x56c727,'uniqueFailedTests':Array[_0x4d51ba(0xbf)](_0x56c727[_0x4d51ba(0xd0)])?_0x56c727[_0x4d51ba(0xd0)]:Array['from'](_0x56c727[_0x4d51ba(0xd0)]||[])};try{fs[_0x4d51ba(0xe1)](this[_0x4d51ba(0xf2)],JSON[_0x4d51ba(0xc1)](_0x1def7e,null,0x2));}catch(_0x452c34){logger[_0x4d51ba(0xe9)]('['+TAG+_0x4d51ba(0xea)+_0x452c34[_0x4d51ba(0xcc)]+'\x20'+_0x452c34['stack']);throw _0x452c34;}}async['recordTestResult'](_0x316de2,_0x36279f){const _0xb3c21f=a132_0x1e7f1b,_0x3de0e4={};_0x3de0e4[_0xb3c21f(0xdc)]=function(_0x5945e9,_0x2352c6){return _0x5945e9!==_0x2352c6;},_0x3de0e4[_0xb3c21f(0xd5)]='function',_0x3de0e4[_0xb3c21f(0xcf)]=function(_0x3a869,_0x5c9ce6){return _0x3a869===_0x5c9ce6;},_0x3de0e4[_0xb3c21f(0xc2)]=_0xb3c21f(0xd3);const _0x28310b=_0x3de0e4,_0x5a71f9=await this['acquireLock']();if(!_0x5a71f9)return logger[_0xb3c21f(0xd8)]('['+TAG+_0xb3c21f(0xc7)),{'newState':this[_0xb3c21f(0xc4)]()||this[_0xb3c21f(0xd4)],'isNewFailure':![]};try{let _0x18e34c=this['readState']();!_0x18e34c&&(_0x18e34c=JSON['parse'](JSON['stringify'](this[_0xb3c21f(0xd4)])));if(!_0x18e34c['uniqueFailedTests']||_0x28310b[_0xb3c21f(0xdc)](typeof _0x18e34c[_0xb3c21f(0xd0)][Symbol['iterator']],_0x28310b[_0xb3c21f(0xd5)]))_0x18e34c[_0xb3c21f(0xd0)]=new Set();else Array[_0xb3c21f(0xbf)](_0x18e34c['uniqueFailedTests'])&&(_0x18e34c[_0xb3c21f(0xd0)]=new Set(_0x18e34c[_0xb3c21f(0xd0)]));_0x18e34c[_0xb3c21f(0xc5)]=_0x36279f;let _0x4195e6=![];_0x28310b[_0xb3c21f(0xcf)](_0x316de2['status'],_0x28310b[_0xb3c21f(0xc2)])&&(_0x18e34c[_0xb3c21f(0xeb)]+=0x1,!_0x18e34c[_0xb3c21f(0xd0)]['has'](_0x316de2['fullName'])&&(_0x18e34c['uniqueFailedTests'][_0xb3c21f(0xcd)](_0x316de2[_0xb3c21f(0xdf)]),_0x4195e6=!![]));await this[_0xb3c21f(0xe8)](_0x18e34c);const _0x33c5f3={};return _0x33c5f3[_0xb3c21f(0xc8)]=_0x18e34c,_0x33c5f3[_0xb3c21f(0xc3)]=_0x4195e6,_0x33c5f3;}finally{await this['releaseLock'](_0x5a71f9);}}async['updateAPIFailedCount'](_0x32d2a0){const _0x3fc4d8=a132_0x1e7f1b,_0x51d042=await this['acquireLock']();if(!_0x51d042)return logger['warn']('['+TAG+']\x20Could\x20not\x20acquire\x20lock\x20to\x20update\x20API\x20failed\x20count.\x20State\x20may\x20be\x20stale.'),this[_0x3fc4d8(0xc4)]()||this['defaultState'];try{let _0x135635=this[_0x3fc4d8(0xc4)]();return!_0x135635&&(_0x135635=JSON['parse'](JSON[_0x3fc4d8(0xc1)](this[_0x3fc4d8(0xd4)]))),_0x135635['lastAPIFailedCount']=_0x32d2a0,await this['writeState'](_0x135635),_0x135635;}finally{await this[_0x3fc4d8(0xd1)](_0x51d042);}}}function a132_0x5865(){const _0x265789=['qubQc','209238RpsAUB','333oiGFyx','warn','exports','qaUUh','umfvh','SBCai','894EvNdfs','readFileSync','fullName','lockFilePath','writeFileSync','acquireLock','utf8','EEXIST','SExpP','159308pWEYKc','closeSync','writeState','error',']\x20Error\x20writing\x20state\x20file:\x20','failedTests','existsSync','code','winstonLogger','wexRY','135410cSKSBn','1542240TfneTa','stateFilePath','3|0|4|1|2','9656ijSlEU','2085XNWFmR','parse','isArray','stack','stringify','QATdA','isNewFailure','readState','totalTests','4cYHCKu',']\x20Could\x20not\x20acquire\x20lock\x20to\x20record\x20test\x20result.\x20State\x20may\x20be\x20stale.','newState',']\x20Error\x20releasing\x20lock:\x20','wEtBI','3986580aSCCwq','message','add','openSync','MFApa','uniqueFailedTests','releaseLock','failFastConfig','failed','defaultState'];a132_0x5865=function(){return _0x265789;};return a132_0x5865();}module[a132_0x1e7f1b(0xd9)]=FileHelper;