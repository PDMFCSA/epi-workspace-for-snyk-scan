const a126_0x2207d1=a126_0x554f;function a126_0x15f2(){const _0x5196b1=['1|4|0|3|2','190394VygXHw','iterator','parse','isArray','add','WrsvU','fbrmX','UQKvf','4494252DkqQBE','stateFilePath','defaultState','stack','exports','writeFileSync','status','message','openSync','../logger','readFileSync','EEXIST','FUCPJ','ykRSc','uniqueFailedTests','isNewFailure',']\x20Error\x20reading\x20state\x20file:\x20','failed','13475480VLjyYu','totalTests','27RGUQhS','readState','has','newState','function','acquireLock',']\x20Error\x20creating\x20state\x20file:\x20','lockFilePath','writeState','OuSUz','4798024KKlOnP','fullName','1797365JmfxRY','existsSync','MyiDR','failedTests','error','releaseLock','recordTestResult','DDaam','warn','810456cneVxp','unlinkSync',']\x20Error\x20writing\x20state\x20file:\x20','5382816ZDbPcp','stringify','code','tGATo'];a126_0x15f2=function(){return _0x5196b1;};return a126_0x15f2();}(function(_0x25fb17,_0x227ba9){const _0x6d3e44=a126_0x554f,_0x35796e=_0x25fb17();while(!![]){try{const _0x2868a0=parseInt(_0x6d3e44(0xbe))/0x1+parseInt(_0x6d3e44(0xc6))/0x2*(-parseInt(_0x6d3e44(0xe2))/0x3)+-parseInt(_0x6d3e44(0xce))/0x4+parseInt(_0x6d3e44(0xb5))/0x5+-parseInt(_0x6d3e44(0xc1))/0x6+parseInt(_0x6d3e44(0xb3))/0x7+parseInt(_0x6d3e44(0xe0))/0x8;if(_0x2868a0===_0x227ba9)break;else _0x35796e['push'](_0x35796e['shift']());}catch(_0x5b2ac7){_0x35796e['push'](_0x35796e['shift']());}}}(a126_0x15f2,0xa1b34));function a126_0x554f(_0x339fd4,_0x1ef228){const _0x15f2e3=a126_0x15f2();return a126_0x554f=function(_0x554fda,_0x38b58f){_0x554fda=_0x554fda-0xb0;let _0x5a63c8=_0x15f2e3[_0x554fda];return _0x5a63c8;},a126_0x554f(_0x339fd4,_0x1ef228);}const fs=require('fs'),logger=require(a126_0x2207d1(0xd7))['winstonLogger'],TAG='FailFastFileHelper';class FileHelper{constructor(_0x59b026,_0x310178,_0x59fc8c,_0x1f2aa9){const _0x49e789=a126_0x2207d1,_0x2ebf48={};_0x2ebf48[_0x49e789(0xb2)]=_0x49e789(0xc5),_0x2ebf48[_0x49e789(0xcd)]='utf8';const _0x1169fa=_0x2ebf48,_0x3e41e2=_0x1169fa[_0x49e789(0xb2)]['split']('|');let _0x23d7f7=0x0;while(!![]){switch(_0x3e41e2[_0x23d7f7++]){case'0':this[_0x49e789(0xb0)]=_0x59fc8c;continue;case'1':this['failFastConfig']=_0x59b026;continue;case'2':if(!fs[_0x49e789(0xb6)](this['stateFilePath']))try{fs['writeFileSync'](this[_0x49e789(0xcf)],'{}',_0x1169fa[_0x49e789(0xcd)]);}catch(_0x444dd2){logger['error']('['+TAG+_0x49e789(0xe8)+_0x444dd2[_0x49e789(0xd5)]+'\x20'+_0x444dd2['stack']);}continue;case'3':this[_0x49e789(0xd0)]=_0x1f2aa9;continue;case'4':this[_0x49e789(0xcf)]=_0x310178;continue;}break;}}async['acquireLock'](){const _0x169bd2=a126_0x2207d1,_0x322378={};_0x322378[_0x169bd2(0xc4)]=function(_0x25e48d,_0x4d03b3){return _0x25e48d===_0x4d03b3;},_0x322378[_0x169bd2(0xb7)]=_0x169bd2(0xd9);const _0x33c8b4=_0x322378;let _0x344b28;try{return _0x344b28=fs[_0x169bd2(0xd6)](this[_0x169bd2(0xb0)],'wx'),_0x344b28;}catch(_0x2b2592){if(_0x33c8b4[_0x169bd2(0xc4)](_0x2b2592[_0x169bd2(0xc3)],_0x33c8b4[_0x169bd2(0xb7)]))return null;throw _0x2b2592;}}async[a126_0x2207d1(0xba)](_0x161fac){const _0x289181=a126_0x2207d1;if(_0x161fac)try{fs['closeSync'](_0x161fac),fs[_0x289181(0xbf)](this['lockFilePath']);}catch(_0x5c63a2){logger[_0x289181(0xb9)]('['+TAG+']\x20Error\x20releasing\x20lock:\x20'+_0x5c63a2[_0x289181(0xd5)]+'\x20'+_0x5c63a2[_0x289181(0xd1)]);}}[a126_0x2207d1(0xe3)](){const _0x3ac881=a126_0x2207d1,_0x28f8ca={};_0x28f8ca[_0x3ac881(0xdb)]='utf8';const _0x2f672c=_0x28f8ca;try{const _0x1ad7d9=fs[_0x3ac881(0xd8)](this['stateFilePath'],_0x2f672c[_0x3ac881(0xdb)]);return JSON[_0x3ac881(0xc8)](_0x1ad7d9);}catch(_0x2e88bc){return logger[_0x3ac881(0xb9)]('['+TAG+_0x3ac881(0xde)+_0x2e88bc[_0x3ac881(0xd5)]+'\x20'+_0x2e88bc[_0x3ac881(0xd1)]),null;}}async[a126_0x2207d1(0xb1)](_0x17d250){const _0x474518=a126_0x2207d1,_0x1f9def={..._0x17d250,'uniqueFailedTests':Array[_0x474518(0xc9)](_0x17d250[_0x474518(0xdc)])?_0x17d250[_0x474518(0xdc)]:Array['from'](_0x17d250[_0x474518(0xdc)]||[])};try{fs[_0x474518(0xd3)](this[_0x474518(0xcf)],JSON[_0x474518(0xc2)](_0x1f9def,null,0x2));}catch(_0x1e8d3d){logger['error']('['+TAG+_0x474518(0xc0)+_0x1e8d3d[_0x474518(0xd5)]+'\x20'+_0x1e8d3d[_0x474518(0xd1)]);throw _0x1e8d3d;}}async[a126_0x2207d1(0xbb)](_0x5e704a,_0x5750b3){const _0x2ab225=a126_0x2207d1,_0x408a87={};_0x408a87[_0x2ab225(0xcc)]=function(_0x57e8d0,_0x36c13e){return _0x57e8d0!==_0x36c13e;},_0x408a87[_0x2ab225(0xda)]=_0x2ab225(0xe6),_0x408a87[_0x2ab225(0xbc)]=function(_0x30bfd2,_0x3bb13a){return _0x30bfd2===_0x3bb13a;},_0x408a87[_0x2ab225(0xcb)]=_0x2ab225(0xdf);const _0x4b7b8e=_0x408a87,_0x2f0625=await this[_0x2ab225(0xe7)]();if(!_0x2f0625)return logger[_0x2ab225(0xbd)]('['+TAG+']\x20Could\x20not\x20acquire\x20lock\x20to\x20record\x20test\x20result.\x20State\x20may\x20be\x20stale.'),{'newState':this[_0x2ab225(0xe3)]()||this[_0x2ab225(0xd0)],'isNewFailure':![]};try{let _0x33d5fc=this[_0x2ab225(0xe3)]();!_0x33d5fc&&(_0x33d5fc=JSON['parse'](JSON[_0x2ab225(0xc2)](this[_0x2ab225(0xd0)])));if(!_0x33d5fc[_0x2ab225(0xdc)]||_0x4b7b8e[_0x2ab225(0xcc)](typeof _0x33d5fc[_0x2ab225(0xdc)][Symbol[_0x2ab225(0xc7)]],_0x4b7b8e[_0x2ab225(0xda)]))_0x33d5fc[_0x2ab225(0xdc)]=new Set();else Array[_0x2ab225(0xc9)](_0x33d5fc[_0x2ab225(0xdc)])&&(_0x33d5fc[_0x2ab225(0xdc)]=new Set(_0x33d5fc[_0x2ab225(0xdc)]));_0x33d5fc[_0x2ab225(0xe1)]=_0x5750b3;let _0x21e4c2=![];_0x4b7b8e[_0x2ab225(0xbc)](_0x5e704a[_0x2ab225(0xd4)],_0x4b7b8e[_0x2ab225(0xcb)])&&(_0x33d5fc[_0x2ab225(0xb8)]+=0x1,!_0x33d5fc[_0x2ab225(0xdc)][_0x2ab225(0xe4)](_0x5e704a['fullName'])&&(_0x33d5fc['uniqueFailedTests'][_0x2ab225(0xca)](_0x5e704a[_0x2ab225(0xb4)]),_0x21e4c2=!![]));await this[_0x2ab225(0xb1)](_0x33d5fc);const _0x492208={};return _0x492208[_0x2ab225(0xe5)]=_0x33d5fc,_0x492208[_0x2ab225(0xdd)]=_0x21e4c2,_0x492208;}finally{await this['releaseLock'](_0x2f0625);}}async['updateAPIFailedCount'](_0x417e44){const _0x1f71a7=a126_0x2207d1,_0x54ff32=await this[_0x1f71a7(0xe7)]();if(!_0x54ff32)return logger[_0x1f71a7(0xbd)]('['+TAG+']\x20Could\x20not\x20acquire\x20lock\x20to\x20update\x20API\x20failed\x20count.\x20State\x20may\x20be\x20stale.'),this[_0x1f71a7(0xe3)]()||this[_0x1f71a7(0xd0)];try{let _0x52d8dc=this['readState']();return!_0x52d8dc&&(_0x52d8dc=JSON[_0x1f71a7(0xc8)](JSON[_0x1f71a7(0xc2)](this['defaultState']))),_0x52d8dc['lastAPIFailedCount']=_0x417e44,await this[_0x1f71a7(0xb1)](_0x52d8dc),_0x52d8dc;}finally{await this[_0x1f71a7(0xba)](_0x54ff32);}}}module[a126_0x2207d1(0xd2)]=FileHelper;