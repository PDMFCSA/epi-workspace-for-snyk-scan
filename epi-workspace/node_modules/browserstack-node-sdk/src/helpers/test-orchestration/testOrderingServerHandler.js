const a137_0x1f67ef=a137_0x4da5;function a137_0x3406(){const _0x312a47=['[processSplitTestsResponse]\x20timeout:\x20','toString','timeoutInterval',',\x20timeoutUrl:\x20','275GAAdFX','splitTests','debug','getOrderedTestFiles','timeout','477425dymgSt','rGDxL','env','iEQCr','tests','FfMzo','resultUrl','217216xrOgiK','Ojlno','[getOrderedTestFiles]\x20Fetching\x20ordered\x20tests\x20from\x20timeout\x20URL','stack','279852xALgNy','map','release','length','BROWSERSTACK_NODE_INDEX','body','WKtxj','freemem','totalmem','processSplitTestsResponse','3SufhOW','config','splitTestsAPICallCount','timeoutUrl','50850GTbYdm','JSQLI','[getOrderedTestFiles]\x20Fetching\x20ordered\x20tests\x20from\x20result\x20URL:\x20','projectName','platform','[getOrderedTestFiles]\x20Exception\x20in\x20fetching\x20ordered\x20test\x20files:\x20','exports','arch','filePath','52JJlZau','1357515XTgjyx','bPGGy','ABMxx',',\x20resultUrl:\x20','now','2676iZGffR','defaultTimeout','6CxJZkM','[getOrderedTestFiles]\x20Fetching\x20ordered\x20test\x20files','buildName','defaultTimeoutInterval','_getHostInfo','getSplitFiles','hostname',',\x20timeoutInterval:\x20','postSplitFiles','[processSplitTestsResponse]\x20Received\x20null\x20value(s)\x20for\x20some\x20attributes\x20in\x20split\x20tests\x20API\x20response','stringify','[getOrderedTestFiles]\x20Response\x20from\x20result\x20URL:\x20','380758QMwGIO'];a137_0x3406=function(){return _0x312a47;};return a137_0x3406();}(function(_0x5ce4d0,_0x1c915a){const _0x4d4465=a137_0x4da5,_0x319563=_0x5ce4d0();while(!![]){try{const _0x390627=-parseInt(_0x4d4465(0x176))/0x1*(parseInt(_0x4d4465(0x170))/0x2)+-parseInt(_0x4d4465(0x163))/0x3*(parseInt(_0x4d4465(0x159))/0x4)+parseInt(_0x4d4465(0x14e))/0x5*(-parseInt(_0x4d4465(0x178))/0x6)+parseInt(_0x4d4465(0x184))/0x7+parseInt(_0x4d4465(0x155))/0x8+parseInt(_0x4d4465(0x171))/0x9+-parseInt(_0x4d4465(0x167))/0xa*(-parseInt(_0x4d4465(0x189))/0xb);if(_0x390627===_0x1c915a)break;else _0x319563['push'](_0x319563['shift']());}catch(_0x2f99ad){_0x319563['push'](_0x319563['shift']());}}}(a137_0x3406,0x1e642));const logger=require('../logger')['winstonLogger'],RequestUtils=require('./requestUtils');class TestOrderingServerHandler{constructor(_0x5c7a74){const _0x4c449d=a137_0x4da5;this[_0x4c449d(0x164)]=_0x5c7a74,this[_0x4c449d(0x165)]=0x0,this[_0x4c449d(0x177)]=0x3c,this[_0x4c449d(0x17b)]=0x5;}['getSplitTestsAPICallCount'](){const _0x47c7e7=a137_0x4da5;return this[_0x47c7e7(0x165)];}[a137_0x1f67ef(0x162)](_0x4681d2){const _0x347220=a137_0x1f67ef,_0x102350={};_0x102350[_0x347220(0x168)]=_0x347220(0x181);const _0x546550=_0x102350;if(!_0x4681d2)return null;const _0x53dae6={};return _0x53dae6['timeout']=_0x4681d2['timeout']||this[_0x347220(0x177)],_0x53dae6[_0x347220(0x187)]=_0x4681d2[_0x347220(0x187)]||this[_0x347220(0x17b)],_0x53dae6['resultUrl']=_0x4681d2[_0x347220(0x154)],_0x53dae6[_0x347220(0x166)]=_0x4681d2[_0x347220(0x166)],logger[_0x347220(0x14b)]('[processSplitTestsResponse]\x20Processing\x20response:\x20'+JSON['stringify'](_0x4681d2)),logger[_0x347220(0x14b)](_0x347220(0x185)+_0x4681d2['timeout']+_0x347220(0x17f)+_0x4681d2[_0x347220(0x187)]+_0x347220(0x174)+_0x4681d2[_0x347220(0x154)]+_0x347220(0x188)+_0x4681d2[_0x347220(0x166)]),(!_0x4681d2[_0x347220(0x14d)]||!_0x4681d2[_0x347220(0x187)]||!_0x4681d2[_0x347220(0x166)]||!_0x4681d2[_0x347220(0x154)])&&logger[_0x347220(0x14b)](_0x546550[_0x347220(0x168)]),_0x53dae6;}async[a137_0x1f67ef(0x18a)](_0x13222f,_0x3569dd){const _0x5515ae=a137_0x1f67ef,_0x3eb9e3={'Ojlno':function(_0x39242b,_0x220cf5){return _0x39242b(_0x220cf5);}};try{const _0x3de5fd=_0x3eb9e3[_0x5515ae(0x156)](parseInt,process[_0x5515ae(0x150)][_0x5515ae(0x15d)]||'0'),_0x499870=_0x3eb9e3[_0x5515ae(0x156)](parseInt,process[_0x5515ae(0x150)]['BROWSERSTACK_TOTAL_NODE_COUNT']||'1'),_0x3e1fdb=process[_0x5515ae(0x150)]['BROWSERSTACK_BUILD_RUN_IDENTIFIER'],_0x18b733={'nodeIndex':_0x3de5fd,'totalNodes':_0x499870,'projectName':this[_0x5515ae(0x164)][_0x5515ae(0x16a)],'buildName':this['config'][_0x5515ae(0x17a)],'buildRunIdentifier':_0x3e1fdb,'orchestrationStrategy':_0x3569dd,'hostInfo':this[_0x5515ae(0x17c)](),'tests':_0x13222f[_0x5515ae(0x15a)](_0x372b11=>({'filePath':_0x372b11}))},_0x32ce7f=await RequestUtils[_0x5515ae(0x180)](_0x18b733);return logger[_0x5515ae(0x14b)]('[splitTests]\x20Response\x20from\x20split\x20tests\x20API:\x20'+JSON[_0x5515ae(0x182)](_0x32ce7f)),this['splitTestsAPICallCount']+=0x1,this[_0x5515ae(0x162)](_0x32ce7f[_0x5515ae(0x15e)]||{});}catch(_0x2e277a){return logger[_0x5515ae(0x14b)]('[splitTests]\x20Exception\x20in\x20sending\x20test\x20files:\x20'+(_0x2e277a[_0x5515ae(0x158)]||_0x2e277a[_0x5515ae(0x186)]())),null;}}async[a137_0x1f67ef(0x14c)](_0x3c477e){const _0x570388=a137_0x1f67ef,_0x460b8e={};_0x460b8e[_0x570388(0x151)]=_0x570388(0x179),_0x460b8e['FfMzo']=function(_0x4754c5,_0x4d7e2a){return _0x4754c5*_0x4d7e2a;},_0x460b8e[_0x570388(0x14f)]=function(_0x550917,_0x445011){return _0x550917&&_0x445011;},_0x460b8e['ABMxx']=function(_0x21e88f,_0x3344fe){return _0x21e88f<_0x3344fe;},_0x460b8e['UwhZJ']=function(_0x505add,_0xabb7be){return _0x505add-_0xabb7be;},_0x460b8e['bPGGy']=_0x570388(0x157),_0x460b8e[_0x570388(0x15f)]=function(_0x123afd,_0x4df482){return _0x123afd>_0x4df482;};const _0x3f9e8e=_0x460b8e;if(!_0x3c477e)return null;try{logger[_0x570388(0x14b)](_0x3f9e8e[_0x570388(0x151)]);const _0x2a15aa=_0x3c477e[_0x570388(0x187)]||this[_0x570388(0x17b)],_0x39d301=_0x3f9e8e[_0x570388(0x153)](_0x3c477e[_0x570388(0x14d)]||this['defaultTimeout'],0x3e8),_0x3e3814=_0x3c477e['timeoutUrl'],_0x5216a1=_0x3c477e['resultUrl'];if(_0x3f9e8e['rGDxL'](!_0x5216a1,!_0x3e3814))return null;let _0x763af6=null;const _0x11fddb=Date['now']();while(_0x5216a1&&_0x3f9e8e[_0x570388(0x173)](_0x3f9e8e['UwhZJ'](Date[_0x570388(0x175)](),_0x11fddb),_0x39d301)){logger['debug'](_0x570388(0x169)+_0x5216a1);const _0x5b4600=await RequestUtils['getSplitFiles'](_0x5216a1);logger[_0x570388(0x14b)](_0x570388(0x183)+JSON['stringify'](_0x5b4600)),this['splitTestsAPICallCount']+=0x1;if(_0x5b4600&&_0x5b4600[_0x570388(0x152)]){_0x763af6=_0x5b4600[_0x570388(0x152)];break;}await new Promise(_0x5037cd=>setTimeout(_0x5037cd,_0x2a15aa*0x3e8)),logger[_0x570388(0x14b)]('[getOrderedTestFiles]\x20Fetching\x20ordered\x20tests\x20from\x20result\x20URL\x20after\x20waiting\x20for\x20'+_0x2a15aa+'\x20seconds.');}if(_0x3f9e8e[_0x570388(0x14f)](!_0x763af6,_0x3e3814)){logger[_0x570388(0x14b)](_0x3f9e8e[_0x570388(0x172)]);const _0xcf9f30=await RequestUtils[_0x570388(0x17d)](_0x3e3814);_0xcf9f30&&_0xcf9f30[_0x570388(0x152)]&&(_0x763af6=_0xcf9f30['tests']);}if(_0x763af6&&_0x3f9e8e[_0x570388(0x15f)](_0x763af6[_0x570388(0x15c)],0x0))return _0x763af6[_0x570388(0x15a)](_0x1f06f9=>_0x1f06f9[_0x570388(0x16f)]);return null;}catch(_0x132f19){return logger[_0x570388(0x14b)](_0x570388(0x16c)+(_0x132f19['stack']||_0x132f19['toString']())),null;}}[a137_0x1f67ef(0x17c)](){const _0x491492=a137_0x1f67ef,_0x3ae854={'ChxLa':function(_0x4028bc,_0x43dd9f){return _0x4028bc(_0x43dd9f);}},_0xd1b084=_0x3ae854['ChxLa'](require,'os');try{return{'hostname':_0xd1b084[_0x491492(0x17e)](),'platform':_0xd1b084[_0x491492(0x16b)](),'release':_0xd1b084[_0x491492(0x15b)](),'arch':_0xd1b084[_0x491492(0x16e)](),'totalmem':_0xd1b084[_0x491492(0x161)](),'freemem':_0xd1b084[_0x491492(0x160)]()};}catch(_0x88998e){return{};}}}function a137_0x4da5(_0x5bb30d,_0x3a3e0f){const _0x34063a=a137_0x3406();return a137_0x4da5=function(_0x4da588,_0x6524c6){_0x4da588=_0x4da588-0x14b;let _0x4059ca=_0x34063a[_0x4da588];return _0x4059ca;},a137_0x4da5(_0x5bb30d,_0x3a3e0f);}module[a137_0x1f67ef(0x16d)]=TestOrderingServerHandler;