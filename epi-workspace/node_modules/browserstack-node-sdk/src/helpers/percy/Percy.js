const a101_0x44aa40=a101_0x3d3c;(function(_0x59548a,_0x157b59){const _0x57ac1=a101_0x3d3c,_0x598dcc=_0x59548a();while(!![]){try{const _0x1c7986=parseInt(_0x57ac1(0x199))/0x1*(parseInt(_0x57ac1(0x19a))/0x2)+parseInt(_0x57ac1(0x1b0))/0x3+parseInt(_0x57ac1(0x186))/0x4*(-parseInt(_0x57ac1(0x16f))/0x5)+-parseInt(_0x57ac1(0x168))/0x6*(parseInt(_0x57ac1(0x17c))/0x7)+parseInt(_0x57ac1(0x19c))/0x8*(parseInt(_0x57ac1(0x177))/0x9)+parseInt(_0x57ac1(0x189))/0xa*(parseInt(_0x57ac1(0x16d))/0xb)+-parseInt(_0x57ac1(0x196))/0xc*(parseInt(_0x57ac1(0x171))/0xd);if(_0x1c7986===_0x157b59)break;else _0x598dcc['push'](_0x598dcc['shift']());}catch(_0x57962c){_0x598dcc['push'](_0x598dcc['shift']());}}}(a101_0x27b8,0x8cac4));function a101_0x3d3c(_0x459d1a,_0x4b2f21){const _0x27b828=a101_0x27b8();return a101_0x3d3c=function(_0x3d3c12,_0x42568c){_0x3d3c12=_0x3d3c12-0x168;let _0x457ffc=_0x27b828[_0x3d3c12];return _0x457ffc;},a101_0x3d3c(_0x459d1a,_0x4b2f21);}const fs=require('fs'),path=require(a101_0x44aa40(0x1aa)),os=require('os'),{spawn}=require(a101_0x44aa40(0x1ab)),helper=require(a101_0x44aa40(0x182)),logger=require(a101_0x44aa40(0x1a5))[a101_0x44aa40(0x176)],{getLogDir}=require(a101_0x44aa40(0x1a5)),testHubConstants=require(a101_0x44aa40(0x16e)),PerformanceTester=require(a101_0x44aa40(0x178)),{PERCY_EVENTS:PerformanceEvents}=require(a101_0x44aa40(0x1a7)),PercyBinary=require(a101_0x44aa40(0x170));class Percy{#logfile=path[a101_0x44aa40(0x191)](getLogDir(),a101_0x44aa40(0x183));#address=process[a101_0x44aa40(0x16c)][a101_0x44aa40(0x18e)]||'http://localhost:5338';#binaryPath=null;#config=null;#proc=null;#isApp=![];[a101_0x44aa40(0x174)]=![];constructor(_0x54f280){this.#config=_0x54f280,!!_0x54f280['app']&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x1e5be7=a101_0x44aa40;if(!this.#binaryPath){const _0x285d56=new PercyBinary();PerformanceTester[_0x1e5be7(0x197)](PerformanceEvents[_0x1e5be7(0x185)]),this.#binaryPath=await _0x285d56[_0x1e5be7(0x19b)](this.#config),PerformanceTester[_0x1e5be7(0x173)](PerformanceEvents[_0x1e5be7(0x185)]);}return this.#binaryPath;}async #sleep(_0x2553d7){return new Promise(_0x39719f=>setTimeout(_0x39719f,_0x2553d7));}async[a101_0x44aa40(0x1a0)](){const _0x318314=a101_0x44aa40,_0xbfa589={};_0xbfa589[_0x318314(0x1b1)]=_0x318314(0x1a1),_0xbfa589[_0x318314(0x1a8)]=_0x318314(0x18c);const _0x565dc7=_0xbfa589;try{const _0x315c95=await helper['nodeRequest'](_0x565dc7[_0x318314(0x1b1)],_0x565dc7[_0x318314(0x1a8)],null,null,this.#address);if(_0x315c95)return!![];}catch(_0x57272a){return![];}}async['start'](){const _0xeb5f4c=a101_0x44aa40,_0x21e748={'NeGwp':_0xeb5f4c(0x169),'thdze':_0xeb5f4c(0x19e),'FgvER':function(_0x565551,_0x51ebb7,_0xc81180,_0x36f2d9){return _0x565551(_0x51ebb7,_0xc81180,_0x36f2d9);},'KCAlY':_0xeb5f4c(0x1af),'Mgwtx':_0xeb5f4c(0x18a)},_0x1bf337=await this.#getBinaryPath(),_0x1f5603={};_0x1f5603[_0xeb5f4c(0x198)]='a';const _0x17ce5b=fs['createWriteStream'](this.#logfile,_0x1f5603),_0x106ee4=await this[_0xeb5f4c(0x195)](),_0x155fac=await this[_0xeb5f4c(0x1b4)]();if(!_0x106ee4)return![];const _0x35cbdf=[(this.#isApp?_0x21e748[_0xeb5f4c(0x1ae)]:_0x21e748[_0xeb5f4c(0x19f)])+_0xeb5f4c(0x1a3)];_0x155fac&&_0x35cbdf['push']('-c',_0x155fac);this.#proc=_0x21e748['FgvER'](spawn,_0x1bf337,_0x35cbdf,{'env':Object[_0xeb5f4c(0x1a6)](process['env'],{'PERCY_TOKEN':_0x106ee4,'TH_BUILD_UUID':process['env'][testHubConstants['ENV_VAR'][_0xeb5f4c(0x1b3)]]})}),this.#proc[_0xeb5f4c(0x187)][_0xeb5f4c(0x181)](_0x17ce5b),this.#proc['stderr'][_0xeb5f4c(0x181)](_0x17ce5b),this[_0xeb5f4c(0x174)]=!![];var _0x77a44c=this;this.#proc['on'](_0x21e748[_0xeb5f4c(0x17d)],function(_0x45269f){_0x77a44c['isProcessRunning']=![];});do{const _0x101561=await this[_0xeb5f4c(0x1a0)]();if(_0x101561)return logger[_0xeb5f4c(0x16b)](_0x21e748[_0xeb5f4c(0x19d)]),!![];await this.#sleep(0x3e8);}while(this[_0xeb5f4c(0x174)]);return![];}async['stop'](){const _0x11b82d={'YXZow':function(_0x42a0dd,_0x30d0eb){return _0x42a0dd(_0x30d0eb);},'MskOk':function(_0x1c2431,_0x33e26e,_0x522412){return _0x1c2431(_0x33e26e,_0x522412);},'Qiexb':'exec:stop','etsxR':'close'},_0x43922c=await this.#getBinaryPath();return new Promise((_0x272f06,_0x4178b6)=>{const _0x42f79a=a101_0x3d3c,_0x2deba0=_0x11b82d['MskOk'](spawn,_0x43922c,[_0x11b82d[_0x42f79a(0x16a)]]);_0x2deba0['on'](_0x11b82d['etsxR'],_0x392536=>{const _0x5a5adf=_0x42f79a;this[_0x5a5adf(0x174)]=![],_0x11b82d['YXZow'](_0x272f06,_0x392536);});});}['isRunning'](){const _0x44bb4c=a101_0x44aa40;return this[_0x44bb4c(0x174)];}async[a101_0x44aa40(0x195)](){const _0x7ffc0a=a101_0x44aa40,_0x3f36da={};_0x3f36da[_0x7ffc0a(0x17e)]='app',_0x3f36da['eKKEs']=_0x7ffc0a(0x18b),_0x3f36da[_0x7ffc0a(0x172)]=_0x7ffc0a(0x1a1),_0x3f36da[_0x7ffc0a(0x1a2)]=_0x7ffc0a(0x175);const _0x7184a2=_0x3f36da,_0x39bc5f=this.#config['projectName'];try{const _0xc60bbe=this.#isApp?_0x7184a2['pLkZo']:_0x7184a2[_0x7ffc0a(0x1a4)],_0x381031=await helper[_0x7ffc0a(0x1b2)](_0x7184a2[_0x7ffc0a(0x172)],_0x7ffc0a(0x18d)+_0x39bc5f+_0x7ffc0a(0x194)+_0xc60bbe,{},this.#config),_0x55b93c=_0x381031[_0x7ffc0a(0x17a)];return logger[_0x7ffc0a(0x16b)](_0x7184a2[_0x7ffc0a(0x1a2)]),_0x55b93c['token'];}catch(_0x596b1e){return logger[_0x7ffc0a(0x1a9)]('Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20'+_0x596b1e),null;}}async[a101_0x44aa40(0x1b4)](){const _0x1978e6=a101_0x44aa40,_0x16f496={'ezXUr':function(_0xc329b2,_0x3fae05){return _0xc329b2(_0x3fae05);},'CquMh':function(_0x12a346,_0x588e0e){return _0x12a346+_0x588e0e;},'tdiny':_0x1978e6(0x192),'sXgNO':function(_0x373209,_0x146db8){return _0x373209(_0x146db8);},'KDuUr':'percy.json'};if(!this.#config[_0x1978e6(0x179)])return null;const _0x1f2a8e=path['join'](os[_0x1978e6(0x193)](),_0x16f496[_0x1978e6(0x1ad)]),_0x59187c=this.#config[_0x1978e6(0x179)];return!_0x59187c[_0x1978e6(0x17b)]&&(_0x59187c['version']='2'),new Promise((_0xaedd56,_0x2721c5)=>{const _0x18a923=_0x1978e6;fs[_0x18a923(0x180)](_0x1f2a8e,JSON[_0x18a923(0x17f)](_0x59187c),_0x16ee1f=>{const _0x228f2b=_0x18a923;_0x16ee1f&&(logger[_0x228f2b(0x1a9)]('Error\x20creating\x20percy\x20config:\x20'+_0x16ee1f),_0x16f496[_0x228f2b(0x1ac)](_0xaedd56,null)),logger[_0x228f2b(0x16b)](_0x16f496[_0x228f2b(0x190)](_0x16f496[_0x228f2b(0x188)],_0x1f2a8e)),_0x16f496[_0x228f2b(0x18f)](_0xaedd56,_0x1f2a8e);});});}}function a101_0x27b8(){const _0x3eb784=['9CQEvmJ','../../helpers/performance/performance-tester','percyOptions','data','version','2853984cyolkD','KCAlY','pLkZo','stringify','writeFile','pipe','../helper','percy.log','exports','DOWNLOAD','76LLHfqW','stdout','tdiny','2210CObPYk','Percy\x20healthcheck\x20successful','automate','percy/healthcheck','api/app_percy/get_project_token?name=','PERCY_SERVER_ADDRESS','sXgNO','CquMh','join','Percy\x20config\x20created\x20at\x20','tmpdir','&type=','fetchPercyToken','15230436NZNjOg','start','flags','952667GQJysV','2arChPA','getBinaryPath','3879152iLlurH','Mgwtx','exec','thdze','healthcheck','GET','AKIoh',':start','eKKEs','../logger','assign','../../helpers/performance/constants','uCFdZ','error','path','child_process','ezXUr','KDuUr','NeGwp','close','2072841frplCF','aRjUn','nodeRequest','BROWSERSTACK_TESTHUB_UUID','createPercyConfig','12iVlmwc','app:exec','Qiexb','debug','env','34199XRLsIJ','../../helpers/testhub/constants','40730SIcMSB','./PercyBinary','13ycJXsW','sZipI','end','isProcessRunning','Percy\x20fetch\x20token\x20success','winstonLogger'];a101_0x27b8=function(){return _0x3eb784;};return a101_0x27b8();}module[a101_0x44aa40(0x184)]=Percy;