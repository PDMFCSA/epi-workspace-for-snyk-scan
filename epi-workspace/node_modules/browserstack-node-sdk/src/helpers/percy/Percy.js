const a113_0x2a4d82=a113_0x31bd;(function(_0xbeefac,_0xa2a6f0){const _0x452225=a113_0x31bd,_0x14f9c6=_0xbeefac();while(!![]){try{const _0x5432ff=parseInt(_0x452225(0x11b))/0x1*(-parseInt(_0x452225(0x161))/0x2)+parseInt(_0x452225(0x127))/0x3+-parseInt(_0x452225(0x163))/0x4*(parseInt(_0x452225(0x128))/0x5)+-parseInt(_0x452225(0x12f))/0x6*(parseInt(_0x452225(0x12a))/0x7)+parseInt(_0x452225(0x14f))/0x8+parseInt(_0x452225(0x148))/0x9*(parseInt(_0x452225(0x124))/0xa)+parseInt(_0x452225(0x120))/0xb*(parseInt(_0x452225(0x139))/0xc);if(_0x5432ff===_0xa2a6f0)break;else _0x14f9c6['push'](_0x14f9c6['shift']());}catch(_0x1925a8){_0x14f9c6['push'](_0x14f9c6['shift']());}}}(a113_0x4219,0xbbf56));const fs=require('fs'),path=require(a113_0x2a4d82(0x12e)),os=require('os'),{spawn}=require(a113_0x2a4d82(0x14c)),helper=require(a113_0x2a4d82(0x15f)),logger=require(a113_0x2a4d82(0x11e))['winstonLogger'],{getLogDir}=require(a113_0x2a4d82(0x11e)),testHubConstants=require(a113_0x2a4d82(0x168)),PerformanceTester=require(a113_0x2a4d82(0x133)),{PERCY_EVENTS:PerformanceEvents}=require(a113_0x2a4d82(0x15b)),PercyBinary=require(a113_0x2a4d82(0x12b));class Percy{#logfile=path[a113_0x2a4d82(0x153)](getLogDir(),'percy.log');#address=process[a113_0x2a4d82(0x119)]['PERCY_SERVER_ADDRESS']||a113_0x2a4d82(0x150);#binaryPath=null;#config=null;#proc=null;#logStream=null;#isApp=![];[a113_0x2a4d82(0x145)]=![];constructor(_0x6d460d){this.#config=_0x6d460d,!!_0x6d460d['app']&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x306631=a113_0x2a4d82;if(!this.#binaryPath){const _0xa6328d=new PercyBinary();PerformanceTester[_0x306631(0x151)](PerformanceEvents[_0x306631(0x11f)]),this.#binaryPath=await _0xa6328d[_0x306631(0x144)](this.#config),PerformanceTester[_0x306631(0x134)](PerformanceEvents[_0x306631(0x11f)]);}return this.#binaryPath;}async #sleep(_0x57f3ac){return new Promise(_0x35b4b9=>setTimeout(_0x35b4b9,_0x57f3ac));}async[a113_0x2a4d82(0x143)](){const _0x4ccc7f=a113_0x2a4d82,_0x23b796={};_0x23b796[_0x4ccc7f(0x138)]='GET',_0x23b796[_0x4ccc7f(0x11a)]=_0x4ccc7f(0x147);const _0x5669ba=_0x23b796;try{const _0x3f5b7e=await helper[_0x4ccc7f(0x162)](_0x5669ba[_0x4ccc7f(0x138)],_0x5669ba[_0x4ccc7f(0x11a)],null,null,this.#address);if(_0x3f5b7e)return!![];}catch(_0x3675e1){return![];}}async[a113_0x2a4d82(0x151)](){const _0xf75396=a113_0x2a4d82,_0x3f87fd={'gBBow':_0xf75396(0x141),'kuxSK':_0xf75396(0x13f),'eenZX':function(_0x2d07b1,_0x2c2e57,_0x2bbd94,_0x4c085f){return _0x2d07b1(_0x2c2e57,_0x2bbd94,_0x4c085f);},'HEwhN':'close','uySxo':_0xf75396(0x11c)},_0xdcd726=await this.#getBinaryPath(),_0x41585c={};_0x41585c[_0xf75396(0x146)]='a',this.#logStream=fs[_0xf75396(0x14b)](this.#logfile,_0x41585c);const _0x1b7a1d=await this['fetchPercyToken'](),_0x2efe84=await this[_0xf75396(0x13d)]();if(!_0x1b7a1d)return![];const _0x53914c=[(this.#isApp?_0x3f87fd[_0xf75396(0x14e)]:_0x3f87fd['kuxSK'])+_0xf75396(0x156)];_0x2efe84&&_0x53914c[_0xf75396(0x12c)]('-c',_0x2efe84);this.#proc=_0x3f87fd[_0xf75396(0x15e)](spawn,_0xdcd726,_0x53914c,{'env':Object['assign'](process['env'],{'PERCY_TOKEN':_0x1b7a1d,'TH_BUILD_UUID':process[_0xf75396(0x119)][testHubConstants['ENV_VAR'][_0xf75396(0x169)]]})}),this.#proc[_0xf75396(0x142)][_0xf75396(0x13e)](this.#logStream),this.#proc[_0xf75396(0x125)]['pipe'](this.#logStream),this[_0xf75396(0x145)]=!![];var _0x58a196=this;this.#proc['on'](_0x3f87fd['HEwhN'],function(_0x23a3ec){const _0x52fcaf=_0xf75396;_0x58a196[_0x52fcaf(0x145)]=![];});do{const _0x55ab40=await this[_0xf75396(0x143)]();if(_0x55ab40)return logger[_0xf75396(0x11d)](_0x3f87fd[_0xf75396(0x155)]),!![];await this.#sleep(0x3e8);}while(this[_0xf75396(0x145)]);return![];}async['stop'](){const _0x34f006=a113_0x2a4d82,_0x5c5e6b={'Hmstn':function(_0x5e21f8,_0x68f8ac){return _0x5e21f8(_0x68f8ac);},'EKwAA':function(_0x1cc757,_0x238fc7,_0x13424b){return _0x1cc757(_0x238fc7,_0x13424b);},'GBoti':_0x34f006(0x123),'HpElj':_0x34f006(0x166)},_0x2f4643=await this.#getBinaryPath();return new Promise((_0x2556f2,_0x36f1b3)=>{const _0x46c0c8=_0x34f006,_0x3dde48=_0x5c5e6b[_0x46c0c8(0x13c)](spawn,_0x2f4643,[_0x5c5e6b[_0x46c0c8(0x164)]]);_0x3dde48['on'](_0x5c5e6b[_0x46c0c8(0x12d)],_0x401aba=>{const _0x5e9cc1=_0x46c0c8;this[_0x5e9cc1(0x145)]=![],this.#logStream&&(this.#logStream[_0x5e9cc1(0x134)](),this.#logStream=null),_0x5c5e6b[_0x5e9cc1(0x167)](_0x2556f2,_0x401aba);});});}['isRunning'](){return this['isProcessRunning'];}async[a113_0x2a4d82(0x154)](){const _0x297bf8=a113_0x2a4d82,_0x155f4a={};_0x155f4a['xdlAf']=_0x297bf8(0x131),_0x155f4a['eCqeW']=_0x297bf8(0x122),_0x155f4a[_0x297bf8(0x15c)]=_0x297bf8(0x157),_0x155f4a[_0x297bf8(0x14a)]=_0x297bf8(0x158);const _0x468d12=_0x155f4a,_0xeb76b7=this.#config['projectName'];try{const _0x1c9695=this.#isApp?_0x468d12[_0x297bf8(0x149)]:_0x468d12[_0x297bf8(0x121)],_0x233c39=await helper[_0x297bf8(0x162)](_0x468d12[_0x297bf8(0x15c)],_0x297bf8(0x118)+_0xeb76b7+'&type='+_0x1c9695,{},this.#config),_0x244883=_0x233c39[_0x297bf8(0x140)];return logger[_0x297bf8(0x11d)](_0x468d12[_0x297bf8(0x14a)]),_0x244883['token'];}catch(_0x453670){return logger[_0x297bf8(0x130)](_0x297bf8(0x126)+_0x453670),null;}}async[a113_0x2a4d82(0x13d)](){const _0x5ab769=a113_0x2a4d82,_0x17c70e={'uDppL':function(_0xfb17fa,_0x30c80d){return _0xfb17fa(_0x30c80d);},'WcoeY':function(_0x39dc6a,_0x296bce){return _0x39dc6a+_0x296bce;},'SuNRJ':_0x5ab769(0x14d),'bQaoM':_0x5ab769(0x136)};if(!this.#config['percyOptions'])return null;const _0x40e1ac=path[_0x5ab769(0x153)](os[_0x5ab769(0x15a)](),_0x17c70e[_0x5ab769(0x159)]),_0x32a99e=this.#config['percyOptions'];return!_0x32a99e[_0x5ab769(0x137)]&&(_0x32a99e['version']='2'),new Promise((_0x260d46,_0xc47526)=>{const _0xc12ac3=_0x5ab769,_0x2494be={'Qgsne':function(_0x16a7c5,_0x1da49c){const _0x16f1ee=a113_0x31bd;return _0x17c70e[_0x16f1ee(0x165)](_0x16a7c5,_0x1da49c);},'aEJRS':function(_0xff3a79,_0x5d7ea4){const _0x25d889=a113_0x31bd;return _0x17c70e[_0x25d889(0x15d)](_0xff3a79,_0x5d7ea4);},'bCqdw':_0x17c70e[_0xc12ac3(0x132)]};fs['writeFile'](_0x40e1ac,JSON[_0xc12ac3(0x129)](_0x32a99e),_0x57fa01=>{const _0x382bc3=_0xc12ac3;_0x57fa01&&(logger[_0x382bc3(0x130)](_0x382bc3(0x160)+_0x57fa01),_0x2494be[_0x382bc3(0x152)](_0x260d46,null)),logger[_0x382bc3(0x11d)](_0x2494be[_0x382bc3(0x13b)](_0x2494be[_0x382bc3(0x13a)],_0x40e1ac)),_0x2494be[_0x382bc3(0x152)](_0x260d46,_0x40e1ac);});});}}module[a113_0x2a4d82(0x135)]=Percy;function a113_0x31bd(_0x3e7f27,_0x35d37a){const _0x421985=a113_0x4219();return a113_0x31bd=function(_0x31bd20,_0x5be6eb){_0x31bd20=_0x31bd20-0x118;let _0x4edbfb=_0x421985[_0x31bd20];return _0x4edbfb;},a113_0x31bd(_0x3e7f27,_0x35d37a);}function a113_0x4219(){const _0x42eb54=['EKwAA','createPercyConfig','pipe','exec','data','app:exec','stdout','healthcheck','getBinaryPath','isProcessRunning','flags','percy/healthcheck','5242338EXqqDF','xdlAf','QkYLD','createWriteStream','child_process','Percy\x20config\x20created\x20at\x20','gBBow','6712608yEjKBE','http://localhost:5338','start','Qgsne','join','fetchPercyToken','uySxo',':start','GET','Percy\x20fetch\x20token\x20success','bQaoM','tmpdir','../../helpers/performance/constants','RbfDK','WcoeY','eenZX','../helper','Error\x20creating\x20percy\x20config:\x20','2TLYDgd','nodeRequest','120568KYMQDl','GBoti','uDppL','close','Hmstn','../../helpers/testhub/constants','BROWSERSTACK_TESTHUB_UUID','api/app_percy/get_project_token?name=','env','HyAtB','1304326zigaIe','Percy\x20healthcheck\x20successful','debug','../logger','DOWNLOAD','11rlaQkT','eCqeW','automate','exec:stop','10XQZDoT','stderr','Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20','426438GUCayp','85HXMCtQ','stringify','8652574YnuMdY','./PercyBinary','push','HpElj','path','6fSXgrs','error','app','SuNRJ','../../helpers/performance/performance-tester','end','exports','percy.json','version','JvBzy','27107952kyGaQj','bCqdw','aEJRS'];a113_0x4219=function(){return _0x42eb54;};return a113_0x4219();}