const a72_0x3cd1cd=a72_0x43dc;(function(_0x48a394,_0x436c4d){const _0xf8a47f=a72_0x43dc,_0x30bf28=_0x48a394();while(!![]){try{const _0x28ebb1=-parseInt(_0xf8a47f(0x168))/0x1*(-parseInt(_0xf8a47f(0x18a))/0x2)+-parseInt(_0xf8a47f(0x176))/0x3*(-parseInt(_0xf8a47f(0x192))/0x4)+parseInt(_0xf8a47f(0x160))/0x5+parseInt(_0xf8a47f(0x14f))/0x6+parseInt(_0xf8a47f(0x156))/0x7*(-parseInt(_0xf8a47f(0x14e))/0x8)+parseInt(_0xf8a47f(0x14d))/0x9+-parseInt(_0xf8a47f(0x153))/0xa*(parseInt(_0xf8a47f(0x197))/0xb);if(_0x28ebb1===_0x436c4d)break;else _0x30bf28['push'](_0x30bf28['shift']());}catch(_0x583944){_0x30bf28['push'](_0x30bf28['shift']());}}}(a72_0x12c5,0xa4f83));function a72_0x12c5(){const _0x5d8061=['percy.log','kbiTa','projectName','percyOptions','8ExvMTY','ENV_VAR','vsyFJ','createPercyConfig','feTCj','11ZmfNBI','app','../../helpers/testhub/constants','eCuhw','stop','BFHOO','join','../../helpers/performance/constants','writeFile','3169647uilSiu','3817424fEuKwS','5992860vulPdp','GET','env','tAiof','12324990biqFTf','tmpdir','api/app_percy/get_project_token?name=','14zgrnUN','error','PERCY_SERVER_ADDRESS','DOWNLOAD','end','healthcheck','close','child_process','LPoOZ','ZRwYy','495335EJdjZj','btHXk','Percy\x20healthcheck\x20successful','http://localhost:5338','EqTlN','version','percy/healthcheck','Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20','2PqswGg','data','nodeRequest','token','exports','vNtJS','aZWix','debug','percy.json','SEQEl','app:exec','stringify','fetchPercyToken','flags','1857627FNHdHO','./PercyBinary','SSaGX','start','../../helpers/performance/performance-tester','isRunning','path',':start','&type=','pipe','automate','push','stdout','../logger','winstonLogger','Percy\x20fetch\x20token\x20success','BROWSERSTACK_TESTHUB_UUID','isProcessRunning','Error\x20creating\x20percy\x20config:\x20','Percy\x20config\x20created\x20at\x20','174092jykEyl','assign','qYJua','SzOsS'];a72_0x12c5=function(){return _0x5d8061;};return a72_0x12c5();}const fs=require('fs'),path=require(a72_0x3cd1cd(0x17c)),os=require('os'),{spawn}=require(a72_0x3cd1cd(0x15d)),helper=require('../helper'),logger=require(a72_0x3cd1cd(0x183))[a72_0x3cd1cd(0x184)],{logDir}=require(a72_0x3cd1cd(0x183)),testHubConstants=require(a72_0x3cd1cd(0x199)),PerformanceTester=require(a72_0x3cd1cd(0x17a)),{PERCY_EVENTS:PerformanceEvents}=require(a72_0x3cd1cd(0x14b)),PercyBinary=require(a72_0x3cd1cd(0x177));class Percy{#logfile=path['join'](logDir,a72_0x3cd1cd(0x18e));#address=process[a72_0x3cd1cd(0x151)][a72_0x3cd1cd(0x158)]||a72_0x3cd1cd(0x163);#binaryPath=null;#config=null;#proc=null;#isApp=![];[a72_0x3cd1cd(0x187)]=![];constructor(_0x5b6ce4){const _0x3f2c3a=a72_0x3cd1cd;this.#config=_0x5b6ce4,!!_0x5b6ce4[_0x3f2c3a(0x198)]&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x12d0c7=a72_0x3cd1cd;if(!this.#binaryPath){const _0x3b5c51=new PercyBinary();PerformanceTester['start'](PerformanceEvents[_0x12d0c7(0x159)]),this.#binaryPath=await _0x3b5c51['getBinaryPath'](this.#config),PerformanceTester[_0x12d0c7(0x15a)](PerformanceEvents[_0x12d0c7(0x159)]);}return this.#binaryPath;}async #sleep(_0x1902d0){return new Promise(_0x3c42f3=>setTimeout(_0x3c42f3,_0x1902d0));}async[a72_0x3cd1cd(0x15b)](){const _0x2eca0f=a72_0x3cd1cd,_0x3f6a5f={};_0x3f6a5f[_0x2eca0f(0x18f)]=_0x2eca0f(0x150),_0x3f6a5f[_0x2eca0f(0x178)]=_0x2eca0f(0x166);const _0x378a3d=_0x3f6a5f;try{const _0x42c624=await helper[_0x2eca0f(0x16a)](_0x378a3d['kbiTa'],_0x378a3d[_0x2eca0f(0x178)],null,null,this.#address);if(_0x42c624)return!![];}catch(_0x329414){return![];}}async[a72_0x3cd1cd(0x179)](){const _0x37a8fe=a72_0x3cd1cd,_0x5c4f8b={'EqTlN':_0x37a8fe(0x172),'feTCj':'exec','itMDU':function(_0x405dca,_0x10646e,_0x304516,_0xe78a10){return _0x405dca(_0x10646e,_0x304516,_0xe78a10);},'qYJua':_0x37a8fe(0x15c),'otVlQ':_0x37a8fe(0x162)},_0x349e44=await this.#getBinaryPath(),_0x3af37b={};_0x3af37b[_0x37a8fe(0x175)]='a';const _0x217247=fs['createWriteStream'](this.#logfile,_0x3af37b),_0x81f7f9=await this[_0x37a8fe(0x174)](),_0x5e8c5d=await this[_0x37a8fe(0x195)]();if(!_0x81f7f9)return![];const _0x63d6da=[(this.#isApp?_0x5c4f8b[_0x37a8fe(0x164)]:_0x5c4f8b[_0x37a8fe(0x196)])+_0x37a8fe(0x17d)];_0x5e8c5d&&_0x63d6da[_0x37a8fe(0x181)]('-c',_0x5e8c5d);this.#proc=_0x5c4f8b['itMDU'](spawn,_0x349e44,_0x63d6da,{'env':Object[_0x37a8fe(0x18b)](process[_0x37a8fe(0x151)],{'PERCY_TOKEN':_0x81f7f9,'TH_BUILD_UUID':process[_0x37a8fe(0x151)][testHubConstants[_0x37a8fe(0x193)][_0x37a8fe(0x186)]]})}),this.#proc[_0x37a8fe(0x182)][_0x37a8fe(0x17f)](_0x217247),this.#proc['stderr']['pipe'](_0x217247),this[_0x37a8fe(0x187)]=!![];var _0x492de4=this;this.#proc['on'](_0x5c4f8b[_0x37a8fe(0x18c)],function(_0xd9111d){const _0x595429=_0x37a8fe;_0x492de4[_0x595429(0x187)]=![];});do{const _0x278f04=await this[_0x37a8fe(0x15b)]();if(_0x278f04)return logger['debug'](_0x5c4f8b['otVlQ']),!![];await this.#sleep(0x3e8);}while(this['isProcessRunning']);return![];}async[a72_0x3cd1cd(0x148)](){const _0x4423d2={'btHXk':function(_0x651917,_0x4100fa){return _0x651917(_0x4100fa);},'WWUGz':function(_0x48b746,_0x38448b,_0x56b5b9){return _0x48b746(_0x38448b,_0x56b5b9);},'eCuhw':'exec:stop','qBcWe':'close'},_0x5791b3=await this.#getBinaryPath();return new Promise((_0x50e3a4,_0x143265)=>{const _0x3b05a6=a72_0x43dc,_0x574a6a={'pCLfK':function(_0x2851ca,_0x11b9b9){const _0x464fdc=a72_0x43dc;return _0x4423d2[_0x464fdc(0x161)](_0x2851ca,_0x11b9b9);}},_0x78bbb7=_0x4423d2['WWUGz'](spawn,_0x5791b3,[_0x4423d2[_0x3b05a6(0x147)]]);_0x78bbb7['on'](_0x4423d2['qBcWe'],_0x17187d=>{const _0x3bd224=_0x3b05a6;this[_0x3bd224(0x187)]=![],_0x574a6a['pCLfK'](_0x50e3a4,_0x17187d);});});}[a72_0x3cd1cd(0x17b)](){return this['isProcessRunning'];}async[a72_0x3cd1cd(0x174)](){const _0x267d15=a72_0x3cd1cd,_0x1b9644={};_0x1b9644[_0x267d15(0x15e)]=_0x267d15(0x198),_0x1b9644[_0x267d15(0x16e)]=_0x267d15(0x180),_0x1b9644[_0x267d15(0x15f)]=_0x267d15(0x150),_0x1b9644[_0x267d15(0x194)]=_0x267d15(0x185);const _0x17a844=_0x1b9644,_0x46493f=this.#config[_0x267d15(0x190)];try{const _0x33e91d=this.#isApp?_0x17a844[_0x267d15(0x15e)]:_0x17a844[_0x267d15(0x16e)],_0x2d2370=await helper[_0x267d15(0x16a)](_0x17a844[_0x267d15(0x15f)],_0x267d15(0x155)+_0x46493f+_0x267d15(0x17e)+_0x33e91d,{},this.#config),_0x1483f7=_0x2d2370[_0x267d15(0x169)];return logger[_0x267d15(0x16f)](_0x17a844[_0x267d15(0x194)]),_0x1483f7[_0x267d15(0x16b)];}catch(_0x404904){return logger[_0x267d15(0x157)](_0x267d15(0x167)+_0x404904),null;}}async[a72_0x3cd1cd(0x195)](){const _0x5340ab=a72_0x3cd1cd,_0x402df4={'SzOsS':function(_0xc0f39a,_0x516eb3){return _0xc0f39a(_0x516eb3);},'tAiof':function(_0x34d6a0,_0x4ffc66){return _0x34d6a0+_0x4ffc66;},'SEQEl':_0x5340ab(0x189),'BFHOO':function(_0x3873f5,_0x5dd678){return _0x3873f5(_0x5dd678);},'vNtJS':_0x5340ab(0x170)};if(!this.#config[_0x5340ab(0x191)])return null;const _0x486635=path[_0x5340ab(0x14a)](os[_0x5340ab(0x154)](),_0x402df4[_0x5340ab(0x16d)]),_0x346ddf=this.#config[_0x5340ab(0x191)];return!_0x346ddf['version']&&(_0x346ddf[_0x5340ab(0x165)]='2'),new Promise((_0x439f68,_0x24bcec)=>{const _0x596d9c=_0x5340ab;fs[_0x596d9c(0x14c)](_0x486635,JSON[_0x596d9c(0x173)](_0x346ddf),_0x6d9ade=>{const _0x287711=_0x596d9c;_0x6d9ade&&(logger['error'](_0x287711(0x188)+_0x6d9ade),_0x402df4[_0x287711(0x18d)](_0x439f68,null)),logger['debug'](_0x402df4[_0x287711(0x152)](_0x402df4[_0x287711(0x171)],_0x486635)),_0x402df4[_0x287711(0x149)](_0x439f68,_0x486635);});});}}function a72_0x43dc(_0x5984b3,_0x24a21d){const _0x12c504=a72_0x12c5();return a72_0x43dc=function(_0x43dc52,_0x2421d5){_0x43dc52=_0x43dc52-0x147;let _0x32cc6b=_0x12c504[_0x43dc52];return _0x32cc6b;},a72_0x43dc(_0x5984b3,_0x24a21d);}module[a72_0x3cd1cd(0x16c)]=Percy;