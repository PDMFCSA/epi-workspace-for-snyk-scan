const a113_0x5c97bb=a113_0x1e06;(function(_0x43b6cd,_0x306509){const _0x34a17c=a113_0x1e06,_0x2e3e3c=_0x43b6cd();while(!![]){try{const _0x297308=parseInt(_0x34a17c(0x10d))/0x1*(-parseInt(_0x34a17c(0xf3))/0x2)+-parseInt(_0x34a17c(0xda))/0x3*(parseInt(_0x34a17c(0x114))/0x4)+parseInt(_0x34a17c(0xe5))/0x5*(-parseInt(_0x34a17c(0xe1))/0x6)+parseInt(_0x34a17c(0xfd))/0x7*(-parseInt(_0x34a17c(0xee))/0x8)+parseInt(_0x34a17c(0xfe))/0x9*(parseInt(_0x34a17c(0xe8))/0xa)+-parseInt(_0x34a17c(0x113))/0xb*(-parseInt(_0x34a17c(0x111))/0xc)+-parseInt(_0x34a17c(0x105))/0xd*(-parseInt(_0x34a17c(0x108))/0xe);if(_0x297308===_0x306509)break;else _0x2e3e3c['push'](_0x2e3e3c['shift']());}catch(_0x4a5d12){_0x2e3e3c['push'](_0x2e3e3c['shift']());}}}(a113_0x2733,0x80b1d));const fs=require('fs'),path=require('path'),os=require('os'),{spawn}=require(a113_0x5c97bb(0x11d)),helper=require(a113_0x5c97bb(0x126)),logger=require(a113_0x5c97bb(0xf7))[a113_0x5c97bb(0xdf)],{getLogDir}=require('../logger'),testHubConstants=require(a113_0x5c97bb(0x127)),PerformanceTester=require(a113_0x5c97bb(0xe2)),{PERCY_EVENTS:PerformanceEvents}=require(a113_0x5c97bb(0xe0)),PercyBinary=require(a113_0x5c97bb(0xe9));class Percy{#logfile=path[a113_0x5c97bb(0xeb)](getLogDir(),a113_0x5c97bb(0xe3));#address=process[a113_0x5c97bb(0xfb)][a113_0x5c97bb(0x10a)]||a113_0x5c97bb(0x103);#binaryPath=null;#config=null;#proc=null;#logStream=null;#isApp=![];[a113_0x5c97bb(0x11c)]=![];constructor(_0x15ddf2){const _0x32a9a8=a113_0x5c97bb;this.#config=_0x15ddf2,!!_0x15ddf2[_0x32a9a8(0x115)]&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x1ecba2=a113_0x5c97bb;if(!this.#binaryPath){const _0x56b6f1=new PercyBinary();PerformanceTester[_0x1ecba2(0xe6)](PerformanceEvents[_0x1ecba2(0x11b)]),this.#binaryPath=await _0x56b6f1['getBinaryPath'](this.#config),PerformanceTester[_0x1ecba2(0xef)](PerformanceEvents[_0x1ecba2(0x11b)]);}return this.#binaryPath;}async #sleep(_0x52404a){return new Promise(_0x48a7f5=>setTimeout(_0x48a7f5,_0x52404a));}async[a113_0x5c97bb(0x128)](){const _0x13acbc=a113_0x5c97bb,_0x502c84={};_0x502c84['qdSZG']=_0x13acbc(0xf9),_0x502c84[_0x13acbc(0x10f)]=_0x13acbc(0x12a);const _0x6a9f0a=_0x502c84;try{const _0x1c93fe=await helper[_0x13acbc(0x104)](_0x6a9f0a['qdSZG'],_0x6a9f0a[_0x13acbc(0x10f)],null,null,this.#address);if(_0x1c93fe)return!![];}catch(_0x14f666){return![];}}async['start'](){const _0x29e046=a113_0x5c97bb,_0xda4748={'BguOC':_0x29e046(0xf6),'yvgtx':'exec','OkIau':function(_0x46e5ca,_0x23b292,_0x878708,_0x52b408){return _0x46e5ca(_0x23b292,_0x878708,_0x52b408);},'qxdDp':_0x29e046(0xde),'VyjaU':_0x29e046(0xe7)},_0x439881=await this.#getBinaryPath(),_0x258e8b={};_0x258e8b['flags']='a',this.#logStream=fs['createWriteStream'](this.#logfile,_0x258e8b);const _0x51bb57=await this[_0x29e046(0xfc)](),_0x55b447=await this[_0x29e046(0x125)]();if(!_0x51bb57)return![];const _0x31281c=[(this.#isApp?_0xda4748['BguOC']:_0xda4748['yvgtx'])+_0x29e046(0x120)];_0x55b447&&_0x31281c['push']('-c',_0x55b447);this.#proc=_0xda4748[_0x29e046(0x10b)](spawn,_0x439881,_0x31281c,{'env':Object[_0x29e046(0x119)](process['env'],{'PERCY_TOKEN':_0x51bb57,'TH_BUILD_UUID':process[_0x29e046(0xfb)][testHubConstants[_0x29e046(0x123)]['BROWSERSTACK_TESTHUB_UUID']]})}),this.#proc[_0x29e046(0x10c)]['pipe'](this.#logStream),this.#proc[_0x29e046(0x129)]['pipe'](this.#logStream),this[_0x29e046(0x11c)]=!![];var _0x5f0e1f=this;this.#proc['on'](_0xda4748[_0x29e046(0xf1)],function(_0x449472){const _0xae1679=_0x29e046;_0x5f0e1f[_0xae1679(0x11c)]=![];});do{const _0x11726c=await this[_0x29e046(0x128)]();if(_0x11726c)return logger['debug'](_0xda4748['VyjaU']),!![];await this.#sleep(0x3e8);}while(this[_0x29e046(0x11c)]);return![];}async[a113_0x5c97bb(0x110)](){const _0x31d3e9=a113_0x5c97bb,_0x422582={'oTiIC':function(_0x56d385,_0x311277){return _0x56d385(_0x311277);},'cBRkp':function(_0x218175,_0x44c171,_0x208e9f){return _0x218175(_0x44c171,_0x208e9f);},'vMCzY':_0x31d3e9(0x112),'GebuN':_0x31d3e9(0xde)},_0x71072f=await this.#getBinaryPath();return new Promise((_0x1848b9,_0x2a6414)=>{const _0x9d2758=_0x31d3e9,_0x1a0ace=_0x422582[_0x9d2758(0xe4)](spawn,_0x71072f,[_0x422582['vMCzY']]);_0x1a0ace['on'](_0x422582[_0x9d2758(0x109)],_0x1c2c33=>{const _0x4f1c7e=_0x9d2758;this['isProcessRunning']=![],this.#logStream&&(this.#logStream[_0x4f1c7e(0xef)](),this.#logStream=null),_0x422582['oTiIC'](_0x1848b9,_0x1c2c33);});});}[a113_0x5c97bb(0xf0)](){const _0x2e67e0=a113_0x5c97bb;return this[_0x2e67e0(0x11c)];}async[a113_0x5c97bb(0xfc)](){const _0x2eb4b7=a113_0x5c97bb,_0x3de9fd={};_0x3de9fd[_0x2eb4b7(0xf5)]=_0x2eb4b7(0x115),_0x3de9fd[_0x2eb4b7(0xdb)]=_0x2eb4b7(0xf8),_0x3de9fd[_0x2eb4b7(0x118)]=_0x2eb4b7(0xf9),_0x3de9fd[_0x2eb4b7(0x121)]=_0x2eb4b7(0x122);const _0x421589=_0x3de9fd,_0x390fe6=this.#config[_0x2eb4b7(0x106)];try{const _0x2e9871=this.#isApp?_0x421589[_0x2eb4b7(0xf5)]:_0x421589[_0x2eb4b7(0xdb)],_0x265146=await helper[_0x2eb4b7(0x104)](_0x421589[_0x2eb4b7(0x118)],_0x2eb4b7(0xdd)+_0x390fe6+'&type='+_0x2e9871,{},this.#config),_0x54a3bd=_0x265146[_0x2eb4b7(0xed)];return logger[_0x2eb4b7(0xdc)](_0x421589['ZkXsj']),_0x54a3bd[_0x2eb4b7(0xfa)];}catch(_0xb4840b){return logger['error'](_0x2eb4b7(0xff)+_0xb4840b),null;}}async[a113_0x5c97bb(0x125)](){const _0x383209=a113_0x5c97bb,_0x497bde={'QllhF':function(_0x5abee7,_0x50fbc6){return _0x5abee7(_0x50fbc6);},'pHNaS':function(_0x597b7d,_0xcc95e3){return _0x597b7d+_0xcc95e3;},'KLDiS':_0x383209(0x100),'kGrkh':_0x383209(0x11a)};if(!this.#config[_0x383209(0xec)])return null;const _0x223d0a=path[_0x383209(0xeb)](os[_0x383209(0x11f)](),_0x497bde[_0x383209(0x107)]),_0xc58151=this.#config[_0x383209(0xec)];return!_0xc58151[_0x383209(0x116)]&&(_0xc58151['version']='2'),new Promise((_0x23fe38,_0x57a944)=>{const _0x5b3605=_0x383209,_0x17f558={'FtlZY':function(_0xc5b142,_0x554e1f){return _0x497bde['QllhF'](_0xc5b142,_0x554e1f);},'SQMpc':function(_0x4f9371,_0x52ff52){const _0x3621e8=a113_0x1e06;return _0x497bde[_0x3621e8(0xf4)](_0x4f9371,_0x52ff52);},'yuFqO':_0x497bde['KLDiS']};fs[_0x5b3605(0xea)](_0x223d0a,JSON[_0x5b3605(0x10e)](_0xc58151),_0x5ab1be=>{const _0x38c7bc=_0x5b3605;_0x5ab1be&&(logger[_0x38c7bc(0x117)](_0x38c7bc(0xf2)+_0x5ab1be),_0x17f558['FtlZY'](_0x23fe38,null)),logger[_0x38c7bc(0xdc)](_0x17f558[_0x38c7bc(0x101)](_0x17f558[_0x38c7bc(0x11e)],_0x223d0a)),_0x17f558[_0x38c7bc(0x124)](_0x23fe38,_0x223d0a);});});}}function a113_0x1e06(_0x3b7ed5,_0x35c316){const _0x273368=a113_0x2733();return a113_0x1e06=function(_0x1e0629,_0x507ba9){_0x1e0629=_0x1e0629-0xda;let _0x3c5fbc=_0x273368[_0x1e0629];return _0x3c5fbc;},a113_0x1e06(_0x3b7ed5,_0x35c316);}function a113_0x2733(){const _0x48f000=['projectName','kGrkh','22727054MevLXZ','GebuN','PERCY_SERVER_ADDRESS','OkIau','stdout','1cdxoyU','stringify','oyWbV','stop','5196PHfdQv','exec:stop','9064VhTJqG','516596tOrmhY','app','version','error','paufZ','assign','percy.json','DOWNLOAD','isProcessRunning','child_process','yuFqO','tmpdir',':start','ZkXsj','Percy\x20fetch\x20token\x20success','ENV_VAR','FtlZY','createPercyConfig','../helper','../../helpers/testhub/constants','healthcheck','stderr','percy/healthcheck','3wvFrUg','hThOh','debug','api/app_percy/get_project_token?name=','close','winstonLogger','../../helpers/performance/constants','1777548XOhdRa','../../helpers/performance/performance-tester','percy.log','cBRkp','15LAIjCD','start','Percy\x20healthcheck\x20successful','1590XutDwc','./PercyBinary','writeFile','join','percyOptions','data','8Nepcvw','end','isRunning','qxdDp','Error\x20creating\x20percy\x20config:\x20','347398BDsTvU','pHNaS','vEMbq','app:exec','../logger','automate','GET','token','env','fetchPercyToken','4296194gvlhgX','19944ZYOYtl','Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20','Percy\x20config\x20created\x20at\x20','SQMpc','exports','http://localhost:5338','nodeRequest','13eKiUJB'];a113_0x2733=function(){return _0x48f000;};return a113_0x2733();}module[a113_0x5c97bb(0x102)]=Percy;