function a101_0x2720(_0x171f0f,_0x4ae73d){const _0x22aacc=a101_0x22aa();return a101_0x2720=function(_0x272058,_0x3d56bc){_0x272058=_0x272058-0x8f;let _0x3ecda0=_0x22aacc[_0x272058];return _0x3ecda0;},a101_0x2720(_0x171f0f,_0x4ae73d);}const a101_0x4ee2ea=a101_0x2720;(function(_0x2b8d08,_0x19f8c1){const _0x2465fe=a101_0x2720,_0x54dd81=_0x2b8d08();while(!![]){try{const _0x3f66ec=-parseInt(_0x2465fe(0x97))/0x1+-parseInt(_0x2465fe(0xdb))/0x2*(-parseInt(_0x2465fe(0xbb))/0x3)+parseInt(_0x2465fe(0xe1))/0x4+-parseInt(_0x2465fe(0x8f))/0x5*(parseInt(_0x2465fe(0xbd))/0x6)+parseInt(_0x2465fe(0x90))/0x7+-parseInt(_0x2465fe(0xad))/0x8+parseInt(_0x2465fe(0xbe))/0x9*(-parseInt(_0x2465fe(0xda))/0xa);if(_0x3f66ec===_0x19f8c1)break;else _0x54dd81['push'](_0x54dd81['shift']());}catch(_0x389f43){_0x54dd81['push'](_0x54dd81['shift']());}}}(a101_0x22aa,0x60c2b));const fs=require('fs'),path=require(a101_0x4ee2ea(0xa2)),os=require('os'),{spawn}=require(a101_0x4ee2ea(0xd9)),helper=require(a101_0x4ee2ea(0xac)),logger=require('../logger')[a101_0x4ee2ea(0xbf)],{getLogDir}=require('../logger'),testHubConstants=require(a101_0x4ee2ea(0xc1)),PerformanceTester=require(a101_0x4ee2ea(0xb6)),{PERCY_EVENTS:PerformanceEvents}=require(a101_0x4ee2ea(0xc8)),PercyBinary=require(a101_0x4ee2ea(0xdd));function a101_0x22aa(){const _0x47c5e9=['./PercyBinary','assign','percyOptions','dyxeI','628696agyOaQ',':start','env','26710xaMenw','4904837qmODuZ','vHtwp','ENV_VAR','close','push','api/app_percy/get_project_token?name=','tOUEy','80338HOZUlr','cKlar','stderr','AtSxN','cXxHr','UDEym','getBinaryPath','lVBdB','KgTZv','nodeRequest','healthcheck','path','BPgPs','start','exec:stop','Percy\x20fetch\x20token\x20success','Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20','Xilrm','app:exec','error','VXWgR','../helper','1076248suenFD','app','zsyXM','debug','fetchPercyToken','join','http://localhost:5338','ISyPZ','Percy\x20config\x20created\x20at\x20','../../helpers/performance/performance-tester','tmpdir','stringify','PERCY_SERVER_ADDRESS','createWriteStream','1440276FINWzg','isRunning','246dpEbzn','405uoIUlx','winstonLogger','DtgMo','../../helpers/testhub/constants','percy/healthcheck','Error\x20creating\x20percy\x20config:\x20','token','percy.json','GRocW','data','../../helpers/performance/constants','stop','end','version','writeFile','isProcessRunning','Bdpye','tkHaf','HVCEB','FGICP','Percy\x20healthcheck\x20successful','createPercyConfig','exports','Apbrt','&type=','pipe','GET','child_process','112830YbDkij','2QvQJUx','projectName'];a101_0x22aa=function(){return _0x47c5e9;};return a101_0x22aa();}class Percy{#logfile=path[a101_0x4ee2ea(0xb2)](getLogDir(),'percy.log');#address=process[a101_0x4ee2ea(0xe3)][a101_0x4ee2ea(0xb9)]||a101_0x4ee2ea(0xb3);#binaryPath=null;#config=null;#proc=null;#isApp=![];[a101_0x4ee2ea(0xcd)]=![];constructor(_0xeb22f1){const _0x1468e3=a101_0x4ee2ea;this.#config=_0xeb22f1,!!_0xeb22f1[_0x1468e3(0xae)]&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x17ad24=a101_0x4ee2ea;if(!this.#binaryPath){const _0x31769b=new PercyBinary();PerformanceTester['start'](PerformanceEvents['DOWNLOAD']),this.#binaryPath=await _0x31769b[_0x17ad24(0x9d)](this.#config),PerformanceTester[_0x17ad24(0xca)](PerformanceEvents['DOWNLOAD']);}return this.#binaryPath;}async #sleep(_0x443288){return new Promise(_0x2a4d4d=>setTimeout(_0x2a4d4d,_0x443288));}async[a101_0x4ee2ea(0xa1)](){const _0x8975cb=a101_0x4ee2ea,_0x21d099={};_0x21d099[_0x8975cb(0xaf)]=_0x8975cb(0xd8),_0x21d099[_0x8975cb(0xd5)]=_0x8975cb(0xc2);const _0x3a7e20=_0x21d099;try{const _0x192a4e=await helper[_0x8975cb(0xa0)](_0x3a7e20[_0x8975cb(0xaf)],_0x3a7e20[_0x8975cb(0xd5)],null,null,this.#address);if(_0x192a4e)return!![];}catch(_0x27799d){return![];}}async[a101_0x4ee2ea(0xa4)](){const _0x21db58=a101_0x4ee2ea,_0x45b4d7={'GRocW':_0x21db58(0xa9),'HVCEB':'exec','VXWgR':function(_0x2146cb,_0x296aed,_0x36f472,_0x251c78){return _0x2146cb(_0x296aed,_0x36f472,_0x251c78);},'FGICP':_0x21db58(0x93),'fmpCZ':_0x21db58(0xd2)},_0x49d50b=await this.#getBinaryPath(),_0x39c2d0={};_0x39c2d0['flags']='a';const _0x46c004=fs[_0x21db58(0xba)](this.#logfile,_0x39c2d0),_0x145420=await this['fetchPercyToken'](),_0x50a983=await this[_0x21db58(0xd3)]();if(!_0x145420)return![];const _0x3aab27=[(this.#isApp?_0x45b4d7[_0x21db58(0xc6)]:_0x45b4d7[_0x21db58(0xd0)])+_0x21db58(0xe2)];_0x50a983&&_0x3aab27[_0x21db58(0x94)]('-c',_0x50a983);this.#proc=_0x45b4d7[_0x21db58(0xab)](spawn,_0x49d50b,_0x3aab27,{'env':Object[_0x21db58(0xde)](process['env'],{'PERCY_TOKEN':_0x145420,'TH_BUILD_UUID':process['env'][testHubConstants[_0x21db58(0x92)]['BROWSERSTACK_TESTHUB_UUID']]})}),this.#proc['stdout'][_0x21db58(0xd7)](_0x46c004),this.#proc[_0x21db58(0x99)]['pipe'](_0x46c004),this[_0x21db58(0xcd)]=!![];var _0x29dd5a=this;this.#proc['on'](_0x45b4d7[_0x21db58(0xd1)],function(_0x15ff88){const _0x1cd1a8=_0x21db58;_0x29dd5a[_0x1cd1a8(0xcd)]=![];});do{const _0x3cd9b6=await this[_0x21db58(0xa1)]();if(_0x3cd9b6)return logger[_0x21db58(0xb0)](_0x45b4d7['fmpCZ']),!![];await this.#sleep(0x3e8);}while(this['isProcessRunning']);return![];}async[a101_0x4ee2ea(0xc9)](){const _0x55655d=a101_0x4ee2ea,_0x516fb3={'KgTZv':function(_0x3d38d5,_0x297afa){return _0x3d38d5(_0x297afa);},'sgcyc':function(_0x1cbc09,_0xf961f9,_0x331286){return _0x1cbc09(_0xf961f9,_0x331286);},'UDEym':_0x55655d(0xa5),'DtgMo':_0x55655d(0x93)},_0x1616be=await this.#getBinaryPath();return new Promise((_0x1f1926,_0x47d361)=>{const _0x440d3e=_0x55655d,_0x14997e={'cKlar':function(_0x17fe03,_0x22dae2){const _0x3692be=a101_0x2720;return _0x516fb3[_0x3692be(0x9f)](_0x17fe03,_0x22dae2);}},_0x59969e=_0x516fb3['sgcyc'](spawn,_0x1616be,[_0x516fb3[_0x440d3e(0x9c)]]);_0x59969e['on'](_0x516fb3[_0x440d3e(0xc0)],_0x2dc0a0=>{const _0x368e71=_0x440d3e;this[_0x368e71(0xcd)]=![],_0x14997e[_0x368e71(0x98)](_0x1f1926,_0x2dc0a0);});});}[a101_0x4ee2ea(0xbc)](){const _0x1ffe64=a101_0x4ee2ea;return this[_0x1ffe64(0xcd)];}async[a101_0x4ee2ea(0xb1)](){const _0x13e7b6=a101_0x4ee2ea,_0x41b866={};_0x41b866[_0x13e7b6(0x96)]=_0x13e7b6(0xae),_0x41b866['AtSxN']='automate',_0x41b866['dyxeI']=_0x13e7b6(0xd8),_0x41b866[_0x13e7b6(0xce)]=_0x13e7b6(0xa6);const _0x1d8a45=_0x41b866,_0x4f1c6f=this.#config[_0x13e7b6(0xdc)];try{const _0x548f07=this.#isApp?_0x1d8a45[_0x13e7b6(0x96)]:_0x1d8a45[_0x13e7b6(0x9a)],_0x4597ab=await helper[_0x13e7b6(0xa0)](_0x1d8a45[_0x13e7b6(0xe0)],_0x13e7b6(0x95)+_0x4f1c6f+_0x13e7b6(0xd6)+_0x548f07,{},this.#config),_0x17fba5=_0x4597ab[_0x13e7b6(0xc7)];return logger['debug'](_0x1d8a45[_0x13e7b6(0xce)]),_0x17fba5[_0x13e7b6(0xc4)];}catch(_0x4ae058){return logger[_0x13e7b6(0xaa)](_0x13e7b6(0xa7)+_0x4ae058),null;}}async[a101_0x4ee2ea(0xd3)](){const _0x3235eb=a101_0x4ee2ea,_0x18fde0={'Xilrm':function(_0x3dedcc,_0x3958ec){return _0x3dedcc(_0x3958ec);},'lVBdB':function(_0x2ba7ff,_0x568f08){return _0x2ba7ff+_0x568f08;},'tkHaf':_0x3235eb(0xb5),'gvOHm':_0x3235eb(0xc5)};if(!this.#config[_0x3235eb(0xdf)])return null;const _0x421892=path[_0x3235eb(0xb2)](os[_0x3235eb(0xb7)](),_0x18fde0['gvOHm']),_0x3b03df=this.#config[_0x3235eb(0xdf)];return!_0x3b03df[_0x3235eb(0xcb)]&&(_0x3b03df[_0x3235eb(0xcb)]='2'),new Promise((_0x58eb37,_0x207474)=>{const _0xb8cdc2=_0x3235eb,_0x1f67a2={'cXxHr':function(_0x49aafd,_0x1d4a25){const _0x2c6a8c=a101_0x2720;return _0x18fde0[_0x2c6a8c(0xa8)](_0x49aafd,_0x1d4a25);},'BPgPs':function(_0x5376a8,_0x2782d8){const _0x1d82d9=a101_0x2720;return _0x18fde0[_0x1d82d9(0x9e)](_0x5376a8,_0x2782d8);},'vHtwp':_0x18fde0[_0xb8cdc2(0xcf)],'ISyPZ':function(_0x4b163b,_0x34966b){return _0x18fde0['Xilrm'](_0x4b163b,_0x34966b);}};fs[_0xb8cdc2(0xcc)](_0x421892,JSON[_0xb8cdc2(0xb8)](_0x3b03df),_0x466662=>{const _0x5f330d=_0xb8cdc2;_0x466662&&(logger[_0x5f330d(0xaa)](_0x5f330d(0xc3)+_0x466662),_0x1f67a2[_0x5f330d(0x9b)](_0x58eb37,null)),logger['debug'](_0x1f67a2[_0x5f330d(0xa3)](_0x1f67a2[_0x5f330d(0x91)],_0x421892)),_0x1f67a2[_0x5f330d(0xb4)](_0x58eb37,_0x421892);});});}}module[a101_0x4ee2ea(0xd4)]=Percy;