const a113_0x4947d2=a113_0x4102;(function(_0x127d24,_0x3a2c83){const _0x4ff61d=a113_0x4102,_0x147973=_0x127d24();while(!![]){try{const _0x2c5f4c=parseInt(_0x4ff61d(0x12c))/0x1*(-parseInt(_0x4ff61d(0x13f))/0x2)+-parseInt(_0x4ff61d(0x14d))/0x3+-parseInt(_0x4ff61d(0x145))/0x4*(parseInt(_0x4ff61d(0x144))/0x5)+-parseInt(_0x4ff61d(0x11d))/0x6+parseInt(_0x4ff61d(0x112))/0x7+parseInt(_0x4ff61d(0x14e))/0x8+-parseInt(_0x4ff61d(0x127))/0x9*(-parseInt(_0x4ff61d(0x149))/0xa);if(_0x2c5f4c===_0x3a2c83)break;else _0x147973['push'](_0x147973['shift']());}catch(_0x2a427a){_0x147973['push'](_0x147973['shift']());}}}(a113_0x2e1f,0x591f9));const fs=require('fs'),path=require(a113_0x4947d2(0x11c)),os=require('os'),{spawn}=require(a113_0x4947d2(0x10a)),helper=require(a113_0x4947d2(0x12e)),logger=require(a113_0x4947d2(0x114))[a113_0x4947d2(0x154)],{getLogDir}=require(a113_0x4947d2(0x114)),testHubConstants=require(a113_0x4947d2(0x124)),PerformanceTester=require(a113_0x4947d2(0x151)),{PERCY_EVENTS:PerformanceEvents}=require(a113_0x4947d2(0x157)),PercyBinary=require(a113_0x4947d2(0x14f));function a113_0x4102(_0x2c0b57,_0x29dd6e){const _0x2e1fda=a113_0x2e1f();return a113_0x4102=function(_0x4102ed,_0x4c9f92){_0x4102ed=_0x4102ed-0x10a;let _0x3ac46c=_0x2e1fda[_0x4102ed];return _0x3ac46c;},a113_0x4102(_0x2c0b57,_0x29dd6e);}class Percy{#logfile=path[a113_0x4947d2(0x15b)](getLogDir(),a113_0x4947d2(0x158));#address=process[a113_0x4947d2(0x133)][a113_0x4947d2(0x118)]||a113_0x4947d2(0x12b);#binaryPath=null;#config=null;#proc=null;#logStream=null;#isApp=![];[a113_0x4947d2(0x11f)]=![];constructor(_0x515efc){const _0x1a2569=a113_0x4947d2;this.#config=_0x515efc,!!_0x515efc[_0x1a2569(0x159)]&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x414f83=a113_0x4947d2;if(!this.#binaryPath){const _0x565ec0=new PercyBinary();PerformanceTester[_0x414f83(0x129)](PerformanceEvents[_0x414f83(0x136)]),this.#binaryPath=await _0x565ec0[_0x414f83(0x139)](this.#config),PerformanceTester[_0x414f83(0x134)](PerformanceEvents[_0x414f83(0x136)]);}return this.#binaryPath;}async #sleep(_0x620763){return new Promise(_0x4bf377=>setTimeout(_0x4bf377,_0x620763));}async[a113_0x4947d2(0x11a)](){const _0x5792a5=a113_0x4947d2,_0x3ff214={};_0x3ff214[_0x5792a5(0x141)]='GET',_0x3ff214['tRWUH']=_0x5792a5(0x15a);const _0x240112=_0x3ff214;try{const _0x284a36=await helper['nodeRequest'](_0x240112['hgmYD'],_0x240112[_0x5792a5(0x119)],null,null,this.#address);if(_0x284a36)return!![];}catch(_0x15f86c){return![];}}async['start'](){const _0x4747b9=a113_0x4947d2,_0x1bb0dc={'fNBFp':_0x4747b9(0x132),'QXXdF':_0x4747b9(0x110),'uLKkv':function(_0x5dd153,_0x5a3da5,_0x2572f8,_0xf071f5){return _0x5dd153(_0x5a3da5,_0x2572f8,_0xf071f5);},'NAZeQ':_0x4747b9(0x137),'weDMW':_0x4747b9(0x116)},_0x4baf34=await this.#getBinaryPath(),_0x4dc379={};_0x4dc379['flags']='a',this.#logStream=fs[_0x4747b9(0x14c)](this.#logfile,_0x4dc379);const _0x30fe95=await this[_0x4747b9(0x150)](),_0x345d35=await this['createPercyConfig']();if(!_0x30fe95)return![];const _0x291c9b=[(this.#isApp?_0x1bb0dc[_0x4747b9(0x14b)]:_0x1bb0dc[_0x4747b9(0x146)])+':start'];_0x345d35&&_0x291c9b[_0x4747b9(0x140)]('-c',_0x345d35);this.#proc=_0x1bb0dc[_0x4747b9(0x13e)](spawn,_0x4baf34,_0x291c9b,{'env':Object[_0x4747b9(0x135)](process['env'],{'PERCY_TOKEN':_0x30fe95,'TH_BUILD_UUID':process[_0x4747b9(0x133)][testHubConstants[_0x4747b9(0x113)]['BROWSERSTACK_TESTHUB_UUID']]})}),this.#proc['stdout']['pipe'](this.#logStream),this.#proc[_0x4747b9(0x115)][_0x4747b9(0x111)](this.#logStream),this[_0x4747b9(0x11f)]=!![];var _0x18ab9d=this;this.#proc['on'](_0x1bb0dc[_0x4747b9(0x152)],function(_0x207385){const _0x5b637e=_0x4747b9;_0x18ab9d[_0x5b637e(0x11f)]=![];});do{const _0x4e28b4=await this[_0x4747b9(0x11a)]();if(_0x4e28b4)return logger[_0x4747b9(0x128)](_0x1bb0dc[_0x4747b9(0x138)]),!![];await this.#sleep(0x3e8);}while(this[_0x4747b9(0x11f)]);return![];}async[a113_0x4947d2(0x12a)](){const _0x3decc4=a113_0x4947d2,_0x10ad83={'bEGyJ':function(_0x173d43,_0x1ac12e){return _0x173d43(_0x1ac12e);},'NEjWW':function(_0x506e71,_0x30b82a,_0x2b4b5b){return _0x506e71(_0x30b82a,_0x2b4b5b);},'Drowx':_0x3decc4(0x125),'hSxVV':_0x3decc4(0x137)},_0x488623=await this.#getBinaryPath();return new Promise((_0x32e166,_0xe6ea6b)=>{const _0x30f783=_0x3decc4,_0x1c0503={'qNlQZ':function(_0x5cc7e1,_0xbe30e0){const _0x526522=a113_0x4102;return _0x10ad83[_0x526522(0x147)](_0x5cc7e1,_0xbe30e0);}},_0x2fb4ee=_0x10ad83[_0x30f783(0x10e)](spawn,_0x488623,[_0x10ad83['Drowx']]);_0x2fb4ee['on'](_0x10ad83[_0x30f783(0x13d)],_0x33771f=>{const _0x4f27b8=_0x30f783;this[_0x4f27b8(0x11f)]=![],this.#logStream&&(this.#logStream['end'](),this.#logStream=null),_0x1c0503[_0x4f27b8(0x142)](_0x32e166,_0x33771f);});});}[a113_0x4947d2(0x122)](){return this['isProcessRunning'];}async[a113_0x4947d2(0x150)](){const _0x340c50=a113_0x4947d2,_0x518c4c={};_0x518c4c[_0x340c50(0x153)]=_0x340c50(0x159),_0x518c4c[_0x340c50(0x11b)]=_0x340c50(0x148),_0x518c4c[_0x340c50(0x120)]=_0x340c50(0x12f),_0x518c4c[_0x340c50(0x10c)]='Percy\x20fetch\x20token\x20success';const _0x4e5571=_0x518c4c,_0x505fd4=this.#config[_0x340c50(0x13b)];try{const _0x3fee55=this.#isApp?_0x4e5571[_0x340c50(0x153)]:_0x4e5571['XrImF'],_0x5a92fe=await helper[_0x340c50(0x11e)](_0x4e5571[_0x340c50(0x120)],_0x340c50(0x123)+_0x505fd4+_0x340c50(0x10f)+_0x3fee55,{},this.#config),_0x45a0a2=_0x5a92fe[_0x340c50(0x143)];return logger[_0x340c50(0x128)](_0x4e5571[_0x340c50(0x10c)]),_0x45a0a2['token'];}catch(_0x4f504a){return logger['error'](_0x340c50(0x13a)+_0x4f504a),null;}}async[a113_0x4947d2(0x12d)](){const _0x2ffb11=a113_0x4947d2,_0x1466c9={'WEbak':function(_0x12ecdf,_0x2a416d){return _0x12ecdf(_0x2a416d);},'EAaXw':function(_0x56d0c2,_0x468146){return _0x56d0c2+_0x468146;},'Hrjii':_0x2ffb11(0x117),'KyuMb':'percy.json'};if(!this.#config[_0x2ffb11(0x130)])return null;const _0x390d1a=path[_0x2ffb11(0x15b)](os['tmpdir'](),_0x1466c9[_0x2ffb11(0x13c)]),_0x52bd94=this.#config[_0x2ffb11(0x130)];return!_0x52bd94['version']&&(_0x52bd94['version']='2'),new Promise((_0x25acd1,_0x5e6977)=>{const _0x3147b0=_0x2ffb11,_0x3cd405={'XcfNT':function(_0x3903f5,_0x187f90){return _0x1466c9['WEbak'](_0x3903f5,_0x187f90);},'nPARO':function(_0x184ee6,_0x282dbc){const _0x611b74=a113_0x4102;return _0x1466c9[_0x611b74(0x131)](_0x184ee6,_0x282dbc);},'dIHZQ':_0x1466c9[_0x3147b0(0x126)]};fs[_0x3147b0(0x10d)](_0x390d1a,JSON[_0x3147b0(0x121)](_0x52bd94),_0x19e1fb=>{const _0x1cae3a=_0x3147b0;_0x19e1fb&&(logger[_0x1cae3a(0x15c)](_0x1cae3a(0x155)+_0x19e1fb),_0x3cd405[_0x1cae3a(0x156)](_0x25acd1,null)),logger[_0x1cae3a(0x128)](_0x3cd405['nPARO'](_0x3cd405[_0x1cae3a(0x14a)],_0x390d1a)),_0x3cd405[_0x1cae3a(0x156)](_0x25acd1,_0x390d1a);});});}}module[a113_0x4947d2(0x10b)]=Percy;function a113_0x2e1f(){const _0x4fec4f=['isProcessRunning','QRFZW','stringify','isRunning','api/app_percy/get_project_token?name=','../../helpers/testhub/constants','exec:stop','Hrjii','18Ecvbfx','debug','start','stop','http://localhost:5338','12076fzEgex','createPercyConfig','../helper','GET','percyOptions','EAaXw','app:exec','env','end','assign','DOWNLOAD','close','weDMW','getBinaryPath','Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20','projectName','KyuMb','hSxVV','uLKkv','32cwOGml','push','hgmYD','qNlQZ','data','1989815sShLLc','4CYiVpy','QXXdF','bEGyJ','automate','4442150wnysRD','dIHZQ','fNBFp','createWriteStream','1495038spITnZ','1133528Kglzdd','./PercyBinary','fetchPercyToken','../../helpers/performance/performance-tester','NAZeQ','ENEqS','winstonLogger','Error\x20creating\x20percy\x20config:\x20','XcfNT','../../helpers/performance/constants','percy.log','app','percy/healthcheck','join','error','child_process','exports','xqeYn','writeFile','NEjWW','&type=','exec','pipe','3657990gMlXeN','ENV_VAR','../logger','stderr','Percy\x20healthcheck\x20successful','Percy\x20config\x20created\x20at\x20','PERCY_SERVER_ADDRESS','tRWUH','healthcheck','XrImF','path','588702XwbsqQ','nodeRequest'];a113_0x2e1f=function(){return _0x4fec4f;};return a113_0x2e1f();}