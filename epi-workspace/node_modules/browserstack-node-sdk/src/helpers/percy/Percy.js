function a99_0x2bbd(){const _0x11a6f1=['dfBCy','push','data','projectName','version','485303cDwBfS','winstonLogger','36EFGCuo','tmpdir','2588922pLraBp','error','percy.log','debug','qHFzL','36FwRsKN','Cijjs','vJkTV','YYBJo','healthcheck','api/app_percy/get_project_token?name=','nodeRequest','../helper','647150rzKkcd','path','exec:stop','mGEED','Percy\x20fetch\x20token\x20success','exports','createWriteStream','DOWNLOAD','13890cJfMJd','hAOZi','13306lLiclx','writeFile','createPercyConfig','isProcessRunning','yJIfZ','stderr','token','getBinaryPath','159140GUrsLD','join','YnTZY','stop','start','../logger','amgcm','close','percyOptions','percy/healthcheck','stringify','famgc','pipe','97761YkkFLp','fVlDT','ssLTR','36cnXLtM','env','ENV_VAR','BROWSERSTACK_TESTHUB_UUID','110OCKrez','zUpop','end','child_process','stdout','16hZrLgc','fetchPercyToken','Percy\x20config\x20created\x20at\x20','isRunning','./PercyBinary','flags','PERCY_SERVER_ADDRESS','SovMA','YUIKF','http://localhost:5338','12vVijvs','../../helpers/performance/performance-tester','GET','HwQbI','Error\x20creating\x20percy\x20config:\x20','../../helpers/performance/constants','app:exec','frgAI'];a99_0x2bbd=function(){return _0x11a6f1;};return a99_0x2bbd();}const a99_0x278bc2=a99_0x2d0d;function a99_0x2d0d(_0xb2a618,_0x1a1667){const _0x2bbdcc=a99_0x2bbd();return a99_0x2d0d=function(_0x2d0df2,_0x4dd994){_0x2d0df2=_0x2d0df2-0x191;let _0x6745d1=_0x2bbdcc[_0x2d0df2];return _0x6745d1;},a99_0x2d0d(_0xb2a618,_0x1a1667);}(function(_0x3aaff3,_0x45019b){const _0x503555=a99_0x2d0d,_0x3d15e2=_0x3aaff3();while(!![]){try{const _0x536926=-parseInt(_0x503555(0x1bf))/0x1*(parseInt(_0x503555(0x197))/0x2)+parseInt(_0x503555(0x1d4))/0x3*(-parseInt(_0x503555(0x1d7))/0x4)+-parseInt(_0x503555(0x1c7))/0x5*(-parseInt(_0x503555(0x1a6))/0x6)+-parseInt(_0x503555(0x1b5))/0x7*(-parseInt(_0x503555(0x1e0))/0x8)+parseInt(_0x503555(0x1a8))/0x9+parseInt(_0x503555(0x1bd))/0xa*(parseInt(_0x503555(0x1db))/0xb)+parseInt(_0x503555(0x1ad))/0xc*(-parseInt(_0x503555(0x1a4))/0xd);if(_0x536926===_0x45019b)break;else _0x3d15e2['push'](_0x3d15e2['shift']());}catch(_0x9dd47b){_0x3d15e2['push'](_0x3d15e2['shift']());}}}(a99_0x2bbd,0x2ef30));const fs=require('fs'),path=require(a99_0x278bc2(0x1b6)),os=require('os'),{spawn}=require(a99_0x278bc2(0x1de)),helper=require(a99_0x278bc2(0x1b4)),logger=require(a99_0x278bc2(0x1cc))[a99_0x278bc2(0x1a5)],{getLogDir}=require(a99_0x278bc2(0x1cc)),testHubConstants=require('../../helpers/testhub/constants'),PerformanceTester=require(a99_0x278bc2(0x198)),{PERCY_EVENTS:PerformanceEvents}=require(a99_0x278bc2(0x19c)),PercyBinary=require(a99_0x278bc2(0x191));class Percy{#logfile=path[a99_0x278bc2(0x1c8)](getLogDir(),a99_0x278bc2(0x1aa));#address=process['env'][a99_0x278bc2(0x193)]||a99_0x278bc2(0x196);#binaryPath=null;#config=null;#proc=null;#isApp=![];[a99_0x278bc2(0x1c2)]=![];constructor(_0x4a4a9d){this.#config=_0x4a4a9d,!!_0x4a4a9d['app']&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x354021=a99_0x278bc2;if(!this.#binaryPath){const _0x3a625c=new PercyBinary();PerformanceTester[_0x354021(0x1cb)](PerformanceEvents[_0x354021(0x1bc)]),this.#binaryPath=await _0x3a625c[_0x354021(0x1c6)](this.#config),PerformanceTester[_0x354021(0x1dd)](PerformanceEvents['DOWNLOAD']);}return this.#binaryPath;}async #sleep(_0x41afd6){return new Promise(_0x531998=>setTimeout(_0x531998,_0x41afd6));}async[a99_0x278bc2(0x1b1)](){const _0x3462b7=a99_0x278bc2,_0x8336b2={};_0x8336b2[_0x3462b7(0x1af)]=_0x3462b7(0x199),_0x8336b2[_0x3462b7(0x1ac)]=_0x3462b7(0x1d0);const _0x322f24=_0x8336b2;try{const _0x1dbb64=await helper[_0x3462b7(0x1b3)](_0x322f24[_0x3462b7(0x1af)],_0x322f24[_0x3462b7(0x1ac)],null,null,this.#address);if(_0x1dbb64)return!![];}catch(_0x1a2180){return![];}}async['start'](){const _0x29b8d4=a99_0x278bc2,_0x14801b={'YUIKF':_0x29b8d4(0x19d),'yJIfZ':'exec','dfBCy':function(_0x5f5981,_0x1d02a9,_0x373fae,_0x2697d6){return _0x5f5981(_0x1d02a9,_0x373fae,_0x2697d6);},'fVlDT':'close','mGEED':'Percy\x20healthcheck\x20successful'},_0xea5217=await this.#getBinaryPath(),_0x1dd79c={};_0x1dd79c[_0x29b8d4(0x192)]='a';const _0x55f6a8=fs[_0x29b8d4(0x1bb)](this.#logfile,_0x1dd79c),_0x136d00=await this['fetchPercyToken'](),_0x11c487=await this[_0x29b8d4(0x1c1)]();if(!_0x136d00)return![];const _0x138da3=[(this.#isApp?_0x14801b[_0x29b8d4(0x195)]:_0x14801b[_0x29b8d4(0x1c3)])+':start'];_0x11c487&&_0x138da3[_0x29b8d4(0x1a0)]('-c',_0x11c487);this.#proc=_0x14801b[_0x29b8d4(0x19f)](spawn,_0xea5217,_0x138da3,{'env':Object['assign'](process[_0x29b8d4(0x1d8)],{'PERCY_TOKEN':_0x136d00,'TH_BUILD_UUID':process[_0x29b8d4(0x1d8)][testHubConstants[_0x29b8d4(0x1d9)][_0x29b8d4(0x1da)]]})}),this.#proc[_0x29b8d4(0x1df)][_0x29b8d4(0x1d3)](_0x55f6a8),this.#proc[_0x29b8d4(0x1c4)][_0x29b8d4(0x1d3)](_0x55f6a8),this['isProcessRunning']=!![];var _0x4b5ce3=this;this.#proc['on'](_0x14801b[_0x29b8d4(0x1d5)],function(_0x593958){const _0x19e557=_0x29b8d4;_0x4b5ce3[_0x19e557(0x1c2)]=![];});do{const _0x4e9612=await this[_0x29b8d4(0x1b1)]();if(_0x4e9612)return logger[_0x29b8d4(0x1ab)](_0x14801b[_0x29b8d4(0x1b8)]),!![];await this.#sleep(0x3e8);}while(this[_0x29b8d4(0x1c2)]);return![];}async[a99_0x278bc2(0x1ca)](){const _0x3e874a=a99_0x278bc2,_0x918872={'ssLTR':function(_0x442b11,_0x2a58d2){return _0x442b11(_0x2a58d2);},'amgcm':function(_0x11454d,_0x9d13fd,_0x5cc03e){return _0x11454d(_0x9d13fd,_0x5cc03e);},'hAOZi':_0x3e874a(0x1b7),'YYBJo':_0x3e874a(0x1ce)},_0x5bfff0=await this.#getBinaryPath();return new Promise((_0x5a23c0,_0x13ff10)=>{const _0x4b6a12=_0x3e874a,_0x262eef={'frgAI':function(_0x2a6107,_0x4e4a0e){const _0x392215=a99_0x2d0d;return _0x918872[_0x392215(0x1d6)](_0x2a6107,_0x4e4a0e);}},_0x5cddad=_0x918872[_0x4b6a12(0x1cd)](spawn,_0x5bfff0,[_0x918872[_0x4b6a12(0x1be)]]);_0x5cddad['on'](_0x918872[_0x4b6a12(0x1b0)],_0x486c77=>{const _0x449223=_0x4b6a12;this[_0x449223(0x1c2)]=![],_0x262eef[_0x449223(0x19e)](_0x5a23c0,_0x486c77);});});}[a99_0x278bc2(0x1e3)](){const _0x510526=a99_0x278bc2;return this[_0x510526(0x1c2)];}async[a99_0x278bc2(0x1e1)](){const _0x195d73=a99_0x278bc2,_0x1e72f5={};_0x1e72f5[_0x195d73(0x1c9)]='app',_0x1e72f5['zUpop']='automate',_0x1e72f5[_0x195d73(0x19a)]=_0x195d73(0x199),_0x1e72f5[_0x195d73(0x1d2)]=_0x195d73(0x1b9);const _0x583d6e=_0x1e72f5,_0x2fa576=this.#config[_0x195d73(0x1a2)];try{const _0x17e00f=this.#isApp?_0x583d6e['YnTZY']:_0x583d6e[_0x195d73(0x1dc)],_0x486365=await helper['nodeRequest'](_0x583d6e['HwQbI'],_0x195d73(0x1b2)+_0x2fa576+'&type='+_0x17e00f,{},this.#config),_0x4cb10a=_0x486365[_0x195d73(0x1a1)];return logger[_0x195d73(0x1ab)](_0x583d6e[_0x195d73(0x1d2)]),_0x4cb10a[_0x195d73(0x1c5)];}catch(_0x56405a){return logger[_0x195d73(0x1a9)]('Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20'+_0x56405a),null;}}async[a99_0x278bc2(0x1c1)](){const _0x4b09b9=a99_0x278bc2,_0x59837f={'Cijjs':function(_0x4ae6fe,_0x1d9fa6){return _0x4ae6fe(_0x1d9fa6);},'INwsm':function(_0x5b8f4d,_0x4f909a){return _0x5b8f4d+_0x4f909a;},'tfKsy':_0x4b09b9(0x1e2),'SovMA':'percy.json'};if(!this.#config[_0x4b09b9(0x1cf)])return null;const _0x2dae88=path['join'](os[_0x4b09b9(0x1a7)](),_0x59837f[_0x4b09b9(0x194)]),_0x30c4d7=this.#config[_0x4b09b9(0x1cf)];return!_0x30c4d7['version']&&(_0x30c4d7[_0x4b09b9(0x1a3)]='2'),new Promise((_0x4f94da,_0x4abb37)=>{const _0x1ae0c4=_0x4b09b9;fs[_0x1ae0c4(0x1c0)](_0x2dae88,JSON[_0x1ae0c4(0x1d1)](_0x30c4d7),_0x576f26=>{const _0x22dc13=_0x1ae0c4;_0x576f26&&(logger[_0x22dc13(0x1a9)](_0x22dc13(0x19b)+_0x576f26),_0x59837f['Cijjs'](_0x4f94da,null)),logger[_0x22dc13(0x1ab)](_0x59837f['INwsm'](_0x59837f['tfKsy'],_0x2dae88)),_0x59837f[_0x22dc13(0x1ae)](_0x4f94da,_0x2dae88);});});}}module[a99_0x278bc2(0x1ba)]=Percy;