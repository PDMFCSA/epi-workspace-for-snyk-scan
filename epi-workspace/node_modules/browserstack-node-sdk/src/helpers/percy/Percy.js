function a113_0x503c(){const _0x1ab544=['data','pipe','13282540QUDIba','api/app_percy/get_project_token?name=','3428OXBBBg','../../helpers/performance/performance-tester','YduWT','3oDVGfH','BROWSERSTACK_TESTHUB_UUID','1820493RAwLWN','http://localhost:5338','56iTKmpd','healthcheck','2085524rTbVgY','WFLnp','tmpdir','env','projectName','../logger','flags','getBinaryPath','path','percy.log','../../helpers/testhub/constants','end','error','createPercyConfig','isProcessRunning','writeFile','percy.json','382Lruqif','JIFwu','child_process','16343833ipxjjg','Percy\x20config\x20created\x20at\x20','exec:stop','969260iAELJq','token','./PercyBinary','MiQlU','../helper','debug','oyyEy','DOWNLOAD','percy/healthcheck','../../helpers/performance/constants','GET','lPHYr','join','Percy\x20healthcheck\x20successful','ZpbXI','PERCY_SERVER_ADDRESS','258fUXEsB','stringify','stderr','OlqLs','1685QaYZSM','fetchPercyToken','iygco','Gktvb','exports','Error\x20creating\x20percy\x20config:\x20','version','nodeRequest','stop','app:exec','wWToL','start','createWriteStream','percyOptions','ivlsW','Percy\x20fetch\x20token\x20success','push','stdout','close'];a113_0x503c=function(){return _0x1ab544;};return a113_0x503c();}const a113_0x57b89e=a113_0x4e12;(function(_0x14c372,_0x4b4fb4){const _0x317292=a113_0x4e12,_0x1a68dd=_0x14c372();while(!![]){try{const _0xa3885e=parseInt(_0x317292(0x114))/0x1*(-parseInt(_0x317292(0xfa))/0x2)+-parseInt(_0x317292(0xfd))/0x3*(parseInt(_0x317292(0x11a))/0x4)+-parseInt(_0x317292(0x12e))/0x5*(parseInt(_0x317292(0x12a))/0x6)+parseInt(_0x317292(0x103))/0x7+parseInt(_0x317292(0x101))/0x8*(parseInt(_0x317292(0xff))/0x9)+-parseInt(_0x317292(0xf8))/0xa+parseInt(_0x317292(0x117))/0xb;if(_0xa3885e===_0x4b4fb4)break;else _0x1a68dd['push'](_0x1a68dd['shift']());}catch(_0x26ec77){_0x1a68dd['push'](_0x1a68dd['shift']());}}}(a113_0x503c,0xea57a));function a113_0x4e12(_0x356351,_0x292dcb){const _0x503cef=a113_0x503c();return a113_0x4e12=function(_0x4e125f,_0x4fe2d1){_0x4e125f=_0x4e125f-0xed;let _0x482488=_0x503cef[_0x4e125f];return _0x482488;},a113_0x4e12(_0x356351,_0x292dcb);}const fs=require('fs'),path=require(a113_0x57b89e(0x10b)),os=require('os'),{spawn}=require(a113_0x57b89e(0x116)),helper=require(a113_0x57b89e(0x11e)),logger=require(a113_0x57b89e(0x108))['winstonLogger'],{getLogDir}=require(a113_0x57b89e(0x108)),testHubConstants=require(a113_0x57b89e(0x10d)),PerformanceTester=require(a113_0x57b89e(0xfb)),{PERCY_EVENTS:PerformanceEvents}=require(a113_0x57b89e(0x123)),PercyBinary=require(a113_0x57b89e(0x11c));class Percy{#logfile=path[a113_0x57b89e(0x126)](getLogDir(),a113_0x57b89e(0x10c));#address=process[a113_0x57b89e(0x106)][a113_0x57b89e(0x129)]||a113_0x57b89e(0x100);#binaryPath=null;#config=null;#proc=null;#logStream=null;#isApp=![];[a113_0x57b89e(0x111)]=![];constructor(_0x4c4f08){this.#config=_0x4c4f08,!!_0x4c4f08['app']&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x1852a4=a113_0x57b89e;if(!this.#binaryPath){const _0x5123d1=new PercyBinary();PerformanceTester[_0x1852a4(0xee)](PerformanceEvents[_0x1852a4(0x121)]),this.#binaryPath=await _0x5123d1[_0x1852a4(0x10a)](this.#config),PerformanceTester[_0x1852a4(0x10e)](PerformanceEvents['DOWNLOAD']);}return this.#binaryPath;}async #sleep(_0x518865){return new Promise(_0x20f517=>setTimeout(_0x20f517,_0x518865));}async[a113_0x57b89e(0x102)](){const _0x5c9e82=a113_0x57b89e,_0x4da33b={};_0x4da33b['OlqLs']=_0x5c9e82(0x124),_0x4da33b['fpdCn']=_0x5c9e82(0x122);const _0x43b015=_0x4da33b;try{const _0x2f66e7=await helper['nodeRequest'](_0x43b015[_0x5c9e82(0x12d)],_0x43b015['fpdCn'],null,null,this.#address);if(_0x2f66e7)return!![];}catch(_0x530396){return![];}}async[a113_0x57b89e(0xee)](){const _0x5a2d23=a113_0x57b89e,_0x38fd49={'kEowg':_0x5a2d23(0x137),'jKbFk':'exec','lPHYr':function(_0x15e890,_0x16c1a9,_0x6ba8d0,_0x29d243){return _0x15e890(_0x16c1a9,_0x6ba8d0,_0x29d243);},'rrIIJ':_0x5a2d23(0xf5),'ZpbXI':_0x5a2d23(0x127)},_0x47e10d=await this.#getBinaryPath(),_0x49ea59={};_0x49ea59[_0x5a2d23(0x109)]='a',this.#logStream=fs[_0x5a2d23(0xef)](this.#logfile,_0x49ea59);const _0xe905f8=await this[_0x5a2d23(0x12f)](),_0x573273=await this[_0x5a2d23(0x110)]();if(!_0xe905f8)return![];const _0x11bc59=[(this.#isApp?_0x38fd49['kEowg']:_0x38fd49['jKbFk'])+':start'];_0x573273&&_0x11bc59[_0x5a2d23(0xf3)]('-c',_0x573273);this.#proc=_0x38fd49[_0x5a2d23(0x125)](spawn,_0x47e10d,_0x11bc59,{'env':Object['assign'](process[_0x5a2d23(0x106)],{'PERCY_TOKEN':_0xe905f8,'TH_BUILD_UUID':process['env'][testHubConstants['ENV_VAR'][_0x5a2d23(0xfe)]]})}),this.#proc[_0x5a2d23(0xf4)][_0x5a2d23(0xf7)](this.#logStream),this.#proc[_0x5a2d23(0x12c)][_0x5a2d23(0xf7)](this.#logStream),this[_0x5a2d23(0x111)]=!![];var _0x1e4b2a=this;this.#proc['on'](_0x38fd49['rrIIJ'],function(_0x10214c){const _0x18db6b=_0x5a2d23;_0x1e4b2a[_0x18db6b(0x111)]=![];});do{const _0x6de12a=await this[_0x5a2d23(0x102)]();if(_0x6de12a)return logger[_0x5a2d23(0x11f)](_0x38fd49[_0x5a2d23(0x128)]),!![];await this.#sleep(0x3e8);}while(this[_0x5a2d23(0x111)]);return![];}async[a113_0x57b89e(0x136)](){const _0x3595e9=a113_0x57b89e,_0x5210c5={'MiQlU':function(_0xc6244d,_0x6bb778){return _0xc6244d(_0x6bb778);},'htxZR':function(_0x14e44a,_0x437cd0,_0x443886){return _0x14e44a(_0x437cd0,_0x443886);},'iygco':_0x3595e9(0x119),'wWToL':_0x3595e9(0xf5)},_0x5747dd=await this.#getBinaryPath();return new Promise((_0x4401b1,_0x1aeec1)=>{const _0x35398c=_0x3595e9,_0x3d8d20=_0x5210c5['htxZR'](spawn,_0x5747dd,[_0x5210c5[_0x35398c(0x130)]]);_0x3d8d20['on'](_0x5210c5[_0x35398c(0xed)],_0x293a1f=>{const _0x20f725=_0x35398c;this[_0x20f725(0x111)]=![],this.#logStream&&(this.#logStream[_0x20f725(0x10e)](),this.#logStream=null),_0x5210c5[_0x20f725(0x11d)](_0x4401b1,_0x293a1f);});});}['isRunning'](){const _0x2322dd=a113_0x57b89e;return this[_0x2322dd(0x111)];}async[a113_0x57b89e(0x12f)](){const _0x3f8312=a113_0x57b89e,_0x5cf255={};_0x5cf255['ivlsW']='app',_0x5cf255[_0x3f8312(0x120)]='automate',_0x5cf255[_0x3f8312(0xfc)]=_0x3f8312(0x124),_0x5cf255[_0x3f8312(0x131)]=_0x3f8312(0xf2);const _0x19b34c=_0x5cf255,_0x1f8d3c=this.#config[_0x3f8312(0x107)];try{const _0xe8acdb=this.#isApp?_0x19b34c[_0x3f8312(0xf1)]:_0x19b34c['oyyEy'],_0x30582a=await helper[_0x3f8312(0x135)](_0x19b34c[_0x3f8312(0xfc)],_0x3f8312(0xf9)+_0x1f8d3c+'&type='+_0xe8acdb,{},this.#config),_0x5b9e90=_0x30582a[_0x3f8312(0xf6)];return logger['debug'](_0x19b34c[_0x3f8312(0x131)]),_0x5b9e90[_0x3f8312(0x11b)];}catch(_0x238301){return logger[_0x3f8312(0x10f)]('Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20'+_0x238301),null;}}async[a113_0x57b89e(0x110)](){const _0xe7c023=a113_0x57b89e,_0x7cbc26={'WFLnp':function(_0x57da81,_0x1f8b38){return _0x57da81(_0x1f8b38);},'JIFwu':function(_0x16b2a4,_0x410e74){return _0x16b2a4+_0x410e74;},'yTaUX':_0xe7c023(0x118),'ERojF':function(_0x4b0b68,_0x27c1a1){return _0x4b0b68(_0x27c1a1);},'PMmbj':_0xe7c023(0x113)};if(!this.#config[_0xe7c023(0xf0)])return null;const _0x13d184=path[_0xe7c023(0x126)](os[_0xe7c023(0x105)](),_0x7cbc26['PMmbj']),_0x4696e8=this.#config['percyOptions'];return!_0x4696e8[_0xe7c023(0x134)]&&(_0x4696e8['version']='2'),new Promise((_0x566de5,_0x2ca6cf)=>{const _0x34a3bd=_0xe7c023;fs[_0x34a3bd(0x112)](_0x13d184,JSON[_0x34a3bd(0x12b)](_0x4696e8),_0x3da59c=>{const _0x590039=_0x34a3bd;_0x3da59c&&(logger[_0x590039(0x10f)](_0x590039(0x133)+_0x3da59c),_0x7cbc26[_0x590039(0x104)](_0x566de5,null)),logger['debug'](_0x7cbc26[_0x590039(0x115)](_0x7cbc26['yTaUX'],_0x13d184)),_0x7cbc26['ERojF'](_0x566de5,_0x13d184);});});}}module[a113_0x57b89e(0x132)]=Percy;