function a110_0x7755(){const _0x585347=['../../helpers/performance/constants','uZzVN','Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20','end','Percy\x20fetch\x20token\x20success','data','token','exports','../../helpers/performance/performance-tester','stderr','BROWSERSTACK_TESTHUB_UUID','healthcheck','3207471nIBvlr','percyOptions','JjAHn','getBinaryPath','../../helpers/testhub/constants','lsLPo','15325398EXTaDR','error','Percy\x20config\x20created\x20at\x20','1sDpiZG','JUZgY','uRKtr','bxlLI','env','assign','PERCY_SERVER_ADDRESS','app:exec','1070vmuHFM','CTSrd','exec:stop','createPercyConfig','117940ZuXYou','path','createWriteStream','EivTp','debug','KdFtf','383493LsFSrz','automate','close','writeFile','6nBBlZm','zLGEH','nodeRequest','exec','isProcessRunning','stringify','http://localhost:5338','api/app_percy/get_project_token?name=','QLwiW','LLThw','stdout','GET','7693609jQEUiz','projectName','isRunning','1453646TkPyil','292384xkMjBn','LWzHS','EcSHa','80QnyaCu','pipe','../logger','start','UQKsP','stop','app','percy/healthcheck','JWHIk',':start','Error\x20creating\x20percy\x20config:\x20','KQKBo','EckTt','UjOLd','VHous'];a110_0x7755=function(){return _0x585347;};return a110_0x7755();}function a110_0x3481(_0xe64120,_0x2ad88f){const _0x775593=a110_0x7755();return a110_0x3481=function(_0x348154,_0x32eb17){_0x348154=_0x348154-0x17e;let _0x4335f4=_0x775593[_0x348154];return _0x4335f4;},a110_0x3481(_0xe64120,_0x2ad88f);}const a110_0x51bcc8=a110_0x3481;(function(_0x1fef58,_0x5d4d18){const _0x2f70bb=a110_0x3481,_0x3ebbf0=_0x1fef58();while(!![]){try{const _0x4a6bcd=-parseInt(_0x2f70bb(0x17e))/0x1*(parseInt(_0x2f70bb(0x1a3))/0x2)+-parseInt(_0x2f70bb(0x1c2))/0x3+-parseInt(_0x2f70bb(0x1a7))/0x4*(parseInt(_0x2f70bb(0x18a))/0x5)+-parseInt(_0x2f70bb(0x194))/0x6*(-parseInt(_0x2f70bb(0x1a0))/0x7)+parseInt(_0x2f70bb(0x1a4))/0x8+-parseInt(_0x2f70bb(0x1c8))/0x9+parseInt(_0x2f70bb(0x186))/0xa*(parseInt(_0x2f70bb(0x190))/0xb);if(_0x4a6bcd===_0x5d4d18)break;else _0x3ebbf0['push'](_0x3ebbf0['shift']());}catch(_0x5dcc07){_0x3ebbf0['push'](_0x3ebbf0['shift']());}}}(a110_0x7755,0xda9b6));const fs=require('fs'),path=require(a110_0x51bcc8(0x18b)),os=require('os'),{spawn}=require('child_process'),helper=require('../helper'),logger=require(a110_0x51bcc8(0x1a9))['winstonLogger'],{getLogDir}=require('../logger'),testHubConstants=require(a110_0x51bcc8(0x1c6)),PerformanceTester=require(a110_0x51bcc8(0x1be)),{PERCY_EVENTS:PerformanceEvents}=require(a110_0x51bcc8(0x1b6)),PercyBinary=require('./PercyBinary');class Percy{#logfile=path['join'](getLogDir(),'percy.log');#address=process[a110_0x51bcc8(0x182)][a110_0x51bcc8(0x184)]||a110_0x51bcc8(0x19a);#binaryPath=null;#config=null;#proc=null;#logStream=null;#isApp=![];[a110_0x51bcc8(0x198)]=![];constructor(_0x454e90){const _0x39c9d0=a110_0x51bcc8;this.#config=_0x454e90,!!_0x454e90[_0x39c9d0(0x1ad)]&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x34f496=a110_0x51bcc8;if(!this.#binaryPath){const _0x56a0a8=new PercyBinary();PerformanceTester['start'](PerformanceEvents['DOWNLOAD']),this.#binaryPath=await _0x56a0a8[_0x34f496(0x1c5)](this.#config),PerformanceTester['end'](PerformanceEvents['DOWNLOAD']);}return this.#binaryPath;}async #sleep(_0x48b562){return new Promise(_0xc579aa=>setTimeout(_0xc579aa,_0x48b562));}async[a110_0x51bcc8(0x1c1)](){const _0x5db579=a110_0x51bcc8,_0x3d0874={};_0x3d0874[_0x5db579(0x19d)]='GET',_0x3d0874['LWzHS']=_0x5db579(0x1ae);const _0x416e50=_0x3d0874;try{const _0x21d375=await helper[_0x5db579(0x196)](_0x416e50[_0x5db579(0x19d)],_0x416e50[_0x5db579(0x1a5)],null,null,this.#address);if(_0x21d375)return!![];}catch(_0x458838){return![];}}async[a110_0x51bcc8(0x1aa)](){const _0x5b0116=a110_0x51bcc8,_0x4f6e94={'VHous':_0x5b0116(0x185),'EcSHa':_0x5b0116(0x197),'JUZgY':function(_0x25a7b9,_0x50d646,_0x31f519,_0x1cd120){return _0x25a7b9(_0x50d646,_0x31f519,_0x1cd120);},'fLJtL':_0x5b0116(0x192),'uZzVN':'Percy\x20healthcheck\x20successful'},_0xe4e2ef=await this.#getBinaryPath(),_0x31967a={};_0x31967a['flags']='a',this.#logStream=fs[_0x5b0116(0x18c)](this.#logfile,_0x31967a);const _0x178946=await this['fetchPercyToken'](),_0x13340c=await this[_0x5b0116(0x189)]();if(!_0x178946)return![];const _0x3a7d67=[(this.#isApp?_0x4f6e94[_0x5b0116(0x1b5)]:_0x4f6e94[_0x5b0116(0x1a6)])+_0x5b0116(0x1b0)];_0x13340c&&_0x3a7d67['push']('-c',_0x13340c);this.#proc=_0x4f6e94[_0x5b0116(0x17f)](spawn,_0xe4e2ef,_0x3a7d67,{'env':Object[_0x5b0116(0x183)](process[_0x5b0116(0x182)],{'PERCY_TOKEN':_0x178946,'TH_BUILD_UUID':process[_0x5b0116(0x182)][testHubConstants['ENV_VAR'][_0x5b0116(0x1c0)]]})}),this.#proc[_0x5b0116(0x19e)][_0x5b0116(0x1a8)](this.#logStream),this.#proc[_0x5b0116(0x1bf)][_0x5b0116(0x1a8)](this.#logStream),this['isProcessRunning']=!![];var _0x5c1077=this;this.#proc['on'](_0x4f6e94['fLJtL'],function(_0x5b45a3){const _0x3fcb1f=_0x5b0116;_0x5c1077[_0x3fcb1f(0x198)]=![];});do{const _0x209789=await this[_0x5b0116(0x1c1)]();if(_0x209789)return logger['debug'](_0x4f6e94[_0x5b0116(0x1b7)]),!![];await this.#sleep(0x3e8);}while(this[_0x5b0116(0x198)]);return![];}async[a110_0x51bcc8(0x1ac)](){const _0x1041bf=a110_0x51bcc8,_0x2d67ae={'vXDqz':function(_0x3f422d,_0x1f943b){return _0x3f422d(_0x1f943b);},'EckTt':function(_0x395639,_0xa5c775,_0x3cb4dd){return _0x395639(_0xa5c775,_0x3cb4dd);},'KdFtf':_0x1041bf(0x188),'uRKtr':_0x1041bf(0x192)},_0xfaaa33=await this.#getBinaryPath();return new Promise((_0x40e236,_0x2a3df2)=>{const _0x22809e=_0x1041bf,_0x2fd456={'CTSrd':function(_0x4ae215,_0x5db879){return _0x2d67ae['vXDqz'](_0x4ae215,_0x5db879);}},_0x206fd9=_0x2d67ae[_0x22809e(0x1b3)](spawn,_0xfaaa33,[_0x2d67ae[_0x22809e(0x18f)]]);_0x206fd9['on'](_0x2d67ae[_0x22809e(0x180)],_0x449d7b=>{const _0x38bb30=_0x22809e;this['isProcessRunning']=![],this.#logStream&&(this.#logStream[_0x38bb30(0x1b9)](),this.#logStream=null),_0x2fd456[_0x38bb30(0x187)](_0x40e236,_0x449d7b);});});}[a110_0x51bcc8(0x1a2)](){return this['isProcessRunning'];}async['fetchPercyToken'](){const _0x280e30=a110_0x51bcc8,_0x3e693a={};_0x3e693a['JWHIk']=_0x280e30(0x1ad),_0x3e693a[_0x280e30(0x18d)]=_0x280e30(0x191),_0x3e693a['JjAHn']=_0x280e30(0x19f),_0x3e693a['lsLPo']=_0x280e30(0x1ba);const _0x2a0192=_0x3e693a,_0x145844=this.#config[_0x280e30(0x1a1)];try{const _0x1b16d5=this.#isApp?_0x2a0192[_0x280e30(0x1af)]:_0x2a0192[_0x280e30(0x18d)],_0x5edd1d=await helper['nodeRequest'](_0x2a0192[_0x280e30(0x1c4)],_0x280e30(0x19b)+_0x145844+'&type='+_0x1b16d5,{},this.#config),_0x2032c9=_0x5edd1d[_0x280e30(0x1bb)];return logger[_0x280e30(0x18e)](_0x2a0192[_0x280e30(0x1c7)]),_0x2032c9[_0x280e30(0x1bc)];}catch(_0x24523e){return logger[_0x280e30(0x1c9)](_0x280e30(0x1b8)+_0x24523e),null;}}async[a110_0x51bcc8(0x189)](){const _0x14a4ac=a110_0x51bcc8,_0x3b5f41={'KQKBo':function(_0x2e1bb2,_0x149e0b){return _0x2e1bb2(_0x149e0b);},'zLGEH':function(_0xb0b602,_0x4287b1){return _0xb0b602+_0x4287b1;},'UQKsP':_0x14a4ac(0x1ca),'QLwiW':'percy.json'};if(!this.#config[_0x14a4ac(0x1c3)])return null;const _0x4629a2=path['join'](os['tmpdir'](),_0x3b5f41[_0x14a4ac(0x19c)]),_0x1897ac=this.#config[_0x14a4ac(0x1c3)];return!_0x1897ac['version']&&(_0x1897ac['version']='2'),new Promise((_0x3a5ab2,_0x15041f)=>{const _0x4a85b6=_0x14a4ac,_0x25f617={'bxlLI':function(_0x10da20,_0x1fcd1b){const _0x539269=a110_0x3481;return _0x3b5f41[_0x539269(0x1b2)](_0x10da20,_0x1fcd1b);},'kxqZU':function(_0x19433c,_0x22ad23){const _0x5795ad=a110_0x3481;return _0x3b5f41[_0x5795ad(0x195)](_0x19433c,_0x22ad23);},'UjOLd':_0x3b5f41[_0x4a85b6(0x1ab)]};fs[_0x4a85b6(0x193)](_0x4629a2,JSON[_0x4a85b6(0x199)](_0x1897ac),_0x56ffe7=>{const _0x4fc157=_0x4a85b6;_0x56ffe7&&(logger[_0x4fc157(0x1c9)](_0x4fc157(0x1b1)+_0x56ffe7),_0x25f617['bxlLI'](_0x3a5ab2,null)),logger['debug'](_0x25f617['kxqZU'](_0x25f617[_0x4fc157(0x1b4)],_0x4629a2)),_0x25f617[_0x4fc157(0x181)](_0x3a5ab2,_0x4629a2);});});}}module[a110_0x51bcc8(0x1bd)]=Percy;