const a110_0x112e5b=a110_0x4f89;(function(_0x1406ed,_0x1fea92){const _0x3e75e6=a110_0x4f89,_0x2b3099=_0x1406ed();while(!![]){try{const _0xef4874=-parseInt(_0x3e75e6(0x22c))/0x1*(parseInt(_0x3e75e6(0x233))/0x2)+parseInt(_0x3e75e6(0x1fd))/0x3*(parseInt(_0x3e75e6(0x1fb))/0x4)+parseInt(_0x3e75e6(0x204))/0x5*(parseInt(_0x3e75e6(0x21d))/0x6)+parseInt(_0x3e75e6(0x1e6))/0x7*(-parseInt(_0x3e75e6(0x214))/0x8)+-parseInt(_0x3e75e6(0x229))/0x9+-parseInt(_0x3e75e6(0x1f9))/0xa+parseInt(_0x3e75e6(0x22b))/0xb*(parseInt(_0x3e75e6(0x200))/0xc);if(_0xef4874===_0x1fea92)break;else _0x2b3099['push'](_0x2b3099['shift']());}catch(_0x8a7d19){_0x2b3099['push'](_0x2b3099['shift']());}}}(a110_0xe55b,0xd5bf8));const fs=require('fs'),path=require(a110_0x112e5b(0x222)),os=require('os'),{spawn}=require(a110_0x112e5b(0x1e7)),helper=require(a110_0x112e5b(0x210)),logger=require(a110_0x112e5b(0x223))[a110_0x112e5b(0x1f3)],{getLogDir}=require(a110_0x112e5b(0x223)),testHubConstants=require(a110_0x112e5b(0x1f0)),PerformanceTester=require(a110_0x112e5b(0x20b)),{PERCY_EVENTS:PerformanceEvents}=require(a110_0x112e5b(0x22e)),PercyBinary=require(a110_0x112e5b(0x1ec));class Percy{#logfile=path[a110_0x112e5b(0x225)](getLogDir(),'percy.log');#address=process[a110_0x112e5b(0x1ea)][a110_0x112e5b(0x228)]||a110_0x112e5b(0x1f7);#binaryPath=null;#config=null;#proc=null;#logStream=null;#isApp=![];[a110_0x112e5b(0x22d)]=![];constructor(_0x388eff){const _0x113535=a110_0x112e5b;this.#config=_0x388eff,!!_0x388eff[_0x113535(0x21e)]&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x520822=a110_0x112e5b;if(!this.#binaryPath){const _0x4a4033=new PercyBinary();PerformanceTester[_0x520822(0x213)](PerformanceEvents[_0x520822(0x216)]),this.#binaryPath=await _0x4a4033[_0x520822(0x1ed)](this.#config),PerformanceTester['end'](PerformanceEvents['DOWNLOAD']);}return this.#binaryPath;}async #sleep(_0x562e72){return new Promise(_0x4c8aec=>setTimeout(_0x4c8aec,_0x562e72));}async[a110_0x112e5b(0x1f2)](){const _0x2f6467=a110_0x112e5b,_0x2dc370={};_0x2dc370[_0x2f6467(0x1fe)]=_0x2f6467(0x205),_0x2dc370[_0x2f6467(0x207)]='percy/healthcheck';const _0x24305b=_0x2dc370;try{const _0x56f361=await helper[_0x2f6467(0x208)](_0x24305b['SUeXl'],_0x24305b['TKzLJ'],null,null,this.#address);if(_0x56f361)return!![];}catch(_0x3af1fa){return![];}}async[a110_0x112e5b(0x213)](){const _0x2c4f1b=a110_0x112e5b,_0x4f609a={'rcWGK':_0x2c4f1b(0x224),'WItYF':_0x2c4f1b(0x21f),'IpaUu':function(_0x238e2b,_0x1972e8,_0x13e10f,_0x5bb7d8){return _0x238e2b(_0x1972e8,_0x13e10f,_0x5bb7d8);},'zofBz':_0x2c4f1b(0x21c),'cculI':_0x2c4f1b(0x1f1)},_0x27c078=await this.#getBinaryPath(),_0x3eaf7b={};_0x3eaf7b[_0x2c4f1b(0x1e4)]='a',this.#logStream=fs[_0x2c4f1b(0x215)](this.#logfile,_0x3eaf7b);const _0x2cf6f6=await this[_0x2c4f1b(0x209)](),_0x244e51=await this[_0x2c4f1b(0x1e8)]();if(!_0x2cf6f6)return![];const _0x3cda0b=[(this.#isApp?_0x4f609a['rcWGK']:_0x4f609a[_0x2c4f1b(0x1ee)])+_0x2c4f1b(0x230)];_0x244e51&&_0x3cda0b[_0x2c4f1b(0x220)]('-c',_0x244e51);this.#proc=_0x4f609a['IpaUu'](spawn,_0x27c078,_0x3cda0b,{'env':Object[_0x2c4f1b(0x1ff)](process[_0x2c4f1b(0x1ea)],{'PERCY_TOKEN':_0x2cf6f6,'TH_BUILD_UUID':process[_0x2c4f1b(0x1ea)][testHubConstants[_0x2c4f1b(0x203)][_0x2c4f1b(0x232)]]})}),this.#proc[_0x2c4f1b(0x201)][_0x2c4f1b(0x227)](this.#logStream),this.#proc['stderr'][_0x2c4f1b(0x227)](this.#logStream),this[_0x2c4f1b(0x22d)]=!![];var _0x1eb2f3=this;this.#proc['on'](_0x4f609a['zofBz'],function(_0x3d1752){const _0xa1f323=_0x2c4f1b;_0x1eb2f3[_0xa1f323(0x22d)]=![];});do{const _0x5e3e5c=await this[_0x2c4f1b(0x1f2)]();if(_0x5e3e5c)return logger[_0x2c4f1b(0x1f6)](_0x4f609a[_0x2c4f1b(0x21a)]),!![];await this.#sleep(0x3e8);}while(this[_0x2c4f1b(0x22d)]);return![];}async['stop'](){const _0x10ef75={'GupvC':function(_0x5e4410,_0x1d894f){return _0x5e4410(_0x1d894f);},'DgjIs':function(_0xc87135,_0x41c3ba,_0x1acc08){return _0xc87135(_0x41c3ba,_0x1acc08);},'CpZkq':'exec:stop','hvGry':'close'},_0x3436df=await this.#getBinaryPath();return new Promise((_0x3bd37b,_0x299958)=>{const _0x464c1a=a110_0x4f89,_0x3f515f={'CpqoD':function(_0x1e1078,_0x50ce5a){return _0x10ef75['GupvC'](_0x1e1078,_0x50ce5a);}},_0x5b1b7f=_0x10ef75[_0x464c1a(0x1e9)](spawn,_0x3436df,[_0x10ef75['CpZkq']]);_0x5b1b7f['on'](_0x10ef75[_0x464c1a(0x22a)],_0x23d40e=>{this['isProcessRunning']=![],this.#logStream&&(this.#logStream['end'](),this.#logStream=null),_0x3f515f['CpqoD'](_0x3bd37b,_0x23d40e);});});}[a110_0x112e5b(0x22f)](){return this['isProcessRunning'];}async[a110_0x112e5b(0x209)](){const _0x39c813=a110_0x112e5b,_0x356b57={};_0x356b57['HLTlc']=_0x39c813(0x21e),_0x356b57[_0x39c813(0x206)]=_0x39c813(0x1eb),_0x356b57[_0x39c813(0x20a)]=_0x39c813(0x205),_0x356b57[_0x39c813(0x1ef)]=_0x39c813(0x20d);const _0x477fb0=_0x356b57,_0x425752=this.#config[_0x39c813(0x1f5)];try{const _0x176489=this.#isApp?_0x477fb0[_0x39c813(0x211)]:_0x477fb0[_0x39c813(0x206)],_0x2093d3=await helper[_0x39c813(0x208)](_0x477fb0[_0x39c813(0x20a)],_0x39c813(0x212)+_0x425752+_0x39c813(0x221)+_0x176489,{},this.#config),_0x3a0ee6=_0x2093d3[_0x39c813(0x1e5)];return logger['debug'](_0x477fb0[_0x39c813(0x1ef)]),_0x3a0ee6[_0x39c813(0x218)];}catch(_0x120620){return logger[_0x39c813(0x20c)]('Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20'+_0x120620),null;}}async[a110_0x112e5b(0x1e8)](){const _0x3f596b=a110_0x112e5b,_0xcf6ce5={'WCkFn':function(_0x5ac5ee,_0x15233b){return _0x5ac5ee(_0x15233b);},'dGUVU':function(_0x2902b0,_0x2c9bd5){return _0x2902b0+_0x2c9bd5;},'rySIz':_0x3f596b(0x202),'eyEYu':_0x3f596b(0x226)};if(!this.#config[_0x3f596b(0x231)])return null;const _0x4ef3dc=path['join'](os['tmpdir'](),_0xcf6ce5[_0x3f596b(0x1fc)]),_0x5a4016=this.#config['percyOptions'];return!_0x5a4016[_0x3f596b(0x20f)]&&(_0x5a4016[_0x3f596b(0x20f)]='2'),new Promise((_0x4927ba,_0x3c60e6)=>{const _0x2dd84f=_0x3f596b;fs[_0x2dd84f(0x20e)](_0x4ef3dc,JSON[_0x2dd84f(0x1f8)](_0x5a4016),_0x36f8a6=>{const _0x6548ea=_0x2dd84f;_0x36f8a6&&(logger['error'](_0x6548ea(0x219)+_0x36f8a6),_0xcf6ce5[_0x6548ea(0x21b)](_0x4927ba,null)),logger['debug'](_0xcf6ce5[_0x6548ea(0x1fa)](_0xcf6ce5[_0x6548ea(0x1f4)],_0x4ef3dc)),_0xcf6ce5['WCkFn'](_0x4927ba,_0x4ef3dc);});});}}function a110_0x4f89(_0x26f4eb,_0x17bc01){const _0xe55be3=a110_0xe55b();return a110_0x4f89=function(_0x4f89bc,_0x57c0b1){_0x4f89bc=_0x4f89bc-0x1e4;let _0x4b41a6=_0xe55be3[_0x4f89bc];return _0x4b41a6;},a110_0x4f89(_0x26f4eb,_0x17bc01);}function a110_0xe55b(){const _0x2af7db=['../../helpers/testhub/constants','Percy\x20healthcheck\x20successful','healthcheck','winstonLogger','rySIz','projectName','debug','http://localhost:5338','stringify','10191040nazVQL','dGUVU','40hYvqNC','eyEYu','399981ALsXWu','SUeXl','assign','408564ohRlwr','stdout','Percy\x20config\x20created\x20at\x20','ENV_VAR','489970yVXGPi','GET','nxdBJ','TKzLJ','nodeRequest','fetchPercyToken','ktqBP','../../helpers/performance/performance-tester','error','Percy\x20fetch\x20token\x20success','writeFile','version','../helper','HLTlc','api/app_percy/get_project_token?name=','start','8zeXkML','createWriteStream','DOWNLOAD','exports','token','Error\x20creating\x20percy\x20config:\x20','cculI','WCkFn','close','12iOkVzb','app','exec','push','&type=','path','../logger','app:exec','join','percy.json','pipe','PERCY_SERVER_ADDRESS','7892640QGTXAs','hvGry','781yGuavu','8Kqhgdt','isProcessRunning','../../helpers/performance/constants','isRunning',':start','percyOptions','BROWSERSTACK_TESTHUB_UUID','152806fNajzy','flags','data','3946565oRuVZO','child_process','createPercyConfig','DgjIs','env','automate','./PercyBinary','getBinaryPath','WItYF','WtSAN'];a110_0xe55b=function(){return _0x2af7db;};return a110_0xe55b();}module[a110_0x112e5b(0x217)]=Percy;