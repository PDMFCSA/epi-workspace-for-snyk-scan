function a113_0x1e56(){const _0x41dc51=['stdout','UatEm','http://localhost:5338','172UZZvxa','winstonLogger','error','iKYPR','percyOptions','app:exec','GET','UMQAp','../../helpers/performance/constants','tmpdir','kaJPg','&type=','percy.json','percy/healthcheck','end','../../helpers/testhub/constants','LNmer',':start','bpOmp','HNqWD','createWriteStream','uusfZ','Percy\x20healthcheck\x20successful','Percy\x20fetch\x20token\x20success','nodeRequest','Arbtj','assign','stop','pipe','automate','107935haXmXN','Percy\x20config\x20created\x20at\x20','JxDGN','fetchPercyToken','debug','data','DxvRd','isProcessRunning','7148448OFLFlE','stringify','248ptdhuu','path','UbZet','child_process','qaHkf','179382DHbNuZ','nuetU','ENV_VAR','ktpco','version','flags','exports','3021666kBmJks','push','ZbXCk','exec:stop','ZHjoF','healthcheck','percy.log','close','app','WqpqP','createPercyConfig','isRunning','890908VNsMsW','DOWNLOAD','start','../../helpers/performance/performance-tester','PERCY_SERVER_ADDRESS','ROmbH','../logger','umdCw','3244620ZkZkfP','2357420vcykfT','join','../helper','projectName','bgwTY','writeFile','stderr','./PercyBinary'];a113_0x1e56=function(){return _0x41dc51;};return a113_0x1e56();}const a113_0x5d9245=a113_0x1d8f;(function(_0x108fbf,_0x218f55){const _0x558366=a113_0x1d8f,_0x21e75d=_0x108fbf();while(!![]){try{const _0x4399d2=parseInt(_0x558366(0x1aa))/0x1+-parseInt(_0x558366(0x1b3))/0x2+parseInt(_0x558366(0x1f2))/0x3+-parseInt(_0x558366(0x1be))/0x4*(-parseInt(_0x558366(0x1dc))/0x5)+parseInt(_0x558366(0x1b2))/0x6+-parseInt(_0x558366(0x1eb))/0x7*(parseInt(_0x558366(0x1e6))/0x8)+-parseInt(_0x558366(0x1e4))/0x9;if(_0x4399d2===_0x218f55)break;else _0x21e75d['push'](_0x21e75d['shift']());}catch(_0x34faf8){_0x21e75d['push'](_0x21e75d['shift']());}}}(a113_0x1e56,0x926c9));const fs=require('fs'),path=require(a113_0x5d9245(0x1e7)),os=require('os'),{spawn}=require(a113_0x5d9245(0x1e9)),helper=require(a113_0x5d9245(0x1b5)),logger=require(a113_0x5d9245(0x1b0))[a113_0x5d9245(0x1bf)],{getLogDir}=require(a113_0x5d9245(0x1b0)),testHubConstants=require(a113_0x5d9245(0x1cd)),PerformanceTester=require(a113_0x5d9245(0x1ad)),{PERCY_EVENTS:PerformanceEvents}=require(a113_0x5d9245(0x1c6)),PercyBinary=require(a113_0x5d9245(0x1ba));class Percy{#logfile=path['join'](getLogDir(),a113_0x5d9245(0x1f8));#address=process['env'][a113_0x5d9245(0x1ae)]||a113_0x5d9245(0x1bd);#binaryPath=null;#config=null;#proc=null;#logStream=null;#isApp=![];[a113_0x5d9245(0x1e3)]=![];constructor(_0x28f261){const _0x214f9c=a113_0x5d9245;this.#config=_0x28f261,!!_0x28f261[_0x214f9c(0x1fa)]&&(this.#isApp=!![]);}async #getBinaryPath(){const _0x2d0a12=a113_0x5d9245;if(!this.#binaryPath){const _0x8a22e2=new PercyBinary();PerformanceTester[_0x2d0a12(0x1ac)](PerformanceEvents[_0x2d0a12(0x1ab)]),this.#binaryPath=await _0x8a22e2['getBinaryPath'](this.#config),PerformanceTester[_0x2d0a12(0x1cc)](PerformanceEvents[_0x2d0a12(0x1ab)]);}return this.#binaryPath;}async #sleep(_0xdf544){return new Promise(_0x39c024=>setTimeout(_0x39c024,_0xdf544));}async[a113_0x5d9245(0x1f7)](){const _0x206736=a113_0x5d9245,_0x50cbfe={};_0x50cbfe[_0x206736(0x1f4)]=_0x206736(0x1c4),_0x50cbfe[_0x206736(0x1b1)]=_0x206736(0x1cb);const _0x863fda=_0x50cbfe;try{const _0x397f48=await helper[_0x206736(0x1d6)](_0x863fda[_0x206736(0x1f4)],_0x863fda['umdCw'],null,null,this.#address);if(_0x397f48)return!![];}catch(_0x52ba20){return![];}}async[a113_0x5d9245(0x1ac)](){const _0xaed48b=a113_0x5d9245,_0x9e687={'iKYPR':_0xaed48b(0x1c3),'NlLCN':'exec','JxDGN':function(_0x30f7d1,_0x5a5854,_0x15f210,_0x15f569){return _0x30f7d1(_0x5a5854,_0x15f210,_0x15f569);},'HNqWD':'close','qaHkf':_0xaed48b(0x1d4)},_0xf76c31=await this.#getBinaryPath(),_0x194295={};_0x194295[_0xaed48b(0x1f0)]='a',this.#logStream=fs[_0xaed48b(0x1d2)](this.#logfile,_0x194295);const _0x59cbfb=await this[_0xaed48b(0x1df)](),_0x454d8d=await this['createPercyConfig']();if(!_0x59cbfb)return![];const _0x145335=[(this.#isApp?_0x9e687[_0xaed48b(0x1c1)]:_0x9e687['NlLCN'])+_0xaed48b(0x1cf)];_0x454d8d&&_0x145335[_0xaed48b(0x1f3)]('-c',_0x454d8d);this.#proc=_0x9e687[_0xaed48b(0x1de)](spawn,_0xf76c31,_0x145335,{'env':Object[_0xaed48b(0x1d8)](process['env'],{'PERCY_TOKEN':_0x59cbfb,'TH_BUILD_UUID':process['env'][testHubConstants[_0xaed48b(0x1ed)]['BROWSERSTACK_TESTHUB_UUID']]})}),this.#proc[_0xaed48b(0x1bb)][_0xaed48b(0x1da)](this.#logStream),this.#proc[_0xaed48b(0x1b9)][_0xaed48b(0x1da)](this.#logStream),this[_0xaed48b(0x1e3)]=!![];var _0x533562=this;this.#proc['on'](_0x9e687[_0xaed48b(0x1d1)],function(_0x43ba81){_0x533562['isProcessRunning']=![];});do{const _0x14d97c=await this[_0xaed48b(0x1f7)]();if(_0x14d97c)return logger[_0xaed48b(0x1e0)](_0x9e687[_0xaed48b(0x1ea)]),!![];await this.#sleep(0x3e8);}while(this[_0xaed48b(0x1e3)]);return![];}async[a113_0x5d9245(0x1d9)](){const _0x147b71=a113_0x5d9245,_0x4ab4d5={'Arbtj':function(_0x4cb8ee,_0xb1fe36){return _0x4cb8ee(_0xb1fe36);},'UMQAp':function(_0x9b2de1,_0x3b33c8,_0x435e9d){return _0x9b2de1(_0x3b33c8,_0x435e9d);},'LNmer':_0x147b71(0x1f5),'kaJPg':_0x147b71(0x1f9)},_0x15db6c=await this.#getBinaryPath();return new Promise((_0x568a68,_0x542c81)=>{const _0x3daf7f=_0x147b71,_0x56f093=_0x4ab4d5[_0x3daf7f(0x1c5)](spawn,_0x15db6c,[_0x4ab4d5[_0x3daf7f(0x1ce)]]);_0x56f093['on'](_0x4ab4d5[_0x3daf7f(0x1c8)],_0x127a37=>{const _0x9d47f5=_0x3daf7f;this['isProcessRunning']=![],this.#logStream&&(this.#logStream[_0x9d47f5(0x1cc)](),this.#logStream=null),_0x4ab4d5[_0x9d47f5(0x1d7)](_0x568a68,_0x127a37);});});}[a113_0x5d9245(0x1fd)](){const _0x387e59=a113_0x5d9245;return this[_0x387e59(0x1e3)];}async[a113_0x5d9245(0x1df)](){const _0x326293=a113_0x5d9245,_0x5ba6a5={};_0x5ba6a5[_0x326293(0x1e2)]=_0x326293(0x1fa),_0x5ba6a5[_0x326293(0x1b7)]=_0x326293(0x1db),_0x5ba6a5[_0x326293(0x1fb)]=_0x326293(0x1c4),_0x5ba6a5[_0x326293(0x1e8)]=_0x326293(0x1d5);const _0x4c73e8=_0x5ba6a5,_0x9b0e01=this.#config[_0x326293(0x1b6)];try{const _0x1f5fb2=this.#isApp?_0x4c73e8['DxvRd']:_0x4c73e8['bgwTY'],_0x30b0a0=await helper[_0x326293(0x1d6)](_0x4c73e8[_0x326293(0x1fb)],'api/app_percy/get_project_token?name='+_0x9b0e01+_0x326293(0x1c9)+_0x1f5fb2,{},this.#config),_0x31d0d7=_0x30b0a0[_0x326293(0x1e1)];return logger[_0x326293(0x1e0)](_0x4c73e8[_0x326293(0x1e8)]),_0x31d0d7['token'];}catch(_0x33cbbc){return logger[_0x326293(0x1c0)]('Percy\x20unable\x20to\x20fetch\x20project\x20token:\x20'+_0x33cbbc),null;}}async[a113_0x5d9245(0x1fc)](){const _0xf839ac=a113_0x5d9245,_0x424645={'nuetU':function(_0x517d2e,_0x21ee2e){return _0x517d2e(_0x21ee2e);},'BUKlV':function(_0x2704b9,_0x477a64){return _0x2704b9+_0x477a64;},'uusfZ':_0xf839ac(0x1dd),'ROmbH':_0xf839ac(0x1ca)};if(!this.#config[_0xf839ac(0x1c2)])return null;const _0x15cb13=path[_0xf839ac(0x1b4)](os[_0xf839ac(0x1c7)](),_0x424645[_0xf839ac(0x1af)]),_0x4dfa41=this.#config['percyOptions'];return!_0x4dfa41[_0xf839ac(0x1ef)]&&(_0x4dfa41['version']='2'),new Promise((_0x51d6a8,_0x9fc3c7)=>{const _0xec16ea=_0xf839ac,_0x5a3179={'UatEm':function(_0x10316d,_0x5ab2bb){return _0x424645['nuetU'](_0x10316d,_0x5ab2bb);},'ktpco':function(_0xbe5d97,_0x152626){return _0x424645['BUKlV'](_0xbe5d97,_0x152626);},'ZHjoF':_0x424645[_0xec16ea(0x1d3)],'bpOmp':function(_0x2f4633,_0x1baa6a){const _0x2f9078=_0xec16ea;return _0x424645[_0x2f9078(0x1ec)](_0x2f4633,_0x1baa6a);}};fs[_0xec16ea(0x1b8)](_0x15cb13,JSON[_0xec16ea(0x1e5)](_0x4dfa41),_0x3d546e=>{const _0x49f7a2=_0xec16ea;_0x3d546e&&(logger[_0x49f7a2(0x1c0)]('Error\x20creating\x20percy\x20config:\x20'+_0x3d546e),_0x5a3179[_0x49f7a2(0x1bc)](_0x51d6a8,null)),logger['debug'](_0x5a3179[_0x49f7a2(0x1ee)](_0x5a3179[_0x49f7a2(0x1f6)],_0x15cb13)),_0x5a3179[_0x49f7a2(0x1d0)](_0x51d6a8,_0x15cb13);});});}}function a113_0x1d8f(_0x5159cb,_0x2501d6){const _0x1e5695=a113_0x1e56();return a113_0x1d8f=function(_0x1d8f20,_0x2eb730){_0x1d8f20=_0x1d8f20-0x1aa;let _0x3046fb=_0x1e5695[_0x1d8f20];return _0x3046fb;},a113_0x1d8f(_0x5159cb,_0x2501d6);}module[a113_0x5d9245(0x1f1)]=Percy;