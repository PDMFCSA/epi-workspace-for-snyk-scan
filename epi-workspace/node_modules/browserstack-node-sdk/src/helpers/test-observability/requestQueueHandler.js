const a123_0x4cdd84=a123_0x2644;(function(_0x4f6dfd,_0x2647f4){const _0x583b8c=a123_0x2644,_0x39e69a=_0x4f6dfd();while(!![]){try{const _0x516446=parseInt(_0x583b8c(0xa7))/0x1*(-parseInt(_0x583b8c(0xb7))/0x2)+parseInt(_0x583b8c(0xb1))/0x3+-parseInt(_0x583b8c(0x9b))/0x4+-parseInt(_0x583b8c(0xa1))/0x5+parseInt(_0x583b8c(0x84))/0x6*(parseInt(_0x583b8c(0xca))/0x7)+parseInt(_0x583b8c(0x70))/0x8*(parseInt(_0x583b8c(0xcf))/0x9)+parseInt(_0x583b8c(0x9f))/0xa;if(_0x516446===_0x2647f4)break;else _0x39e69a['push'](_0x39e69a['shift']());}catch(_0x165591){_0x39e69a['push'](_0x39e69a['shift']());}}}(a123_0x3001,0x7ee7e));function a123_0x2644(_0x206098,_0x5e4b93){const _0x300191=a123_0x3001();return a123_0x2644=function(_0x264410,_0x1b8808){_0x264410=_0x264410-0x6b;let _0x17b129=_0x300191[_0x264410];return _0x17b129;},a123_0x2644(_0x206098,_0x5e4b93);}function a123_0x3001(){const _0x82b84e=['vTxKS','mqquE','rwYxS','pollEventBatchInterval','queue','startEventBatchPolling','push','jsBaj','logs','21vYNNJJ','eNjHN','XHpbz','shutdown','split','3536829YQFcBX','HookRunFinished','splice','started','nzROT','wcGHM','IGaHC','uuid','api/v1/batch','CKxcA','byteLength','error','WMJUR','kind','max','YiVyq','proceedWithUrl','./utils','8rfkTLF','hNxRK','TEST_ATTACHMENT','.\x20Request\x20Size\x20-\x20','../helper','TestRunSkipped','CsGiz','vffaJ','\x20REQUEST\x20TO\x20','shouldProceed','test_run','TEST_SCREENSHOT','TestRunStarted','XbCJG','Processing\x20events.\x20Queue\x20Length\x20-\x20','cbDpn','data','instance','add','VdsZU','562236ILsKvx','HookRunStarted','kkxUk','POST','uploadPending','api/v1/screenshots','Remaining\x20Queue\x20Length\x20-\x20','BATCH_EVENT_TYPES','uploadAttachmentUrl','../../bin/utils/constants','\x20--\x20','slice','TaGlw','batchAndPostEvents','LogCreated','eventUrl','proceedWithData','UUcnJ','response','YGFWT','event_type','BSnlx','Processing\x20batch\x20events\x20for\x20','1464156isYmbc','UMePS','start','TEST_REPORTING_ANALYTICS','2845940hItFPW','oxJUL','1142710VgmbIf','\x20event\x20successful\x20for\x20events\x20','gEhdA','./constants','RGdaK','KdoKm','1bwuFer','Shutdown-Queue','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','hook_run','RESETTING','jlTBz','TestRunFinished','EXCEPTION\x20IN\x20','utf8','REMOVING','1589565kAbCLh','format','IDwiE','screenshotEventUrl','CBTSessionCreated','statusText','748322IntTMR','removeEventBatchPolling','includes','\x20:\x20','dixtE','XEQWY','pendingUploads','MisVl','length','wfvLR'];a123_0x3001=function(){return _0x82b84e;};return a123_0x3001();}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a123_0x4cdd84(0xa4)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a123_0x4cdd84(0x6f)),{nestedKeyValue}=require(a123_0x4cdd84(0x74)),util=require('util'),constants=require(a123_0x4cdd84(0x8d));class RequestQueueHandler{static [a123_0x4cdd84(0x81)];[a123_0x4cdd84(0xbd)]=0x0;constructor(){const _0xbf2bb3=a123_0x4cdd84,_0xa74ce={};_0xa74ce[_0xbf2bb3(0xbe)]='5|4|2|6|3|0|1',_0xa74ce[_0xbf2bb3(0x77)]=_0xbf2bb3(0x92),_0xa74ce[_0xbf2bb3(0xd8)]=_0xbf2bb3(0xb5),_0xa74ce[_0xbf2bb3(0xc2)]=_0xbf2bb3(0xad),_0xa74ce[_0xbf2bb3(0xb3)]=_0xbf2bb3(0x75),_0xa74ce[_0xbf2bb3(0xcb)]=_0xbf2bb3(0xd0),_0xa74ce[_0xbf2bb3(0xa6)]=_0xbf2bb3(0x7c),_0xa74ce[_0xbf2bb3(0x7d)]=_0xbf2bb3(0x85),_0xa74ce[_0xbf2bb3(0x86)]=_0xbf2bb3(0xd7),_0xa74ce['VdsZU']='upload-attachments',_0xa74ce[_0xbf2bb3(0x9c)]=_0xbf2bb3(0x89);const _0x3a3bfd=_0xa74ce,_0x28660f=_0x3a3bfd[_0xbf2bb3(0xbe)][_0xbf2bb3(0xce)]('|');let _0x59c790=0x0;while(!![]){switch(_0x28660f[_0x59c790++]){case'0':this[_0xbf2bb3(0x8b)]=[_0x3a3bfd[_0xbf2bb3(0x77)],_0x3a3bfd[_0xbf2bb3(0xd8)],_0x3a3bfd[_0xbf2bb3(0xc2)],_0x3a3bfd[_0xbf2bb3(0xb3)],_0x3a3bfd[_0xbf2bb3(0xcb)],_0x3a3bfd['KdoKm'],_0x3a3bfd[_0xbf2bb3(0x7d)]];continue;case'1':this[_0xbf2bb3(0xc4)]=null;continue;case'2':this[_0xbf2bb3(0x93)]=_0x3a3bfd[_0xbf2bb3(0x86)];continue;case'3':this[_0xbf2bb3(0x8c)]=_0x3a3bfd[_0xbf2bb3(0x83)];continue;case'4':this[_0xbf2bb3(0xd2)]=![];continue;case'5':this[_0xbf2bb3(0xc5)]=[];continue;case'6':this[_0xbf2bb3(0xb4)]=_0x3a3bfd[_0xbf2bb3(0x9c)];continue;}break;}}static['getInstance'](){const _0x1abb50=a123_0x4cdd84;return!RequestQueueHandler['instance']&&(RequestQueueHandler[_0x1abb50(0x81)]=new RequestQueueHandler()),RequestQueueHandler[_0x1abb50(0x81)];}[a123_0x4cdd84(0x9d)]=()=>{const _0x39d60b=a123_0x4cdd84;!this[_0x39d60b(0xd2)]&&(this[_0x39d60b(0xd2)]=!![],this['startEventBatchPolling']());};[a123_0x4cdd84(0x82)]=_0x527892=>{const _0x149e7f=a123_0x4cdd84,_0x345e24={'UUcnJ':function(_0x1464f8,_0x1f3429){return _0x1464f8===_0x1f3429;},'krSrw':_0x149e7f(0x7b),'MpUwg':function(_0x3a1eed,_0x270cf1){return _0x3a1eed>_0x270cf1;},'ZkxPl':_0x149e7f(0x72),'nzROT':function(_0x3b281d,_0x264b63){return _0x3b281d!==_0x264b63;},'WMJUR':_0x149e7f(0xad),'hNxRK':function(_0x25cfca,_0x3331a7){return _0x25cfca(_0x3331a7);},'wfvLR':'Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..'};if(this['BATCH_EVENT_TYPES'][_0x149e7f(0xb9)](_0x527892[_0x149e7f(0x98)])){if(_0x527892[_0x149e7f(0xc9)]&&_0x527892[_0x149e7f(0xc9)][0x0]&&_0x345e24[_0x149e7f(0x95)](_0x527892['logs'][0x0][_0x149e7f(0x6b)],_0x345e24['krSrw'])){const _0x4f6e4c={};return _0x4f6e4c[_0x149e7f(0x79)]=!![],_0x4f6e4c[_0x149e7f(0x94)]=[_0x527892],_0x4f6e4c[_0x149e7f(0x6e)]=this[_0x149e7f(0xb4)],_0x4f6e4c;}if(_0x527892[_0x149e7f(0xc9)]&&_0x345e24['MpUwg'](_0x527892[_0x149e7f(0xc9)]['length'],0x0)&&_0x345e24['UUcnJ'](_0x527892[_0x149e7f(0xc9)][0x0][_0x149e7f(0x6b)],_0x345e24['ZkxPl'])&&_0x345e24[_0x149e7f(0xd3)](_0x527892[_0x149e7f(0x98)],_0x345e24[_0x149e7f(0xdb)])){const _0x500b7d={};return _0x500b7d[_0x149e7f(0x79)]=!![],_0x500b7d[_0x149e7f(0x94)]=[_0x527892],_0x500b7d[_0x149e7f(0x6e)]=this[_0x149e7f(0x8c)],_0x500b7d;}this[_0x149e7f(0xc5)][_0x149e7f(0xc7)](_0x527892);let _0x200bd1=null;const _0x5c1373=this['shouldProceed']();_0x5c1373&&(_0x345e24[_0x149e7f(0x71)](trace,_0x345e24[_0x149e7f(0xc0)]),_0x200bd1=this['queue'][_0x149e7f(0x8f)](0x0,BATCH_SIZE),this['queue'][_0x149e7f(0xd1)](0x0,BATCH_SIZE),this['resetEventBatchPolling']());const _0x5cf779={};return _0x5cf779[_0x149e7f(0x79)]=_0x5c1373,_0x5cf779[_0x149e7f(0x94)]=_0x200bd1,_0x5cf779[_0x149e7f(0x6e)]=this['eventUrl'],_0x5cf779;}const _0x28c24b={};return _0x28c24b['shouldProceed']=!![],_0x28c24b;};[a123_0x4cdd84(0xcd)]=async()=>{const _0x48e414=a123_0x4cdd84,_0x2f6a46={'vTxKS':_0x48e414(0xb0),'xHvqU':function(_0x3a2ecd,_0x54a169){return _0x3a2ecd>_0x54a169;},'hwHHs':_0x48e414(0xa8),'oxJUL':function(_0x35bfe2,_0x22bb92){return _0x35bfe2>_0x22bb92;},'jsBaj':function(_0x37354a,_0x399acc){return _0x37354a(_0x399acc);}};await this[_0x48e414(0x88)](),this[_0x48e414(0xb8)](_0x2f6a46[_0x48e414(0xc1)]);while(_0x2f6a46['xHvqU'](this[_0x48e414(0xc5)]['length'],0x0)){const _0x20b9ec=this[_0x48e414(0xc5)][_0x48e414(0x8f)](0x0,BATCH_SIZE);this[_0x48e414(0xc5)][_0x48e414(0xd1)](0x0,BATCH_SIZE),await this[_0x48e414(0x91)](this[_0x48e414(0x93)],_0x2f6a46['hwHHs'],_0x20b9ec);}_0x2f6a46[_0x48e414(0xa0)](this['pendingUploads'],0x0)&&_0x2f6a46[_0x48e414(0xc8)](debug,_0x48e414(0xa9)+this[_0x48e414(0xbd)]);};[a123_0x4cdd84(0x91)]=async(_0x4ccaad,_0x2d1024,_0x19f5d6)=>{const _0x383e03=a123_0x4cdd84,_0x37716f={'rwYxS':function(_0x3bb0ac,_0x17a23d){return _0x3bb0ac(_0x17a23d);},'XPjic':_0x383e03(0xaf),'RDAnA':function(_0x29a99c){return _0x29a99c();},'IGaHC':function(_0x5ab634,_0x2125ac,_0x564c0d,_0x359e3e,_0x539a07){return _0x5ab634(_0x2125ac,_0x564c0d,_0x359e3e,_0x539a07);},'TaGlw':_0x383e03(0x87),'dixtE':function(_0x5e2093,_0x457e26){return _0x5e2093(_0x457e26);},'dUVwe':function(_0x5a497e,_0x44bdd2){return _0x5a497e-_0x44bdd2;},'XEQWY':function(_0x1ada47,_0x5d556e){return _0x1ada47(_0x5d556e);},'YiVyq':function(_0x2ebfce,_0x310c36){return _0x2ebfce-_0x310c36;}};let _0x1ba094='';try{_0x1ba094=_0x19f5d6['map'](_0x35ba66=>'\x27'+_0x35ba66[_0x383e03(0x98)]+'\x27:'+(nestedKeyValue(_0x35ba66,[_0x383e03(0x7a),_0x383e03(0xd6)])||nestedKeyValue(_0x35ba66,[_0x383e03(0xaa),_0x383e03(0xd6)])))['join'](','),_0x37716f[_0x383e03(0xc3)](debug,_0x383e03(0x9a)+_0x2d1024+_0x383e03(0x73)+Buffer[_0x383e03(0xd9)](util[_0x383e03(0xb2)]('%j',_0x19f5d6),_0x37716f['XPjic'])+'\x20bytes.\x20Events\x20are\x20'+_0x1ba094);}catch(_0x50d9e0){_0x37716f[_0x383e03(0xc3)](debug,'Exception\x20in\x20logging\x20batch\x20events\x20--\x20'+util[_0x383e03(0xb2)](_0x50d9e0)+'}');}const _0x2b8357={'headers':_0x37716f['RDAnA'](getDefaultHeaders)};try{const _0xde41=await _0x37716f[_0x383e03(0xd5)](nodeRequest,_0x37716f[_0x383e03(0x90)],_0x4ccaad,_0x19f5d6,_0x2b8357);if(_0xde41[_0x383e03(0x80)][_0x383e03(0xda)]){const _0x47f479={};_0x47f479['message']=_0xde41[_0x383e03(0x80)][_0x383e03(0xda)];throw _0x47f479;}else _0x37716f[_0x383e03(0xbb)](debug,_0x2d1024+_0x383e03(0xa2)+_0x1ba094+_0x383e03(0x8e)+util[_0x383e03(0xb2)]('%j',_0xde41['data'])),this[_0x383e03(0xbd)]=Math[_0x383e03(0x6c)](0x0,_0x37716f['dUVwe'](this[_0x383e03(0xbd)],_0x19f5d6[_0x383e03(0xbf)]));}catch(_0x4df960){_0x4df960['response']?_0x37716f[_0x383e03(0xbc)](debug,_0x383e03(0xae)+_0x2d1024+_0x383e03(0x78)+constants[_0x383e03(0x9e)]+_0x383e03(0xba)+_0x4df960[_0x383e03(0x96)]['status']+'\x20'+_0x4df960[_0x383e03(0x96)][_0x383e03(0xb6)]+'\x20'+util[_0x383e03(0xb2)]('%j',_0x4df960['response'])):_0x37716f[_0x383e03(0xbb)](debug,_0x383e03(0xae)+_0x2d1024+_0x383e03(0x78)+constants[_0x383e03(0x9e)]+_0x383e03(0xba)+(_0x4df960['message']||_0x4df960)),this[_0x383e03(0xbd)]=Math[_0x383e03(0x6c)](0x0,_0x37716f[_0x383e03(0x6d)](this[_0x383e03(0xbd)],_0x19f5d6[_0x383e03(0xbf)]));}};[a123_0x4cdd84(0xc6)]=()=>{const _0x234b8d=a123_0x4cdd84,_0x10bdc4={'cbDpn':function(_0x1866a4,_0x2b8a6e){return _0x1866a4>_0x2b8a6e;},'XHpbz':function(_0x11dcb3,_0x5c09f8){return _0x11dcb3(_0x5c09f8);},'jlTBz':'Interval-Queue','wcGHM':function(_0x4765ff,_0xf1f543,_0x1c1bbb){return _0x4765ff(_0xf1f543,_0x1c1bbb);}};this['pollEventBatchInterval']=_0x10bdc4[_0x234b8d(0xd4)](setInterval,async()=>{const _0x50941b=_0x234b8d;if(_0x10bdc4[_0x50941b(0x7f)](this['queue'][_0x50941b(0xbf)],0x0)){_0x10bdc4[_0x50941b(0xcc)](trace,_0x50941b(0x7e)+this[_0x50941b(0xc5)][_0x50941b(0xbf)]);const _0x421c1c=this[_0x50941b(0xc5)][_0x50941b(0x8f)](0x0,BATCH_SIZE);this[_0x50941b(0xc5)][_0x50941b(0xd1)](0x0,BATCH_SIZE),await this[_0x50941b(0x91)](this[_0x50941b(0x93)],_0x10bdc4[_0x50941b(0xac)],_0x421c1c),_0x10bdc4[_0x50941b(0xcc)](trace,_0x50941b(0x8a)+this[_0x50941b(0xc5)][_0x50941b(0xbf)]);}},BATCH_INTERVAL);};['resetEventBatchPolling']=()=>{const _0xf47a8e=a123_0x4cdd84,_0x23ebdb={};_0x23ebdb[_0xf47a8e(0x99)]=_0xf47a8e(0xab);const _0x4f2999=_0x23ebdb;this['removeEventBatchPolling'](_0x4f2999['BSnlx']),this[_0xf47a8e(0xc6)]();};[a123_0x4cdd84(0xb8)]=_0x535457=>{const _0xeadf66=a123_0x4cdd84,_0x594b92={'tIqGL':function(_0x37b793,_0x1f7f3c){return _0x37b793(_0x1f7f3c);},'dVZsa':function(_0x147b1a,_0x9dcc22){return _0x147b1a===_0x9dcc22;},'OhIll':_0xeadf66(0xb0)};this[_0xeadf66(0xc4)]&&(_0x594b92['tIqGL'](clearInterval,this[_0xeadf66(0xc4)]),this['pollEventBatchInterval']=null,_0x594b92['dVZsa'](_0x535457,_0x594b92['OhIll'])&&(this[_0xeadf66(0xd2)]=![]));};[a123_0x4cdd84(0x79)]=()=>{const _0x2f717b=a123_0x4cdd84,_0x39a778={};_0x39a778[_0x2f717b(0x76)]=function(_0x45efdd,_0xbaabcf){return _0x45efdd>=_0xbaabcf;};const _0x42a5fc=_0x39a778;return _0x42a5fc[_0x2f717b(0x76)](this[_0x2f717b(0xc5)][_0x2f717b(0xbf)],BATCH_SIZE);};async[a123_0x4cdd84(0x88)](_0x4de542=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x438bc0=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x5395f0=a123_0x4cdd84,_0x25b1c4={'gEhdA':function(_0x10ce80,_0x58d501){return _0x10ce80<=_0x58d501;},'YGFWT':function(_0x1a57b2,_0x40df4b){return _0x1a57b2(_0x40df4b);},'RGdaK':function(_0x5b1e6a,_0x5d429f){return _0x5b1e6a-_0x5d429f;}};if(_0x25b1c4[_0x5395f0(0xa3)](this[_0x5395f0(0xbd)],0x0)||_0x25b1c4[_0x5395f0(0xa3)](_0x4de542,0x0))return;return await _0x25b1c4[_0x5395f0(0x97)](sleep,_0x438bc0),this[_0x5395f0(0x88)](_0x25b1c4[_0x5395f0(0xa5)](_0x4de542,_0x438bc0));}}module['exports']=RequestQueueHandler;