const a115_0x1ccd86=a115_0x4281;function a115_0x4281(_0x32e481,_0x56229e){const _0x3b3eef=a115_0x3b3e();return a115_0x4281=function(_0x428152,_0x448d5d){_0x428152=_0x428152-0xd9;let _0x4c7243=_0x3b3eef[_0x428152];return _0x4c7243;},a115_0x4281(_0x32e481,_0x56229e);}(function(_0x201aa8,_0xb17e44){const _0x198c9f=a115_0x4281,_0x1ab948=_0x201aa8();while(!![]){try{const _0x486b51=-parseInt(_0x198c9f(0xf5))/0x1+parseInt(_0x198c9f(0x11a))/0x2*(-parseInt(_0x198c9f(0x136))/0x3)+-parseInt(_0x198c9f(0x149))/0x4*(parseInt(_0x198c9f(0xfa))/0x5)+-parseInt(_0x198c9f(0x101))/0x6+-parseInt(_0x198c9f(0x10e))/0x7*(-parseInt(_0x198c9f(0x13f))/0x8)+-parseInt(_0x198c9f(0x139))/0x9+parseInt(_0x198c9f(0xe4))/0xa;if(_0x486b51===_0xb17e44)break;else _0x1ab948['push'](_0x1ab948['shift']());}catch(_0x4b24cc){_0x1ab948['push'](_0x1ab948['shift']());}}}(a115_0x3b3e,0xeea3d));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require('./constants'),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a115_0x1ccd86(0x119)),{nestedKeyValue}=require(a115_0x1ccd86(0xea)),util=require(a115_0x1ccd86(0x12d));function a115_0x3b3e(){const _0x4b43a5=['WzVTy','byteLength','Interval-Queue','WKkkr','instance','../helper','rpiXX','HookRunStarted','slice','shouldProceed','jDqpM','wqmNB','kbRkJ','includes','proceedWithUrl','vNOwF','335817mUMnrL','euGvu','format','removeEventBatchPolling','\x20--\x20','45axNAHG','HookRunFinished','mYKvS','start','BKQvv','test_run','\x20bytes.\x20Events\x20are\x20','2440500zbUcDO','aKlAM','message','TEST_SCREENSHOT','KBfkr','status','startEventBatchPolling','EXCEPTION\x20IN\x20','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','queue','utf8','NMlId','qGXjq','7eteISh','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','getInstance','TestRunStarted','wkhOU','JwTyG','HGGuO','pollEventBatchInterval','Processing\x20events.\x20Queue\x20Length\x20-\x20','splice','NVMwm','./utils','60980oGcVbd','uploadPending','statusText','DsTEn','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','TestRunFinished','iaLEO','UMdra','jkFSj','sQeAn','proceedWithData','max','add','TEST_ATTACHMENT','dmhOA','TestRunSkipped','event_type','map','response','util','api/v1/batch','vUpLG','join','error','TNhoh','\x20event\x20successful\x20for\x20events\x20','bsacX','hook_run','165DUQZcr','POST','OhuCM','12600711kjavhd','Remaining\x20Queue\x20Length\x20-\x20','logs','ykIid','resetEventBatchPolling','BATCH_EVENT_TYPES','105208LjBrlD','screenshotEventUrl','split','pWcZK','pendingUploads','length','batchAndPostEvents','nMPCq','swPWu','uMamO','91588YYbwWI','CpokM','kind','AgCdu','eventUrl','RESETTING','ybmLq','gCaMt','push','data','REMOVING','uploadAttachmentUrl','GvEjn','Processing\x20batch\x20events\x20for\x20','AfkYF','started','49899870EZYUoZ'];a115_0x3b3e=function(){return _0x4b43a5;};return a115_0x3b3e();}class RequestQueueHandler{static [a115_0x1ccd86(0xe9)];[a115_0x1ccd86(0x143)]=0x0;constructor(){const _0x342dfa=a115_0x1ccd86,_0x55fce4={};_0x55fce4[_0x342dfa(0x11d)]='6|0|3|5|1|4|2',_0x55fce4[_0x342dfa(0x105)]='upload-attachments',_0x55fce4[_0x342dfa(0xe2)]=_0x342dfa(0x12e),_0x55fce4[_0x342dfa(0x134)]='LogCreated',_0x55fce4['gCaMt']='CBTSessionCreated',_0x55fce4[_0x342dfa(0x148)]=_0x342dfa(0x11f),_0x55fce4['vNOwF']=_0x342dfa(0x129),_0x55fce4[_0x342dfa(0x13c)]=_0x342dfa(0xfb),_0x55fce4[_0x342dfa(0x114)]=_0x342dfa(0x111),_0x55fce4[_0x342dfa(0x112)]=_0x342dfa(0xec),_0x55fce4[_0x342dfa(0xeb)]='api/v1/screenshots';const _0x31bf24=_0x55fce4,_0xa00025=_0x31bf24[_0x342dfa(0x11d)][_0x342dfa(0x141)]('|');let _0xa9f831=0x0;while(!![]){switch(_0xa00025[_0xa9f831++]){case'0':this[_0x342dfa(0xe3)]=![];continue;case'1':this[_0x342dfa(0xdf)]=_0x31bf24['KBfkr'];continue;case'2':this[_0x342dfa(0x115)]=null;continue;case'3':this[_0x342dfa(0x14d)]=_0x31bf24[_0x342dfa(0xe2)];continue;case'4':this[_0x342dfa(0x13e)]=[_0x31bf24[_0x342dfa(0x134)],_0x31bf24[_0x342dfa(0xdb)],_0x31bf24[_0x342dfa(0x148)],_0x31bf24[_0x342dfa(0xf4)],_0x31bf24[_0x342dfa(0x13c)],_0x31bf24[_0x342dfa(0x114)],_0x31bf24[_0x342dfa(0x112)]];continue;case'5':this['screenshotEventUrl']=_0x31bf24['rpiXX'];continue;case'6':this[_0x342dfa(0x10a)]=[];continue;}break;}}static[a115_0x1ccd86(0x110)](){const _0x411601=a115_0x1ccd86;return!RequestQueueHandler[_0x411601(0xe9)]&&(RequestQueueHandler[_0x411601(0xe9)]=new RequestQueueHandler()),RequestQueueHandler[_0x411601(0xe9)];}[a115_0x1ccd86(0xfd)]=()=>{const _0x364c11=a115_0x1ccd86;!this[_0x364c11(0xe3)]&&(this[_0x364c11(0xe3)]=!![],this['startEventBatchPolling']());};[a115_0x1ccd86(0x126)]=_0x43f0f2=>{const _0x2ad493=a115_0x1ccd86,_0x175785={'vtVHu':function(_0x345c81,_0x2bfefb){return _0x345c81===_0x2bfefb;},'dmhOA':_0x2ad493(0x104),'FRwbg':function(_0x34e893,_0x1cfb5f){return _0x34e893>_0x1cfb5f;},'WzVTy':function(_0x2de10b,_0x4c3896){return _0x2de10b===_0x4c3896;},'JwTyG':_0x2ad493(0x127),'jDqpM':function(_0x5368da,_0x4983fe){return _0x5368da!==_0x4983fe;},'KBMAU':_0x2ad493(0x11f),'swPWu':function(_0x419f9f,_0x203f7d){return _0x419f9f(_0x203f7d);},'iaLEO':_0x2ad493(0x10f)};if(this[_0x2ad493(0x13e)][_0x2ad493(0xf2)](_0x43f0f2[_0x2ad493(0x12a)])){if(_0x43f0f2[_0x2ad493(0x13b)]&&_0x43f0f2['logs'][0x0]&&_0x175785['vtVHu'](_0x43f0f2['logs'][0x0][_0x2ad493(0x14b)],_0x175785[_0x2ad493(0x128)])){const _0x33f29b={};return _0x33f29b[_0x2ad493(0xee)]=!![],_0x33f29b[_0x2ad493(0x124)]=[_0x43f0f2],_0x33f29b[_0x2ad493(0xf3)]=this[_0x2ad493(0x140)],_0x33f29b;}if(_0x43f0f2[_0x2ad493(0x13b)]&&_0x175785['FRwbg'](_0x43f0f2[_0x2ad493(0x13b)]['length'],0x0)&&_0x175785[_0x2ad493(0xe5)](_0x43f0f2[_0x2ad493(0x13b)][0x0][_0x2ad493(0x14b)],_0x175785[_0x2ad493(0x113)])&&_0x175785[_0x2ad493(0xef)](_0x43f0f2['event_type'],_0x175785['KBMAU'])){const _0x5e3631={};return _0x5e3631[_0x2ad493(0xee)]=!![],_0x5e3631[_0x2ad493(0x124)]=[_0x43f0f2],_0x5e3631[_0x2ad493(0xf3)]=this[_0x2ad493(0xdf)],_0x5e3631;}this['queue'][_0x2ad493(0xdc)](_0x43f0f2);let _0x1c1e52=null;const _0x2a62c3=this[_0x2ad493(0xee)]();_0x2a62c3&&(_0x175785[_0x2ad493(0x147)](trace,_0x175785[_0x2ad493(0x120)]),_0x1c1e52=this[_0x2ad493(0x10a)]['slice'](0x0,BATCH_SIZE),this[_0x2ad493(0x10a)][_0x2ad493(0x117)](0x0,BATCH_SIZE),this[_0x2ad493(0x13d)]());const _0x258955={};return _0x258955['shouldProceed']=_0x2a62c3,_0x258955[_0x2ad493(0x124)]=_0x1c1e52,_0x258955['proceedWithUrl']=this[_0x2ad493(0x14d)],_0x258955;}const _0x2798ac={};return _0x2798ac[_0x2ad493(0xee)]=!![],_0x2798ac;};['shutdown']=async()=>{const _0x411be5=a115_0x1ccd86,_0x313813={'NMlId':_0x411be5(0xde),'jkFSj':function(_0x2ea7ca,_0x4ff7d5){return _0x2ea7ca>_0x4ff7d5;},'AgCdu':'Shutdown-Queue','BKQvv':function(_0x4270ae,_0x432774){return _0x4270ae>_0x432774;},'OhuCM':function(_0x112946,_0x5f4013){return _0x112946(_0x5f4013);}};await this[_0x411be5(0x11b)](),this['removeEventBatchPolling'](_0x313813[_0x411be5(0x10c)]);while(_0x313813[_0x411be5(0x122)](this['queue'][_0x411be5(0x144)],0x0)){const _0x4463fd=this['queue']['slice'](0x0,BATCH_SIZE);this[_0x411be5(0x10a)][_0x411be5(0x117)](0x0,BATCH_SIZE),await this[_0x411be5(0x145)](this[_0x411be5(0x14d)],_0x313813[_0x411be5(0x14c)],_0x4463fd);}_0x313813[_0x411be5(0xfe)](this[_0x411be5(0x143)],0x0)&&_0x313813[_0x411be5(0x138)](debug,_0x411be5(0x109)+this[_0x411be5(0x143)]);};[a115_0x1ccd86(0x145)]=async(_0x2aa6d7,_0x319165,_0xe6614d)=>{const _0x256179=a115_0x1ccd86,_0x361a6c={'aKlAM':function(_0x301e7f,_0xa3f53e){return _0x301e7f(_0xa3f53e);},'oUhEy':_0x256179(0x10b),'nMPCq':function(_0xd540e,_0x52ad80){return _0xd540e(_0x52ad80);},'jiHID':function(_0x2b5398){return _0x2b5398();},'euGvu':function(_0x27b5ad,_0x5bc79f,_0x21f35a,_0x52e5f7,_0x59cbed){return _0x27b5ad(_0x5bc79f,_0x21f35a,_0x52e5f7,_0x59cbed);},'GvEjn':_0x256179(0x137),'blvjL':function(_0x517770,_0x3b8fde){return _0x517770(_0x3b8fde);},'CpokM':function(_0x510150,_0x1cc769){return _0x510150-_0x1cc769;},'sQeAn':function(_0x501267,_0x876039){return _0x501267(_0x876039);},'TNhoh':function(_0x3dd950,_0xceada5){return _0x3dd950-_0xceada5;}};let _0x334cec='';try{_0x334cec=_0xe6614d[_0x256179(0x12b)](_0x39c454=>'\x27'+_0x39c454['event_type']+'\x27:'+(nestedKeyValue(_0x39c454,[_0x256179(0xff),'uuid'])||nestedKeyValue(_0x39c454,[_0x256179(0x135),'uuid'])))[_0x256179(0x130)](','),_0x361a6c[_0x256179(0x102)](debug,_0x256179(0xe1)+_0x319165+'.\x20Request\x20Size\x20-\x20'+Buffer[_0x256179(0xe6)](util[_0x256179(0xf7)]('%j',_0xe6614d),_0x361a6c['oUhEy'])+_0x256179(0x100)+_0x334cec);}catch(_0x170d1f){_0x361a6c[_0x256179(0x146)](debug,'Exception\x20in\x20logging\x20batch\x20events\x20--\x20'+util[_0x256179(0xf7)](_0x170d1f)+'}');}const _0x3a548f={'headers':_0x361a6c['jiHID'](getDefaultHeaders)};try{const _0x15aa6e=await _0x361a6c[_0x256179(0xf6)](nodeRequest,_0x361a6c[_0x256179(0xe0)],_0x2aa6d7,_0xe6614d,_0x3a548f);if(_0x15aa6e[_0x256179(0xdd)][_0x256179(0x131)]){const _0x3fcd22={};_0x3fcd22[_0x256179(0x103)]=_0x15aa6e[_0x256179(0xdd)][_0x256179(0x131)];throw _0x3fcd22;}else _0x361a6c['blvjL'](debug,_0x319165+_0x256179(0x133)+_0x334cec+_0x256179(0xf9)+util[_0x256179(0xf7)]('%j',_0x15aa6e[_0x256179(0xdd)])),this['pendingUploads']=Math[_0x256179(0x125)](0x0,_0x361a6c[_0x256179(0x14a)](this[_0x256179(0x143)],_0xe6614d[_0x256179(0x144)]));}catch(_0x46bc60){_0x46bc60['response']?_0x361a6c[_0x256179(0x146)](debug,_0x256179(0x108)+_0x319165+_0x256179(0x11e)+_0x46bc60['response'][_0x256179(0x106)]+'\x20'+_0x46bc60[_0x256179(0x12c)][_0x256179(0x11c)]+'\x20'+util[_0x256179(0xf7)]('%j',_0x46bc60[_0x256179(0x12c)])):_0x361a6c[_0x256179(0x123)](debug,_0x256179(0x108)+_0x319165+'\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20'+(_0x46bc60['message']||_0x46bc60)),this[_0x256179(0x143)]=Math['max'](0x0,_0x361a6c[_0x256179(0x132)](this['pendingUploads'],_0xe6614d['length']));}};[a115_0x1ccd86(0x107)]=()=>{const _0x422087=a115_0x1ccd86,_0x1af9d4={'mYKvS':function(_0x40e35f,_0x6ea5dc){return _0x40e35f>_0x6ea5dc;},'kbRkJ':function(_0x19c3ac,_0x523977){return _0x19c3ac(_0x523977);},'zqVMf':_0x422087(0xe7),'wqmNB':function(_0x2d35dd,_0x2061b7,_0x28a03d){return _0x2d35dd(_0x2061b7,_0x28a03d);}};this[_0x422087(0x115)]=_0x1af9d4[_0x422087(0xf0)](setInterval,async()=>{const _0x38a83b=_0x422087;if(_0x1af9d4[_0x38a83b(0xfc)](this[_0x38a83b(0x10a)][_0x38a83b(0x144)],0x0)){_0x1af9d4[_0x38a83b(0xf1)](trace,_0x38a83b(0x116)+this[_0x38a83b(0x10a)][_0x38a83b(0x144)]);const _0x1b316e=this[_0x38a83b(0x10a)][_0x38a83b(0xed)](0x0,BATCH_SIZE);this[_0x38a83b(0x10a)]['splice'](0x0,BATCH_SIZE),await this[_0x38a83b(0x145)](this[_0x38a83b(0x14d)],_0x1af9d4['zqVMf'],_0x1b316e),_0x1af9d4[_0x38a83b(0xf1)](trace,_0x38a83b(0x13a)+this[_0x38a83b(0x10a)]['length']);}},BATCH_INTERVAL);};[a115_0x1ccd86(0x13d)]=()=>{const _0x17e5ca=a115_0x1ccd86,_0x2ab426={};_0x2ab426[_0x17e5ca(0xda)]=_0x17e5ca(0xd9);const _0x105928=_0x2ab426;this['removeEventBatchPolling'](_0x105928['ybmLq']),this['startEventBatchPolling']();};[a115_0x1ccd86(0xf8)]=_0x57b960=>{const _0x2ea06e=a115_0x1ccd86,_0x1709b0={'Bhxff':function(_0x152ce4,_0x369abc){return _0x152ce4(_0x369abc);},'pWcZK':function(_0x4bc275,_0x2e3abb){return _0x4bc275===_0x2e3abb;},'WKkkr':_0x2ea06e(0xde)};this[_0x2ea06e(0x115)]&&(_0x1709b0['Bhxff'](clearInterval,this[_0x2ea06e(0x115)]),this[_0x2ea06e(0x115)]=null,_0x1709b0[_0x2ea06e(0x142)](_0x57b960,_0x1709b0[_0x2ea06e(0xe8)])&&(this['started']=![]));};[a115_0x1ccd86(0xee)]=()=>{const _0x1f39e4=a115_0x1ccd86,_0x392bdc={};_0x392bdc['vUpLG']=function(_0x1cdd7c,_0x27c5ba){return _0x1cdd7c>=_0x27c5ba;};const _0x4af967=_0x392bdc;return _0x4af967[_0x1f39e4(0x12f)](this[_0x1f39e4(0x10a)][_0x1f39e4(0x144)],BATCH_SIZE);};async[a115_0x1ccd86(0x11b)](_0x5d594f=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x172233=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x2351d4=a115_0x1ccd86,_0x4ef6e1={'NVMwm':function(_0x39a933,_0xe42d9a){return _0x39a933<=_0xe42d9a;},'qGXjq':function(_0x3fb9a5,_0x1ae93b){return _0x3fb9a5(_0x1ae93b);},'UMdra':function(_0x25d390,_0x59759e){return _0x25d390-_0x59759e;}};if(_0x4ef6e1[_0x2351d4(0x118)](this['pendingUploads'],0x0)||_0x4ef6e1[_0x2351d4(0x118)](_0x5d594f,0x0))return;return await _0x4ef6e1[_0x2351d4(0x10d)](sleep,_0x172233),this[_0x2351d4(0x11b)](_0x4ef6e1[_0x2351d4(0x121)](_0x5d594f,_0x172233));}}module['exports']=RequestQueueHandler;