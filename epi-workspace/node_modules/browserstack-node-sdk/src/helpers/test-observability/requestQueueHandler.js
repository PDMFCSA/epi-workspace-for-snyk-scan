const a86_0x2697e6=a86_0x11ed;function a86_0x11ed(_0x51f0aa,_0x1de4da){const _0x236871=a86_0x2368();return a86_0x11ed=function(_0x11ed7a,_0x549ed4){_0x11ed7a=_0x11ed7a-0x1d4;let _0xdc0563=_0x236871[_0x11ed7a];return _0xdc0563;},a86_0x11ed(_0x51f0aa,_0x1de4da);}function a86_0x2368(){const _0x18f37b=['slice','abXkV','dYduI','jqJBs','uepPp','upload-attachments','length','kind','32955LxpXQo','message','instance','utf8','pollEventBatchInterval','osewO','format','ERFmj','mjLDT','shutdown','bGCjT','ZRLwM','595160MfXiLo','proceedWithUrl','GZtLO','21rwEFyn','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','join','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','LzaJW','606452ikMYBy','3050154xztTdl','10SRoekq','hook_run','response','screenshotEventUrl','removeEventBatchPolling','shouldProceed','error','RzHvv','uchba','TestRunSkipped','eventUrl','BTzmT','TEST_ATTACHMENT','qfnqT','uploadPending','queue','pjvGE','splice','logs','REMOVING','includes','\x20event\x20successful\x20for\x20events\x20','uuid','einbh','uploadAttachmentUrl','BATCH_EVENT_TYPES','GJtfV','EXCEPTION\x20IN\x20','\x20--\x20','start','rZnWd','fhwLI','UFXym','map','WLJwU','vHDJK','dJjTB','resetEventBatchPolling','fUvPg','90etbHEo','byteLength','HookRunStarted','exports','WrRsl','TEST_SCREENSHOT','fjrjK','BRhai','TestRunStarted','proceedWithData','NRILr','../helper','752876dVWwjt','eKWTS','RFfwM','api/v1/batch','YBygn','PqRSl','.\x20Request\x20Size\x20-\x20','RESETTING','AdIRu','hxVWN','statusText','push','200wvjKZv','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','split','getInstance','event_type','batchAndPostEvents','TestRunFinished','oaioc','POST','Interval-Queue','6262157ZlIWjS','data','ahiMF','106164rzsljQ','OHIWH','pendingUploads','Shutdown-Queue','started','3|5|0|4|2|1|6','startEventBatchPolling','bsagt'];a86_0x2368=function(){return _0x18f37b;};return a86_0x2368();}(function(_0x1aa426,_0x5173aa){const _0x4a2c5c=a86_0x11ed,_0x1a112f=_0x1aa426();while(!![]){try{const _0x5b5ad4=parseInt(_0x4a2c5c(0x1e6))/0x1+-parseInt(_0x4a2c5c(0x1da))/0x2*(parseInt(_0x4a2c5c(0x210))/0x3)+parseInt(_0x4a2c5c(0x224))/0x4+-parseInt(_0x4a2c5c(0x1f2))/0x5*(-parseInt(_0x4a2c5c(0x200))/0x6)+parseInt(_0x4a2c5c(0x21f))/0x7*(parseInt(_0x4a2c5c(0x21c))/0x8)+-parseInt(_0x4a2c5c(0x225))/0x9+-parseInt(_0x4a2c5c(0x226))/0xa*(parseInt(_0x4a2c5c(0x1fd))/0xb);if(_0x5b5ad4===_0x5173aa)break;else _0x1a112f['push'](_0x1a112f['shift']());}catch(_0x4ee074){_0x1a112f['push'](_0x1a112f['shift']());}}}(a86_0x2368,0x69b14));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require('./constants'),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require(a86_0x2697e6(0x1e5)),util=require('util');class RequestQueueHandler{static [a86_0x2697e6(0x212)];[a86_0x2697e6(0x202)]=0x0;constructor(){const _0x2b91dd=a86_0x2697e6,_0x3b575d={};_0x3b575d[_0x2b91dd(0x236)]=_0x2b91dd(0x205),_0x3b575d[_0x2b91dd(0x1d7)]=_0x2b91dd(0x1e9),_0x3b575d[_0x2b91dd(0x20b)]='LogCreated',_0x3b575d['RzHvv']='CBTSessionCreated',_0x3b575d[_0x2b91dd(0x1eb)]=_0x2b91dd(0x1f9),_0x3b575d[_0x2b91dd(0x217)]=_0x2b91dd(0x22f),_0x3b575d[_0x2b91dd(0x1d5)]='HookRunFinished',_0x3b575d[_0x2b91dd(0x1ef)]=_0x2b91dd(0x1e2),_0x3b575d[_0x2b91dd(0x1ee)]=_0x2b91dd(0x1dc),_0x3b575d[_0x2b91dd(0x23d)]=_0x2b91dd(0x20d),_0x3b575d[_0x2b91dd(0x1e7)]='api/v1/screenshots';const _0x8ce8b6=_0x3b575d,_0x380ee4=_0x8ce8b6[_0x2b91dd(0x236)][_0x2b91dd(0x1f5)]('|');let _0x5abe7d=0x0;while(!![]){switch(_0x380ee4[_0x5abe7d++]){case'0':this[_0x2b91dd(0x230)]=_0x8ce8b6['dJjTB'];continue;case'1':this[_0x2b91dd(0x23f)]=[_0x8ce8b6['jqJBs'],_0x8ce8b6[_0x2b91dd(0x22d)],_0x8ce8b6['PqRSl'],_0x8ce8b6[_0x2b91dd(0x217)],_0x8ce8b6[_0x2b91dd(0x1d5)],_0x8ce8b6[_0x2b91dd(0x1ef)],_0x8ce8b6[_0x2b91dd(0x1ee)]];continue;case'2':this[_0x2b91dd(0x23e)]=_0x8ce8b6['einbh'];continue;case'3':this[_0x2b91dd(0x235)]=[];continue;case'4':this[_0x2b91dd(0x229)]=_0x8ce8b6[_0x2b91dd(0x1e7)];continue;case'5':this[_0x2b91dd(0x204)]=![];continue;case'6':this[_0x2b91dd(0x214)]=null;continue;}break;}}static[a86_0x2697e6(0x1f6)](){const _0x3122c4=a86_0x2697e6;return!RequestQueueHandler[_0x3122c4(0x212)]&&(RequestQueueHandler[_0x3122c4(0x212)]=new RequestQueueHandler()),RequestQueueHandler[_0x3122c4(0x212)];}[a86_0x2697e6(0x243)]=()=>{const _0xfabb26=a86_0x2697e6;!this[_0xfabb26(0x204)]&&(this[_0xfabb26(0x204)]=!![],this[_0xfabb26(0x206)]());};['add']=_0xad68df=>{const _0x324f48=a86_0x2697e6,_0x2e0421={'lEaON':function(_0x1647e9,_0x2c38de){return _0x1647e9===_0x2c38de;},'dNdwf':_0x324f48(0x1df),'BRhai':function(_0x39a1db,_0xa16a31){return _0x39a1db>_0xa16a31;},'OHIWH':function(_0x1622a9,_0x57af5f){return _0x1622a9===_0x57af5f;},'uchba':_0x324f48(0x232),'qfnqT':function(_0x45517d,_0x57dfcf){return _0x45517d!==_0x57dfcf;},'GJtfV':_0x324f48(0x1f9),'UFXym':function(_0x931042,_0x366159){return _0x931042(_0x366159);},'GZtLO':_0x324f48(0x222)};if(this['BATCH_EVENT_TYPES'][_0x324f48(0x23a)](_0xad68df[_0x324f48(0x1f7)])){if(_0xad68df[_0x324f48(0x238)]&&_0xad68df[_0x324f48(0x238)][0x0]&&_0x2e0421['lEaON'](_0xad68df[_0x324f48(0x238)][0x0][_0x324f48(0x20f)],_0x2e0421['dNdwf'])){const _0x57959e={};return _0x57959e['shouldProceed']=!![],_0x57959e[_0x324f48(0x1e3)]=[_0xad68df],_0x57959e[_0x324f48(0x21d)]=this[_0x324f48(0x229)],_0x57959e;}if(_0xad68df['logs']&&_0x2e0421[_0x324f48(0x1e1)](_0xad68df[_0x324f48(0x238)]['length'],0x0)&&_0x2e0421[_0x324f48(0x201)](_0xad68df[_0x324f48(0x238)][0x0][_0x324f48(0x20f)],_0x2e0421[_0x324f48(0x22e)])&&_0x2e0421[_0x324f48(0x233)](_0xad68df[_0x324f48(0x1f7)],_0x2e0421[_0x324f48(0x240)])){const _0x303606={};return _0x303606[_0x324f48(0x22b)]=!![],_0x303606['proceedWithData']=[_0xad68df],_0x303606['proceedWithUrl']=this[_0x324f48(0x23e)],_0x303606;}this[_0x324f48(0x235)][_0x324f48(0x1f1)](_0xad68df);let _0x5a1dba=null;const _0x20f29f=this['shouldProceed']();_0x20f29f&&(_0x2e0421[_0x324f48(0x246)](trace,_0x2e0421[_0x324f48(0x21e)]),_0x5a1dba=this[_0x324f48(0x235)][_0x324f48(0x208)](0x0,BATCH_SIZE),this[_0x324f48(0x235)][_0x324f48(0x237)](0x0,BATCH_SIZE),this[_0x324f48(0x1d8)]());const _0x1fbfb7={};return _0x1fbfb7[_0x324f48(0x22b)]=_0x20f29f,_0x1fbfb7[_0x324f48(0x1e3)]=_0x5a1dba,_0x1fbfb7[_0x324f48(0x21d)]=this['eventUrl'],_0x1fbfb7;}const _0x4ce605={};return _0x4ce605[_0x324f48(0x22b)]=!![],_0x4ce605;};[a86_0x2697e6(0x219)]=async()=>{const _0x497239=a86_0x2697e6,_0x355fba={'YBygn':_0x497239(0x239),'BTzmT':function(_0xa4a94d,_0x5af673){return _0xa4a94d>_0x5af673;},'oKZMn':_0x497239(0x203),'ndgph':function(_0x365ed4,_0x225e94){return _0x365ed4>_0x225e94;},'abXkV':function(_0x4f60c1,_0x34cef0){return _0x4f60c1(_0x34cef0);}};await this[_0x497239(0x234)](),this[_0x497239(0x22a)](_0x355fba[_0x497239(0x1ea)]);while(_0x355fba[_0x497239(0x231)](this['queue'][_0x497239(0x20e)],0x0)){const _0x1b98ea=this[_0x497239(0x235)]['slice'](0x0,BATCH_SIZE);this[_0x497239(0x235)][_0x497239(0x237)](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x497239(0x230)],_0x355fba['oKZMn'],_0x1b98ea);}_0x355fba['ndgph'](this['pendingUploads'],0x0)&&_0x355fba[_0x497239(0x209)](debug,_0x497239(0x1f3)+this[_0x497239(0x202)]);};['batchAndPostEvents']=async(_0x351e3d,_0xe773f1,_0x5c437c)=>{const _0x41b841=a86_0x2697e6,_0x264b57={'NRILr':function(_0xe59659,_0x5b1160){return _0xe59659(_0x5b1160);},'uepPp':_0x41b841(0x213),'dYduI':function(_0x48b798){return _0x48b798();},'osewO':function(_0x7f1457,_0xd3d121,_0x13bcc6,_0x56b16d,_0x1e3677){return _0x7f1457(_0xd3d121,_0x13bcc6,_0x56b16d,_0x1e3677);},'vHDJK':_0x41b841(0x1fb),'ahiMF':function(_0x1f3fb6,_0x344a38){return _0x1f3fb6-_0x344a38;},'bGCjT':function(_0x27a4fc,_0x4dc533){return _0x27a4fc(_0x4dc533);},'oaioc':function(_0xe2d74e,_0x4648a1){return _0xe2d74e-_0x4648a1;}};let _0x4e2e9f='';try{_0x4e2e9f=_0x5c437c[_0x41b841(0x1d4)](_0x566ba7=>'\x27'+_0x566ba7[_0x41b841(0x1f7)]+'\x27:'+(nestedKeyValue(_0x566ba7,['test_run','uuid'])||nestedKeyValue(_0x566ba7,[_0x41b841(0x227),_0x41b841(0x23c)])))[_0x41b841(0x221)](','),_0x264b57[_0x41b841(0x1e4)](debug,'Processing\x20batch\x20events\x20for\x20'+_0xe773f1+_0x41b841(0x1ec)+Buffer[_0x41b841(0x1db)](util[_0x41b841(0x216)]('%j',_0x5c437c),_0x264b57[_0x41b841(0x20c)])+'\x20bytes.\x20Events\x20are\x20'+_0x4e2e9f);}catch(_0x1b492e){_0x264b57['NRILr'](debug,_0x41b841(0x220)+util[_0x41b841(0x216)](_0x1b492e)+'}');}const _0x24b7ee={'headers':_0x264b57[_0x41b841(0x20a)](getDefaultHeaders)};try{const _0x2aac10=await _0x264b57[_0x41b841(0x215)](nodeRequest,_0x264b57[_0x41b841(0x1d6)],_0x351e3d,_0x5c437c,_0x24b7ee);if(_0x2aac10[_0x41b841(0x1fe)]['error']){const _0x20e394={};_0x20e394[_0x41b841(0x211)]=_0x2aac10[_0x41b841(0x1fe)][_0x41b841(0x22c)];throw _0x20e394;}else _0x264b57[_0x41b841(0x1e4)](debug,_0xe773f1+_0x41b841(0x23b)+_0x4e2e9f+_0x41b841(0x242)+util[_0x41b841(0x216)]('%j',_0x2aac10['data'])),this[_0x41b841(0x202)]=Math['max'](0x0,_0x264b57[_0x41b841(0x1ff)](this[_0x41b841(0x202)],_0x5c437c['length']));}catch(_0x597d2a){_0x597d2a['response']?_0x264b57['bGCjT'](debug,_0x41b841(0x241)+_0xe773f1+_0x41b841(0x1f4)+_0x597d2a[_0x41b841(0x228)]['status']+'\x20'+_0x597d2a[_0x41b841(0x228)][_0x41b841(0x1f0)]+'\x20'+util[_0x41b841(0x216)]('%j',_0x597d2a[_0x41b841(0x228)])):_0x264b57[_0x41b841(0x21a)](debug,_0x41b841(0x241)+_0xe773f1+_0x41b841(0x1f4)+(_0x597d2a[_0x41b841(0x211)]||_0x597d2a)),this[_0x41b841(0x202)]=Math['max'](0x0,_0x264b57[_0x41b841(0x1fa)](this[_0x41b841(0x202)],_0x5c437c[_0x41b841(0x20e)]));}};[a86_0x2697e6(0x206)]=()=>{const _0x3d17ac=a86_0x2697e6,_0x589fe3={'LzaJW':function(_0x8b73b2,_0x5ea3ad){return _0x8b73b2>_0x5ea3ad;},'WrRsl':function(_0x2b6770,_0x40e3c2){return _0x2b6770(_0x40e3c2);},'bsagt':_0x3d17ac(0x1fc),'ZRLwM':function(_0x24b173,_0x4cbe4b,_0x58b867){return _0x24b173(_0x4cbe4b,_0x58b867);}};this[_0x3d17ac(0x214)]=_0x589fe3[_0x3d17ac(0x21b)](setInterval,async()=>{const _0x3b3fd6=_0x3d17ac;if(_0x589fe3[_0x3b3fd6(0x223)](this[_0x3b3fd6(0x235)][_0x3b3fd6(0x20e)],0x0)){_0x589fe3[_0x3b3fd6(0x1de)](trace,'Processing\x20events.\x20Queue\x20Length\x20-\x20'+this[_0x3b3fd6(0x235)]['length']);const _0x312b26=this['queue'][_0x3b3fd6(0x208)](0x0,BATCH_SIZE);this[_0x3b3fd6(0x235)]['splice'](0x0,BATCH_SIZE),await this[_0x3b3fd6(0x1f8)](this[_0x3b3fd6(0x230)],_0x589fe3[_0x3b3fd6(0x207)],_0x312b26),_0x589fe3[_0x3b3fd6(0x1de)](trace,'Remaining\x20Queue\x20Length\x20-\x20'+this[_0x3b3fd6(0x235)][_0x3b3fd6(0x20e)]);}},BATCH_INTERVAL);};['resetEventBatchPolling']=()=>{const _0x436db7=a86_0x2697e6,_0x2f34fb={};_0x2f34fb['fjrjK']=_0x436db7(0x1ed);const _0x4d50cf=_0x2f34fb;this[_0x436db7(0x22a)](_0x4d50cf[_0x436db7(0x1e0)]),this[_0x436db7(0x206)]();};[a86_0x2697e6(0x22a)]=_0x48800d=>{const _0x1a86b2=a86_0x2697e6,_0x5915ee={'fhwLI':function(_0x316b54,_0x1cf46c){return _0x316b54(_0x1cf46c);},'fUvPg':function(_0x1e24c7,_0x429d22){return _0x1e24c7===_0x429d22;},'RFfwM':_0x1a86b2(0x239)};this[_0x1a86b2(0x214)]&&(_0x5915ee[_0x1a86b2(0x245)](clearInterval,this[_0x1a86b2(0x214)]),this['pollEventBatchInterval']=null,_0x5915ee[_0x1a86b2(0x1d9)](_0x48800d,_0x5915ee[_0x1a86b2(0x1e8)])&&(this[_0x1a86b2(0x204)]=![]));};[a86_0x2697e6(0x22b)]=()=>{const _0x2f3a09=a86_0x2697e6,_0x59db5c={};_0x59db5c[_0x2f3a09(0x218)]=function(_0x1fc1ef,_0x28f1d8){return _0x1fc1ef>=_0x28f1d8;};const _0x328d90=_0x59db5c;return _0x328d90[_0x2f3a09(0x218)](this[_0x2f3a09(0x235)]['length'],BATCH_SIZE);};async[a86_0x2697e6(0x234)](_0x252dcd=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x148aaf=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x28aeda=a86_0x2697e6,_0x59764d={'qxSTB':function(_0x1b8179,_0x480345){return _0x1b8179<=_0x480345;},'rZnWd':function(_0x4c0abf,_0x339647){return _0x4c0abf<=_0x339647;},'Crdbv':function(_0x80c184,_0x25c651){return _0x80c184(_0x25c651);},'PoBGt':function(_0x401954,_0x3293a3){return _0x401954-_0x3293a3;}};if(_0x59764d['qxSTB'](this[_0x28aeda(0x202)],0x0)||_0x59764d[_0x28aeda(0x244)](_0x252dcd,0x0))return;return await _0x59764d['Crdbv'](sleep,_0x148aaf),this[_0x28aeda(0x234)](_0x59764d['PoBGt'](_0x252dcd,_0x148aaf));}}module[a86_0x2697e6(0x1dd)]=RequestQueueHandler;