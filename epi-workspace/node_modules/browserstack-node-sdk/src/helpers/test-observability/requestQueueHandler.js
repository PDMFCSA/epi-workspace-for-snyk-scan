const a123_0x16019f=a123_0x313e;(function(_0x254fa1,_0x3e1352){const _0x556ca2=a123_0x313e,_0x4e6c49=_0x254fa1();while(!![]){try{const _0xb5eaf7=-parseInt(_0x556ca2(0x15d))/0x1*(-parseInt(_0x556ca2(0x16f))/0x2)+parseInt(_0x556ca2(0x139))/0x3+-parseInt(_0x556ca2(0x163))/0x4*(parseInt(_0x556ca2(0x13c))/0x5)+parseInt(_0x556ca2(0x171))/0x6*(parseInt(_0x556ca2(0x155))/0x7)+parseInt(_0x556ca2(0x10d))/0x8+-parseInt(_0x556ca2(0x112))/0x9+-parseInt(_0x556ca2(0x154))/0xa;if(_0xb5eaf7===_0x3e1352)break;else _0x4e6c49['push'](_0x4e6c49['shift']());}catch(_0x17559d){_0x4e6c49['push'](_0x4e6c49['shift']());}}}(a123_0x1a99,0xbd912));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a123_0x16019f(0x115)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a123_0x16019f(0x113)),{nestedKeyValue}=require(a123_0x16019f(0x137)),util=require(a123_0x16019f(0x141)),constants=require('../../bin/utils/constants');function a123_0x1a99(){const _0x34a4bd=['uploadPending','started','add','split','removeEventBatchPolling','status','EXCEPTION\x20IN\x20','gNCIL','hxaNy','start','error','uuid','exports','AvsFd','QaxHI','Interval-Queue','AEods','QbmGx','data','../helper','response','2037918HTtoSr','getInstance','tEHTN','16065uXpxdU','queue','pendingUploads','instance','SsLit','util','slice','ZFpuj','TestRunSkipped','vOwys','fHcHg','cMRgN','WnjzC','Vbihy','startEventBatchPolling','\x20--\x20','pnEcz','map','api/v1/screenshots','join','\x20event\x20successful\x20for\x20events\x20','CIdCT','push','Shutdown-Queue','6915260ePBYpI','4566219aTsFVO','\x20:\x20','REMOVING','Processing\x20batch\x20events\x20for\x20','utf8','POST','jYbco','IfiQh','510242GCdIGk','TestRunStarted','batchAndPostEvents','Idiom','TEST_ATTACHMENT','ASNCx','820kjynFT','jgFYE','pXfzh','test_run','LogCreated','IHEaK','RESETTING','proceedWithUrl','max','RxorC','CoZsD','uploadAttachmentUrl','2KNSOgL','length','6mwOvIS','logs','TEST_SCREENSHOT','proceedWithData','BATCH_EVENT_TYPES','format','resetEventBatchPolling','\x20REQUEST\x20TO\x20','pollEventBatchInterval','JnZsO','eventUrl','splice','shouldProceed','10918384WTkojA','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','event_type','DeHYm','hook_run','9720054CyJmvH','./utils','CvyMl','./constants','keJux','.\x20Request\x20Size\x20-\x20','LwamV','TestRunFinished','TEST_REPORTING_ANALYTICS','shutdown','YQSMC','\x20bytes.\x20Events\x20are\x20','EIzQt','FAXSf','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','GLSdd','YYJNl','OAxRD'];a123_0x1a99=function(){return _0x34a4bd;};return a123_0x1a99();}class RequestQueueHandler{static [a123_0x16019f(0x13f)];[a123_0x16019f(0x13e)]=0x0;constructor(){const _0x27b15a=a123_0x16019f,_0x29ed0e={};_0x29ed0e[_0x27b15a(0x143)]='6|5|2|3|4|0|1',_0x29ed0e[_0x27b15a(0x134)]=_0x27b15a(0x167),_0x29ed0e[_0x27b15a(0x149)]='CBTSessionCreated',_0x29ed0e[_0x27b15a(0x14c)]=_0x27b15a(0x119),_0x29ed0e[_0x27b15a(0x164)]=_0x27b15a(0x144),_0x29ed0e[_0x27b15a(0x12b)]='HookRunFinished',_0x29ed0e[_0x27b15a(0x16d)]=_0x27b15a(0x15e),_0x29ed0e[_0x27b15a(0x15b)]='HookRunStarted',_0x29ed0e['ASNCx']='api/v1/batch',_0x29ed0e['FAXSf']=_0x27b15a(0x14e),_0x29ed0e[_0x27b15a(0x165)]='upload-attachments';const _0x27287b=_0x29ed0e,_0x5ef3de=_0x27287b[_0x27b15a(0x143)][_0x27b15a(0x127)]('|');let _0x291aa9=0x0;while(!![]){switch(_0x5ef3de[_0x291aa9++]){case'0':this['BATCH_EVENT_TYPES']=[_0x27287b['AEods'],_0x27287b[_0x27b15a(0x149)],_0x27287b['pnEcz'],_0x27287b[_0x27b15a(0x164)],_0x27287b[_0x27b15a(0x12b)],_0x27287b[_0x27b15a(0x16d)],_0x27287b[_0x27b15a(0x15b)]];continue;case'1':this[_0x27b15a(0x179)]=null;continue;case'2':this['eventUrl']=_0x27287b[_0x27b15a(0x162)];continue;case'3':this['screenshotEventUrl']=_0x27287b[_0x27b15a(0x11f)];continue;case'4':this[_0x27b15a(0x16e)]=_0x27287b[_0x27b15a(0x165)];continue;case'5':this[_0x27b15a(0x125)]=![];continue;case'6':this['queue']=[];continue;}break;}}static[a123_0x16019f(0x13a)](){const _0x5d5e41=a123_0x16019f;return!RequestQueueHandler['instance']&&(RequestQueueHandler['instance']=new RequestQueueHandler()),RequestQueueHandler[_0x5d5e41(0x13f)];}[a123_0x16019f(0x12d)]=()=>{const _0x324e98=a123_0x16019f;!this['started']&&(this[_0x324e98(0x125)]=!![],this[_0x324e98(0x14a)]());};[a123_0x16019f(0x126)]=_0x545548=>{const _0x1a6151=a123_0x16019f,_0x357d5d={'EIzQt':function(_0x2aff7d,_0x180c4b){return _0x2aff7d===_0x180c4b;},'keJux':_0x1a6151(0x173),'SsLit':function(_0x59225a,_0x317114){return _0x59225a>_0x317114;},'YYJNl':_0x1a6151(0x161),'vkEiu':function(_0x1664bd,_0x3f5161){return _0x1664bd!==_0x3f5161;},'CvyMl':_0x1a6151(0x119),'hxaNy':function(_0x2a22b1,_0x3e03a5){return _0x2a22b1(_0x3e03a5);},'IfiQh':_0x1a6151(0x120)};if(this[_0x1a6151(0x175)]['includes'](_0x545548[_0x1a6151(0x10f)])){if(_0x545548[_0x1a6151(0x172)]&&_0x545548['logs'][0x0]&&_0x357d5d[_0x1a6151(0x11e)](_0x545548[_0x1a6151(0x172)][0x0]['kind'],_0x357d5d[_0x1a6151(0x116)])){const _0x159504={};return _0x159504['shouldProceed']=!![],_0x159504[_0x1a6151(0x174)]=[_0x545548],_0x159504[_0x1a6151(0x16a)]=this['screenshotEventUrl'],_0x159504;}if(_0x545548[_0x1a6151(0x172)]&&_0x357d5d[_0x1a6151(0x140)](_0x545548[_0x1a6151(0x172)]['length'],0x0)&&_0x357d5d[_0x1a6151(0x11e)](_0x545548[_0x1a6151(0x172)][0x0]['kind'],_0x357d5d[_0x1a6151(0x122)])&&_0x357d5d['vkEiu'](_0x545548[_0x1a6151(0x10f)],_0x357d5d[_0x1a6151(0x114)])){const _0x3a84f3={};return _0x3a84f3[_0x1a6151(0x10c)]=!![],_0x3a84f3[_0x1a6151(0x174)]=[_0x545548],_0x3a84f3[_0x1a6151(0x16a)]=this['uploadAttachmentUrl'],_0x3a84f3;}this[_0x1a6151(0x13d)][_0x1a6151(0x152)](_0x545548);let _0x4cb7fd=null;const _0x138d2e=this['shouldProceed']();_0x138d2e&&(_0x357d5d[_0x1a6151(0x12c)](trace,_0x357d5d[_0x1a6151(0x15c)]),_0x4cb7fd=this['queue'][_0x1a6151(0x142)](0x0,BATCH_SIZE),this[_0x1a6151(0x13d)][_0x1a6151(0x17c)](0x0,BATCH_SIZE),this[_0x1a6151(0x177)]());const _0x230f43={};return _0x230f43[_0x1a6151(0x10c)]=_0x138d2e,_0x230f43[_0x1a6151(0x174)]=_0x4cb7fd,_0x230f43[_0x1a6151(0x16a)]=this[_0x1a6151(0x17b)],_0x230f43;}const _0xeb8f80={};return _0xeb8f80[_0x1a6151(0x10c)]=!![],_0xeb8f80;};[a123_0x16019f(0x11b)]=async()=>{const _0x378382=a123_0x16019f,_0x300e47={'AvsFd':_0x378382(0x157),'JnZsO':function(_0x42118b,_0xb01b61){return _0x42118b>_0xb01b61;},'tEHTN':_0x378382(0x153),'cMRgN':function(_0x49bee5,_0x5ebfe3){return _0x49bee5(_0x5ebfe3);}};await this[_0x378382(0x124)](),this['removeEventBatchPolling'](_0x300e47[_0x378382(0x131)]);while(_0x300e47[_0x378382(0x17a)](this[_0x378382(0x13d)][_0x378382(0x170)],0x0)){const _0x248abd=this[_0x378382(0x13d)]['slice'](0x0,BATCH_SIZE);this[_0x378382(0x13d)]['splice'](0x0,BATCH_SIZE),await this[_0x378382(0x15f)](this[_0x378382(0x17b)],_0x300e47[_0x378382(0x13b)],_0x248abd);}_0x300e47[_0x378382(0x17a)](this[_0x378382(0x13e)],0x0)&&_0x300e47[_0x378382(0x147)](debug,_0x378382(0x10e)+this[_0x378382(0x13e)]);};[a123_0x16019f(0x15f)]=async(_0x2d31c6,_0x190394,_0x4dca0b)=>{const _0x375881=a123_0x16019f,_0x21c255={'YQSMC':function(_0x48d798,_0x2078b5){return _0x48d798(_0x2078b5);},'LwamV':_0x375881(0x159),'IHEaK':function(_0x54663a){return _0x54663a();},'hiJCR':function(_0x1f69f0,_0x35b242,_0x35dc0a,_0x17c251,_0x1db141){return _0x1f69f0(_0x35b242,_0x35dc0a,_0x17c251,_0x1db141);},'fHcHg':_0x375881(0x15a),'DgULp':function(_0x4f3f35,_0x488398){return _0x4f3f35-_0x488398;},'HJAcu':function(_0x5227b6,_0x24fea3){return _0x5227b6-_0x24fea3;}};let _0x105914='';try{_0x105914=_0x4dca0b[_0x375881(0x14d)](_0xfb0bcf=>'\x27'+_0xfb0bcf[_0x375881(0x10f)]+'\x27:'+(nestedKeyValue(_0xfb0bcf,[_0x375881(0x166),_0x375881(0x12f)])||nestedKeyValue(_0xfb0bcf,[_0x375881(0x111),'uuid'])))[_0x375881(0x14f)](','),_0x21c255[_0x375881(0x11c)](debug,_0x375881(0x158)+_0x190394+_0x375881(0x117)+Buffer['byteLength'](util[_0x375881(0x176)]('%j',_0x4dca0b),_0x21c255[_0x375881(0x118)])+_0x375881(0x11d)+_0x105914);}catch(_0xe6e72){_0x21c255[_0x375881(0x11c)](debug,'Exception\x20in\x20logging\x20batch\x20events\x20--\x20'+util['format'](_0xe6e72)+'}');}const _0x15c44a={'headers':_0x21c255[_0x375881(0x168)](getDefaultHeaders)};try{const _0x296c7d=await _0x21c255['hiJCR'](nodeRequest,_0x21c255[_0x375881(0x146)],_0x2d31c6,_0x4dca0b,_0x15c44a);if(_0x296c7d[_0x375881(0x136)]['error']){const _0x1e1398={};_0x1e1398['message']=_0x296c7d['data'][_0x375881(0x12e)];throw _0x1e1398;}else _0x21c255[_0x375881(0x11c)](debug,_0x190394+_0x375881(0x150)+_0x105914+_0x375881(0x14b)+util['format']('%j',_0x296c7d[_0x375881(0x136)])),this['pendingUploads']=Math[_0x375881(0x16b)](0x0,_0x21c255['DgULp'](this['pendingUploads'],_0x4dca0b[_0x375881(0x170)]));}catch(_0x10c1f2){_0x10c1f2[_0x375881(0x138)]?_0x21c255[_0x375881(0x11c)](debug,_0x375881(0x12a)+_0x190394+'\x20REQUEST\x20TO\x20'+constants[_0x375881(0x11a)]+_0x375881(0x156)+_0x10c1f2[_0x375881(0x138)][_0x375881(0x129)]+'\x20'+_0x10c1f2['response']['statusText']+'\x20'+util[_0x375881(0x176)]('%j',_0x10c1f2['response'])):_0x21c255['YQSMC'](debug,'EXCEPTION\x20IN\x20'+_0x190394+_0x375881(0x178)+constants['TEST_REPORTING_ANALYTICS']+_0x375881(0x156)+(_0x10c1f2['message']||_0x10c1f2)),this[_0x375881(0x13e)]=Math[_0x375881(0x16b)](0x0,_0x21c255['HJAcu'](this[_0x375881(0x13e)],_0x4dca0b[_0x375881(0x170)]));}};[a123_0x16019f(0x14a)]=()=>{const _0x101368=a123_0x16019f,_0x20d154={'kyVOT':function(_0x20a2d4,_0x49e23f){return _0x20a2d4>_0x49e23f;},'QaxHI':function(_0x56188e,_0x567ba9){return _0x56188e(_0x567ba9);},'npxOy':_0x101368(0x133),'vOwys':function(_0x4a1148,_0x31f4a4,_0x267d4d){return _0x4a1148(_0x31f4a4,_0x267d4d);}};this[_0x101368(0x179)]=_0x20d154[_0x101368(0x145)](setInterval,async()=>{const _0x1a47e9=_0x101368;if(_0x20d154['kyVOT'](this[_0x1a47e9(0x13d)][_0x1a47e9(0x170)],0x0)){_0x20d154['QaxHI'](trace,'Processing\x20events.\x20Queue\x20Length\x20-\x20'+this[_0x1a47e9(0x13d)][_0x1a47e9(0x170)]);const _0x3484c7=this[_0x1a47e9(0x13d)][_0x1a47e9(0x142)](0x0,BATCH_SIZE);this[_0x1a47e9(0x13d)]['splice'](0x0,BATCH_SIZE),await this[_0x1a47e9(0x15f)](this['eventUrl'],_0x20d154['npxOy'],_0x3484c7),_0x20d154[_0x1a47e9(0x132)](trace,'Remaining\x20Queue\x20Length\x20-\x20'+this[_0x1a47e9(0x13d)][_0x1a47e9(0x170)]);}},BATCH_INTERVAL);};[a123_0x16019f(0x177)]=()=>{const _0x382b78=a123_0x16019f,_0x27ab06={};_0x27ab06['DeHYm']=_0x382b78(0x169);const _0x1f9e48=_0x27ab06;this[_0x382b78(0x128)](_0x1f9e48[_0x382b78(0x110)]),this['startEventBatchPolling']();};[a123_0x16019f(0x128)]=_0x182ec1=>{const _0x204676=a123_0x16019f,_0x27d276={'OAxRD':function(_0x7e6c74,_0xf856a8){return _0x7e6c74(_0xf856a8);},'WnjzC':function(_0x498968,_0x12c3cc){return _0x498968===_0x12c3cc;},'CIdCT':_0x204676(0x157)};this['pollEventBatchInterval']&&(_0x27d276[_0x204676(0x123)](clearInterval,this[_0x204676(0x179)]),this[_0x204676(0x179)]=null,_0x27d276[_0x204676(0x148)](_0x182ec1,_0x27d276[_0x204676(0x151)])&&(this[_0x204676(0x125)]=![]));};[a123_0x16019f(0x10c)]=()=>{const _0x14d95d=a123_0x16019f,_0x5c1fa3={};_0x5c1fa3[_0x14d95d(0x16c)]=function(_0x3afe45,_0x11fc2a){return _0x3afe45>=_0x11fc2a;};const _0x53f318=_0x5c1fa3;return _0x53f318['RxorC'](this[_0x14d95d(0x13d)][_0x14d95d(0x170)],BATCH_SIZE);};async['uploadPending'](_0x5ae107=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x3f3f18=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0xf1276c=a123_0x16019f,_0x598e0c={'GLSdd':function(_0xe31107,_0xc741e4){return _0xe31107<=_0xc741e4;},'Idiom':function(_0x4e1806,_0x5d0667){return _0x4e1806(_0x5d0667);},'QbmGx':function(_0x197f62,_0xa69969){return _0x197f62-_0xa69969;}};if(_0x598e0c['GLSdd'](this['pendingUploads'],0x0)||_0x598e0c[_0xf1276c(0x121)](_0x5ae107,0x0))return;return await _0x598e0c[_0xf1276c(0x160)](sleep,_0x3f3f18),this[_0xf1276c(0x124)](_0x598e0c[_0xf1276c(0x135)](_0x5ae107,_0x3f3f18));}}function a123_0x313e(_0x167019,_0x277675){const _0x1a99bb=a123_0x1a99();return a123_0x313e=function(_0x313e63,_0xd4ccf3){_0x313e63=_0x313e63-0x10c;let _0xc51e24=_0x1a99bb[_0x313e63];return _0xc51e24;},a123_0x313e(_0x167019,_0x277675);}module[a123_0x16019f(0x130)]=RequestQueueHandler;