const a115_0x1be6fe=a115_0x45c2;function a115_0x45c2(_0x4ba6da,_0x2f9afb){const _0x370ad4=a115_0x370a();return a115_0x45c2=function(_0x45c274,_0x3f5513){_0x45c274=_0x45c274-0x18d;let _0x39ac9c=_0x370ad4[_0x45c274];return _0x39ac9c;},a115_0x45c2(_0x4ba6da,_0x2f9afb);}(function(_0x48ff80,_0x200698){const _0x39f20e=a115_0x45c2,_0x522df0=_0x48ff80();while(!![]){try{const _0x1bd1e9=-parseInt(_0x39f20e(0x1f2))/0x1+-parseInt(_0x39f20e(0x1ce))/0x2*(parseInt(_0x39f20e(0x1eb))/0x3)+parseInt(_0x39f20e(0x191))/0x4*(-parseInt(_0x39f20e(0x1bd))/0x5)+parseInt(_0x39f20e(0x1b9))/0x6*(-parseInt(_0x39f20e(0x198))/0x7)+-parseInt(_0x39f20e(0x1cf))/0x8+parseInt(_0x39f20e(0x1dd))/0x9+parseInt(_0x39f20e(0x18d))/0xa*(parseInt(_0x39f20e(0x1a5))/0xb);if(_0x1bd1e9===_0x200698)break;else _0x522df0['push'](_0x522df0['shift']());}catch(_0x48a859){_0x522df0['push'](_0x522df0['shift']());}}}(a115_0x370a,0xb851a));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a115_0x1be6fe(0x1a9)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require(a115_0x1be6fe(0x1ac)),util=require('util');class RequestQueueHandler{static [a115_0x1be6fe(0x1e6)];[a115_0x1be6fe(0x193)]=0x0;constructor(){const _0x155c53=a115_0x1be6fe,_0x1327cd={};_0x1327cd[_0x155c53(0x1ba)]='1|0|6|4|2|5|3',_0x1327cd[_0x155c53(0x1f8)]=_0x155c53(0x1d9),_0x1327cd['ALJOM']=_0x155c53(0x1d8),_0x1327cd['WcyfQ']=_0x155c53(0x18f),_0x1327cd[_0x155c53(0x1bc)]=_0x155c53(0x1b2),_0x1327cd[_0x155c53(0x19c)]='TestRunFinished',_0x1327cd[_0x155c53(0x19a)]=_0x155c53(0x1aa),_0x1327cd[_0x155c53(0x1ca)]=_0x155c53(0x1c1),_0x1327cd[_0x155c53(0x1a7)]=_0x155c53(0x1e7),_0x1327cd['HrRyS']=_0x155c53(0x1a3),_0x1327cd[_0x155c53(0x1f7)]='api/v1/batch';const _0x10feae=_0x1327cd,_0x217e5a=_0x10feae[_0x155c53(0x1ba)][_0x155c53(0x1e5)]('|');let _0x4d42f7=0x0;while(!![]){switch(_0x217e5a[_0x4d42f7++]){case'0':this['started']=![];continue;case'1':this[_0x155c53(0x1e1)]=[];continue;case'2':this[_0x155c53(0x1d5)]=_0x10feae['pDrHW'];continue;case'3':this[_0x155c53(0x1f6)]=null;continue;case'4':this[_0x155c53(0x1a4)]=_0x10feae[_0x155c53(0x1d3)];continue;case'5':this[_0x155c53(0x1b6)]=[_0x10feae[_0x155c53(0x1b0)],_0x10feae[_0x155c53(0x1bc)],_0x10feae[_0x155c53(0x19c)],_0x10feae[_0x155c53(0x19a)],_0x10feae['StndQ'],_0x10feae['wDzuY'],_0x10feae[_0x155c53(0x1e3)]];continue;case'6':this['eventUrl']=_0x10feae['BPmGX'];continue;}break;}}static['getInstance'](){const _0x2d0fa8=a115_0x1be6fe;return!RequestQueueHandler[_0x2d0fa8(0x1e6)]&&(RequestQueueHandler[_0x2d0fa8(0x1e6)]=new RequestQueueHandler()),RequestQueueHandler[_0x2d0fa8(0x1e6)];}['start']=()=>{const _0x12832b=a115_0x1be6fe;!this[_0x12832b(0x1af)]&&(this[_0x12832b(0x1af)]=!![],this['startEventBatchPolling']());};[a115_0x1be6fe(0x197)]=_0x3f817d=>{const _0x4e4010=a115_0x1be6fe,_0x2e4e92={'Opdtp':function(_0x17cd1f,_0x44fa73){return _0x17cd1f===_0x44fa73;},'WoOXo':'TEST_SCREENSHOT','qeraa':function(_0x426018,_0x31d153){return _0x426018>_0x31d153;},'TuZlu':function(_0x8de3f8,_0x50ee7d){return _0x8de3f8===_0x50ee7d;},'sdZSo':_0x4e4010(0x1da),'oSBNn':function(_0x55bc86,_0x3d1a67){return _0x55bc86!==_0x3d1a67;},'qMLfA':'TestRunFinished','PrYkf':function(_0x418655,_0x38fafc){return _0x418655(_0x38fafc);},'QRXCc':_0x4e4010(0x1d6)};if(this['BATCH_EVENT_TYPES'][_0x4e4010(0x1a8)](_0x3f817d[_0x4e4010(0x1ad)])){if(_0x3f817d['logs']&&_0x3f817d[_0x4e4010(0x1f0)][0x0]&&_0x2e4e92[_0x4e4010(0x1e0)](_0x3f817d['logs'][0x0][_0x4e4010(0x1ab)],_0x2e4e92[_0x4e4010(0x192)])){const _0x631200={};return _0x631200[_0x4e4010(0x1cc)]=!![],_0x631200['proceedWithData']=[_0x3f817d],_0x631200[_0x4e4010(0x19b)]=this['screenshotEventUrl'],_0x631200;}if(_0x3f817d[_0x4e4010(0x1f0)]&&_0x2e4e92[_0x4e4010(0x1f1)](_0x3f817d['logs'][_0x4e4010(0x1ee)],0x0)&&_0x2e4e92['TuZlu'](_0x3f817d[_0x4e4010(0x1f0)][0x0][_0x4e4010(0x1ab)],_0x2e4e92[_0x4e4010(0x1ea)])&&_0x2e4e92[_0x4e4010(0x1f4)](_0x3f817d[_0x4e4010(0x1ad)],_0x2e4e92[_0x4e4010(0x1c8)])){const _0x21f264={};return _0x21f264[_0x4e4010(0x1cc)]=!![],_0x21f264[_0x4e4010(0x1ef)]=[_0x3f817d],_0x21f264[_0x4e4010(0x19b)]=this[_0x4e4010(0x1d5)],_0x21f264;}this[_0x4e4010(0x1e1)][_0x4e4010(0x1c4)](_0x3f817d);let _0x271fce=null;const _0x258791=this[_0x4e4010(0x1cc)]();_0x258791&&(_0x2e4e92[_0x4e4010(0x1c5)](trace,_0x2e4e92[_0x4e4010(0x1be)]),_0x271fce=this[_0x4e4010(0x1e1)][_0x4e4010(0x1e8)](0x0,BATCH_SIZE),this['queue'][_0x4e4010(0x1a0)](0x0,BATCH_SIZE),this[_0x4e4010(0x1d4)]());const _0x760989={};return _0x760989[_0x4e4010(0x1cc)]=_0x258791,_0x760989[_0x4e4010(0x1ef)]=_0x271fce,_0x760989[_0x4e4010(0x19b)]=this[_0x4e4010(0x1c3)],_0x760989;}const _0x23b912={};return _0x23b912['shouldProceed']=!![],_0x23b912;};[a115_0x1be6fe(0x18e)]=async()=>{const _0x4709cc=a115_0x1be6fe,_0x510dc5={'NuMWM':_0x4709cc(0x1a2),'FCEPx':function(_0x2369fb,_0x306537){return _0x2369fb>_0x306537;},'oyqDD':'Shutdown-Queue','XuamX':function(_0x2fcb0b,_0x362a42){return _0x2fcb0b(_0x362a42);}};await this[_0x4709cc(0x19d)](),this['removeEventBatchPolling'](_0x510dc5['NuMWM']);while(_0x510dc5[_0x4709cc(0x1b4)](this[_0x4709cc(0x1e1)][_0x4709cc(0x1ee)],0x0)){const _0x36fdf5=this['queue'][_0x4709cc(0x1e8)](0x0,BATCH_SIZE);this['queue'][_0x4709cc(0x1a0)](0x0,BATCH_SIZE),await this[_0x4709cc(0x1ed)](this['eventUrl'],_0x510dc5['oyqDD'],_0x36fdf5);}_0x510dc5['FCEPx'](this['pendingUploads'],0x0)&&_0x510dc5[_0x4709cc(0x1e4)](debug,_0x4709cc(0x1de)+this['pendingUploads']);};[a115_0x1be6fe(0x1ed)]=async(_0x4aabf4,_0x37ba4d,_0x5709ee)=>{const _0x53ffc4=a115_0x1be6fe,_0x4184b2={'MVNvK':function(_0x352fa6,_0x1cb419){return _0x352fa6(_0x1cb419);},'qvzvk':_0x53ffc4(0x1c0),'uHAWw':function(_0x42feba){return _0x42feba();},'pvvjD':function(_0xcc741,_0x4aadae,_0x404091,_0x4c68e5,_0x59b61a){return _0xcc741(_0x4aadae,_0x404091,_0x4c68e5,_0x59b61a);},'XNIZm':'POST','bSAJi':function(_0x163fef,_0x570d61){return _0x163fef-_0x570d61;}};let _0x1705a8='';try{_0x1705a8=_0x5709ee[_0x53ffc4(0x1c6)](_0x43908a=>'\x27'+_0x43908a['event_type']+'\x27:'+(nestedKeyValue(_0x43908a,['test_run',_0x53ffc4(0x1e9)])||nestedKeyValue(_0x43908a,[_0x53ffc4(0x1a6),'uuid'])))['join'](','),_0x4184b2['MVNvK'](debug,_0x53ffc4(0x1df)+_0x37ba4d+_0x53ffc4(0x1f5)+Buffer['byteLength'](util[_0x53ffc4(0x190)]('%j',_0x5709ee),_0x4184b2['qvzvk'])+_0x53ffc4(0x1c9)+_0x1705a8);}catch(_0x488ae0){_0x4184b2[_0x53ffc4(0x1db)](debug,_0x53ffc4(0x1a1)+util['format'](_0x488ae0)+'}');}const _0x106dfa={'headers':_0x4184b2[_0x53ffc4(0x1b5)](getDefaultHeaders)};try{const _0x1c70f5=await _0x4184b2[_0x53ffc4(0x1d0)](nodeRequest,_0x4184b2['XNIZm'],_0x4aabf4,_0x5709ee,_0x106dfa);if(_0x1c70f5['data']['error']){const _0x4221f1={};_0x4221f1['message']=_0x1c70f5['data'][_0x53ffc4(0x1c7)];throw _0x4221f1;}else _0x4184b2[_0x53ffc4(0x1db)](debug,_0x37ba4d+_0x53ffc4(0x1c2)+_0x1705a8+_0x53ffc4(0x199)+util[_0x53ffc4(0x190)]('%j',_0x1c70f5[_0x53ffc4(0x1b7)])),this[_0x53ffc4(0x193)]=Math[_0x53ffc4(0x1dc)](0x0,_0x4184b2[_0x53ffc4(0x1d7)](this[_0x53ffc4(0x193)],_0x5709ee[_0x53ffc4(0x1ee)]));}catch(_0x14b1ee){_0x14b1ee[_0x53ffc4(0x196)]?_0x4184b2[_0x53ffc4(0x1db)](debug,_0x53ffc4(0x194)+_0x37ba4d+_0x53ffc4(0x1bf)+_0x14b1ee[_0x53ffc4(0x196)]['status']+'\x20'+_0x14b1ee[_0x53ffc4(0x196)][_0x53ffc4(0x19e)]+'\x20'+util[_0x53ffc4(0x190)]('%j',_0x14b1ee[_0x53ffc4(0x196)])):_0x4184b2['MVNvK'](debug,_0x53ffc4(0x194)+_0x37ba4d+_0x53ffc4(0x1bf)+(_0x14b1ee[_0x53ffc4(0x1b8)]||_0x14b1ee)),this[_0x53ffc4(0x193)]=Math[_0x53ffc4(0x1dc)](0x0,_0x4184b2[_0x53ffc4(0x1d7)](this[_0x53ffc4(0x193)],_0x5709ee[_0x53ffc4(0x1ee)]));}};[a115_0x1be6fe(0x19f)]=()=>{const _0x51983e=a115_0x1be6fe,_0x10f2c8={'pAqHW':function(_0x622e5,_0x2b4cb2){return _0x622e5>_0x2b4cb2;},'Krglv':function(_0x32331f,_0x2a484d){return _0x32331f(_0x2a484d);},'GAMzW':_0x51983e(0x1b3),'meFNB':function(_0x24e7c8,_0x23e4f3){return _0x24e7c8(_0x23e4f3);},'anPej':function(_0x4b8bab,_0x372e7a,_0x56f543){return _0x4b8bab(_0x372e7a,_0x56f543);}};this[_0x51983e(0x1f6)]=_0x10f2c8['anPej'](setInterval,async()=>{const _0x405448=_0x51983e;if(_0x10f2c8[_0x405448(0x1d2)](this[_0x405448(0x1e1)][_0x405448(0x1ee)],0x0)){_0x10f2c8[_0x405448(0x1ec)](trace,'Processing\x20events.\x20Queue\x20Length\x20-\x20'+this[_0x405448(0x1e1)][_0x405448(0x1ee)]);const _0x4edf34=this[_0x405448(0x1e1)]['slice'](0x0,BATCH_SIZE);this[_0x405448(0x1e1)]['splice'](0x0,BATCH_SIZE),await this[_0x405448(0x1ed)](this[_0x405448(0x1c3)],_0x10f2c8['GAMzW'],_0x4edf34),_0x10f2c8[_0x405448(0x195)](trace,'Remaining\x20Queue\x20Length\x20-\x20'+this[_0x405448(0x1e1)][_0x405448(0x1ee)]);}},BATCH_INTERVAL);};['resetEventBatchPolling']=()=>{const _0x46e0f2=a115_0x1be6fe,_0x158081={};_0x158081[_0x46e0f2(0x1d1)]=_0x46e0f2(0x1ae);const _0x282949=_0x158081;this[_0x46e0f2(0x1f3)](_0x282949[_0x46e0f2(0x1d1)]),this[_0x46e0f2(0x19f)]();};[a115_0x1be6fe(0x1f3)]=_0x7f0d3=>{const _0x17546f=a115_0x1be6fe,_0x203965={'uKiXd':function(_0x2f2a46,_0x3fdb76){return _0x2f2a46(_0x3fdb76);},'eaxgb':function(_0x87f374,_0x19fbab){return _0x87f374===_0x19fbab;},'iPjVa':_0x17546f(0x1a2)};this[_0x17546f(0x1f6)]&&(_0x203965[_0x17546f(0x1b1)](clearInterval,this['pollEventBatchInterval']),this[_0x17546f(0x1f6)]=null,_0x203965['eaxgb'](_0x7f0d3,_0x203965[_0x17546f(0x1cd)])&&(this[_0x17546f(0x1af)]=![]));};[a115_0x1be6fe(0x1cc)]=()=>{const _0x53cf0e=a115_0x1be6fe,_0x462ad6={};_0x462ad6[_0x53cf0e(0x1bb)]=function(_0x1e62ed,_0x1eab0a){return _0x1e62ed>=_0x1eab0a;};const _0x127723=_0x462ad6;return _0x127723[_0x53cf0e(0x1bb)](this['queue']['length'],BATCH_SIZE);};async[a115_0x1be6fe(0x19d)](_0x3dba2f=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x290151=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x31c736=a115_0x1be6fe,_0x46b5e5={'fQuwk':function(_0xc171af,_0x4f7f3b){return _0xc171af<=_0x4f7f3b;},'MzytF':function(_0x5f0f4a,_0x2b6cb9){return _0x5f0f4a(_0x2b6cb9);},'ezOMs':function(_0x445e00,_0x3c53ac){return _0x445e00-_0x3c53ac;}};if(_0x46b5e5[_0x31c736(0x1cb)](this[_0x31c736(0x193)],0x0)||_0x46b5e5['fQuwk'](_0x3dba2f,0x0))return;return await _0x46b5e5[_0x31c736(0x1e2)](sleep,_0x290151),this['uploadPending'](_0x46b5e5['ezOMs'](_0x3dba2f,_0x290151));}}module['exports']=RequestQueueHandler;function a115_0x370a(){const _0x37c69c=['\x20bytes.\x20Events\x20are\x20','StndQ','fQuwk','shouldProceed','iPjVa','2070382bGtMZd','10246872jFbkCY','pvvjD','UgkvD','pAqHW','ALJOM','resetEventBatchPolling','uploadAttachmentUrl','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','bSAJi','api/v1/screenshots','upload-attachments','TEST_ATTACHMENT','MVNvK','max','9291132FCklmb','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','Processing\x20batch\x20events\x20for\x20','Opdtp','queue','MzytF','HrRyS','XuamX','split','instance','TestRunStarted','slice','uuid','sdZSo','3eRTMWG','Krglv','batchAndPostEvents','length','proceedWithData','logs','qeraa','1328363VqJnBk','removeEventBatchPolling','oSBNn','.\x20Request\x20Size\x20-\x20','pollEventBatchInterval','BPmGX','pDrHW','25865620lrvdvW','shutdown','LogCreated','format','1540sdpXmz','WoOXo','pendingUploads','EXCEPTION\x20IN\x20','meFNB','response','add','1043GlqTrR','\x20--\x20','oPOjI','proceedWithUrl','wdZJj','uploadPending','statusText','startEventBatchPolling','splice','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','REMOVING','HookRunStarted','screenshotEventUrl','22YLggJU','hook_run','wDzuY','includes','./constants','TestRunSkipped','kind','../helper','event_type','RESETTING','started','WcyfQ','uKiXd','CBTSessionCreated','Interval-Queue','FCEPx','uHAWw','BATCH_EVENT_TYPES','data','message','24606aqHXEO','rIiqR','PXDjr','KffmQ','15520pAvefa','QRXCc','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','utf8','HookRunFinished','\x20event\x20successful\x20for\x20events\x20','eventUrl','push','PrYkf','map','error','qMLfA'];a115_0x370a=function(){return _0x37c69c;};return a115_0x370a();}