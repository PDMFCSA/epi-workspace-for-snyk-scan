const a86_0x5935f3=a86_0x3787;function a86_0x4f7d(){const _0x4310ee=['TEST_ATTACHMENT','vWkqR','MSVPv','length','Processing\x20batch\x20events\x20for\x20','jssVg','response','error','batchAndPostEvents','JOpOq','removeEventBatchPolling','SjXBY','\x20--\x20','status','Processing\x20events.\x20Queue\x20Length\x20-\x20','./utils','Remaining\x20Queue\x20Length\x20-\x20','format','util','618742XIBrhz','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','uDNMP','\x20event\x20successful\x20for\x20events\x20','screenshotEventUrl','uploadAttachmentUrl','zvDvm','queue','8360jemdqE','uTqUg','REMOVING','171339HgdruY','splice','yVJjI','slice','getInstance','Shutdown-Queue','uploadPending','statusText','.\x20Request\x20Size\x20-\x20','vKpsq','hgwbC','TestRunSkipped','shutdown','startEventBatchPolling','5928215IRaYnd','message','IWFSq','3477282KucCUA','map','oRoEv','./constants','byteLength','event_type','pollEventBatchInterval','KtDvt','WrKvY','957750aTGdZA','FmrOt','CBTSessionCreated','dTLes','jYokU','logs','cKJYM','max','QQOCI','kOmXx','hFBLz','YMQIb','3322701gULSkt','wMgoM','../helper','GXMed','TestRunFinished','data','proceedWithData','vsEkp','BATCH_EVENT_TYPES','TestRunStarted','instance','resetEventBatchPolling','roTRr','zGtEc','16itXeaF','split','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','Interval-Queue','add','EXCEPTION\x20IN\x20','pendingUploads','VERob','started','HookRunStarted','HookRunFinished','utf8','InPam','LogCreated','VspuC','LtXqI','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','eventUrl','start','upload-attachments','exports','72wNzaTp','FNLgo','shouldProceed','test_run','kind','proceedWithUrl','uuid'];a86_0x4f7d=function(){return _0x4310ee;};return a86_0x4f7d();}(function(_0x14f40d,_0xb0e3b8){const _0x1ee5f1=a86_0x3787,_0x107e61=_0x14f40d();while(!![]){try{const _0x4315f7=parseInt(_0x1ee5f1(0x12e))/0x1+parseInt(_0x1ee5f1(0xe5))/0x2+-parseInt(_0x1ee5f1(0xdc))/0x3+-parseInt(_0x1ee5f1(0x136))/0x4+parseInt(_0x1ee5f1(0xd9))/0x5+-parseInt(_0x1ee5f1(0x114))/0x6*(-parseInt(_0x1ee5f1(0x139))/0x7)+-parseInt(_0x1ee5f1(0xff))/0x8*(parseInt(_0x1ee5f1(0xf1))/0x9);if(_0x4315f7===_0xb0e3b8)break;else _0x107e61['push'](_0x107e61['shift']());}catch(_0x58757a){_0x107e61['push'](_0x107e61['shift']());}}}(a86_0x4f7d,0xa562e));function a86_0x3787(_0xf113f6,_0x5d3fb7){const _0x4f7dfa=a86_0x4f7d();return a86_0x3787=function(_0x378728,_0x1468e1){_0x378728=_0x378728-0xd7;let _0x485d4b=_0x4f7dfa[_0x378728];return _0x485d4b;},a86_0x3787(_0xf113f6,_0x5d3fb7);}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a86_0x5935f3(0xdf)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a86_0x5935f3(0x12a)),{nestedKeyValue}=require(a86_0x5935f3(0xf3)),util=require(a86_0x5935f3(0x12d));class RequestQueueHandler{static [a86_0x5935f3(0xfb)];[a86_0x5935f3(0x105)]=0x0;constructor(){const _0x3a0906=a86_0x5935f3,_0x1a8444={};_0x1a8444[_0x3a0906(0xee)]='3|2|5|4|6|0|1',_0x1a8444[_0x3a0906(0x124)]=_0x3a0906(0x10c),_0x1a8444[_0x3a0906(0x10b)]=_0x3a0906(0xe7),_0x1a8444[_0x3a0906(0xe9)]=_0x3a0906(0xf5),_0x1a8444[_0x3a0906(0x11d)]=_0x3a0906(0x144),_0x1a8444[_0x3a0906(0x142)]=_0x3a0906(0x109),_0x1a8444['vWkqR']=_0x3a0906(0xfa),_0x1a8444[_0x3a0906(0xf4)]=_0x3a0906(0x108),_0x1a8444['zjgwd']='api/v1/screenshots',_0x1a8444[_0x3a0906(0xe3)]='api/v1/batch',_0x1a8444[_0x3a0906(0x143)]=_0x3a0906(0x112);const _0x5b9863=_0x1a8444,_0x2e89cd=_0x5b9863[_0x3a0906(0xee)][_0x3a0906(0x100)]('|');let _0x5039f3=0x0;while(!![]){switch(_0x2e89cd[_0x5039f3++]){case'0':this[_0x3a0906(0xf9)]=[_0x5b9863[_0x3a0906(0x124)],_0x5b9863[_0x3a0906(0x10b)],_0x5b9863['jYokU'],_0x5b9863[_0x3a0906(0x11d)],_0x5b9863['vKpsq'],_0x5b9863[_0x3a0906(0x11c)],_0x5b9863[_0x3a0906(0xf4)]];continue;case'1':this['pollEventBatchInterval']=null;continue;case'2':this[_0x3a0906(0x107)]=![];continue;case'3':this[_0x3a0906(0x135)]=[];continue;case'4':this[_0x3a0906(0x132)]=_0x5b9863['zjgwd'];continue;case'5':this[_0x3a0906(0x110)]=_0x5b9863[_0x3a0906(0xe3)];continue;case'6':this[_0x3a0906(0x133)]=_0x5b9863[_0x3a0906(0x143)];continue;}break;}}static[a86_0x5935f3(0x13d)](){return!RequestQueueHandler['instance']&&(RequestQueueHandler['instance']=new RequestQueueHandler()),RequestQueueHandler['instance'];}[a86_0x5935f3(0x111)]=()=>{const _0x2445d1=a86_0x5935f3;!this[_0x2445d1(0x107)]&&(this[_0x2445d1(0x107)]=!![],this[_0x2445d1(0xd8)]());};[a86_0x5935f3(0x103)]=_0x505792=>{const _0x3961e7=a86_0x5935f3,_0x58478e={'VspuC':function(_0x368e74,_0x275150){return _0x368e74===_0x275150;},'roTRr':'TEST_SCREENSHOT','hFBLz':function(_0x2d505b,_0x48b577){return _0x2d505b>_0x48b577;},'QQOCI':function(_0x4e8371,_0x2257b4){return _0x4e8371===_0x2257b4;},'wMgoM':_0x3961e7(0x11b),'FmrOt':function(_0x3fa682,_0x42012b){return _0x3fa682!==_0x42012b;},'ThdYc':_0x3961e7(0xf5),'hTVJe':function(_0x25300b,_0x6e69a3){return _0x25300b(_0x6e69a3);},'vsEkp':_0x3961e7(0x101)};if(this['BATCH_EVENT_TYPES']['includes'](_0x505792[_0x3961e7(0xe1)])){if(_0x505792['logs']&&_0x505792['logs'][0x0]&&_0x58478e[_0x3961e7(0x10d)](_0x505792[_0x3961e7(0xea)][0x0][_0x3961e7(0x118)],_0x58478e[_0x3961e7(0xfd)])){const _0x41b42e={};return _0x41b42e[_0x3961e7(0x116)]=!![],_0x41b42e[_0x3961e7(0xf7)]=[_0x505792],_0x41b42e['proceedWithUrl']=this['screenshotEventUrl'],_0x41b42e;}if(_0x505792[_0x3961e7(0xea)]&&_0x58478e[_0x3961e7(0xef)](_0x505792[_0x3961e7(0xea)][_0x3961e7(0x11e)],0x0)&&_0x58478e[_0x3961e7(0xed)](_0x505792[_0x3961e7(0xea)][0x0]['kind'],_0x58478e[_0x3961e7(0xf2)])&&_0x58478e[_0x3961e7(0xe6)](_0x505792[_0x3961e7(0xe1)],_0x58478e['ThdYc'])){const _0x43430f={};return _0x43430f[_0x3961e7(0x116)]=!![],_0x43430f['proceedWithData']=[_0x505792],_0x43430f[_0x3961e7(0x119)]=this[_0x3961e7(0x133)],_0x43430f;}this[_0x3961e7(0x135)]['push'](_0x505792);let _0x30a597=null;const _0x36031e=this[_0x3961e7(0x116)]();_0x36031e&&(_0x58478e['hTVJe'](trace,_0x58478e[_0x3961e7(0xf8)]),_0x30a597=this[_0x3961e7(0x135)][_0x3961e7(0x13c)](0x0,BATCH_SIZE),this[_0x3961e7(0x135)][_0x3961e7(0x13a)](0x0,BATCH_SIZE),this[_0x3961e7(0xfc)]());const _0x3beefb={};return _0x3beefb[_0x3961e7(0x116)]=_0x36031e,_0x3beefb[_0x3961e7(0xf7)]=_0x30a597,_0x3beefb[_0x3961e7(0x119)]=this['eventUrl'],_0x3beefb;}const _0x517c84={};return _0x517c84[_0x3961e7(0x116)]=!![],_0x517c84;};[a86_0x5935f3(0xd7)]=async()=>{const _0x11ebfb=a86_0x5935f3,_0x3f4e51={'eIgen':_0x11ebfb(0x138),'VERob':function(_0x385213,_0x97b9fd){return _0x385213>_0x97b9fd;},'uTqUg':_0x11ebfb(0x13e),'oRqUs':function(_0x24c4a4,_0x1f1528){return _0x24c4a4>_0x1f1528;},'zVjKd':function(_0x574aa3,_0x944022){return _0x574aa3(_0x944022);}};await this[_0x11ebfb(0x13f)](),this[_0x11ebfb(0x125)](_0x3f4e51['eIgen']);while(_0x3f4e51[_0x11ebfb(0x106)](this[_0x11ebfb(0x135)][_0x11ebfb(0x11e)],0x0)){const _0x1e6f70=this[_0x11ebfb(0x135)][_0x11ebfb(0x13c)](0x0,BATCH_SIZE);this[_0x11ebfb(0x135)]['splice'](0x0,BATCH_SIZE),await this[_0x11ebfb(0x123)](this['eventUrl'],_0x3f4e51[_0x11ebfb(0x137)],_0x1e6f70);}_0x3f4e51['oRqUs'](this['pendingUploads'],0x0)&&_0x3f4e51['zVjKd'](debug,'Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20'+this['pendingUploads']);};[a86_0x5935f3(0x123)]=async(_0x36cb8d,_0x3948f4,_0x18ca93)=>{const _0x39ba4f=a86_0x5935f3,_0x5e066e={'yVJjI':function(_0x53e6eb,_0xc4da4e){return _0x53e6eb(_0xc4da4e);},'SjXBY':_0x39ba4f(0x10a),'gLQJR':function(_0x29303b){return _0x29303b();},'FNLgo':function(_0x1ee89a,_0x485944,_0x3aa0ab,_0x344b88,_0x4ea698){return _0x1ee89a(_0x485944,_0x3aa0ab,_0x344b88,_0x4ea698);},'BwyGL':'POST','uDNMP':function(_0x18cc27,_0x52766a){return _0x18cc27(_0x52766a);},'YMQIb':function(_0x246a1b,_0x410120){return _0x246a1b-_0x410120;},'jssVg':function(_0x5d886f,_0x3f6cd6){return _0x5d886f(_0x3f6cd6);}};let _0x334dae='';try{_0x334dae=_0x18ca93[_0x39ba4f(0xdd)](_0x154f26=>'\x27'+_0x154f26[_0x39ba4f(0xe1)]+'\x27:'+(nestedKeyValue(_0x154f26,[_0x39ba4f(0x117),_0x39ba4f(0x11a)])||nestedKeyValue(_0x154f26,['hook_run',_0x39ba4f(0x11a)])))['join'](','),_0x5e066e[_0x39ba4f(0x13b)](debug,_0x39ba4f(0x11f)+_0x3948f4+_0x39ba4f(0x141)+Buffer[_0x39ba4f(0xe0)](util[_0x39ba4f(0x12c)]('%j',_0x18ca93),_0x5e066e[_0x39ba4f(0x126)])+'\x20bytes.\x20Events\x20are\x20'+_0x334dae);}catch(_0x4134fc){_0x5e066e[_0x39ba4f(0x13b)](debug,_0x39ba4f(0x12f)+util['format'](_0x4134fc)+'}');}const _0xa10c51={'headers':_0x5e066e['gLQJR'](getDefaultHeaders)};try{const _0x520a30=await _0x5e066e[_0x39ba4f(0x115)](nodeRequest,_0x5e066e['BwyGL'],_0x36cb8d,_0x18ca93,_0xa10c51);if(_0x520a30[_0x39ba4f(0xf6)][_0x39ba4f(0x122)]){const _0x57abf8={};_0x57abf8[_0x39ba4f(0xda)]=_0x520a30[_0x39ba4f(0xf6)][_0x39ba4f(0x122)];throw _0x57abf8;}else _0x5e066e['uDNMP'](debug,_0x3948f4+_0x39ba4f(0x131)+_0x334dae+_0x39ba4f(0x127)+util['format']('%j',_0x520a30[_0x39ba4f(0xf6)])),this[_0x39ba4f(0x105)]=Math[_0x39ba4f(0xec)](0x0,_0x5e066e[_0x39ba4f(0xf0)](this[_0x39ba4f(0x105)],_0x18ca93[_0x39ba4f(0x11e)]));}catch(_0x476f27){_0x476f27[_0x39ba4f(0x121)]?_0x5e066e[_0x39ba4f(0x130)](debug,_0x39ba4f(0x104)+_0x3948f4+_0x39ba4f(0x10f)+_0x476f27[_0x39ba4f(0x121)][_0x39ba4f(0x128)]+'\x20'+_0x476f27[_0x39ba4f(0x121)][_0x39ba4f(0x140)]+'\x20'+util[_0x39ba4f(0x12c)]('%j',_0x476f27[_0x39ba4f(0x121)])):_0x5e066e[_0x39ba4f(0x120)](debug,'EXCEPTION\x20IN\x20'+_0x3948f4+_0x39ba4f(0x10f)+(_0x476f27[_0x39ba4f(0xda)]||_0x476f27)),this['pendingUploads']=Math[_0x39ba4f(0xec)](0x0,_0x5e066e[_0x39ba4f(0xf0)](this[_0x39ba4f(0x105)],_0x18ca93[_0x39ba4f(0x11e)]));}};[a86_0x5935f3(0xd8)]=()=>{const _0x1f3bd8=a86_0x5935f3,_0x32518f={'IWFSq':function(_0x344fa4,_0x3ce6e4){return _0x344fa4>_0x3ce6e4;},'LtXqI':function(_0x1b3365,_0x3cfac7){return _0x1b3365(_0x3cfac7);},'WrKvY':_0x1f3bd8(0x102),'zGtEc':function(_0x41a355,_0x2d8b6a,_0x10e31b){return _0x41a355(_0x2d8b6a,_0x10e31b);}};this[_0x1f3bd8(0xe2)]=_0x32518f[_0x1f3bd8(0xfe)](setInterval,async()=>{const _0x23605f=_0x1f3bd8;if(_0x32518f[_0x23605f(0xdb)](this['queue'][_0x23605f(0x11e)],0x0)){_0x32518f[_0x23605f(0x10e)](trace,_0x23605f(0x129)+this[_0x23605f(0x135)][_0x23605f(0x11e)]);const _0x5aa34d=this[_0x23605f(0x135)][_0x23605f(0x13c)](0x0,BATCH_SIZE);this[_0x23605f(0x135)][_0x23605f(0x13a)](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x23605f(0x110)],_0x32518f[_0x23605f(0xe4)],_0x5aa34d),_0x32518f[_0x23605f(0x10e)](trace,_0x23605f(0x12b)+this[_0x23605f(0x135)][_0x23605f(0x11e)]);}},BATCH_INTERVAL);};[a86_0x5935f3(0xfc)]=()=>{const _0x5ac1d3=a86_0x5935f3,_0xc531b9={};_0xc531b9[_0x5ac1d3(0xde)]='RESETTING';const _0x4b3b3d=_0xc531b9;this[_0x5ac1d3(0x125)](_0x4b3b3d[_0x5ac1d3(0xde)]),this['startEventBatchPolling']();};[a86_0x5935f3(0x125)]=_0x168d9c=>{const _0x387cfb=a86_0x5935f3,_0x6cfada={'gQXir':function(_0x50a7a1,_0x388553){return _0x50a7a1(_0x388553);},'aNnxZ':function(_0x425707,_0x2e737a){return _0x425707===_0x2e737a;},'zvDvm':'REMOVING'};this['pollEventBatchInterval']&&(_0x6cfada['gQXir'](clearInterval,this[_0x387cfb(0xe2)]),this[_0x387cfb(0xe2)]=null,_0x6cfada['aNnxZ'](_0x168d9c,_0x6cfada[_0x387cfb(0x134)])&&(this['started']=![]));};['shouldProceed']=()=>{const _0x1b1c96=a86_0x5935f3,_0x274480={};_0x274480[_0x1b1c96(0xe8)]=function(_0x5e34c4,_0x3322e8){return _0x5e34c4>=_0x3322e8;};const _0x1b8774=_0x274480;return _0x1b8774['dTLes'](this[_0x1b1c96(0x135)][_0x1b1c96(0x11e)],BATCH_SIZE);};async[a86_0x5935f3(0x13f)](_0x450fda=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x241105=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x453a41=a86_0x5935f3,_0x2d03bd={'cKJYM':function(_0x1733ac,_0x333241){return _0x1733ac<=_0x333241;},'gkYfG':function(_0x561aed,_0x12a2ef){return _0x561aed(_0x12a2ef);},'SNSKG':function(_0x32c64f,_0x1f5ebc){return _0x32c64f-_0x1f5ebc;}};if(_0x2d03bd[_0x453a41(0xeb)](this[_0x453a41(0x105)],0x0)||_0x2d03bd[_0x453a41(0xeb)](_0x450fda,0x0))return;return await _0x2d03bd['gkYfG'](sleep,_0x241105),this[_0x453a41(0x13f)](_0x2d03bd['SNSKG'](_0x450fda,_0x241105));}}module[a86_0x5935f3(0x113)]=RequestQueueHandler;