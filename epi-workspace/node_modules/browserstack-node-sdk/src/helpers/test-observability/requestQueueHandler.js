function a118_0x5f24(_0x33c976,_0x55f6a0){const _0x997b80=a118_0x997b();return a118_0x5f24=function(_0x5f248b,_0x4abc30){_0x5f248b=_0x5f248b-0x92;let _0x32e608=_0x997b80[_0x5f248b];return _0x32e608;},a118_0x5f24(_0x33c976,_0x55f6a0);}const a118_0x15d864=a118_0x5f24;(function(_0x187d67,_0x4d3f9a){const _0x47040e=a118_0x5f24,_0x11ec52=_0x187d67();while(!![]){try{const _0x28ecd1=parseInt(_0x47040e(0xdc))/0x1*(-parseInt(_0x47040e(0xd6))/0x2)+-parseInt(_0x47040e(0x9d))/0x3+parseInt(_0x47040e(0xfb))/0x4*(parseInt(_0x47040e(0xf4))/0x5)+parseInt(_0x47040e(0xfa))/0x6+parseInt(_0x47040e(0xfc))/0x7*(parseInt(_0x47040e(0x9c))/0x8)+parseInt(_0x47040e(0xcf))/0x9*(-parseInt(_0x47040e(0xb9))/0xa)+parseInt(_0x47040e(0x101))/0xb;if(_0x28ecd1===_0x4d3f9a)break;else _0x11ec52['push'](_0x11ec52['shift']());}catch(_0x48a42b){_0x11ec52['push'](_0x11ec52['shift']());}}}(a118_0x997b,0x2ef74));function a118_0x997b(){const _0x3fcb6a=['Remaining\x20Queue\x20Length\x20-\x20','qplkn','SqgZR','kfaRp','resetEventBatchPolling','XsWtI','Processing\x20batch\x20events\x20for\x20','Agcdv','DwBxW','startEventBatchPolling','message','TestRunFinished','started','shouldProceed','BSldc','screenshotEventUrl','381545velhnw','TEST_REPORTING_ANALYTICS','HookRunStarted','push','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','queue','110010PURSCF','4NXjwHW','283682DyoNdl','zNJMY','statusText','ontzC','event_type','4596636DlOTFa','uploadPending','QckGP','TestRunSkipped','Avcaj','batchAndPostEvents','hook_run','ruNEP','getInstance','QHgbQ','proceedWithData','16zNutIt','1034892SrmXDW','AcdHV','\x20REQUEST\x20TO\x20','logs','NNtcr','1|3|0|5|2|4|6','BBxnJ','QYsmJ','includes','POST','ZflgR','format','removeEventBatchPolling','api/v1/screenshots','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','TestRunStarted','kind','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','Interval-Queue','EXCEPTION\x20IN\x20','OsPjM','split','LogCreated','instance','REMOVING','.\x20Request\x20Size\x20-\x20','ixqqk','DvaMS','170BuwBQU','uploadAttachmentUrl','AOtKK','response','./utils','max','proceedWithUrl','MnMNZ','data','splice','utf8','length','thJHV','exports','\x20--\x20','RTDJU','MmLLh','start','./constants','pollEventBatchInterval','byteLength','\x20:\x20','21393LYbpAz','xpRsU','Processing\x20events.\x20Queue\x20Length\x20-\x20','test_run','VvBTS','HLOdA','lMnwq','1862ygVLaI','dSkVA','util','pendingUploads','GCTje','TEST_ATTACHMENT','17xTobGz','uuid','jfgLK','\x20bytes.\x20Events\x20are\x20','eventUrl','tHwVu','slice','error'];a118_0x997b=function(){return _0x3fcb6a;};return a118_0x997b();}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a118_0x15d864(0xcb)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a118_0x15d864(0xbd)),{nestedKeyValue}=require('../helper'),util=require(a118_0x15d864(0xd8)),constants=require('../../bin/utils/constants');class RequestQueueHandler{static ['instance'];[a118_0x15d864(0xd9)]=0x0;constructor(){const _0x199d73=a118_0x15d864,_0x5563d1={};_0x5563d1[_0x199d73(0xeb)]=_0x199d73(0xa2),_0x5563d1['OsPjM']='api/v1/batch',_0x5563d1['BBxnJ']='upload-attachments',_0x5563d1[_0x199d73(0x9e)]=_0x199d73(0xb3),_0x5563d1['IPosl']='CBTSessionCreated',_0x5563d1[_0x199d73(0xb7)]=_0x199d73(0xef),_0x5563d1[_0x199d73(0xa4)]=_0x199d73(0x94),_0x5563d1['HcCwj']='HookRunFinished',_0x5563d1[_0x199d73(0xd3)]=_0x199d73(0xac),_0x5563d1[_0x199d73(0xe9)]=_0x199d73(0xf6),_0x5563d1['BSldc']=_0x199d73(0xaa);const _0x319ea6=_0x5563d1,_0x292188=_0x319ea6[_0x199d73(0xeb)][_0x199d73(0xb2)]('|');let _0x5a327e=0x0;while(!![]){switch(_0x292188[_0x5a327e++]){case'0':this[_0x199d73(0xe0)]=_0x319ea6[_0x199d73(0xb1)];continue;case'1':this[_0x199d73(0xf9)]=[];continue;case'2':this[_0x199d73(0xba)]=_0x319ea6[_0x199d73(0xa3)];continue;case'3':this[_0x199d73(0xf0)]=![];continue;case'4':this['BATCH_EVENT_TYPES']=[_0x319ea6[_0x199d73(0x9e)],_0x319ea6['IPosl'],_0x319ea6[_0x199d73(0xb7)],_0x319ea6[_0x199d73(0xa4)],_0x319ea6['HcCwj'],_0x319ea6[_0x199d73(0xd3)],_0x319ea6['XsWtI']];continue;case'5':this['screenshotEventUrl']=_0x319ea6[_0x199d73(0xf2)];continue;case'6':this[_0x199d73(0xcc)]=null;continue;}break;}}static[a118_0x15d864(0x99)](){const _0x53e6ce=a118_0x15d864;return!RequestQueueHandler[_0x53e6ce(0xb4)]&&(RequestQueueHandler[_0x53e6ce(0xb4)]=new RequestQueueHandler()),RequestQueueHandler[_0x53e6ce(0xb4)];}[a118_0x15d864(0xca)]=()=>{const _0x539225=a118_0x15d864;!this['started']&&(this[_0x539225(0xf0)]=!![],this[_0x539225(0xed)]());};['add']=_0x523d2f=>{const _0x21147c=a118_0x15d864,_0x2e1794={'DvaMS':function(_0x16a8ad,_0x169082){return _0x16a8ad===_0x169082;},'sFiFU':'TEST_SCREENSHOT','AOtKK':function(_0x46f0b9,_0x15260b){return _0x46f0b9>_0x15260b;},'ubUCQ':_0x21147c(0xdb),'lMnwq':function(_0x27e9c4,_0x1f15eb){return _0x27e9c4!==_0x1f15eb;},'kfaRp':_0x21147c(0xef),'dSkVA':function(_0x518ba7,_0x1f97a4){return _0x518ba7(_0x1f97a4);},'yGzWk':_0x21147c(0xae)};if(this['BATCH_EVENT_TYPES'][_0x21147c(0xa5)](_0x523d2f['event_type'])){if(_0x523d2f[_0x21147c(0xa0)]&&_0x523d2f[_0x21147c(0xa0)][0x0]&&_0x2e1794[_0x21147c(0xb8)](_0x523d2f[_0x21147c(0xa0)][0x0]['kind'],_0x2e1794['sFiFU'])){const _0x482861={};return _0x482861['shouldProceed']=!![],_0x482861[_0x21147c(0x9b)]=[_0x523d2f],_0x482861[_0x21147c(0xbf)]=this[_0x21147c(0xf3)],_0x482861;}if(_0x523d2f[_0x21147c(0xa0)]&&_0x2e1794[_0x21147c(0xbb)](_0x523d2f['logs'][_0x21147c(0xc4)],0x0)&&_0x2e1794[_0x21147c(0xb8)](_0x523d2f[_0x21147c(0xa0)][0x0][_0x21147c(0xad)],_0x2e1794['ubUCQ'])&&_0x2e1794[_0x21147c(0xd5)](_0x523d2f['event_type'],_0x2e1794[_0x21147c(0xe7)])){const _0x5c6705={};return _0x5c6705[_0x21147c(0xf1)]=!![],_0x5c6705[_0x21147c(0x9b)]=[_0x523d2f],_0x5c6705['proceedWithUrl']=this['uploadAttachmentUrl'],_0x5c6705;}this[_0x21147c(0xf9)][_0x21147c(0xf7)](_0x523d2f);let _0x1294b3=null;const _0x17cc2f=this[_0x21147c(0xf1)]();_0x17cc2f&&(_0x2e1794[_0x21147c(0xd7)](trace,_0x2e1794['yGzWk']),_0x1294b3=this['queue'][_0x21147c(0xe2)](0x0,BATCH_SIZE),this['queue'][_0x21147c(0xc2)](0x0,BATCH_SIZE),this[_0x21147c(0xe8)]());const _0x3a6deb={};return _0x3a6deb['shouldProceed']=_0x17cc2f,_0x3a6deb[_0x21147c(0x9b)]=_0x1294b3,_0x3a6deb[_0x21147c(0xbf)]=this[_0x21147c(0xe0)],_0x3a6deb;}const _0x38045a={};return _0x38045a[_0x21147c(0xf1)]=!![],_0x38045a;};['shutdown']=async()=>{const _0x55a1ca=a118_0x15d864,_0x212c6d={'MmLLh':_0x55a1ca(0xb5),'jfgLK':function(_0x102b8e,_0x294e0f){return _0x102b8e>_0x294e0f;},'MnMNZ':'Shutdown-Queue','huLnS':function(_0x3650da,_0x1a2fd2){return _0x3650da>_0x1a2fd2;},'VnXUD':function(_0x418816,_0x2f7704){return _0x418816(_0x2f7704);}};await this[_0x55a1ca(0x92)](),this['removeEventBatchPolling'](_0x212c6d[_0x55a1ca(0xc9)]);while(_0x212c6d[_0x55a1ca(0xde)](this[_0x55a1ca(0xf9)][_0x55a1ca(0xc4)],0x0)){const _0x182905=this[_0x55a1ca(0xf9)][_0x55a1ca(0xe2)](0x0,BATCH_SIZE);this[_0x55a1ca(0xf9)][_0x55a1ca(0xc2)](0x0,BATCH_SIZE),await this[_0x55a1ca(0x96)](this[_0x55a1ca(0xe0)],_0x212c6d[_0x55a1ca(0xc0)],_0x182905);}_0x212c6d['huLnS'](this[_0x55a1ca(0xd9)],0x0)&&_0x212c6d['VnXUD'](debug,_0x55a1ca(0xab)+this['pendingUploads']);};[a118_0x15d864(0x96)]=async(_0x3f1a73,_0x4a2af9,_0x4c2d61)=>{const _0x5b42d1=a118_0x15d864,_0x4c9b2e={'SqgZR':function(_0x31a923,_0x752ed4){return _0x31a923(_0x752ed4);},'QHgbQ':_0x5b42d1(0xc3),'GCTje':function(_0x1b25d2){return _0x1b25d2();},'ontzC':function(_0x1271a9,_0x5b9ac6,_0x8b0fa6,_0xaf3060,_0x2e8854){return _0x1271a9(_0x5b9ac6,_0x8b0fa6,_0xaf3060,_0x2e8854);},'UPHSn':_0x5b42d1(0xa6),'HLOdA':function(_0x38e541,_0x2d6eee){return _0x38e541-_0x2d6eee;},'NNtcr':function(_0x77285d,_0x1873a9){return _0x77285d(_0x1873a9);},'QckGP':function(_0x377ab7,_0x1f3c29){return _0x377ab7-_0x1f3c29;}};let _0x9c48c='';try{_0x9c48c=_0x4c2d61['map'](_0x1c3731=>'\x27'+_0x1c3731[_0x5b42d1(0x100)]+'\x27:'+(nestedKeyValue(_0x1c3731,[_0x5b42d1(0xd2),_0x5b42d1(0xdd)])||nestedKeyValue(_0x1c3731,[_0x5b42d1(0x97),_0x5b42d1(0xdd)])))['join'](','),_0x4c9b2e[_0x5b42d1(0xe6)](debug,_0x5b42d1(0xea)+_0x4a2af9+_0x5b42d1(0xb6)+Buffer[_0x5b42d1(0xcd)](util[_0x5b42d1(0xa8)]('%j',_0x4c2d61),_0x4c9b2e[_0x5b42d1(0x9a)])+_0x5b42d1(0xdf)+_0x9c48c);}catch(_0x450ca9){_0x4c9b2e[_0x5b42d1(0xe6)](debug,_0x5b42d1(0xf8)+util[_0x5b42d1(0xa8)](_0x450ca9)+'}');}const _0x11b2d9={'headers':_0x4c9b2e[_0x5b42d1(0xda)](getDefaultHeaders)};try{const _0x3fdd12=await _0x4c9b2e[_0x5b42d1(0xff)](nodeRequest,_0x4c9b2e['UPHSn'],_0x3f1a73,_0x4c2d61,_0x11b2d9);if(_0x3fdd12['data'][_0x5b42d1(0xe3)]){const _0x399d9c={};_0x399d9c[_0x5b42d1(0xee)]=_0x3fdd12['data'][_0x5b42d1(0xe3)];throw _0x399d9c;}else _0x4c9b2e[_0x5b42d1(0xe6)](debug,_0x4a2af9+'\x20event\x20successful\x20for\x20events\x20'+_0x9c48c+_0x5b42d1(0xc7)+util[_0x5b42d1(0xa8)]('%j',_0x3fdd12[_0x5b42d1(0xc1)])),this[_0x5b42d1(0xd9)]=Math[_0x5b42d1(0xbe)](0x0,_0x4c9b2e[_0x5b42d1(0xd4)](this[_0x5b42d1(0xd9)],_0x4c2d61['length']));}catch(_0x503c4e){_0x503c4e[_0x5b42d1(0xbc)]?_0x4c9b2e[_0x5b42d1(0xa1)](debug,_0x5b42d1(0xb0)+_0x4a2af9+_0x5b42d1(0x9f)+constants[_0x5b42d1(0xf5)]+_0x5b42d1(0xce)+_0x503c4e[_0x5b42d1(0xbc)]['status']+'\x20'+_0x503c4e['response'][_0x5b42d1(0xfe)]+'\x20'+util[_0x5b42d1(0xa8)]('%j',_0x503c4e[_0x5b42d1(0xbc)])):_0x4c9b2e['NNtcr'](debug,_0x5b42d1(0xb0)+_0x4a2af9+_0x5b42d1(0x9f)+constants[_0x5b42d1(0xf5)]+_0x5b42d1(0xce)+(_0x503c4e['message']||_0x503c4e)),this['pendingUploads']=Math[_0x5b42d1(0xbe)](0x0,_0x4c9b2e[_0x5b42d1(0x93)](this['pendingUploads'],_0x4c2d61[_0x5b42d1(0xc4)]));}};[a118_0x15d864(0xed)]=()=>{const _0x5dee70=a118_0x15d864,_0x55214b={'zNJMY':function(_0xd3b625,_0x2cc9f7){return _0xd3b625>_0x2cc9f7;},'DwBxW':function(_0x50bdf2,_0x5f4e3f){return _0x50bdf2(_0x5f4e3f);},'XanMy':_0x5dee70(0xaf),'thJHV':function(_0x38e9fe,_0x4e5892,_0x3ada87){return _0x38e9fe(_0x4e5892,_0x3ada87);}};this[_0x5dee70(0xcc)]=_0x55214b[_0x5dee70(0xc5)](setInterval,async()=>{const _0x2152e=_0x5dee70;if(_0x55214b[_0x2152e(0xfd)](this['queue']['length'],0x0)){_0x55214b[_0x2152e(0xec)](trace,_0x2152e(0xd1)+this['queue'][_0x2152e(0xc4)]);const _0x4f8b05=this['queue']['slice'](0x0,BATCH_SIZE);this[_0x2152e(0xf9)]['splice'](0x0,BATCH_SIZE),await this[_0x2152e(0x96)](this[_0x2152e(0xe0)],_0x55214b['XanMy'],_0x4f8b05),_0x55214b[_0x2152e(0xec)](trace,_0x2152e(0xe4)+this[_0x2152e(0xf9)][_0x2152e(0xc4)]);}},BATCH_INTERVAL);};[a118_0x15d864(0xe8)]=()=>{const _0x36467d=a118_0x15d864,_0x39cb7e={};_0x39cb7e[_0x36467d(0xe5)]='RESETTING';const _0x310d0c=_0x39cb7e;this[_0x36467d(0xa9)](_0x310d0c[_0x36467d(0xe5)]),this[_0x36467d(0xed)]();};[a118_0x15d864(0xa9)]=_0x1be380=>{const _0x4fa7ce=a118_0x15d864,_0x24815a={'RTDJU':function(_0x505008,_0xf5231){return _0x505008(_0xf5231);},'tHwVu':function(_0x11b2bd,_0x14e359){return _0x11b2bd===_0x14e359;},'OxlXZ':_0x4fa7ce(0xb5)};this[_0x4fa7ce(0xcc)]&&(_0x24815a[_0x4fa7ce(0xc8)](clearInterval,this[_0x4fa7ce(0xcc)]),this[_0x4fa7ce(0xcc)]=null,_0x24815a[_0x4fa7ce(0xe1)](_0x1be380,_0x24815a['OxlXZ'])&&(this[_0x4fa7ce(0xf0)]=![]));};[a118_0x15d864(0xf1)]=()=>{const _0x322553=a118_0x15d864,_0x2ed85e={};_0x2ed85e[_0x322553(0xd0)]=function(_0x17eb4e,_0x5bdb5f){return _0x17eb4e>=_0x5bdb5f;};const _0x469c2e=_0x2ed85e;return _0x469c2e['xpRsU'](this[_0x322553(0xf9)][_0x322553(0xc4)],BATCH_SIZE);};async[a118_0x15d864(0x92)](_0x50b4d3=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x7b8e27=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x1f5890=a118_0x15d864,_0x1476fc={'Avcaj':function(_0x28c46b,_0xbc45a){return _0x28c46b<=_0xbc45a;},'ruNEP':function(_0x405e0f,_0x41330a){return _0x405e0f<=_0x41330a;},'ZflgR':function(_0x498bf6,_0x7cab4d){return _0x498bf6(_0x7cab4d);},'pfFHw':function(_0x3a82d7,_0x1002f1){return _0x3a82d7-_0x1002f1;}};if(_0x1476fc[_0x1f5890(0x95)](this[_0x1f5890(0xd9)],0x0)||_0x1476fc[_0x1f5890(0x98)](_0x50b4d3,0x0))return;return await _0x1476fc[_0x1f5890(0xa7)](sleep,_0x7b8e27),this[_0x1f5890(0x92)](_0x1476fc['pfFHw'](_0x50b4d3,_0x7b8e27));}}module[a118_0x15d864(0xc6)]=RequestQueueHandler;