const a86_0x3aad77=a86_0x24b5;(function(_0x4a138c,_0x4e1e45){const _0x1b9df1=a86_0x24b5,_0x30732b=_0x4a138c();while(!![]){try{const _0x5d0624=-parseInt(_0x1b9df1(0x7e))/0x1*(parseInt(_0x1b9df1(0xa3))/0x2)+parseInt(_0x1b9df1(0xba))/0x3*(-parseInt(_0x1b9df1(0xd1))/0x4)+-parseInt(_0x1b9df1(0x72))/0x5+-parseInt(_0x1b9df1(0x8b))/0x6*(-parseInt(_0x1b9df1(0xab))/0x7)+-parseInt(_0x1b9df1(0x79))/0x8+-parseInt(_0x1b9df1(0x95))/0x9+parseInt(_0x1b9df1(0xd6))/0xa*(parseInt(_0x1b9df1(0x9c))/0xb);if(_0x5d0624===_0x4e1e45)break;else _0x30732b['push'](_0x30732b['shift']());}catch(_0x5544d1){_0x30732b['push'](_0x30732b['shift']());}}}(a86_0x4226,0xb4cfe));function a86_0x24b5(_0x2bbd36,_0xc5d2a0){const _0x4226c0=a86_0x4226();return a86_0x24b5=function(_0x24b586,_0x36940b){_0x24b586=_0x24b586-0x67;let _0x23812e=_0x4226c0[_0x24b586];return _0x23812e;},a86_0x24b5(_0x2bbd36,_0xc5d2a0);}function a86_0x4226(){const _0xb7361a=['resetEventBatchPolling','util','mxaMR','vFYcy','eVhGW','api/v1/screenshots','eiKrc','kpiZt','byteLength','2936118uzBUde','uuid','usIQc','vHrTN','slice','\x20bytes.\x20Events\x20are\x20','api/v1/batch','TEhgp','event_type','kind','10204173aCBLcz','exports','format','Prxld','statusText','tQlUm','uHSln','2507241FMhkjH','1|3|5|4|2|6|0','Apcdw','startEventBatchPolling','TestRunSkipped','NmGbp','includes','22QMHWTx','AwHne','xtVHx','upload-attachments','message','rEuWi','wqytM','proceedWithData','21NKSpYw','join','logs','nmqQV','\x20--\x20','SoEWJ','GqhNl','LogCreated','pCXWK','TestRunFinished','cQxag','add','push','eWrxB','.\x20Request\x20Size\x20-\x20','6kZsmtY','test_run','getInstance','shouldProceed','instance','max','VZAng','screenshotEventUrl','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','TestRunStarted','EXqXa','queue','xMHiX','pendingUploads','CBTSessionCreated','BATCH_EVENT_TYPES','gBIfh','utf8','EXCEPTION\x20IN\x20','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','elxZF','response','start','11428FUGABM','splice','HookRunFinished','sCABX','FoAso','70CqAcET','Remaining\x20Queue\x20Length\x20-\x20','split','removeEventBatchPolling','error','mzEwY','oPALh','started','eventUrl','../helper','XNCxw','batchAndPostEvents','FjmeK','Interval-Queue','./constants','hook_run','uploadPending','Shutdown-Queue','1876500gXnIfh','data','AtcVs','Ipcwb','fgBdz','proceedWithUrl','status','4936976oAxblf','xunoo','BlPQR','length','uploadAttachmentUrl','17367vMBeYi','\x20event\x20successful\x20for\x20events\x20','pollEventBatchInterval','map'];a86_0x4226=function(){return _0xb7361a;};return a86_0x4226();}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a86_0x3aad77(0x6e)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require(a86_0x3aad77(0x69)),util=require(a86_0x3aad77(0x83));class RequestQueueHandler{static [a86_0x3aad77(0xbe)];[a86_0x3aad77(0xc7)]=0x0;constructor(){const _0x1636fc=a86_0x3aad77,_0x48b4f7={};_0x48b4f7[_0x1636fc(0x85)]=_0x1636fc(0x9d),_0x48b4f7['Ipcwb']=_0x1636fc(0xa6),_0x48b4f7[_0x1636fc(0x74)]=_0x1636fc(0x87),_0x48b4f7[_0x1636fc(0xa8)]=_0x1636fc(0x91),_0x48b4f7[_0x1636fc(0x84)]=_0x1636fc(0xb2),_0x48b4f7[_0x1636fc(0x86)]=_0x1636fc(0xc8),_0x48b4f7[_0x1636fc(0x89)]=_0x1636fc(0xb4),_0x48b4f7['sOPJq']=_0x1636fc(0xa0),_0x48b4f7[_0x1636fc(0xc6)]=_0x1636fc(0xd3),_0x48b4f7[_0x1636fc(0x7b)]=_0x1636fc(0xc3),_0x48b4f7[_0x1636fc(0xca)]='HookRunStarted';const _0x572f73=_0x48b4f7,_0x459255=_0x572f73[_0x1636fc(0x85)][_0x1636fc(0xd8)]('|');let _0x18b851=0x0;while(!![]){switch(_0x459255[_0x18b851++]){case'0':this['pollEventBatchInterval']=null;continue;case'1':this[_0x1636fc(0xc5)]=[];continue;case'2':this[_0x1636fc(0x7d)]=_0x572f73[_0x1636fc(0x75)];continue;case'3':this[_0x1636fc(0x67)]=![];continue;case'4':this['screenshotEventUrl']=_0x572f73[_0x1636fc(0x74)];continue;case'5':this['eventUrl']=_0x572f73[_0x1636fc(0xa8)];continue;case'6':this[_0x1636fc(0xc9)]=[_0x572f73[_0x1636fc(0x84)],_0x572f73[_0x1636fc(0x86)],_0x572f73[_0x1636fc(0x89)],_0x572f73['sOPJq'],_0x572f73['xMHiX'],_0x572f73['BlPQR'],_0x572f73[_0x1636fc(0xca)]];continue;}break;}}static[a86_0x3aad77(0xbc)](){const _0x1d2a3f=a86_0x3aad77;return!RequestQueueHandler[_0x1d2a3f(0xbe)]&&(RequestQueueHandler['instance']=new RequestQueueHandler()),RequestQueueHandler[_0x1d2a3f(0xbe)];}[a86_0x3aad77(0xd0)]=()=>{const _0x950f28=a86_0x3aad77;!this['started']&&(this[_0x950f28(0x67)]=!![],this[_0x950f28(0x9f)]());};[a86_0x3aad77(0xb6)]=_0x5ccb65=>{const _0x41aa0e=a86_0x3aad77,_0x15e1a9={'tQlUm':function(_0x4085c4,_0x4b8bd5){return _0x4085c4===_0x4b8bd5;},'Prxld':'TEST_SCREENSHOT','usIQc':function(_0x4e6a35,_0x33ea0b){return _0x4e6a35>_0x33ea0b;},'pCXWK':function(_0x2fb6d8,_0x2b26bc){return _0x2fb6d8===_0x2b26bc;},'RyeKU':'TEST_ATTACHMENT','mCEdg':function(_0x51ceaf,_0x47ce8a){return _0x51ceaf!==_0x47ce8a;},'GqhNl':_0x41aa0e(0xb4),'xtVHx':function(_0x360128,_0x31221b){return _0x360128(_0x31221b);},'cQxag':'Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..'};if(this[_0x41aa0e(0xc9)][_0x41aa0e(0xa2)](_0x5ccb65[_0x41aa0e(0x93)])){if(_0x5ccb65[_0x41aa0e(0xad)]&&_0x5ccb65[_0x41aa0e(0xad)][0x0]&&_0x15e1a9[_0x41aa0e(0x9a)](_0x5ccb65[_0x41aa0e(0xad)][0x0][_0x41aa0e(0x94)],_0x15e1a9[_0x41aa0e(0x98)])){const _0x3f4412={};return _0x3f4412[_0x41aa0e(0xbd)]=!![],_0x3f4412[_0x41aa0e(0xaa)]=[_0x5ccb65],_0x3f4412[_0x41aa0e(0x77)]=this[_0x41aa0e(0xc1)],_0x3f4412;}if(_0x5ccb65[_0x41aa0e(0xad)]&&_0x15e1a9[_0x41aa0e(0x8d)](_0x5ccb65['logs'][_0x41aa0e(0x7c)],0x0)&&_0x15e1a9[_0x41aa0e(0xb3)](_0x5ccb65['logs'][0x0][_0x41aa0e(0x94)],_0x15e1a9['RyeKU'])&&_0x15e1a9['mCEdg'](_0x5ccb65['event_type'],_0x15e1a9[_0x41aa0e(0xb1)])){const _0x4ee48d={};return _0x4ee48d[_0x41aa0e(0xbd)]=!![],_0x4ee48d[_0x41aa0e(0xaa)]=[_0x5ccb65],_0x4ee48d[_0x41aa0e(0x77)]=this['uploadAttachmentUrl'],_0x4ee48d;}this[_0x41aa0e(0xc5)][_0x41aa0e(0xb7)](_0x5ccb65);let _0x41dbae=null;const _0x575e63=this[_0x41aa0e(0xbd)]();_0x575e63&&(_0x15e1a9[_0x41aa0e(0xa5)](trace,_0x15e1a9[_0x41aa0e(0xb5)]),_0x41dbae=this['queue'][_0x41aa0e(0x8f)](0x0,BATCH_SIZE),this[_0x41aa0e(0xc5)][_0x41aa0e(0xd2)](0x0,BATCH_SIZE),this[_0x41aa0e(0x82)]());const _0x70592d={};return _0x70592d[_0x41aa0e(0xbd)]=_0x575e63,_0x70592d['proceedWithData']=_0x41dbae,_0x70592d[_0x41aa0e(0x77)]=this[_0x41aa0e(0x68)],_0x70592d;}const _0x2852c6={};return _0x2852c6['shouldProceed']=!![],_0x2852c6;};['shutdown']=async()=>{const _0x4c33d0=a86_0x3aad77,_0x25419d={'FjmeK':'REMOVING','elxZF':function(_0x3edb44,_0x12de0a){return _0x3edb44>_0x12de0a;},'EXqXa':_0x4c33d0(0x71),'TEhgp':function(_0x2faf96,_0x3b0c3a){return _0x2faf96(_0x3b0c3a);}};await this[_0x4c33d0(0x70)](),this[_0x4c33d0(0xd9)](_0x25419d[_0x4c33d0(0x6c)]);while(_0x25419d['elxZF'](this[_0x4c33d0(0xc5)]['length'],0x0)){const _0x98c054=this[_0x4c33d0(0xc5)][_0x4c33d0(0x8f)](0x0,BATCH_SIZE);this[_0x4c33d0(0xc5)]['splice'](0x0,BATCH_SIZE),await this[_0x4c33d0(0x6b)](this[_0x4c33d0(0x68)],_0x25419d[_0x4c33d0(0xc4)],_0x98c054);}_0x25419d[_0x4c33d0(0xce)](this[_0x4c33d0(0xc7)],0x0)&&_0x25419d[_0x4c33d0(0x92)](debug,_0x4c33d0(0xc2)+this[_0x4c33d0(0xc7)]);};[a86_0x3aad77(0x6b)]=async(_0x4bd0d8,_0xe11b87,_0x2ae6f7)=>{const _0x340d4d=a86_0x3aad77,_0x25579e={'mzEwY':function(_0x1c316c,_0x3c8f4a){return _0x1c316c(_0x3c8f4a);},'wqytM':_0x340d4d(0xcb),'vHrTN':function(_0x3a7065){return _0x3a7065();},'DwJwX':function(_0x12f06c,_0x255a9c,_0x409ff3,_0x32dd2a,_0x68c5a4){return _0x12f06c(_0x255a9c,_0x409ff3,_0x32dd2a,_0x68c5a4);},'WuMoV':'POST','AwHne':function(_0x510403,_0x3d9d12){return _0x510403-_0x3d9d12;},'oPALh':function(_0x38da41,_0x549df3){return _0x38da41(_0x549df3);},'VZAng':function(_0x1a5a76,_0x88747){return _0x1a5a76(_0x88747);}};let _0x315204='';try{_0x315204=_0x2ae6f7[_0x340d4d(0x81)](_0x2057ad=>'\x27'+_0x2057ad[_0x340d4d(0x93)]+'\x27:'+(nestedKeyValue(_0x2057ad,[_0x340d4d(0xbb),_0x340d4d(0x8c)])||nestedKeyValue(_0x2057ad,[_0x340d4d(0x6f),'uuid'])))[_0x340d4d(0xac)](','),_0x25579e[_0x340d4d(0xdb)](debug,'Processing\x20batch\x20events\x20for\x20'+_0xe11b87+_0x340d4d(0xb9)+Buffer[_0x340d4d(0x8a)](util[_0x340d4d(0x97)]('%j',_0x2ae6f7),_0x25579e[_0x340d4d(0xa9)])+_0x340d4d(0x90)+_0x315204);}catch(_0x4d7cb6){_0x25579e['mzEwY'](debug,_0x340d4d(0xcd)+util['format'](_0x4d7cb6)+'}');}const _0x3fe248={'headers':_0x25579e[_0x340d4d(0x8e)](getDefaultHeaders)};try{const _0xb4eb8a=await _0x25579e['DwJwX'](nodeRequest,_0x25579e['WuMoV'],_0x4bd0d8,_0x2ae6f7,_0x3fe248);if(_0xb4eb8a[_0x340d4d(0x73)][_0x340d4d(0xda)]){const _0x43e82c={};_0x43e82c['message']=_0xb4eb8a[_0x340d4d(0x73)][_0x340d4d(0xda)];throw _0x43e82c;}else _0x25579e['mzEwY'](debug,_0xe11b87+_0x340d4d(0x7f)+_0x315204+_0x340d4d(0xaf)+util[_0x340d4d(0x97)]('%j',_0xb4eb8a[_0x340d4d(0x73)])),this[_0x340d4d(0xc7)]=Math[_0x340d4d(0xbf)](0x0,_0x25579e['AwHne'](this['pendingUploads'],_0x2ae6f7[_0x340d4d(0x7c)]));}catch(_0x15ba93){_0x15ba93['response']?_0x25579e[_0x340d4d(0xdc)](debug,_0x340d4d(0xcc)+_0xe11b87+'\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20'+_0x15ba93['response'][_0x340d4d(0x78)]+'\x20'+_0x15ba93['response'][_0x340d4d(0x99)]+'\x20'+util[_0x340d4d(0x97)]('%j',_0x15ba93[_0x340d4d(0xcf)])):_0x25579e[_0x340d4d(0xc0)](debug,_0x340d4d(0xcc)+_0xe11b87+'\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20'+(_0x15ba93[_0x340d4d(0xa7)]||_0x15ba93)),this['pendingUploads']=Math[_0x340d4d(0xbf)](0x0,_0x25579e[_0x340d4d(0xa4)](this[_0x340d4d(0xc7)],_0x2ae6f7['length']));}};['startEventBatchPolling']=()=>{const _0x1cc1b1=a86_0x3aad77,_0x4f0732={'Apcdw':function(_0x50f39c,_0x2b245d){return _0x50f39c>_0x2b245d;},'nmqQV':function(_0x433fee,_0x165e19){return _0x433fee(_0x165e19);},'FoAso':_0x1cc1b1(0x6d),'PCgPn':function(_0x1914f9,_0x2d819f){return _0x1914f9(_0x2d819f);},'PLDMy':function(_0x374c36,_0xe8d53b,_0x45902c){return _0x374c36(_0xe8d53b,_0x45902c);}};this[_0x1cc1b1(0x80)]=_0x4f0732['PLDMy'](setInterval,async()=>{const _0x2047a8=_0x1cc1b1;if(_0x4f0732[_0x2047a8(0x9e)](this[_0x2047a8(0xc5)]['length'],0x0)){_0x4f0732[_0x2047a8(0xae)](trace,'Processing\x20events.\x20Queue\x20Length\x20-\x20'+this['queue'][_0x2047a8(0x7c)]);const _0x7d162b=this[_0x2047a8(0xc5)][_0x2047a8(0x8f)](0x0,BATCH_SIZE);this[_0x2047a8(0xc5)][_0x2047a8(0xd2)](0x0,BATCH_SIZE),await this[_0x2047a8(0x6b)](this['eventUrl'],_0x4f0732[_0x2047a8(0xd5)],_0x7d162b),_0x4f0732['PCgPn'](trace,_0x2047a8(0xd7)+this[_0x2047a8(0xc5)]['length']);}},BATCH_INTERVAL);};[a86_0x3aad77(0x82)]=()=>{const _0xeb2ae5=a86_0x3aad77,_0x216ad9={};_0x216ad9['xunoo']='RESETTING';const _0x32ac54=_0x216ad9;this[_0xeb2ae5(0xd9)](_0x32ac54[_0xeb2ae5(0x7a)]),this[_0xeb2ae5(0x9f)]();};[a86_0x3aad77(0xd9)]=_0x529fe2=>{const _0x31e60f=a86_0x3aad77,_0x1a02f1={'NmGbp':function(_0x2a5f19,_0x3b1a25){return _0x2a5f19(_0x3b1a25);},'eWrxB':function(_0x17abb7,_0x1143c5){return _0x17abb7===_0x1143c5;},'sCABX':'REMOVING'};this[_0x31e60f(0x80)]&&(_0x1a02f1[_0x31e60f(0xa1)](clearInterval,this['pollEventBatchInterval']),this['pollEventBatchInterval']=null,_0x1a02f1[_0x31e60f(0xb8)](_0x529fe2,_0x1a02f1[_0x31e60f(0xd4)])&&(this[_0x31e60f(0x67)]=![]));};['shouldProceed']=()=>{const _0x27e1a5=a86_0x3aad77,_0x30fc7f={};_0x30fc7f['uHSln']=function(_0x80fc4c,_0x4654af){return _0x80fc4c>=_0x4654af;};const _0x1c8cb6=_0x30fc7f;return _0x1c8cb6[_0x27e1a5(0x9b)](this[_0x27e1a5(0xc5)][_0x27e1a5(0x7c)],BATCH_SIZE);};async[a86_0x3aad77(0x70)](_0x2ca0ae=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x2f8ffa=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x20b0fd=a86_0x3aad77,_0x3e4e22={'SoEWJ':function(_0x323389,_0x5b49c9){return _0x323389<=_0x5b49c9;},'eiKrc':function(_0x82cabe,_0x2a4ec6){return _0x82cabe<=_0x2a4ec6;},'XNCxw':function(_0x6e94c8,_0x2c8b9a){return _0x6e94c8(_0x2c8b9a);},'fgBdz':function(_0x4ecbf5,_0x10b7c9){return _0x4ecbf5-_0x10b7c9;}};if(_0x3e4e22[_0x20b0fd(0xb0)](this[_0x20b0fd(0xc7)],0x0)||_0x3e4e22[_0x20b0fd(0x88)](_0x2ca0ae,0x0))return;return await _0x3e4e22[_0x20b0fd(0x6a)](sleep,_0x2f8ffa),this['uploadPending'](_0x3e4e22[_0x20b0fd(0x76)](_0x2ca0ae,_0x2f8ffa));}}module[a86_0x3aad77(0x96)]=RequestQueueHandler;