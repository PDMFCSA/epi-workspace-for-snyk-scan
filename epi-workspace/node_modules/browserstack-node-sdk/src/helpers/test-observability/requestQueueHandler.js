const a115_0xea8750=a115_0x5e97;(function(_0x155362,_0x44f34b){const _0xdb840c=a115_0x5e97,_0xd7d196=_0x155362();while(!![]){try{const _0x5cd54a=-parseInt(_0xdb840c(0xb4))/0x1*(-parseInt(_0xdb840c(0xe8))/0x2)+parseInt(_0xdb840c(0xac))/0x3*(-parseInt(_0xdb840c(0x7a))/0x4)+parseInt(_0xdb840c(0xe5))/0x5+parseInt(_0xdb840c(0xa0))/0x6*(-parseInt(_0xdb840c(0x81))/0x7)+parseInt(_0xdb840c(0x85))/0x8+-parseInt(_0xdb840c(0x96))/0x9*(parseInt(_0xdb840c(0x95))/0xa)+parseInt(_0xdb840c(0xb5))/0xb;if(_0x5cd54a===_0x44f34b)break;else _0xd7d196['push'](_0xd7d196['shift']());}catch(_0x2ada6e){_0xd7d196['push'](_0xd7d196['shift']());}}}(a115_0x5938,0x56868));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a115_0xea8750(0xa8)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require(a115_0xea8750(0xc5)),util=require(a115_0xea8750(0xc4)),constants=require(a115_0xea8750(0x84));function a115_0x5e97(_0x2a4481,_0x30e671){const _0x5938f7=a115_0x5938();return a115_0x5e97=function(_0x5e97b3,_0x1c8110){_0x5e97b3=_0x5e97b3-0x77;let _0x591b0d=_0x5938f7[_0x5e97b3];return _0x591b0d;},a115_0x5e97(_0x2a4481,_0x30e671);}function a115_0x5938(){const _0x26c99b=['CBTSessionCreated','LogCreated','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','UlOPi','EEpOP','98uNcjfJ','RESETTING','KRPZh','../../bin/utils/constants','2892952ActFoM','resetEventBatchPolling','started','RlOmO','format','xbBem','NXhNr','cORtl','TEST_SCREENSHOT','hook_run','BATCH_EVENT_TYPES','TestRunStarted','TestRunFinished','kind','MWyfP','screenshotEventUrl','89520cuNWEo','486apiPFh','slice','pendingUploads','aGGjr','irdyN','jCLnv','TEST_ATTACHMENT','cvhnZ','.\x20Request\x20Size\x20-\x20','response','193926ZWfGEb','\x20bytes.\x20Events\x20are\x20','\x20event\x20successful\x20for\x20events\x20','uploadAttachmentUrl','TVQQT','getInstance','uploadPending','exports','./constants','api/v1/screenshots','Interval-Queue','start','6iNfdZs','shouldProceed','PQbrD','Shutdown-Queue','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','VefgG','Processing\x20batch\x20events\x20for\x20','\x20REQUEST\x20TO\x20','30083ZdydNG','11013871aQgmWC','QbWex','data','startEventBatchPolling','PPZlL','instance','fnvLx','eventUrl','splice','proceedWithUrl','join','bpVbI','upload-attachments','TrcXS','GfAHc','util','../helper','removeEventBatchPolling','queue','max','push','yBjHp','moXOj','xnBQs','nKIxC','POST','pTolh','ZqWDn','qDyqC','error','Remaining\x20Queue\x20Length\x20-\x20','REMOVING','BzDfi','HEOjG','status','Cqxqj','test_run','pollEventBatchInterval','URLuT','Nwtwj','DUKRy','\x20:\x20','event_type','wcuSN','ErulO','wgCSn','proceedWithData','FrsWg','882530DJNUPb','length','DFuxJ','28TipQtW','TestRunSkipped','split','logs','qqeNy','1340476hFlSsX','batchAndPostEvents'];a115_0x5938=function(){return _0x26c99b;};return a115_0x5938();}class RequestQueueHandler{static [a115_0xea8750(0xba)];[a115_0xea8750(0x98)]=0x0;constructor(){const _0x2b0fa7=a115_0xea8750,_0x27bff4={};_0x27bff4[_0x2b0fa7(0xe2)]='5|1|2|6|3|4|0',_0x27bff4[_0x2b0fa7(0xcb)]='api/v1/batch',_0x27bff4[_0x2b0fa7(0x9b)]=_0x2b0fa7(0xc1),_0x27bff4[_0x2b0fa7(0x79)]=_0x2b0fa7(0x7d),_0x27bff4[_0x2b0fa7(0xd0)]=_0x2b0fa7(0x7c),_0x27bff4[_0x2b0fa7(0xbb)]=_0x2b0fa7(0x91),_0x27bff4[_0x2b0fa7(0xae)]=_0x2b0fa7(0xe9),_0x27bff4[_0x2b0fa7(0xc3)]='HookRunFinished',_0x27bff4['oApod']=_0x2b0fa7(0x90),_0x27bff4['Cqxqj']='HookRunStarted',_0x27bff4[_0x2b0fa7(0xa4)]=_0x2b0fa7(0xa9);const _0x4c8118=_0x27bff4,_0x2479da=_0x4c8118[_0x2b0fa7(0xe2)][_0x2b0fa7(0x77)]('|');let _0x488119=0x0;while(!![]){switch(_0x2479da[_0x488119++]){case'0':this[_0x2b0fa7(0xda)]=null;continue;case'1':this['started']=![];continue;case'2':this[_0x2b0fa7(0xbc)]=_0x4c8118[_0x2b0fa7(0xcb)];continue;case'3':this[_0x2b0fa7(0xa3)]=_0x4c8118['jCLnv'];continue;case'4':this[_0x2b0fa7(0x8f)]=[_0x4c8118[_0x2b0fa7(0x79)],_0x4c8118[_0x2b0fa7(0xd0)],_0x4c8118['fnvLx'],_0x4c8118['PQbrD'],_0x4c8118[_0x2b0fa7(0xc3)],_0x4c8118['oApod'],_0x4c8118[_0x2b0fa7(0xd8)]];continue;case'5':this['queue']=[];continue;case'6':this[_0x2b0fa7(0x94)]=_0x4c8118['TVQQT'];continue;}break;}}static[a115_0xea8750(0xa5)](){const _0x18a03a=a115_0xea8750;return!RequestQueueHandler[_0x18a03a(0xba)]&&(RequestQueueHandler[_0x18a03a(0xba)]=new RequestQueueHandler()),RequestQueueHandler['instance'];}[a115_0xea8750(0xab)]=()=>{const _0x1fda60=a115_0xea8750;!this[_0x1fda60(0x87)]&&(this[_0x1fda60(0x87)]=!![],this['startEventBatchPolling']());};['add']=_0x4f0eee=>{const _0x2ea4f1=a115_0xea8750,_0x43fa79={'DFuxJ':function(_0x503903,_0x5e050f){return _0x503903===_0x5e050f;},'oizxM':_0x2ea4f1(0x8d),'ErulO':function(_0x980946,_0x26b508){return _0x980946>_0x26b508;},'xbBem':function(_0x1f44ec,_0x41ee01){return _0x1f44ec===_0x41ee01;},'cvhnZ':_0x2ea4f1(0x9c),'opnIN':function(_0x5192ca,_0x15ca74){return _0x5192ca!==_0x15ca74;},'DUKRy':_0x2ea4f1(0x91),'URLuT':function(_0x188ed2,_0x4e2d90){return _0x188ed2(_0x4e2d90);},'KRPZh':_0x2ea4f1(0xb0)};if(this[_0x2ea4f1(0x8f)]['includes'](_0x4f0eee['event_type'])){if(_0x4f0eee['logs']&&_0x4f0eee['logs'][0x0]&&_0x43fa79[_0x2ea4f1(0xe7)](_0x4f0eee[_0x2ea4f1(0x78)][0x0][_0x2ea4f1(0x92)],_0x43fa79['oizxM'])){const _0x5c3c7b={};return _0x5c3c7b['shouldProceed']=!![],_0x5c3c7b[_0x2ea4f1(0xe3)]=[_0x4f0eee],_0x5c3c7b[_0x2ea4f1(0xbe)]=this[_0x2ea4f1(0x94)],_0x5c3c7b;}if(_0x4f0eee['logs']&&_0x43fa79[_0x2ea4f1(0xe1)](_0x4f0eee[_0x2ea4f1(0x78)][_0x2ea4f1(0xe6)],0x0)&&_0x43fa79[_0x2ea4f1(0x8a)](_0x4f0eee['logs'][0x0][_0x2ea4f1(0x92)],_0x43fa79[_0x2ea4f1(0x9d)])&&_0x43fa79['opnIN'](_0x4f0eee[_0x2ea4f1(0xdf)],_0x43fa79[_0x2ea4f1(0xdd)])){const _0x3676ad={};return _0x3676ad[_0x2ea4f1(0xad)]=!![],_0x3676ad[_0x2ea4f1(0xe3)]=[_0x4f0eee],_0x3676ad[_0x2ea4f1(0xbe)]=this['uploadAttachmentUrl'],_0x3676ad;}this[_0x2ea4f1(0xc7)][_0x2ea4f1(0xc9)](_0x4f0eee);let _0x3b1098=null;const _0x5ce91e=this[_0x2ea4f1(0xad)]();_0x5ce91e&&(_0x43fa79[_0x2ea4f1(0xdb)](trace,_0x43fa79[_0x2ea4f1(0x83)]),_0x3b1098=this[_0x2ea4f1(0xc7)][_0x2ea4f1(0x97)](0x0,BATCH_SIZE),this[_0x2ea4f1(0xc7)]['splice'](0x0,BATCH_SIZE),this[_0x2ea4f1(0x86)]());const _0x53aaea={};return _0x53aaea[_0x2ea4f1(0xad)]=_0x5ce91e,_0x53aaea[_0x2ea4f1(0xe3)]=_0x3b1098,_0x53aaea[_0x2ea4f1(0xbe)]=this[_0x2ea4f1(0xbc)],_0x53aaea;}const _0x5b17e5={};return _0x5b17e5[_0x2ea4f1(0xad)]=!![],_0x5b17e5;};['shutdown']=async()=>{const _0x569200=a115_0xea8750,_0x23cb4e={'xnBQs':_0x569200(0xd4),'FrsWg':function(_0x166e90,_0x51095a){return _0x166e90>_0x51095a;},'MWyfP':_0x569200(0xaf),'eDxrt':function(_0x3bdd7d,_0x5b0305){return _0x3bdd7d(_0x5b0305);}};await this[_0x569200(0xa6)](),this[_0x569200(0xc6)](_0x23cb4e[_0x569200(0xcc)]);while(_0x23cb4e[_0x569200(0xe4)](this[_0x569200(0xc7)][_0x569200(0xe6)],0x0)){const _0x3115d0=this[_0x569200(0xc7)][_0x569200(0x97)](0x0,BATCH_SIZE);this[_0x569200(0xc7)][_0x569200(0xbd)](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x569200(0xbc)],_0x23cb4e[_0x569200(0x93)],_0x3115d0);}_0x23cb4e[_0x569200(0xe4)](this[_0x569200(0x98)],0x0)&&_0x23cb4e['eDxrt'](debug,'Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20'+this[_0x569200(0x98)]);};[a115_0xea8750(0x7b)]=async(_0x32e0a4,_0x49b912,_0x129db7)=>{const _0x346c98=a115_0xea8750,_0xc4224b={'Nwtwj':function(_0x5aec74,_0x190344){return _0x5aec74(_0x190344);},'jXiVg':'utf8','VefgG':function(_0x456dd8,_0x16a11e){return _0x456dd8(_0x16a11e);},'cORtl':function(_0x3bd16c){return _0x3bd16c();},'TrcXS':function(_0xf93360,_0x27a098,_0xa75e24,_0x1505d0,_0x56924c){return _0xf93360(_0x27a098,_0xa75e24,_0x1505d0,_0x56924c);},'wcuSN':_0x346c98(0xce),'NXhNr':function(_0x34d818,_0x5df53d){return _0x34d818-_0x5df53d;},'HEOjG':function(_0x163cfa,_0x412c0b){return _0x163cfa(_0x412c0b);}};let _0x1fccab='';try{_0x1fccab=_0x129db7['map'](_0x3879eb=>'\x27'+_0x3879eb[_0x346c98(0xdf)]+'\x27:'+(nestedKeyValue(_0x3879eb,[_0x346c98(0xd9),'uuid'])||nestedKeyValue(_0x3879eb,[_0x346c98(0x8e),'uuid'])))[_0x346c98(0xbf)](','),_0xc4224b[_0x346c98(0xdc)](debug,_0x346c98(0xb2)+_0x49b912+_0x346c98(0x9e)+Buffer['byteLength'](util[_0x346c98(0x89)]('%j',_0x129db7),_0xc4224b['jXiVg'])+_0x346c98(0xa1)+_0x1fccab);}catch(_0x443481){_0xc4224b[_0x346c98(0xb1)](debug,_0x346c98(0x7e)+util[_0x346c98(0x89)](_0x443481)+'}');}const _0x4c088d={'headers':_0xc4224b[_0x346c98(0x8c)](getDefaultHeaders)};try{const _0xaca3f7=await _0xc4224b[_0x346c98(0xc2)](nodeRequest,_0xc4224b[_0x346c98(0xe0)],_0x32e0a4,_0x129db7,_0x4c088d);if(_0xaca3f7[_0x346c98(0xb7)][_0x346c98(0xd2)]){const _0x42afa4={};_0x42afa4['message']=_0xaca3f7[_0x346c98(0xb7)][_0x346c98(0xd2)];throw _0x42afa4;}else _0xc4224b['VefgG'](debug,_0x49b912+_0x346c98(0xa2)+_0x1fccab+'\x20--\x20'+util[_0x346c98(0x89)]('%j',_0xaca3f7[_0x346c98(0xb7)])),this[_0x346c98(0x98)]=Math[_0x346c98(0xc8)](0x0,_0xc4224b[_0x346c98(0x8b)](this['pendingUploads'],_0x129db7['length']));}catch(_0x551f3d){_0x551f3d[_0x346c98(0x9f)]?_0xc4224b[_0x346c98(0xd6)](debug,'EXCEPTION\x20IN\x20'+_0x49b912+'\x20REQUEST\x20TO\x20'+constants['TEST_REPORTING_ANALYTICS']+_0x346c98(0xde)+_0x551f3d[_0x346c98(0x9f)][_0x346c98(0xd7)]+'\x20'+_0x551f3d[_0x346c98(0x9f)]['statusText']+'\x20'+util['format']('%j',_0x551f3d['response'])):_0xc4224b[_0x346c98(0xdc)](debug,'EXCEPTION\x20IN\x20'+_0x49b912+_0x346c98(0xb3)+constants['TEST_REPORTING_ANALYTICS']+'\x20:\x20'+(_0x551f3d['message']||_0x551f3d)),this['pendingUploads']=Math['max'](0x0,_0xc4224b[_0x346c98(0x8b)](this[_0x346c98(0x98)],_0x129db7['length']));}};[a115_0xea8750(0xb8)]=()=>{const _0x226df6=a115_0xea8750,_0x2cd968={'UlOPi':function(_0xb5fae4,_0x5f01df){return _0xb5fae4>_0x5f01df;},'bpVbI':function(_0x48b317,_0x100590){return _0x48b317(_0x100590);},'aGGjr':_0x226df6(0xaa),'yBjHp':function(_0x55b3dd,_0x46f5fd){return _0x55b3dd(_0x46f5fd);},'QbWex':function(_0x564030,_0x52f406,_0x344cca){return _0x564030(_0x52f406,_0x344cca);}};this['pollEventBatchInterval']=_0x2cd968[_0x226df6(0xb6)](setInterval,async()=>{const _0x3eb4da=_0x226df6;if(_0x2cd968[_0x3eb4da(0x7f)](this[_0x3eb4da(0xc7)][_0x3eb4da(0xe6)],0x0)){_0x2cd968[_0x3eb4da(0xc0)](trace,'Processing\x20events.\x20Queue\x20Length\x20-\x20'+this[_0x3eb4da(0xc7)][_0x3eb4da(0xe6)]);const _0x598de6=this['queue'][_0x3eb4da(0x97)](0x0,BATCH_SIZE);this['queue'][_0x3eb4da(0xbd)](0x0,BATCH_SIZE),await this[_0x3eb4da(0x7b)](this['eventUrl'],_0x2cd968[_0x3eb4da(0x99)],_0x598de6),_0x2cd968[_0x3eb4da(0xca)](trace,_0x3eb4da(0xd3)+this[_0x3eb4da(0xc7)][_0x3eb4da(0xe6)]);}},BATCH_INTERVAL);};['resetEventBatchPolling']=()=>{const _0x15a06b=a115_0xea8750,_0x21cce0={};_0x21cce0[_0x15a06b(0x80)]=_0x15a06b(0x82);const _0x3ea11d=_0x21cce0;this[_0x15a06b(0xc6)](_0x3ea11d[_0x15a06b(0x80)]),this[_0x15a06b(0xb8)]();};['removeEventBatchPolling']=_0x5b5298=>{const _0x4c6e5e=a115_0xea8750,_0x49a790={'nKIxC':function(_0x41ae51,_0x384899){return _0x41ae51(_0x384899);},'irdyN':function(_0x28da29,_0x405a0e){return _0x28da29===_0x405a0e;},'RlOmO':_0x4c6e5e(0xd4)};this[_0x4c6e5e(0xda)]&&(_0x49a790[_0x4c6e5e(0xcd)](clearInterval,this[_0x4c6e5e(0xda)]),this[_0x4c6e5e(0xda)]=null,_0x49a790[_0x4c6e5e(0x9a)](_0x5b5298,_0x49a790[_0x4c6e5e(0x88)])&&(this['started']=![]));};[a115_0xea8750(0xad)]=()=>{const _0x32f730=a115_0xea8750,_0x973c11={};_0x973c11[_0x32f730(0xcf)]=function(_0x65da40,_0x5aeb57){return _0x65da40>=_0x5aeb57;};const _0x10dcbf=_0x973c11;return _0x10dcbf[_0x32f730(0xcf)](this[_0x32f730(0xc7)][_0x32f730(0xe6)],BATCH_SIZE);};async['uploadPending'](_0x457219=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x392f88=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x52f557=a115_0xea8750,_0x44481d={'BzDfi':function(_0x194c55,_0x2a4d0e){return _0x194c55<=_0x2a4d0e;},'PPZlL':function(_0x368328,_0x51a3bc){return _0x368328(_0x51a3bc);},'qDyqC':function(_0x47f19a,_0x6fa096){return _0x47f19a-_0x6fa096;}};if(_0x44481d[_0x52f557(0xd5)](this['pendingUploads'],0x0)||_0x44481d[_0x52f557(0xd5)](_0x457219,0x0))return;return await _0x44481d[_0x52f557(0xb9)](sleep,_0x392f88),this['uploadPending'](_0x44481d[_0x52f557(0xd1)](_0x457219,_0x392f88));}}module[a115_0xea8750(0xa7)]=RequestQueueHandler;