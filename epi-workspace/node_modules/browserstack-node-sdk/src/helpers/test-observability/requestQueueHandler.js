const a123_0x1ac777=a123_0x184f;(function(_0x58c225,_0x9c0e3b){const _0x492a0d=a123_0x184f,_0x1f8a3c=_0x58c225();while(!![]){try{const _0x1d44e6=parseInt(_0x492a0d(0x1aa))/0x1*(parseInt(_0x492a0d(0x157))/0x2)+-parseInt(_0x492a0d(0x14e))/0x3*(-parseInt(_0x492a0d(0x17d))/0x4)+-parseInt(_0x492a0d(0x17b))/0x5*(parseInt(_0x492a0d(0x178))/0x6)+-parseInt(_0x492a0d(0x177))/0x7*(-parseInt(_0x492a0d(0x1b8))/0x8)+parseInt(_0x492a0d(0x156))/0x9+-parseInt(_0x492a0d(0x1a2))/0xa*(-parseInt(_0x492a0d(0x1ae))/0xb)+-parseInt(_0x492a0d(0x1c3))/0xc*(parseInt(_0x492a0d(0x196))/0xd);if(_0x1d44e6===_0x9c0e3b)break;else _0x1f8a3c['push'](_0x1f8a3c['shift']());}catch(_0x12b5f5){_0x1f8a3c['push'](_0x1f8a3c['shift']());}}}(a123_0x197b,0x48525));function a123_0x197b(){const _0x3cf1e1=['splice','5|0|6|1|4|2|3','proceedWithData','TestRunSkipped','kind','started','14ZSXFKf','62946WcCeJf','response','jLZAo','185BgJOMl','NmfZH','61692bPdKCI','format','Processing\x20events.\x20Queue\x20Length\x20-\x20','GHhGE','TestRunFinished','CBTSessionCreated','uploadAttachmentUrl','PLAht','proceedWithUrl','data','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','queue','pollEventBatchInterval','TEST_REPORTING_ANALYTICS','TYoXA','BATCH_EVENT_TYPES','pendingUploads','HZAPr','exports','eventUrl','SZNop','test_run','api/v1/batch','WyXXh','uploadPending','13TtHcnv','slice','split','utf8','JjlkJ','yjGWI','logs','removeEventBatchPolling','wexxx','util','UHjAP','uaqeU','1910GrQmeK','\x20REQUEST\x20TO\x20','Eybep','QBAKP','eRbTU','yTIAD','FtNhQ','HookRunFinished','25577ZUYjoU','RESETTING','llNNw','OLqRA','20636zLXjMP','gQPDr','KHWjO','neDll','TEST_ATTACHMENT','qmuwD','map','hajYY','length','shouldProceed','816728eOXBei','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','resetEventBatchPolling','../helper','instance','event_type','../../bin/utils/constants','eXeaz','RiFbd','IIXGz','rSWUN','14561604NXHzoi','vSpkw','39HxIMqB','xwMMR','LogCreated','HookRunStarted','byteLength','TestRunStarted','\x20:\x20','screenshotEventUrl','4919355QtEUnr','46WNgfCK','KSyRF','uxiWi','Shutdown-Queue','POST','max','batchAndPostEvents','MkmtA','TEST_SCREENSHOT','\x20event\x20successful\x20for\x20events\x20','statusText','EXCEPTION\x20IN\x20','message','pqcNq','tFxuZ','ocWiw','wtbaG','Interval-Queue','add','\x20--\x20','HfpDE','Remaining\x20Queue\x20Length\x20-\x20','REMOVING','startEventBatchPolling','QZVwr','./utils'];a123_0x197b=function(){return _0x3cf1e1;};return a123_0x197b();}function a123_0x184f(_0x13dfbc,_0x10fea1){const _0x197bf1=a123_0x197b();return a123_0x184f=function(_0x184f44,_0x3b644e){_0x184f44=_0x184f44-0x14e;let _0x1a6f89=_0x197bf1[_0x184f44];return _0x1a6f89;},a123_0x184f(_0x13dfbc,_0x10fea1);}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require('./constants'),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a123_0x1ac777(0x170)),{nestedKeyValue}=require(a123_0x1ac777(0x1bb)),util=require(a123_0x1ac777(0x19f)),constants=require(a123_0x1ac777(0x1be));class RequestQueueHandler{static [a123_0x1ac777(0x1bc)];[a123_0x1ac777(0x18d)]=0x0;constructor(){const _0xa672df=a123_0x1ac777,_0x1b7e39={};_0x1b7e39[_0xa672df(0x1b3)]=_0xa672df(0x172),_0x1b7e39[_0xa672df(0x1a8)]='api/v1/screenshots',_0x1b7e39['PFlBn']=_0xa672df(0x150),_0x1b7e39[_0xa672df(0x159)]=_0xa672df(0x182),_0x1b7e39['ocWiw']=_0xa672df(0x181),_0x1b7e39[_0xa672df(0x1b0)]=_0xa672df(0x174),_0x1b7e39['wtbaG']=_0xa672df(0x1a9),_0x1b7e39[_0xa672df(0x1a4)]=_0xa672df(0x153),_0x1b7e39['RiFbd']=_0xa672df(0x151),_0x1b7e39[_0xa672df(0x191)]='upload-attachments',_0x1b7e39[_0xa672df(0x1c1)]=_0xa672df(0x193);const _0x8b8e1b=_0x1b7e39,_0x471d90=_0x8b8e1b[_0xa672df(0x1b3)][_0xa672df(0x198)]('|');let _0x5afb6e=0x0;while(!![]){switch(_0x471d90[_0x5afb6e++]){case'0':this[_0xa672df(0x176)]=![];continue;case'1':this[_0xa672df(0x155)]=_0x8b8e1b[_0xa672df(0x1a8)];continue;case'2':this[_0xa672df(0x18c)]=[_0x8b8e1b['PFlBn'],_0x8b8e1b[_0xa672df(0x159)],_0x8b8e1b[_0xa672df(0x166)],_0x8b8e1b[_0xa672df(0x1b0)],_0x8b8e1b[_0xa672df(0x167)],_0x8b8e1b[_0xa672df(0x1a4)],_0x8b8e1b[_0xa672df(0x1c0)]];continue;case'3':this[_0xa672df(0x189)]=null;continue;case'4':this['uploadAttachmentUrl']=_0x8b8e1b[_0xa672df(0x191)];continue;case'5':this['queue']=[];continue;case'6':this[_0xa672df(0x190)]=_0x8b8e1b[_0xa672df(0x1c1)];continue;}break;}}static['getInstance'](){const _0x165741=a123_0x1ac777;return!RequestQueueHandler[_0x165741(0x1bc)]&&(RequestQueueHandler['instance']=new RequestQueueHandler()),RequestQueueHandler[_0x165741(0x1bc)];}['start']=()=>{const _0x1761ae=a123_0x1ac777;!this[_0x1761ae(0x176)]&&(this[_0x1761ae(0x176)]=!![],this[_0x1761ae(0x16e)]());};[a123_0x1ac777(0x169)]=_0x491478=>{const _0x53d65e=a123_0x1ac777,_0x47d3f2={'GHhGE':function(_0x3977f1,_0x20a1db){return _0x3977f1===_0x20a1db;},'QBAKP':_0x53d65e(0x15f),'NmfZH':function(_0x399b51,_0x3b42dc){return _0x399b51>_0x3b42dc;},'pqcNq':_0x53d65e(0x1b2),'OLqRA':function(_0x3f0210,_0x54c762){return _0x3f0210!==_0x54c762;},'neDll':_0x53d65e(0x181),'eRbTU':function(_0x1bd67e,_0x313f72){return _0x1bd67e(_0x313f72);},'CbHKe':_0x53d65e(0x1b9)};if(this[_0x53d65e(0x18c)]['includes'](_0x491478[_0x53d65e(0x1bd)])){if(_0x491478[_0x53d65e(0x19c)]&&_0x491478['logs'][0x0]&&_0x47d3f2['GHhGE'](_0x491478['logs'][0x0][_0x53d65e(0x175)],_0x47d3f2[_0x53d65e(0x1a5)])){const _0x348f31={};return _0x348f31['shouldProceed']=!![],_0x348f31['proceedWithData']=[_0x491478],_0x348f31[_0x53d65e(0x185)]=this[_0x53d65e(0x155)],_0x348f31;}if(_0x491478[_0x53d65e(0x19c)]&&_0x47d3f2[_0x53d65e(0x17c)](_0x491478[_0x53d65e(0x19c)][_0x53d65e(0x1b6)],0x0)&&_0x47d3f2[_0x53d65e(0x180)](_0x491478[_0x53d65e(0x19c)][0x0][_0x53d65e(0x175)],_0x47d3f2[_0x53d65e(0x164)])&&_0x47d3f2[_0x53d65e(0x1ad)](_0x491478[_0x53d65e(0x1bd)],_0x47d3f2[_0x53d65e(0x1b1)])){const _0x38b158={};return _0x38b158[_0x53d65e(0x1b7)]=!![],_0x38b158[_0x53d65e(0x173)]=[_0x491478],_0x38b158[_0x53d65e(0x185)]=this[_0x53d65e(0x183)],_0x38b158;}this[_0x53d65e(0x188)]['push'](_0x491478);let _0x3afdc2=null;const _0x16335e=this[_0x53d65e(0x1b7)]();_0x16335e&&(_0x47d3f2[_0x53d65e(0x1a6)](trace,_0x47d3f2['CbHKe']),_0x3afdc2=this[_0x53d65e(0x188)][_0x53d65e(0x197)](0x0,BATCH_SIZE),this[_0x53d65e(0x188)][_0x53d65e(0x171)](0x0,BATCH_SIZE),this[_0x53d65e(0x1ba)]());const _0xdb438d={};return _0xdb438d['shouldProceed']=_0x16335e,_0xdb438d['proceedWithData']=_0x3afdc2,_0xdb438d['proceedWithUrl']=this[_0x53d65e(0x190)],_0xdb438d;}const _0x208244={};return _0x208244[_0x53d65e(0x1b7)]=!![],_0x208244;};['shutdown']=async()=>{const _0x5573d4=a123_0x1ac777,_0x1de91f={'QZVwr':'REMOVING','WyXXh':function(_0x1b930a,_0x480353){return _0x1b930a>_0x480353;},'GPmPQ':_0x5573d4(0x15a),'vSpkw':function(_0x26dc17,_0xd341ed){return _0x26dc17>_0xd341ed;},'xwMMR':function(_0x3259eb,_0x79ee7c){return _0x3259eb(_0x79ee7c);}};await this[_0x5573d4(0x195)](),this['removeEventBatchPolling'](_0x1de91f[_0x5573d4(0x16f)]);while(_0x1de91f[_0x5573d4(0x194)](this[_0x5573d4(0x188)]['length'],0x0)){const _0x26fa4d=this['queue']['slice'](0x0,BATCH_SIZE);this[_0x5573d4(0x188)][_0x5573d4(0x171)](0x0,BATCH_SIZE),await this[_0x5573d4(0x15d)](this[_0x5573d4(0x190)],_0x1de91f['GPmPQ'],_0x26fa4d);}_0x1de91f[_0x5573d4(0x1c4)](this[_0x5573d4(0x18d)],0x0)&&_0x1de91f[_0x5573d4(0x14f)](debug,_0x5573d4(0x187)+this[_0x5573d4(0x18d)]);};['batchAndPostEvents']=async(_0x299b49,_0x1ef8e2,_0x2b55a3)=>{const _0x56f604=a123_0x1ac777,_0x15454f={'HZAPr':function(_0x3525c2,_0x2fcd1d){return _0x3525c2(_0x2fcd1d);},'yjGWI':_0x56f604(0x199),'eXeaz':function(_0x4f722d){return _0x4f722d();},'tFxuZ':function(_0x291a37,_0x45818c,_0x30c57e,_0x3c96e7,_0x20886a){return _0x291a37(_0x45818c,_0x30c57e,_0x3c96e7,_0x20886a);},'HfpDE':_0x56f604(0x15b),'rSWUN':function(_0x1393a3,_0xb352e4){return _0x1393a3(_0xb352e4);},'PLAht':function(_0x583d5b,_0x4a2c3f){return _0x583d5b-_0x4a2c3f;},'llNNw':function(_0x152acb,_0xfa6548){return _0x152acb(_0xfa6548);}};let _0x25d443='';try{_0x25d443=_0x2b55a3[_0x56f604(0x1b4)](_0x457e95=>'\x27'+_0x457e95['event_type']+'\x27:'+(nestedKeyValue(_0x457e95,[_0x56f604(0x192),'uuid'])||nestedKeyValue(_0x457e95,['hook_run','uuid'])))['join'](','),_0x15454f[_0x56f604(0x18e)](debug,'Processing\x20batch\x20events\x20for\x20'+_0x1ef8e2+'.\x20Request\x20Size\x20-\x20'+Buffer[_0x56f604(0x152)](util['format']('%j',_0x2b55a3),_0x15454f[_0x56f604(0x19b)])+'\x20bytes.\x20Events\x20are\x20'+_0x25d443);}catch(_0x25e3dd){_0x15454f['HZAPr'](debug,'Exception\x20in\x20logging\x20batch\x20events\x20--\x20'+util[_0x56f604(0x17e)](_0x25e3dd)+'}');}const _0x2c66ce={'headers':_0x15454f[_0x56f604(0x1bf)](getDefaultHeaders)};try{const _0x406867=await _0x15454f[_0x56f604(0x165)](nodeRequest,_0x15454f[_0x56f604(0x16b)],_0x299b49,_0x2b55a3,_0x2c66ce);if(_0x406867[_0x56f604(0x186)]['error']){const _0x17cb4e={};_0x17cb4e[_0x56f604(0x163)]=_0x406867[_0x56f604(0x186)]['error'];throw _0x17cb4e;}else _0x15454f[_0x56f604(0x1c2)](debug,_0x1ef8e2+_0x56f604(0x160)+_0x25d443+_0x56f604(0x16a)+util[_0x56f604(0x17e)]('%j',_0x406867[_0x56f604(0x186)])),this['pendingUploads']=Math['max'](0x0,_0x15454f[_0x56f604(0x184)](this['pendingUploads'],_0x2b55a3[_0x56f604(0x1b6)]));}catch(_0xfbd435){_0xfbd435[_0x56f604(0x179)]?_0x15454f['rSWUN'](debug,'EXCEPTION\x20IN\x20'+_0x1ef8e2+_0x56f604(0x1a3)+constants[_0x56f604(0x18a)]+'\x20:\x20'+_0xfbd435[_0x56f604(0x179)]['status']+'\x20'+_0xfbd435[_0x56f604(0x179)][_0x56f604(0x161)]+'\x20'+util[_0x56f604(0x17e)]('%j',_0xfbd435[_0x56f604(0x179)])):_0x15454f[_0x56f604(0x1ac)](debug,_0x56f604(0x162)+_0x1ef8e2+_0x56f604(0x1a3)+constants[_0x56f604(0x18a)]+_0x56f604(0x154)+(_0xfbd435[_0x56f604(0x163)]||_0xfbd435)),this['pendingUploads']=Math[_0x56f604(0x15c)](0x0,_0x15454f[_0x56f604(0x184)](this[_0x56f604(0x18d)],_0x2b55a3[_0x56f604(0x1b6)]));}};[a123_0x1ac777(0x16e)]=()=>{const _0x386fb1=a123_0x1ac777,_0x145b19={'yTIAD':function(_0x2b1dab,_0x2596b6){return _0x2b1dab>_0x2596b6;},'FmFzI':function(_0x471a52,_0x2c0609){return _0x471a52(_0x2c0609);},'KSyRF':_0x386fb1(0x168),'dDiPj':function(_0x577ae8,_0x3e6e4d){return _0x577ae8(_0x3e6e4d);},'JjlkJ':function(_0x2a10cb,_0x6d05fd,_0x29ee02){return _0x2a10cb(_0x6d05fd,_0x29ee02);}};this[_0x386fb1(0x189)]=_0x145b19[_0x386fb1(0x19a)](setInterval,async()=>{const _0x3d6328=_0x386fb1;if(_0x145b19[_0x3d6328(0x1a7)](this[_0x3d6328(0x188)][_0x3d6328(0x1b6)],0x0)){_0x145b19['FmFzI'](trace,_0x3d6328(0x17f)+this[_0x3d6328(0x188)][_0x3d6328(0x1b6)]);const _0x4a6c85=this['queue'][_0x3d6328(0x197)](0x0,BATCH_SIZE);this[_0x3d6328(0x188)][_0x3d6328(0x171)](0x0,BATCH_SIZE),await this[_0x3d6328(0x15d)](this[_0x3d6328(0x190)],_0x145b19[_0x3d6328(0x158)],_0x4a6c85),_0x145b19['dDiPj'](trace,_0x3d6328(0x16c)+this[_0x3d6328(0x188)][_0x3d6328(0x1b6)]);}},BATCH_INTERVAL);};[a123_0x1ac777(0x1ba)]=()=>{const _0x28cdec=a123_0x1ac777,_0x3828c6={};_0x3828c6[_0x28cdec(0x1a0)]=_0x28cdec(0x1ab);const _0x43eb27=_0x3828c6;this[_0x28cdec(0x19d)](_0x43eb27[_0x28cdec(0x1a0)]),this[_0x28cdec(0x16e)]();};[a123_0x1ac777(0x19d)]=_0xb2a5e6=>{const _0x2935d0=a123_0x1ac777,_0x1bbaf0={'hajYY':function(_0x4dff68,_0x1953b2){return _0x4dff68(_0x1953b2);},'jLZAo':function(_0x211bc4,_0x5091ca){return _0x211bc4===_0x5091ca;},'MkmtA':_0x2935d0(0x16d)};this[_0x2935d0(0x189)]&&(_0x1bbaf0[_0x2935d0(0x1b5)](clearInterval,this[_0x2935d0(0x189)]),this[_0x2935d0(0x189)]=null,_0x1bbaf0[_0x2935d0(0x17a)](_0xb2a5e6,_0x1bbaf0[_0x2935d0(0x15e)])&&(this[_0x2935d0(0x176)]=![]));};[a123_0x1ac777(0x1b7)]=()=>{const _0x4d18fa=a123_0x1ac777,_0x2f33b3={};_0x2f33b3[_0x4d18fa(0x18b)]=function(_0xe5bfdd,_0x3d96ba){return _0xe5bfdd>=_0x3d96ba;};const _0x468178=_0x2f33b3;return _0x468178['TYoXA'](this[_0x4d18fa(0x188)][_0x4d18fa(0x1b6)],BATCH_SIZE);};async['uploadPending'](_0x416575=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x8f3932=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x12d122=a123_0x1ac777,_0x2f814f={'wexxx':function(_0x52f8a4,_0x4c5c07){return _0x52f8a4<=_0x4c5c07;},'uaqeU':function(_0x1898c8,_0x3df229){return _0x1898c8(_0x3df229);},'gQPDr':function(_0x188e62,_0x3ebbb2){return _0x188e62-_0x3ebbb2;}};if(_0x2f814f[_0x12d122(0x19e)](this['pendingUploads'],0x0)||_0x2f814f[_0x12d122(0x19e)](_0x416575,0x0))return;return await _0x2f814f[_0x12d122(0x1a1)](sleep,_0x8f3932),this[_0x12d122(0x195)](_0x2f814f[_0x12d122(0x1af)](_0x416575,_0x8f3932));}}module[a123_0x1ac777(0x18f)]=RequestQueueHandler;