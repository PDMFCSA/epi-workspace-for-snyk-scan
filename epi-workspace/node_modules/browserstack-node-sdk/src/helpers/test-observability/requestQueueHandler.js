function a128_0x1ad3(){const _0x4eef10=['OldfO','proceedWithUrl','\x20bytes.\x20Events\x20are\x20','vQWWh','error','10DMJLpm','REMOVING','DWdYe','start','Processing\x20batch\x20events\x20for\x20','status','Processing\x20events.\x20Queue\x20Length\x20-\x20','join','queue','\x20--\x20','./constants','response','map','hook_run','api/v1/screenshots','uploadAttachmentUrl','HookRunFinished','CjsWz','\x20:\x20','amnIr','GkFQl','kind','3|1|6|0|2|5|4','IwilJ','getInstance','Qcxpj','33684hHvGHQ','.\x20Request\x20Size\x20-\x20','RESETTING','600NrUgGQ','ClwVB','aqpQx','KYrYO','event_type','add','QgIxT','hvfJk','format','dOAaq','shouldProceed','zdoaB','batchAndPostEvents','utf8','HNOqB','ljdgc','message','TestRunStarted','TestRunFinished','561538DyMyTM','BzAdP','yqRSn','shutdown','VVKWf','3371826cVwdDp','\x20REQUEST\x20TO\x20','gIFix','CJIti','22115826OXOJau','split','nUEmE','kHuqS','POST','data','EXCEPTION\x20IN\x20','uuid','TEST_REPORTING_ANALYTICS','LogCreated','72858rFibha','eventUrl','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','statusText','uploadPending','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','resetEventBatchPolling','splice','pollEventBatchInterval','BSvem','instance','xwlJJ','pendingUploads','CBTSessionCreated','Remaining\x20Queue\x20Length\x20-\x20','removeEventBatchPolling','HXgkH','logs','started','JQDvj','\x20event\x20successful\x20for\x20events\x20','nGqDm','slice','969778uzhPeS','JvkGl','BATCH_EVENT_TYPES','TestRunSkipped','startEventBatchPolling','jzJIO','byteLength','BQwBp','upload-attachments','4409004BHbfjo','length','sOLxY','iGmAv','proceedWithData','tBowj','../../bin/utils/constants','MUGnC','Qehtb','HookRunStarted','TEST_ATTACHMENT','max','screenshotEventUrl','util'];a128_0x1ad3=function(){return _0x4eef10;};return a128_0x1ad3();}const a128_0x495895=a128_0x23d0;(function(_0x3c5157,_0x42076b){const _0x4bbc6e=a128_0x23d0,_0x3746dd=_0x3c5157();while(!![]){try{const _0x31241c=parseInt(_0x4bbc6e(0x1e1))/0x1+parseInt(_0x4bbc6e(0x22d))/0x2+parseInt(_0x4bbc6e(0x232))/0x3+parseInt(_0x4bbc6e(0x1ea))/0x4+-parseInt(_0x4bbc6e(0x1fd))/0x5*(parseInt(_0x4bbc6e(0x240))/0x6)+-parseInt(_0x4bbc6e(0x217))/0x7*(parseInt(_0x4bbc6e(0x21a))/0x8)+-parseInt(_0x4bbc6e(0x236))/0x9;if(_0x31241c===_0x42076b)break;else _0x3746dd['push'](_0x3746dd['shift']());}catch(_0x213ad5){_0x3746dd['push'](_0x3746dd['shift']());}}}(a128_0x1ad3,0x9ad80));function a128_0x23d0(_0x3cbb0e,_0xc25bee){const _0x1ad37c=a128_0x1ad3();return a128_0x23d0=function(_0x23d04f,_0x44e92a){_0x23d04f=_0x23d04f-0x1e1;let _0x4e0b62=_0x1ad37c[_0x23d04f];return _0x4e0b62;},a128_0x23d0(_0x3cbb0e,_0xc25bee);}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a128_0x495895(0x207)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require('../helper'),util=require(a128_0x495895(0x1f7)),constants=require(a128_0x495895(0x1f0));class RequestQueueHandler{static [a128_0x495895(0x24a)];['pendingUploads']=0x0;constructor(){const _0xcd167d=a128_0x495895,_0x17ac89={};_0x17ac89[_0xcd167d(0x21b)]=_0xcd167d(0x213),_0x17ac89[_0xcd167d(0x211)]=_0xcd167d(0x20b),_0x17ac89['iGmAv']=_0xcd167d(0x1e9),_0x17ac89[_0xcd167d(0x223)]=_0xcd167d(0x23f),_0x17ac89[_0xcd167d(0x221)]=_0xcd167d(0x24d),_0x17ac89[_0xcd167d(0x229)]='TestRunFinished',_0x17ac89[_0xcd167d(0x253)]=_0xcd167d(0x1e4),_0x17ac89[_0xcd167d(0x1ff)]=_0xcd167d(0x20d),_0x17ac89[_0xcd167d(0x21d)]=_0xcd167d(0x22b),_0x17ac89[_0xcd167d(0x1e2)]=_0xcd167d(0x1f3),_0x17ac89[_0xcd167d(0x216)]='api/v1/batch';const _0x3a8914=_0x17ac89,_0x3d3958=_0x3a8914[_0xcd167d(0x21b)][_0xcd167d(0x237)]('|');let _0x2aa8c2=0x0;while(!![]){switch(_0x3d3958[_0x2aa8c2++]){case'0':this[_0xcd167d(0x1f6)]=_0x3a8914[_0xcd167d(0x211)];continue;case'1':this[_0xcd167d(0x252)]=![];continue;case'2':this[_0xcd167d(0x20c)]=_0x3a8914[_0xcd167d(0x1ed)];continue;case'3':this[_0xcd167d(0x205)]=[];continue;case'4':this[_0xcd167d(0x248)]=null;continue;case'5':this[_0xcd167d(0x1e3)]=[_0x3a8914['dOAaq'],_0x3a8914[_0xcd167d(0x221)],_0x3a8914[_0xcd167d(0x229)],_0x3a8914['JQDvj'],_0x3a8914[_0xcd167d(0x1ff)],_0x3a8914['KYrYO'],_0x3a8914[_0xcd167d(0x1e2)]];continue;case'6':this['eventUrl']=_0x3a8914[_0xcd167d(0x216)];continue;}break;}}static[a128_0x495895(0x215)](){const _0x1b5ecd=a128_0x495895;return!RequestQueueHandler[_0x1b5ecd(0x24a)]&&(RequestQueueHandler[_0x1b5ecd(0x24a)]=new RequestQueueHandler()),RequestQueueHandler['instance'];}[a128_0x495895(0x200)]=()=>{const _0x50b6eb=a128_0x495895;!this[_0x50b6eb(0x252)]&&(this[_0x50b6eb(0x252)]=!![],this[_0x50b6eb(0x1e5)]());};[a128_0x495895(0x21f)]=_0x4be5ec=>{const _0x56a98c=a128_0x495895,_0x2e465e={'CjsWz':function(_0x30e878,_0x3176d3){return _0x30e878===_0x3176d3;},'BSvem':'TEST_SCREENSHOT','IwilJ':function(_0x59f56f,_0x529175){return _0x59f56f>_0x529175;},'HXgkH':function(_0xa443b3,_0x4f8123){return _0xa443b3===_0x4f8123;},'jzJIO':_0x56a98c(0x1f4),'NfFuv':function(_0x270bc1,_0x4412e8){return _0x270bc1!==_0x4412e8;},'aqpQx':_0x56a98c(0x22c),'xwlJJ':function(_0x8de21a,_0x476b3b){return _0x8de21a(_0x476b3b);},'yqRSn':_0x56a98c(0x245)};if(this['BATCH_EVENT_TYPES']['includes'](_0x4be5ec[_0x56a98c(0x21e)])){if(_0x4be5ec[_0x56a98c(0x251)]&&_0x4be5ec['logs'][0x0]&&_0x2e465e[_0x56a98c(0x20e)](_0x4be5ec['logs'][0x0][_0x56a98c(0x212)],_0x2e465e[_0x56a98c(0x249)])){const _0x59cbc1={};return _0x59cbc1[_0x56a98c(0x224)]=!![],_0x59cbc1[_0x56a98c(0x1ee)]=[_0x4be5ec],_0x59cbc1[_0x56a98c(0x1f9)]=this['screenshotEventUrl'],_0x59cbc1;}if(_0x4be5ec[_0x56a98c(0x251)]&&_0x2e465e[_0x56a98c(0x214)](_0x4be5ec[_0x56a98c(0x251)][_0x56a98c(0x1eb)],0x0)&&_0x2e465e[_0x56a98c(0x250)](_0x4be5ec[_0x56a98c(0x251)][0x0]['kind'],_0x2e465e[_0x56a98c(0x1e6)])&&_0x2e465e['NfFuv'](_0x4be5ec[_0x56a98c(0x21e)],_0x2e465e[_0x56a98c(0x21c)])){const _0x37f322={};return _0x37f322[_0x56a98c(0x224)]=!![],_0x37f322[_0x56a98c(0x1ee)]=[_0x4be5ec],_0x37f322[_0x56a98c(0x1f9)]=this[_0x56a98c(0x20c)],_0x37f322;}this[_0x56a98c(0x205)]['push'](_0x4be5ec);let _0x27ad48=null;const _0x45436d=this['shouldProceed']();_0x45436d&&(_0x2e465e[_0x56a98c(0x24b)](trace,_0x2e465e[_0x56a98c(0x22f)]),_0x27ad48=this[_0x56a98c(0x205)][_0x56a98c(0x256)](0x0,BATCH_SIZE),this[_0x56a98c(0x205)][_0x56a98c(0x247)](0x0,BATCH_SIZE),this[_0x56a98c(0x246)]());const _0x4c0a16={};return _0x4c0a16[_0x56a98c(0x224)]=_0x45436d,_0x4c0a16['proceedWithData']=_0x27ad48,_0x4c0a16[_0x56a98c(0x1f9)]=this[_0x56a98c(0x241)],_0x4c0a16;}const _0x336091={};return _0x336091[_0x56a98c(0x224)]=!![],_0x336091;};[a128_0x495895(0x230)]=async()=>{const _0x18245f=a128_0x495895,_0x2ae24f={'MUGnC':_0x18245f(0x1fe),'VVKWf':function(_0x55f35b,_0x141887){return _0x55f35b>_0x141887;},'fUPxD':'Shutdown-Queue','sIJat':function(_0x51f7db,_0x1db0d7){return _0x51f7db(_0x1db0d7);}};await this[_0x18245f(0x244)](),this[_0x18245f(0x24f)](_0x2ae24f[_0x18245f(0x1f1)]);while(_0x2ae24f[_0x18245f(0x231)](this[_0x18245f(0x205)]['length'],0x0)){const _0x1647c0=this['queue']['slice'](0x0,BATCH_SIZE);this[_0x18245f(0x205)][_0x18245f(0x247)](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x18245f(0x241)],_0x2ae24f['fUPxD'],_0x1647c0);}_0x2ae24f['VVKWf'](this['pendingUploads'],0x0)&&_0x2ae24f['sIJat'](debug,_0x18245f(0x242)+this[_0x18245f(0x24c)]);};[a128_0x495895(0x226)]=async(_0x3e3342,_0x1fe6ad,_0xa7193d)=>{const _0x47159c=a128_0x495895,_0x35d9b7={'zdoaB':function(_0x329a79,_0x21ad54){return _0x329a79(_0x21ad54);},'CJIti':_0x47159c(0x227),'uuMUy':function(_0x48166c,_0x102d40){return _0x48166c(_0x102d40);},'vQWWh':function(_0x384f76){return _0x384f76();},'BzAdP':function(_0x8a856,_0x5d7ebe,_0x2a11aa,_0x460a40,_0x56842d){return _0x8a856(_0x5d7ebe,_0x2a11aa,_0x460a40,_0x56842d);},'eCCND':_0x47159c(0x23a),'BQwBp':function(_0x1dc76e,_0x48d708){return _0x1dc76e-_0x48d708;},'kHuqS':function(_0x3e0dd2,_0x538529){return _0x3e0dd2(_0x538529);},'sOLxY':function(_0x28c883,_0x1a24df){return _0x28c883(_0x1a24df);}};let _0x389361='';try{_0x389361=_0xa7193d[_0x47159c(0x209)](_0x3ae7fd=>'\x27'+_0x3ae7fd[_0x47159c(0x21e)]+'\x27:'+(nestedKeyValue(_0x3ae7fd,['test_run',_0x47159c(0x23d)])||nestedKeyValue(_0x3ae7fd,[_0x47159c(0x20a),'uuid'])))[_0x47159c(0x204)](','),_0x35d9b7[_0x47159c(0x225)](debug,_0x47159c(0x201)+_0x1fe6ad+_0x47159c(0x218)+Buffer[_0x47159c(0x1e7)](util[_0x47159c(0x222)]('%j',_0xa7193d),_0x35d9b7[_0x47159c(0x235)])+_0x47159c(0x1fa)+_0x389361);}catch(_0x1057f8){_0x35d9b7['uuMUy'](debug,'Exception\x20in\x20logging\x20batch\x20events\x20--\x20'+util['format'](_0x1057f8)+'}');}const _0x46ea0b={'headers':_0x35d9b7[_0x47159c(0x1fb)](getDefaultHeaders)};try{const _0x4c1b73=await _0x35d9b7[_0x47159c(0x22e)](nodeRequest,_0x35d9b7['eCCND'],_0x3e3342,_0xa7193d,_0x46ea0b);if(_0x4c1b73['data'][_0x47159c(0x1fc)]){const _0x14a7b8={};_0x14a7b8['message']=_0x4c1b73[_0x47159c(0x23b)]['error'];throw _0x14a7b8;}else _0x35d9b7['zdoaB'](debug,_0x1fe6ad+_0x47159c(0x254)+_0x389361+_0x47159c(0x206)+util[_0x47159c(0x222)]('%j',_0x4c1b73[_0x47159c(0x23b)])),this[_0x47159c(0x24c)]=Math[_0x47159c(0x1f5)](0x0,_0x35d9b7[_0x47159c(0x1e8)](this[_0x47159c(0x24c)],_0xa7193d[_0x47159c(0x1eb)]));}catch(_0x12c627){_0x12c627[_0x47159c(0x208)]?_0x35d9b7[_0x47159c(0x239)](debug,_0x47159c(0x23c)+_0x1fe6ad+'\x20REQUEST\x20TO\x20'+constants[_0x47159c(0x23e)]+'\x20:\x20'+_0x12c627[_0x47159c(0x208)][_0x47159c(0x202)]+'\x20'+_0x12c627['response'][_0x47159c(0x243)]+'\x20'+util[_0x47159c(0x222)]('%j',_0x12c627[_0x47159c(0x208)])):_0x35d9b7[_0x47159c(0x1ec)](debug,_0x47159c(0x23c)+_0x1fe6ad+_0x47159c(0x233)+constants[_0x47159c(0x23e)]+_0x47159c(0x20f)+(_0x12c627[_0x47159c(0x22a)]||_0x12c627)),this[_0x47159c(0x24c)]=Math['max'](0x0,_0x35d9b7[_0x47159c(0x1e8)](this[_0x47159c(0x24c)],_0xa7193d[_0x47159c(0x1eb)]));}};[a128_0x495895(0x1e5)]=()=>{const _0x5abb67={'gIFix':function(_0x327428,_0x47b493){return _0x327428>_0x47b493;},'tBowj':function(_0x366cb5,_0x3a4346){return _0x366cb5(_0x3a4346);},'QgIxT':'Interval-Queue','tDnPQ':function(_0x45ed4e,_0x464b78,_0x5c71a2){return _0x45ed4e(_0x464b78,_0x5c71a2);}};this['pollEventBatchInterval']=_0x5abb67['tDnPQ'](setInterval,async()=>{const _0x495c8e=a128_0x23d0;if(_0x5abb67[_0x495c8e(0x234)](this[_0x495c8e(0x205)][_0x495c8e(0x1eb)],0x0)){_0x5abb67[_0x495c8e(0x1ef)](trace,_0x495c8e(0x203)+this[_0x495c8e(0x205)]['length']);const _0x4a094e=this[_0x495c8e(0x205)][_0x495c8e(0x256)](0x0,BATCH_SIZE);this[_0x495c8e(0x205)]['splice'](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x495c8e(0x241)],_0x5abb67[_0x495c8e(0x220)],_0x4a094e),_0x5abb67['tBowj'](trace,_0x495c8e(0x24e)+this['queue'][_0x495c8e(0x1eb)]);}},BATCH_INTERVAL);};[a128_0x495895(0x246)]=()=>{const _0x2a3a49=a128_0x495895,_0x34f069={};_0x34f069['NRfUR']=_0x2a3a49(0x219);const _0xa16fbf=_0x34f069;this['removeEventBatchPolling'](_0xa16fbf['NRfUR']),this[_0x2a3a49(0x1e5)]();};[a128_0x495895(0x24f)]=_0x4ee26b=>{const _0x24f4ca=a128_0x495895,_0x2c9ed5={'OldfO':function(_0x304e83,_0x220223){return _0x304e83(_0x220223);},'pkIXy':function(_0x3d6c29,_0x52d805){return _0x3d6c29===_0x52d805;},'Qehtb':_0x24f4ca(0x1fe)};this[_0x24f4ca(0x248)]&&(_0x2c9ed5[_0x24f4ca(0x1f8)](clearInterval,this[_0x24f4ca(0x248)]),this[_0x24f4ca(0x248)]=null,_0x2c9ed5['pkIXy'](_0x4ee26b,_0x2c9ed5[_0x24f4ca(0x1f2)])&&(this[_0x24f4ca(0x252)]=![]));};[a128_0x495895(0x224)]=()=>{const _0x1b1ad3=a128_0x495895,_0x3161d9={};_0x3161d9[_0x1b1ad3(0x228)]=function(_0x23d532,_0xf8c3a4){return _0x23d532>=_0xf8c3a4;};const _0x5ad163=_0x3161d9;return _0x5ad163['HNOqB'](this['queue'][_0x1b1ad3(0x1eb)],BATCH_SIZE);};async['uploadPending'](_0x5b72b9=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x52f7a8=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x3577b8=a128_0x495895,_0x3d82c4={'nUEmE':function(_0x26a4b4,_0x48fb05){return _0x26a4b4<=_0x48fb05;},'amnIr':function(_0xfaef0f,_0x59acfc){return _0xfaef0f(_0x59acfc);},'nGqDm':function(_0xb94c5c,_0x218aa3){return _0xb94c5c-_0x218aa3;}};if(_0x3d82c4[_0x3577b8(0x238)](this['pendingUploads'],0x0)||_0x3d82c4['nUEmE'](_0x5b72b9,0x0))return;return await _0x3d82c4[_0x3577b8(0x210)](sleep,_0x52f7a8),this[_0x3577b8(0x244)](_0x3d82c4[_0x3577b8(0x255)](_0x5b72b9,_0x52f7a8));}}module['exports']=RequestQueueHandler;