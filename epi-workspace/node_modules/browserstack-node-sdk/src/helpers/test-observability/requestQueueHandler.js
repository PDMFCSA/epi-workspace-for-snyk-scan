const a121_0x1dc7d3=a121_0x4d2d;(function(_0x19eeba,_0x4b30e0){const _0x321158=a121_0x4d2d,_0x3bc146=_0x19eeba();while(!![]){try{const _0x257a10=parseInt(_0x321158(0x1d5))/0x1+parseInt(_0x321158(0x19c))/0x2*(-parseInt(_0x321158(0x1c2))/0x3)+-parseInt(_0x321158(0x1a7))/0x4*(-parseInt(_0x321158(0x196))/0x5)+-parseInt(_0x321158(0x199))/0x6+-parseInt(_0x321158(0x178))/0x7*(-parseInt(_0x321158(0x1be))/0x8)+parseInt(_0x321158(0x170))/0x9*(parseInt(_0x321158(0x19e))/0xa)+-parseInt(_0x321158(0x1c8))/0xb;if(_0x257a10===_0x4b30e0)break;else _0x3bc146['push'](_0x3bc146['shift']());}catch(_0x5a3d34){_0x3bc146['push'](_0x3bc146['shift']());}}}(a121_0x2334,0xb6777));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a121_0x1dc7d3(0x166)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a121_0x1dc7d3(0x16a)),{nestedKeyValue}=require(a121_0x1dc7d3(0x1c6)),util=require(a121_0x1dc7d3(0x1da)),constants=require('../../bin/utils/constants');function a121_0x2334(){const _0x5b8c79=['max','pollEventBatchInterval','byteLength','vVRQN','WFOqA','1070HqMAcK','REMOVING','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','7186962xbmqKd','eventUrl','TestRunSkipped','132980iiKrFQ','logs','10rSOuoQ','queue','resetEventBatchPolling','LBgHo','KwhFr','pzLBi','proceedWithData','exports','UerIg','27932OsIMzG','SxYcn','WfppD','length','FsLhb','getInstance','slice','glITx','POST','TEST_ATTACHMENT','push','\x20REQUEST\x20TO\x20','QThZD','format','oPYpf','PwSdR','fzLUh','ghZJG','HookRunStarted','NQEMB','includes','vrFjn','pendingUploads','739952ENVUSn','start','instance','started','12yRaxqB','shouldProceed','\x20event\x20successful\x20for\x20events\x20','NFiJq','../helper','TEST_REPORTING_ANALYTICS','12300420EmTiev','hook_run','Processing\x20batch\x20events\x20for\x20','FMwLL','uxlcs','bnwrW','tdpiY','statusText','TEST_SCREENSHOT','BATCH_EVENT_TYPES','\x20:\x20','.\x20Request\x20Size\x20-\x20','split','561513KHrQOm','uploadPending','uploadAttachmentUrl','event_type','mTnnQ','util','LogCreated','status','./constants','Remaining\x20Queue\x20Length\x20-\x20','EXCEPTION\x20IN\x20','error','./utils','response','ujXxQ','\x20bytes.\x20Events\x20are\x20','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','OgIqK','8131851sUwSFR','RESETTING','TestRunFinished','Arvmq','startEventBatchPolling','data','screenshotEventUrl','proceedWithUrl','28QVzszJ','lxOmc','HXiKl','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','UzFeO','message','shutdown','ZdLPV','HookRunFinished','lKjHs','splice','YLLyp','removeEventBatchPolling','batchAndPostEvents','test_run','kind','Interval-Queue','ZRtsQ','join','bUYsp','api/v1/screenshots','wwFsU','KaswU','3|2|0|4|5|6|1','uuid'];a121_0x2334=function(){return _0x5b8c79;};return a121_0x2334();}class RequestQueueHandler{static [a121_0x1dc7d3(0x1c0)];[a121_0x1dc7d3(0x1bd)]=0x0;constructor(){const _0x3a4f92=a121_0x1dc7d3,_0x385296={};_0x385296['mTnnQ']=_0x3a4f92(0x18f),_0x385296['eKfvW']='api/v1/batch',_0x385296[_0x3a4f92(0x1a1)]=_0x3a4f92(0x18c),_0x385296[_0x3a4f92(0x18d)]='upload-attachments',_0x385296['OgIqK']=_0x3a4f92(0x1db),_0x385296['SOOmG']='CBTSessionCreated',_0x385296[_0x3a4f92(0x1c5)]=_0x3a4f92(0x172),_0x385296[_0x3a4f92(0x1a3)]=_0x3a4f92(0x19b),_0x385296[_0x3a4f92(0x1ce)]=_0x3a4f92(0x180),_0x385296[_0x3a4f92(0x1b5)]='TestRunStarted',_0x385296[_0x3a4f92(0x18e)]=_0x3a4f92(0x1b9);const _0x1a7263=_0x385296,_0x32a67e=_0x1a7263[_0x3a4f92(0x1d9)][_0x3a4f92(0x1d4)]('|');let _0xba57f6=0x0;while(!![]){switch(_0x32a67e[_0xba57f6++]){case'0':this[_0x3a4f92(0x19a)]=_0x1a7263['eKfvW'];continue;case'1':this['pollEventBatchInterval']=null;continue;case'2':this['started']=![];continue;case'3':this[_0x3a4f92(0x19f)]=[];continue;case'4':this[_0x3a4f92(0x176)]=_0x1a7263[_0x3a4f92(0x1a1)];continue;case'5':this[_0x3a4f92(0x1d7)]=_0x1a7263[_0x3a4f92(0x18d)];continue;case'6':this[_0x3a4f92(0x1d1)]=[_0x1a7263[_0x3a4f92(0x16f)],_0x1a7263['SOOmG'],_0x1a7263[_0x3a4f92(0x1c5)],_0x1a7263['pzLBi'],_0x1a7263[_0x3a4f92(0x1ce)],_0x1a7263[_0x3a4f92(0x1b5)],_0x1a7263[_0x3a4f92(0x18e)]];continue;}break;}}static[a121_0x1dc7d3(0x1ac)](){const _0x171bc2=a121_0x1dc7d3;return!RequestQueueHandler[_0x171bc2(0x1c0)]&&(RequestQueueHandler['instance']=new RequestQueueHandler()),RequestQueueHandler[_0x171bc2(0x1c0)];}[a121_0x1dc7d3(0x1bf)]=()=>{const _0x57195e=a121_0x1dc7d3;!this[_0x57195e(0x1c1)]&&(this[_0x57195e(0x1c1)]=!![],this[_0x57195e(0x174)]());};['add']=_0xc282c4=>{const _0x363355=a121_0x1dc7d3,_0x400c3e={'FMwLL':function(_0x3a2efe,_0x31482d){return _0x3a2efe===_0x31482d;},'ZdLPV':_0x363355(0x1d0),'paLiJ':function(_0x463b6b,_0x548ac4){return _0x463b6b>_0x548ac4;},'bnwrW':_0x363355(0x1b0),'bUYsp':function(_0xd091b0,_0x3d5492){return _0xd091b0!==_0x3d5492;},'QThZD':_0x363355(0x172),'FsLhb':function(_0xa55b24,_0x19aff2){return _0xa55b24(_0x19aff2);},'qihMv':_0x363355(0x198)};if(this[_0x363355(0x1d1)][_0x363355(0x1bb)](_0xc282c4[_0x363355(0x1d8)])){if(_0xc282c4[_0x363355(0x19d)]&&_0xc282c4[_0x363355(0x19d)][0x0]&&_0x400c3e[_0x363355(0x1cb)](_0xc282c4[_0x363355(0x19d)][0x0][_0x363355(0x187)],_0x400c3e[_0x363355(0x17f)])){const _0xac8fac={};return _0xac8fac[_0x363355(0x1c3)]=!![],_0xac8fac['proceedWithData']=[_0xc282c4],_0xac8fac[_0x363355(0x177)]=this['screenshotEventUrl'],_0xac8fac;}if(_0xc282c4[_0x363355(0x19d)]&&_0x400c3e['paLiJ'](_0xc282c4['logs'][_0x363355(0x1aa)],0x0)&&_0x400c3e[_0x363355(0x1cb)](_0xc282c4[_0x363355(0x19d)][0x0][_0x363355(0x187)],_0x400c3e[_0x363355(0x1cd)])&&_0x400c3e[_0x363355(0x18b)](_0xc282c4[_0x363355(0x1d8)],_0x400c3e[_0x363355(0x1b3)])){const _0x8772e9={};return _0x8772e9[_0x363355(0x1c3)]=!![],_0x8772e9[_0x363355(0x1a4)]=[_0xc282c4],_0x8772e9[_0x363355(0x177)]=this[_0x363355(0x1d7)],_0x8772e9;}this[_0x363355(0x19f)][_0x363355(0x1b1)](_0xc282c4);let _0x1d99e5=null;const _0x1644b3=this[_0x363355(0x1c3)]();_0x1644b3&&(_0x400c3e[_0x363355(0x1ab)](trace,_0x400c3e['qihMv']),_0x1d99e5=this[_0x363355(0x19f)][_0x363355(0x1ad)](0x0,BATCH_SIZE),this[_0x363355(0x19f)][_0x363355(0x182)](0x0,BATCH_SIZE),this['resetEventBatchPolling']());const _0x3a2bd0={};return _0x3a2bd0[_0x363355(0x1c3)]=_0x1644b3,_0x3a2bd0[_0x363355(0x1a4)]=_0x1d99e5,_0x3a2bd0[_0x363355(0x177)]=this[_0x363355(0x19a)],_0x3a2bd0;}const _0x490028={};return _0x490028[_0x363355(0x1c3)]=!![],_0x490028;};[a121_0x1dc7d3(0x17e)]=async()=>{const _0x381686=a121_0x1dc7d3,_0x315c08={'vrFjn':_0x381686(0x197),'WFOqA':function(_0x20e026,_0x3a3cea){return _0x20e026>_0x3a3cea;},'PKTIs':'Shutdown-Queue','ZRtsQ':function(_0xdded6,_0x67438d){return _0xdded6(_0x67438d);}};await this[_0x381686(0x1d6)](),this['removeEventBatchPolling'](_0x315c08[_0x381686(0x1bc)]);while(_0x315c08[_0x381686(0x195)](this[_0x381686(0x19f)][_0x381686(0x1aa)],0x0)){const _0x15e545=this['queue'][_0x381686(0x1ad)](0x0,BATCH_SIZE);this[_0x381686(0x19f)]['splice'](0x0,BATCH_SIZE),await this[_0x381686(0x185)](this[_0x381686(0x19a)],_0x315c08['PKTIs'],_0x15e545);}_0x315c08['WFOqA'](this[_0x381686(0x1bd)],0x0)&&_0x315c08[_0x381686(0x189)](debug,_0x381686(0x16e)+this[_0x381686(0x1bd)]);};[a121_0x1dc7d3(0x185)]=async(_0x74c24a,_0x2a22c1,_0xd27566)=>{const _0x3e84d7=a121_0x1dc7d3,_0x11ad6f={'KwhFr':function(_0x15feaa,_0xc4fe52){return _0x15feaa(_0xc4fe52);},'SxYcn':'utf8','YLLyp':function(_0x4d4e47){return _0x4d4e47();},'UzFeO':function(_0x14f980,_0x226f51,_0x4e65ca,_0x45ac22,_0x152c99){return _0x14f980(_0x226f51,_0x4e65ca,_0x45ac22,_0x152c99);},'UerIg':_0x3e84d7(0x1af),'HXiKl':function(_0x5e26dd,_0x50bad5){return _0x5e26dd(_0x50bad5);},'glITx':function(_0x5f1534,_0x5b18cb){return _0x5f1534-_0x5b18cb;},'MBHka':function(_0x28f730,_0x2bb97d){return _0x28f730(_0x2bb97d);},'NQEMB':function(_0x254a3d,_0xe4d662){return _0x254a3d-_0xe4d662;}};let _0x3346d5='';try{_0x3346d5=_0xd27566['map'](_0x27c297=>'\x27'+_0x27c297[_0x3e84d7(0x1d8)]+'\x27:'+(nestedKeyValue(_0x27c297,[_0x3e84d7(0x186),_0x3e84d7(0x190)])||nestedKeyValue(_0x27c297,[_0x3e84d7(0x1c9),_0x3e84d7(0x190)])))[_0x3e84d7(0x18a)](','),_0x11ad6f[_0x3e84d7(0x1a2)](debug,_0x3e84d7(0x1ca)+_0x2a22c1+_0x3e84d7(0x1d3)+Buffer[_0x3e84d7(0x193)](util['format']('%j',_0xd27566),_0x11ad6f[_0x3e84d7(0x1a8)])+_0x3e84d7(0x16d)+_0x3346d5);}catch(_0x5bcf30){_0x11ad6f[_0x3e84d7(0x1a2)](debug,_0x3e84d7(0x17b)+util['format'](_0x5bcf30)+'}');}const _0x5728e9={'headers':_0x11ad6f[_0x3e84d7(0x183)](getDefaultHeaders)};try{const _0x46cb6b=await _0x11ad6f[_0x3e84d7(0x17c)](nodeRequest,_0x11ad6f[_0x3e84d7(0x1a6)],_0x74c24a,_0xd27566,_0x5728e9);if(_0x46cb6b['data'][_0x3e84d7(0x169)]){const _0x5ed339={};_0x5ed339[_0x3e84d7(0x17d)]=_0x46cb6b[_0x3e84d7(0x175)]['error'];throw _0x5ed339;}else _0x11ad6f[_0x3e84d7(0x17a)](debug,_0x2a22c1+_0x3e84d7(0x1c4)+_0x3346d5+'\x20--\x20'+util['format']('%j',_0x46cb6b[_0x3e84d7(0x175)])),this[_0x3e84d7(0x1bd)]=Math[_0x3e84d7(0x191)](0x0,_0x11ad6f[_0x3e84d7(0x1ae)](this[_0x3e84d7(0x1bd)],_0xd27566[_0x3e84d7(0x1aa)]));}catch(_0x287183){_0x287183[_0x3e84d7(0x16b)]?_0x11ad6f[_0x3e84d7(0x1a2)](debug,'EXCEPTION\x20IN\x20'+_0x2a22c1+'\x20REQUEST\x20TO\x20'+constants[_0x3e84d7(0x1c7)]+_0x3e84d7(0x1d2)+_0x287183['response'][_0x3e84d7(0x165)]+'\x20'+_0x287183[_0x3e84d7(0x16b)][_0x3e84d7(0x1cf)]+'\x20'+util[_0x3e84d7(0x1b4)]('%j',_0x287183[_0x3e84d7(0x16b)])):_0x11ad6f['MBHka'](debug,_0x3e84d7(0x168)+_0x2a22c1+_0x3e84d7(0x1b2)+constants[_0x3e84d7(0x1c7)]+_0x3e84d7(0x1d2)+(_0x287183[_0x3e84d7(0x17d)]||_0x287183)),this[_0x3e84d7(0x1bd)]=Math['max'](0x0,_0x11ad6f[_0x3e84d7(0x1ba)](this[_0x3e84d7(0x1bd)],_0xd27566['length']));}};[a121_0x1dc7d3(0x174)]=()=>{const _0x30a4f8=a121_0x1dc7d3,_0x23ca36={'uxlcs':function(_0x2fbcde,_0x1a7170){return _0x2fbcde>_0x1a7170;},'vVRQN':function(_0x503de4,_0x5d3df9){return _0x503de4(_0x5d3df9);},'QIgJj':_0x30a4f8(0x188),'ujXxQ':function(_0x3e328f,_0x55e203,_0x49d845){return _0x3e328f(_0x55e203,_0x49d845);}};this[_0x30a4f8(0x192)]=_0x23ca36[_0x30a4f8(0x16c)](setInterval,async()=>{const _0x2a8e6e=_0x30a4f8;if(_0x23ca36[_0x2a8e6e(0x1cc)](this[_0x2a8e6e(0x19f)][_0x2a8e6e(0x1aa)],0x0)){_0x23ca36['vVRQN'](trace,'Processing\x20events.\x20Queue\x20Length\x20-\x20'+this['queue']['length']);const _0x5a104b=this[_0x2a8e6e(0x19f)][_0x2a8e6e(0x1ad)](0x0,BATCH_SIZE);this[_0x2a8e6e(0x19f)][_0x2a8e6e(0x182)](0x0,BATCH_SIZE),await this[_0x2a8e6e(0x185)](this[_0x2a8e6e(0x19a)],_0x23ca36['QIgJj'],_0x5a104b),_0x23ca36[_0x2a8e6e(0x194)](trace,_0x2a8e6e(0x167)+this[_0x2a8e6e(0x19f)]['length']);}},BATCH_INTERVAL);};[a121_0x1dc7d3(0x1a0)]=()=>{const _0x1ed5d6=a121_0x1dc7d3,_0x464282={};_0x464282[_0x1ed5d6(0x179)]=_0x1ed5d6(0x171);const _0x5e1f49=_0x464282;this[_0x1ed5d6(0x184)](_0x5e1f49[_0x1ed5d6(0x179)]),this['startEventBatchPolling']();};['removeEventBatchPolling']=_0x22eb4d=>{const _0x3ea3e9=a121_0x1dc7d3,_0xe3c153={'nOTBQ':function(_0x2ad08b,_0x22b255){return _0x2ad08b(_0x22b255);},'WfppD':function(_0x185029,_0x28abeb){return _0x185029===_0x28abeb;},'Arvmq':_0x3ea3e9(0x197)};this['pollEventBatchInterval']&&(_0xe3c153['nOTBQ'](clearInterval,this[_0x3ea3e9(0x192)]),this['pollEventBatchInterval']=null,_0xe3c153[_0x3ea3e9(0x1a9)](_0x22eb4d,_0xe3c153[_0x3ea3e9(0x173)])&&(this[_0x3ea3e9(0x1c1)]=![]));};['shouldProceed']=()=>{const _0x460f78=a121_0x1dc7d3,_0x334489={};_0x334489[_0x460f78(0x1b6)]=function(_0x3eaa28,_0x3c59a5){return _0x3eaa28>=_0x3c59a5;};const _0x4f640c=_0x334489;return _0x4f640c[_0x460f78(0x1b6)](this[_0x460f78(0x19f)][_0x460f78(0x1aa)],BATCH_SIZE);};async['uploadPending'](_0x23119d=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x36fdb4=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x5bfc68=a121_0x1dc7d3,_0x10853b={'lKjHs':function(_0xa01a6c,_0x28e358){return _0xa01a6c<=_0x28e358;},'fzLUh':function(_0x2d17a3,_0x471fac){return _0x2d17a3(_0x471fac);},'ghZJG':function(_0x4cc4c6,_0x2b92c7){return _0x4cc4c6-_0x2b92c7;}};if(_0x10853b[_0x5bfc68(0x181)](this[_0x5bfc68(0x1bd)],0x0)||_0x10853b[_0x5bfc68(0x181)](_0x23119d,0x0))return;return await _0x10853b[_0x5bfc68(0x1b7)](sleep,_0x36fdb4),this[_0x5bfc68(0x1d6)](_0x10853b[_0x5bfc68(0x1b8)](_0x23119d,_0x36fdb4));}}function a121_0x4d2d(_0x1c1b4f,_0x145117){const _0x23340f=a121_0x2334();return a121_0x4d2d=function(_0x4d2d26,_0x5bbc33){_0x4d2d26=_0x4d2d26-0x165;let _0x2b60ee=_0x23340f[_0x4d2d26];return _0x2b60ee;},a121_0x4d2d(_0x1c1b4f,_0x145117);}module[a121_0x1dc7d3(0x1a5)]=RequestQueueHandler;