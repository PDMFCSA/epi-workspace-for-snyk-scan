const a118_0x504cb5=a118_0x329a;(function(_0xa393b,_0x5a43c7){const _0x283008=a118_0x329a,_0x4b472c=_0xa393b();while(!![]){try{const _0x32ce9f=-parseInt(_0x283008(0x192))/0x1*(parseInt(_0x283008(0x162))/0x2)+-parseInt(_0x283008(0x191))/0x3*(-parseInt(_0x283008(0x144))/0x4)+-parseInt(_0x283008(0x175))/0x5+-parseInt(_0x283008(0x161))/0x6+parseInt(_0x283008(0x151))/0x7*(parseInt(_0x283008(0x137))/0x8)+parseInt(_0x283008(0x168))/0x9*(-parseInt(_0x283008(0x135))/0xa)+parseInt(_0x283008(0x17d))/0xb;if(_0x32ce9f===_0x5a43c7)break;else _0x4b472c['push'](_0x4b472c['shift']());}catch(_0x2548b1){_0x4b472c['push'](_0x4b472c['shift']());}}}(a118_0x1091,0x7a0d9));function a118_0x329a(_0x56db02,_0x2b6622){const _0x109193=a118_0x1091();return a118_0x329a=function(_0x329a09,_0x194e2e){_0x329a09=_0x329a09-0x12e;let _0x1ff96b=_0x109193[_0x329a09];return _0x1ff96b;},a118_0x329a(_0x56db02,_0x2b6622);}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a118_0x504cb5(0x183)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a118_0x504cb5(0x155)),{nestedKeyValue}=require(a118_0x504cb5(0x130)),util=require('util'),constants=require('../../bin/utils/constants');function a118_0x1091(){const _0x2d1974=['\x20REQUEST\x20TO\x20','hook_run','TestRunFinished','1062rAHPLd','utf8','zUCHb','includes','uploadAttachmentUrl','.\x20Request\x20Size\x20-\x20','mHCdp','\x20bytes.\x20Events\x20are\x20','OTgZJ','POST','byteLength','pendingUploads','TEST_REPORTING_ANALYTICS','4292450NbtrgN','join','exports','proceedWithUrl','\x20:\x20','\x20--\x20','started','GltZS','22252670mDvtyQ','yQvps','dchET','removeEventBatchPolling','event_type','zChaM','./constants','max','status','getInstance','\x20event\x20successful\x20for\x20events\x20','upload-attachments','instance','uuid','TEST_ATTACHMENT','push','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','Jsqgo','screenshotEventUrl','shouldProceed','6pfYTZB','1tjOggW','QvxCF','startEventBatchPolling','slice','rPFIs','error','UPTfa','TEST_SCREENSHOT','czabr','proceedWithData','pollEventBatchInterval','resetEventBatchPolling','REMOVING','TQqJO','format','Qwycg','MzMXg','aiTPO','wMEfb','vuISi','bTuAy','split','Remaining\x20Queue\x20Length\x20-\x20','../helper','RESETTING','start','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','OeaLV','60480dHOYzv','xWQOs','93736LSLugO','NjkQe','aioqc','add','nGzMb','LogCreated','yLZsr','ioTgq','Shutdown-Queue','IRbwZ','BATCH_EVENT_TYPES','batchAndPostEvents','response','263672iILtZS','api/v1/batch','data','caeIT','wWaBn','splice','HookRunStarted','Processing\x20events.\x20Queue\x20Length\x20-\x20','logs','queue','tghdM','Interval-Queue','eventUrl','560BYLQTj','OvKnM','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','RquRp','./utils','shutdown','map','TestRunSkipped','eojXj','XDufz','Processing\x20batch\x20events\x20for\x20','VbRBn','uploadPending','TestRunStarted','TWgWe','Nwawr','5419320YNedmV','233726HpDEbd','length','statusText'];a118_0x1091=function(){return _0x2d1974;};return a118_0x1091();}class RequestQueueHandler{static [a118_0x504cb5(0x189)];[a118_0x504cb5(0x173)]=0x0;constructor(){const _0x47b62e=a118_0x504cb5,_0x40ae73={};_0x40ae73['vuISi']='0|5|3|2|6|4|1',_0x40ae73['zUCHb']='api/v1/screenshots',_0x40ae73[_0x47b62e(0x1a4)]=_0x47b62e(0x145),_0x40ae73['aiTPO']=_0x47b62e(0x13c),_0x40ae73[_0x47b62e(0x148)]='CBTSessionCreated',_0x40ae73[_0x47b62e(0x18e)]=_0x47b62e(0x167),_0x40ae73['ioTgq']=_0x47b62e(0x158),_0x40ae73['wnhRE']='HookRunFinished',_0x40ae73[_0x47b62e(0x19f)]=_0x47b62e(0x15e),_0x40ae73[_0x47b62e(0x160)]=_0x47b62e(0x14a),_0x40ae73[_0x47b62e(0x193)]=_0x47b62e(0x188);const _0x471e03=_0x40ae73,_0x399512=_0x471e03[_0x47b62e(0x1a5)][_0x47b62e(0x12e)]('|');let _0x4c9513=0x0;while(!![]){switch(_0x399512[_0x4c9513++]){case'0':this[_0x47b62e(0x14d)]=[];continue;case'1':this[_0x47b62e(0x19c)]=null;continue;case'2':this['screenshotEventUrl']=_0x471e03[_0x47b62e(0x16a)];continue;case'3':this[_0x47b62e(0x150)]=_0x471e03[_0x47b62e(0x1a4)];continue;case'4':this[_0x47b62e(0x141)]=[_0x471e03[_0x47b62e(0x1a3)],_0x471e03['wWaBn'],_0x471e03[_0x47b62e(0x18e)],_0x471e03[_0x47b62e(0x13e)],_0x471e03['wnhRE'],_0x471e03[_0x47b62e(0x19f)],_0x471e03[_0x47b62e(0x160)]];continue;case'5':this[_0x47b62e(0x17b)]=![];continue;case'6':this['uploadAttachmentUrl']=_0x471e03[_0x47b62e(0x193)];continue;}break;}}static[a118_0x504cb5(0x186)](){const _0x364d74=a118_0x504cb5;return!RequestQueueHandler['instance']&&(RequestQueueHandler[_0x364d74(0x189)]=new RequestQueueHandler()),RequestQueueHandler[_0x364d74(0x189)];}[a118_0x504cb5(0x132)]=()=>{const _0x5a863a=a118_0x504cb5;!this[_0x5a863a(0x17b)]&&(this[_0x5a863a(0x17b)]=!![],this['startEventBatchPolling']());};[a118_0x504cb5(0x13a)]=_0x30d378=>{const _0x5eb327=a118_0x504cb5,_0x50d7e9={'UPTfa':function(_0x12e0c5,_0x533f00){return _0x12e0c5===_0x533f00;},'rPFIs':_0x5eb327(0x199),'aioqc':function(_0x5f0db8,_0x3af949){return _0x5f0db8>_0x3af949;},'TWgWe':function(_0x8c941e,_0x1c7e17){return _0x8c941e===_0x1c7e17;},'aULck':_0x5eb327(0x18b),'VbRBn':function(_0x36cdfc,_0x3448f6){return _0x36cdfc!==_0x3448f6;},'nGzMb':_0x5eb327(0x167),'xgiOV':function(_0x7c09c7,_0x3827a0){return _0x7c09c7(_0x3827a0);},'MzMXg':_0x5eb327(0x18d)};if(this[_0x5eb327(0x141)][_0x5eb327(0x16b)](_0x30d378[_0x5eb327(0x181)])){if(_0x30d378[_0x5eb327(0x14c)]&&_0x30d378['logs'][0x0]&&_0x50d7e9[_0x5eb327(0x198)](_0x30d378[_0x5eb327(0x14c)][0x0]['kind'],_0x50d7e9[_0x5eb327(0x196)])){const _0x19f36f={};return _0x19f36f['shouldProceed']=!![],_0x19f36f[_0x5eb327(0x19b)]=[_0x30d378],_0x19f36f[_0x5eb327(0x178)]=this[_0x5eb327(0x18f)],_0x19f36f;}if(_0x30d378[_0x5eb327(0x14c)]&&_0x50d7e9[_0x5eb327(0x139)](_0x30d378['logs'][_0x5eb327(0x163)],0x0)&&_0x50d7e9[_0x5eb327(0x15f)](_0x30d378['logs'][0x0]['kind'],_0x50d7e9['aULck'])&&_0x50d7e9[_0x5eb327(0x15c)](_0x30d378[_0x5eb327(0x181)],_0x50d7e9[_0x5eb327(0x13b)])){const _0x4c697a={};return _0x4c697a[_0x5eb327(0x190)]=!![],_0x4c697a[_0x5eb327(0x19b)]=[_0x30d378],_0x4c697a[_0x5eb327(0x178)]=this[_0x5eb327(0x16c)],_0x4c697a;}this[_0x5eb327(0x14d)][_0x5eb327(0x18c)](_0x30d378);let _0x1a645b=null;const _0x655f15=this['shouldProceed']();_0x655f15&&(_0x50d7e9['xgiOV'](trace,_0x50d7e9[_0x5eb327(0x1a2)]),_0x1a645b=this[_0x5eb327(0x14d)]['slice'](0x0,BATCH_SIZE),this[_0x5eb327(0x14d)][_0x5eb327(0x149)](0x0,BATCH_SIZE),this[_0x5eb327(0x19d)]());const _0x922b13={};return _0x922b13[_0x5eb327(0x190)]=_0x655f15,_0x922b13[_0x5eb327(0x19b)]=_0x1a645b,_0x922b13[_0x5eb327(0x178)]=this[_0x5eb327(0x150)],_0x922b13;}const _0x972f19={};return _0x972f19[_0x5eb327(0x190)]=!![],_0x972f19;};[a118_0x504cb5(0x156)]=async()=>{const _0xa7dee6=a118_0x504cb5,_0x40948a={'OeaLV':_0xa7dee6(0x19e),'yQvps':function(_0x535674,_0x40c47c){return _0x535674>_0x40c47c;},'RquRp':_0xa7dee6(0x13f),'IRbwZ':function(_0x283aec,_0x50afad){return _0x283aec>_0x50afad;},'bTuAy':function(_0x43dffe,_0x4389b8){return _0x43dffe(_0x4389b8);}};await this['uploadPending'](),this[_0xa7dee6(0x180)](_0x40948a[_0xa7dee6(0x134)]);while(_0x40948a[_0xa7dee6(0x17e)](this[_0xa7dee6(0x14d)][_0xa7dee6(0x163)],0x0)){const _0x3f359a=this[_0xa7dee6(0x14d)][_0xa7dee6(0x195)](0x0,BATCH_SIZE);this[_0xa7dee6(0x14d)][_0xa7dee6(0x149)](0x0,BATCH_SIZE),await this[_0xa7dee6(0x142)](this[_0xa7dee6(0x150)],_0x40948a[_0xa7dee6(0x154)],_0x3f359a);}_0x40948a[_0xa7dee6(0x140)](this[_0xa7dee6(0x173)],0x0)&&_0x40948a[_0xa7dee6(0x1a6)](debug,_0xa7dee6(0x153)+this[_0xa7dee6(0x173)]);};['batchAndPostEvents']=async(_0x14cca9,_0x3e2e9,_0x44bae3)=>{const _0x3d4c3a=a118_0x504cb5,_0x39a62c={'dchET':function(_0x32fb7a,_0x58b97e){return _0x32fb7a(_0x58b97e);},'NjkQe':_0x3d4c3a(0x169),'czabr':function(_0x53524c){return _0x53524c();},'NHGYn':function(_0x3e93ad,_0x1d56b5,_0x1cf05f,_0x80f357,_0x44fca4){return _0x3e93ad(_0x1d56b5,_0x1cf05f,_0x80f357,_0x44fca4);},'caeIT':_0x3d4c3a(0x171),'mHCdp':function(_0x186297,_0x26aca6){return _0x186297(_0x26aca6);},'QAxhq':function(_0xa85b4f,_0x52f403){return _0xa85b4f-_0x52f403;},'lLBhs':function(_0x130f96,_0x43d29e){return _0x130f96(_0x43d29e);},'DBWYe':function(_0x333605,_0x2f1047){return _0x333605-_0x2f1047;}};let _0x55afec='';try{_0x55afec=_0x44bae3[_0x3d4c3a(0x157)](_0xbcab99=>'\x27'+_0xbcab99[_0x3d4c3a(0x181)]+'\x27:'+(nestedKeyValue(_0xbcab99,['test_run',_0x3d4c3a(0x18a)])||nestedKeyValue(_0xbcab99,[_0x3d4c3a(0x166),_0x3d4c3a(0x18a)])))[_0x3d4c3a(0x176)](','),_0x39a62c[_0x3d4c3a(0x17f)](debug,_0x3d4c3a(0x15b)+_0x3e2e9+_0x3d4c3a(0x16d)+Buffer[_0x3d4c3a(0x172)](util[_0x3d4c3a(0x1a0)]('%j',_0x44bae3),_0x39a62c[_0x3d4c3a(0x138)])+_0x3d4c3a(0x16f)+_0x55afec);}catch(_0x23ed2b){_0x39a62c[_0x3d4c3a(0x17f)](debug,_0x3d4c3a(0x133)+util[_0x3d4c3a(0x1a0)](_0x23ed2b)+'}');}const _0x41818f={'headers':_0x39a62c[_0x3d4c3a(0x19a)](getDefaultHeaders)};try{const _0x3e0f3c=await _0x39a62c['NHGYn'](nodeRequest,_0x39a62c[_0x3d4c3a(0x147)],_0x14cca9,_0x44bae3,_0x41818f);if(_0x3e0f3c[_0x3d4c3a(0x146)][_0x3d4c3a(0x197)]){const _0x4e1e91={};_0x4e1e91['message']=_0x3e0f3c[_0x3d4c3a(0x146)]['error'];throw _0x4e1e91;}else _0x39a62c[_0x3d4c3a(0x16e)](debug,_0x3e2e9+_0x3d4c3a(0x187)+_0x55afec+_0x3d4c3a(0x17a)+util['format']('%j',_0x3e0f3c[_0x3d4c3a(0x146)])),this[_0x3d4c3a(0x173)]=Math[_0x3d4c3a(0x184)](0x0,_0x39a62c['QAxhq'](this['pendingUploads'],_0x44bae3[_0x3d4c3a(0x163)]));}catch(_0x2316f0){_0x2316f0[_0x3d4c3a(0x143)]?_0x39a62c['lLBhs'](debug,'EXCEPTION\x20IN\x20'+_0x3e2e9+_0x3d4c3a(0x165)+constants[_0x3d4c3a(0x174)]+'\x20:\x20'+_0x2316f0[_0x3d4c3a(0x143)][_0x3d4c3a(0x185)]+'\x20'+_0x2316f0['response'][_0x3d4c3a(0x164)]+'\x20'+util[_0x3d4c3a(0x1a0)]('%j',_0x2316f0['response'])):_0x39a62c[_0x3d4c3a(0x17f)](debug,'EXCEPTION\x20IN\x20'+_0x3e2e9+'\x20REQUEST\x20TO\x20'+constants[_0x3d4c3a(0x174)]+_0x3d4c3a(0x179)+(_0x2316f0['message']||_0x2316f0)),this[_0x3d4c3a(0x173)]=Math['max'](0x0,_0x39a62c['DBWYe'](this[_0x3d4c3a(0x173)],_0x44bae3['length']));}};[a118_0x504cb5(0x194)]=()=>{const _0x55a123=a118_0x504cb5,_0x283620={'GltZS':function(_0x5429ab,_0x2c5e3e){return _0x5429ab>_0x2c5e3e;},'xWQOs':function(_0x5d372d,_0x228389){return _0x5d372d(_0x228389);},'eojXj':_0x55a123(0x14f),'SKLRh':function(_0x21d298,_0x5f2cf0,_0x3e4a91){return _0x21d298(_0x5f2cf0,_0x3e4a91);}};this['pollEventBatchInterval']=_0x283620['SKLRh'](setInterval,async()=>{const _0x2174f1=_0x55a123;if(_0x283620[_0x2174f1(0x17c)](this[_0x2174f1(0x14d)]['length'],0x0)){_0x283620[_0x2174f1(0x136)](trace,_0x2174f1(0x14b)+this[_0x2174f1(0x14d)][_0x2174f1(0x163)]);const _0x444d1f=this[_0x2174f1(0x14d)][_0x2174f1(0x195)](0x0,BATCH_SIZE);this[_0x2174f1(0x14d)][_0x2174f1(0x149)](0x0,BATCH_SIZE),await this[_0x2174f1(0x142)](this['eventUrl'],_0x283620[_0x2174f1(0x159)],_0x444d1f),_0x283620[_0x2174f1(0x136)](trace,_0x2174f1(0x12f)+this[_0x2174f1(0x14d)]['length']);}},BATCH_INTERVAL);};[a118_0x504cb5(0x19d)]=()=>{const _0x5ad31f=a118_0x504cb5,_0x5ae0b3={};_0x5ae0b3[_0x5ad31f(0x182)]=_0x5ad31f(0x131);const _0xf87257=_0x5ae0b3;this[_0x5ad31f(0x180)](_0xf87257[_0x5ad31f(0x182)]),this['startEventBatchPolling']();};[a118_0x504cb5(0x180)]=_0x382865=>{const _0x23383b=a118_0x504cb5,_0x2ecffb={'XDufz':function(_0x49688f,_0x1ac56a){return _0x49688f(_0x1ac56a);},'ymEGl':function(_0x3519bd,_0x41ee8e){return _0x3519bd===_0x41ee8e;},'tghdM':_0x23383b(0x19e)};this[_0x23383b(0x19c)]&&(_0x2ecffb[_0x23383b(0x15a)](clearInterval,this['pollEventBatchInterval']),this['pollEventBatchInterval']=null,_0x2ecffb['ymEGl'](_0x382865,_0x2ecffb[_0x23383b(0x14e)])&&(this[_0x23383b(0x17b)]=![]));};['shouldProceed']=()=>{const _0x34f007=a118_0x504cb5,_0x4770f2={};_0x4770f2[_0x34f007(0x152)]=function(_0x23857a,_0x208022){return _0x23857a>=_0x208022;};const _0x432ea5=_0x4770f2;return _0x432ea5[_0x34f007(0x152)](this['queue'][_0x34f007(0x163)],BATCH_SIZE);};async['uploadPending'](_0x33513a=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x52ba2c=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x3b3fc6=a118_0x504cb5,_0x3c2a57={'kpewW':function(_0x1115d5,_0x196a8b){return _0x1115d5<=_0x196a8b;},'OTgZJ':function(_0x1ed7d7,_0x3cf5d5){return _0x1ed7d7<=_0x3cf5d5;},'Qwycg':function(_0x29dc25,_0x34a7d9){return _0x29dc25(_0x34a7d9);},'yLZsr':function(_0x3b34f6,_0x11b277){return _0x3b34f6-_0x11b277;}};if(_0x3c2a57['kpewW'](this[_0x3b3fc6(0x173)],0x0)||_0x3c2a57[_0x3b3fc6(0x170)](_0x33513a,0x0))return;return await _0x3c2a57[_0x3b3fc6(0x1a1)](sleep,_0x52ba2c),this[_0x3b3fc6(0x15d)](_0x3c2a57[_0x3b3fc6(0x13d)](_0x33513a,_0x52ba2c));}}module[a118_0x504cb5(0x177)]=RequestQueueHandler;