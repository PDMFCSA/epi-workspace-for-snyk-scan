const a115_0x4c3ab0=a115_0x15c5;(function(_0x2b82ea,_0x3626ce){const _0x2de7ac=a115_0x15c5,_0x4f47ab=_0x2b82ea();while(!![]){try{const _0x12c804=-parseInt(_0x2de7ac(0x12b))/0x1*(parseInt(_0x2de7ac(0x12e))/0x2)+parseInt(_0x2de7ac(0x174))/0x3+parseInt(_0x2de7ac(0x121))/0x4*(-parseInt(_0x2de7ac(0x118))/0x5)+-parseInt(_0x2de7ac(0x147))/0x6*(parseInt(_0x2de7ac(0x167))/0x7)+-parseInt(_0x2de7ac(0x17a))/0x8*(parseInt(_0x2de7ac(0x16b))/0x9)+parseInt(_0x2de7ac(0x149))/0xa*(-parseInt(_0x2de7ac(0x13e))/0xb)+-parseInt(_0x2de7ac(0x13c))/0xc*(-parseInt(_0x2de7ac(0x11f))/0xd);if(_0x12c804===_0x3626ce)break;else _0x4f47ab['push'](_0x4f47ab['shift']());}catch(_0xc19a04){_0x4f47ab['push'](_0x4f47ab['shift']());}}}(a115_0x2fe9,0x7ce4c));function a115_0x15c5(_0x172f7c,_0x56ef2a){const _0x2fe935=a115_0x2fe9();return a115_0x15c5=function(_0x15c5ae,_0x210946){_0x15c5ae=_0x15c5ae-0x109;let _0x87c37b=_0x2fe935[_0x15c5ae];return _0x87c37b;},a115_0x15c5(_0x172f7c,_0x56ef2a);}function a115_0x2fe9(){const _0x4809b0=['CfQrg','bTSWZ','.\x20Request\x20Size\x20-\x20','577552DJzeZq','POST','Fcoyc','eMAvS','max','wgapq','event_type','pwFVk','Processing\x20events.\x20Queue\x20Length\x20-\x20','OUcIP','exports','xGkSJ','batchAndPostEvents','HookRunStarted','xWSTG','splice','3|5|6|2|1|0|4','iHKrR','REMOVING','5BSBJsn','XqhoU','slice','Shutdown-Queue','length','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','TestRunStarted','3575pWQJiA','shutdown','635608IIlDVr','pOZMA','pLDNq','zRGci','RESETTING','util','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','utf8','vKhuI','waYgP','1eSVRoh','queue','uploadPending','139654sMjUEW','LogCreated','CBTSessionCreated','CjXbc','PRaMp','started','fPqZQ','pollEventBatchInterval','instance','api/v1/batch','ecFoU','Processing\x20batch\x20events\x20for\x20','uploadAttachmentUrl','aIIEl','124764eZqzcS','NhIYJ','9702671GgQTMJ','IcFRJ','proceedWithData','wLais','../helper','removeEventBatchPolling','screenshotEventUrl','hook_run','TestRunSkipped','171132teVuXZ','HookRunFinished','10DYKuWV','format','kind','MMjHP','fHOpc','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','pendingUploads','VAKJR','response','startEventBatchPolling','error','Remaining\x20Queue\x20Length\x20-\x20','VsqnK','statusText','EXCEPTION\x20IN\x20','sZzoN','data','message','split','uuid','TmhOg','BATCH_EVENT_TYPES','hUfGM','TestRunFinished','TEST_ATTACHMENT','test_run','AMBuw','push','MDsBJ','resetEventBatchPolling','210tavQuh','\x20bytes.\x20Events\x20are\x20','OoUiM','logs','54csgMBO','join','includes','PGeMN','api/v1/screenshots','eventUrl','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','shouldProceed','ZXygq','156009dkZALt','./constants','ESCAE'];a115_0x2fe9=function(){return _0x4809b0;};return a115_0x2fe9();}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a115_0x4c3ab0(0x175)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require(a115_0x4c3ab0(0x142)),util=require(a115_0x4c3ab0(0x126));class RequestQueueHandler{static [a115_0x4c3ab0(0x136)];[a115_0x4c3ab0(0x14f)]=0x0;constructor(){const _0x3d2f04=a115_0x4c3ab0,_0x5362b7={};_0x5362b7['vKhuI']=_0x3d2f04(0x115),_0x5362b7[_0x3d2f04(0x141)]=_0x3d2f04(0x12f),_0x5362b7[_0x3d2f04(0x17c)]=_0x3d2f04(0x130),_0x5362b7[_0x3d2f04(0x173)]=_0x3d2f04(0x160),_0x5362b7[_0x3d2f04(0x131)]=_0x3d2f04(0x146),_0x5362b7[_0x3d2f04(0x169)]=_0x3d2f04(0x148),_0x5362b7[_0x3d2f04(0x123)]=_0x3d2f04(0x11e),_0x5362b7['waYgP']=_0x3d2f04(0x112),_0x5362b7[_0x3d2f04(0x178)]='upload-attachments',_0x5362b7[_0x3d2f04(0x122)]=_0x3d2f04(0x16f),_0x5362b7[_0x3d2f04(0x134)]=_0x3d2f04(0x137);const _0x1196d7=_0x5362b7,_0x1cc46c=_0x1196d7[_0x3d2f04(0x129)][_0x3d2f04(0x15b)]('|');let _0x570bb1=0x0;while(!![]){switch(_0x1cc46c[_0x570bb1++]){case'0':this[_0x3d2f04(0x15e)]=[_0x1196d7['wLais'],_0x1196d7[_0x3d2f04(0x17c)],_0x1196d7[_0x3d2f04(0x173)],_0x1196d7[_0x3d2f04(0x131)],_0x1196d7[_0x3d2f04(0x169)],_0x1196d7[_0x3d2f04(0x123)],_0x1196d7[_0x3d2f04(0x12a)]];continue;case'1':this[_0x3d2f04(0x13a)]=_0x1196d7['bTSWZ'];continue;case'2':this[_0x3d2f04(0x144)]=_0x1196d7[_0x3d2f04(0x122)];continue;case'3':this[_0x3d2f04(0x12c)]=[];continue;case'4':this[_0x3d2f04(0x135)]=null;continue;case'5':this[_0x3d2f04(0x133)]=![];continue;case'6':this[_0x3d2f04(0x170)]=_0x1196d7[_0x3d2f04(0x134)];continue;}break;}}static['getInstance'](){const _0x35f4d7=a115_0x4c3ab0;return!RequestQueueHandler[_0x35f4d7(0x136)]&&(RequestQueueHandler[_0x35f4d7(0x136)]=new RequestQueueHandler()),RequestQueueHandler['instance'];}['start']=()=>{const _0x22ae88=a115_0x4c3ab0;!this[_0x22ae88(0x133)]&&(this[_0x22ae88(0x133)]=!![],this[_0x22ae88(0x152)]());};['add']=_0x173086=>{const _0x2d3f49=a115_0x4c3ab0,_0x16a71c={'fHOpc':function(_0x3d6d3a,_0x9a5213){return _0x3d6d3a===_0x9a5213;},'CfQrg':'TEST_SCREENSHOT','MMjHP':function(_0x340c91,_0x6ccdd8){return _0x340c91>_0x6ccdd8;},'XqhoU':_0x2d3f49(0x161),'jOHep':function(_0x2328c2,_0xdfb7a8){return _0x2328c2!==_0xdfb7a8;},'MoTQg':_0x2d3f49(0x160),'YUVbX':function(_0x2954b8,_0x1f04cd){return _0x2954b8(_0x1f04cd);},'DczRB':_0x2d3f49(0x14e)};if(this['BATCH_EVENT_TYPES'][_0x2d3f49(0x16d)](_0x173086['event_type'])){if(_0x173086[_0x2d3f49(0x16a)]&&_0x173086[_0x2d3f49(0x16a)][0x0]&&_0x16a71c[_0x2d3f49(0x14d)](_0x173086[_0x2d3f49(0x16a)][0x0][_0x2d3f49(0x14b)],_0x16a71c[_0x2d3f49(0x177)])){const _0x51df4f={};return _0x51df4f[_0x2d3f49(0x172)]=!![],_0x51df4f[_0x2d3f49(0x140)]=[_0x173086],_0x51df4f['proceedWithUrl']=this[_0x2d3f49(0x144)],_0x51df4f;}if(_0x173086[_0x2d3f49(0x16a)]&&_0x16a71c[_0x2d3f49(0x14c)](_0x173086[_0x2d3f49(0x16a)][_0x2d3f49(0x11c)],0x0)&&_0x16a71c['fHOpc'](_0x173086[_0x2d3f49(0x16a)][0x0][_0x2d3f49(0x14b)],_0x16a71c[_0x2d3f49(0x119)])&&_0x16a71c['jOHep'](_0x173086[_0x2d3f49(0x10b)],_0x16a71c['MoTQg'])){const _0x403f29={};return _0x403f29[_0x2d3f49(0x172)]=!![],_0x403f29[_0x2d3f49(0x140)]=[_0x173086],_0x403f29['proceedWithUrl']=this[_0x2d3f49(0x13a)],_0x403f29;}this[_0x2d3f49(0x12c)][_0x2d3f49(0x164)](_0x173086);let _0x1cbc9a=null;const _0x5e884b=this[_0x2d3f49(0x172)]();_0x5e884b&&(_0x16a71c['YUVbX'](trace,_0x16a71c['DczRB']),_0x1cbc9a=this['queue'][_0x2d3f49(0x11a)](0x0,BATCH_SIZE),this[_0x2d3f49(0x12c)][_0x2d3f49(0x114)](0x0,BATCH_SIZE),this[_0x2d3f49(0x166)]());const _0xf21a60={};return _0xf21a60[_0x2d3f49(0x172)]=_0x5e884b,_0xf21a60[_0x2d3f49(0x140)]=_0x1cbc9a,_0xf21a60['proceedWithUrl']=this[_0x2d3f49(0x170)],_0xf21a60;}const _0x98ca09={};return _0x98ca09['shouldProceed']=!![],_0x98ca09;};[a115_0x4c3ab0(0x120)]=async()=>{const _0x3d8c53=a115_0x4c3ab0,_0x337265={'AMBuw':_0x3d8c53(0x117),'pwFVk':function(_0x30682e,_0x482210){return _0x30682e>_0x482210;},'ESCAE':_0x3d8c53(0x11b),'PGeMN':function(_0x453306,_0x6aa11e){return _0x453306>_0x6aa11e;},'zRGci':function(_0x3ac622,_0x102aec){return _0x3ac622(_0x102aec);}};await this[_0x3d8c53(0x12d)](),this[_0x3d8c53(0x143)](_0x337265[_0x3d8c53(0x163)]);while(_0x337265[_0x3d8c53(0x10c)](this['queue'][_0x3d8c53(0x11c)],0x0)){const _0x3b1074=this[_0x3d8c53(0x12c)]['slice'](0x0,BATCH_SIZE);this[_0x3d8c53(0x12c)][_0x3d8c53(0x114)](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x3d8c53(0x170)],_0x337265[_0x3d8c53(0x176)],_0x3b1074);}_0x337265[_0x3d8c53(0x16e)](this['pendingUploads'],0x0)&&_0x337265[_0x3d8c53(0x124)](debug,_0x3d8c53(0x171)+this['pendingUploads']);};['batchAndPostEvents']=async(_0x561336,_0x2ad2b0,_0x15088e)=>{const _0x1e7306=a115_0x4c3ab0,_0x5a4158={'xWSTG':function(_0x44972e,_0x3ec61f){return _0x44972e(_0x3ec61f);},'RMzPd':_0x1e7306(0x128),'IcFRJ':function(_0x26da96,_0x3dcecf){return _0x26da96(_0x3dcecf);},'wgapq':function(_0x3f3e58){return _0x3f3e58();},'NhIYJ':function(_0x566b4a,_0x56c361,_0x13d341,_0x223795,_0x29b7c5){return _0x566b4a(_0x56c361,_0x13d341,_0x223795,_0x29b7c5);},'xkhJp':_0x1e7306(0x17b),'jvVel':function(_0x24bccd,_0x3b2cb3){return _0x24bccd(_0x3b2cb3);},'OUcIP':function(_0x505a97,_0x1b0e54){return _0x505a97-_0x1b0e54;},'sZzoN':function(_0x6ed111,_0x2f7a9d){return _0x6ed111(_0x2f7a9d);}};let _0x51eacb='';try{_0x51eacb=_0x15088e['map'](_0x2b3b7f=>'\x27'+_0x2b3b7f[_0x1e7306(0x10b)]+'\x27:'+(nestedKeyValue(_0x2b3b7f,[_0x1e7306(0x162),'uuid'])||nestedKeyValue(_0x2b3b7f,[_0x1e7306(0x145),_0x1e7306(0x15c)])))[_0x1e7306(0x16c)](','),_0x5a4158[_0x1e7306(0x113)](debug,_0x1e7306(0x139)+_0x2ad2b0+_0x1e7306(0x179)+Buffer['byteLength'](util[_0x1e7306(0x14a)]('%j',_0x15088e),_0x5a4158['RMzPd'])+_0x1e7306(0x168)+_0x51eacb);}catch(_0x2a8933){_0x5a4158[_0x1e7306(0x13f)](debug,_0x1e7306(0x11d)+util[_0x1e7306(0x14a)](_0x2a8933)+'}');}const _0xc09be0={'headers':_0x5a4158[_0x1e7306(0x10a)](getDefaultHeaders)};try{const _0x40c993=await _0x5a4158[_0x1e7306(0x13d)](nodeRequest,_0x5a4158['xkhJp'],_0x561336,_0x15088e,_0xc09be0);if(_0x40c993[_0x1e7306(0x159)][_0x1e7306(0x153)]){const _0x4ef28c={};_0x4ef28c[_0x1e7306(0x15a)]=_0x40c993['data'][_0x1e7306(0x153)];throw _0x4ef28c;}else _0x5a4158['jvVel'](debug,_0x2ad2b0+'\x20event\x20successful\x20for\x20events\x20'+_0x51eacb+'\x20--\x20'+util[_0x1e7306(0x14a)]('%j',_0x40c993['data'])),this['pendingUploads']=Math['max'](0x0,_0x5a4158[_0x1e7306(0x10e)](this['pendingUploads'],_0x15088e[_0x1e7306(0x11c)]));}catch(_0x5ab9f3){_0x5ab9f3[_0x1e7306(0x151)]?_0x5a4158[_0x1e7306(0x158)](debug,'EXCEPTION\x20IN\x20'+_0x2ad2b0+_0x1e7306(0x127)+_0x5ab9f3[_0x1e7306(0x151)]['status']+'\x20'+_0x5ab9f3[_0x1e7306(0x151)][_0x1e7306(0x156)]+'\x20'+util[_0x1e7306(0x14a)]('%j',_0x5ab9f3['response'])):_0x5a4158[_0x1e7306(0x158)](debug,_0x1e7306(0x157)+_0x2ad2b0+_0x1e7306(0x127)+(_0x5ab9f3[_0x1e7306(0x15a)]||_0x5ab9f3)),this[_0x1e7306(0x14f)]=Math[_0x1e7306(0x109)](0x0,_0x5a4158['OUcIP'](this[_0x1e7306(0x14f)],_0x15088e[_0x1e7306(0x11c)]));}};[a115_0x4c3ab0(0x152)]=()=>{const _0x329671=a115_0x4c3ab0,_0x3e27c={'iHKrR':function(_0x47aaae,_0x3c1bef){return _0x47aaae>_0x3c1bef;},'VAKJR':function(_0x2f20a6,_0xc3d404){return _0x2f20a6(_0xc3d404);},'ecFoU':'Interval-Queue','PRaMp':function(_0x56ff27,_0x153291,_0x181e59){return _0x56ff27(_0x153291,_0x181e59);}};this[_0x329671(0x135)]=_0x3e27c[_0x329671(0x132)](setInterval,async()=>{const _0x334930=_0x329671;if(_0x3e27c[_0x334930(0x116)](this[_0x334930(0x12c)][_0x334930(0x11c)],0x0)){_0x3e27c['VAKJR'](trace,_0x334930(0x10d)+this[_0x334930(0x12c)]['length']);const _0x306e4e=this[_0x334930(0x12c)][_0x334930(0x11a)](0x0,BATCH_SIZE);this[_0x334930(0x12c)][_0x334930(0x114)](0x0,BATCH_SIZE),await this[_0x334930(0x111)](this[_0x334930(0x170)],_0x3e27c[_0x334930(0x138)],_0x306e4e),_0x3e27c[_0x334930(0x150)](trace,_0x334930(0x154)+this['queue'][_0x334930(0x11c)]);}},BATCH_INTERVAL);};[a115_0x4c3ab0(0x166)]=()=>{const _0x16e94c=a115_0x4c3ab0,_0x17cbdc={};_0x17cbdc['xGkSJ']=_0x16e94c(0x125);const _0x3078ca=_0x17cbdc;this[_0x16e94c(0x143)](_0x3078ca[_0x16e94c(0x110)]),this['startEventBatchPolling']();};[a115_0x4c3ab0(0x143)]=_0x597c8a=>{const _0x153aed=a115_0x4c3ab0,_0x217bdc={'fXOmP':function(_0x58c964,_0x43be7a){return _0x58c964(_0x43be7a);},'hUfGM':function(_0xac4b63,_0x28179e){return _0xac4b63===_0x28179e;},'TmhOg':'REMOVING'};this['pollEventBatchInterval']&&(_0x217bdc['fXOmP'](clearInterval,this[_0x153aed(0x135)]),this[_0x153aed(0x135)]=null,_0x217bdc[_0x153aed(0x15f)](_0x597c8a,_0x217bdc[_0x153aed(0x15d)])&&(this['started']=![]));};[a115_0x4c3ab0(0x172)]=()=>{const _0x8413b5=a115_0x4c3ab0,_0x5eda0e={};_0x5eda0e[_0x8413b5(0x155)]=function(_0x2d547b,_0x194420){return _0x2d547b>=_0x194420;};const _0x1a34e1=_0x5eda0e;return _0x1a34e1[_0x8413b5(0x155)](this['queue'][_0x8413b5(0x11c)],BATCH_SIZE);};async[a115_0x4c3ab0(0x12d)](_0x3da3d4=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x5a8280=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0xe302c5=a115_0x4c3ab0,_0x27516a={'aIIEl':function(_0x37b6b7,_0x50fd9c){return _0x37b6b7<=_0x50fd9c;},'MDsBJ':function(_0x57e38d,_0x413953){return _0x57e38d(_0x413953);},'eMAvS':function(_0x3fd96a,_0xcf853c){return _0x3fd96a-_0xcf853c;}};if(_0x27516a[_0xe302c5(0x13b)](this[_0xe302c5(0x14f)],0x0)||_0x27516a[_0xe302c5(0x13b)](_0x3da3d4,0x0))return;return await _0x27516a[_0xe302c5(0x165)](sleep,_0x5a8280),this['uploadPending'](_0x27516a[_0xe302c5(0x17d)](_0x3da3d4,_0x5a8280));}}module[a115_0x4c3ab0(0x10f)]=RequestQueueHandler;