const a128_0x5c7ea8=a128_0x578d;(function(_0x315ab7,_0x21d771){const _0x25ba55=a128_0x578d,_0x671f16=_0x315ab7();while(!![]){try{const _0x5eb189=-parseInt(_0x25ba55(0x1fb))/0x1+-parseInt(_0x25ba55(0x1ff))/0x2+parseInt(_0x25ba55(0x1c9))/0x3*(-parseInt(_0x25ba55(0x1e6))/0x4)+parseInt(_0x25ba55(0x1d5))/0x5*(-parseInt(_0x25ba55(0x217))/0x6)+parseInt(_0x25ba55(0x1e2))/0x7+-parseInt(_0x25ba55(0x1d6))/0x8+parseInt(_0x25ba55(0x20d))/0x9*(parseInt(_0x25ba55(0x1cf))/0xa);if(_0x5eb189===_0x21d771)break;else _0x671f16['push'](_0x671f16['shift']());}catch(_0x186c2a){_0x671f16['push'](_0x671f16['shift']());}}}(a128_0x3ae9,0x5fc9e));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a128_0x5c7ea8(0x212)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require(a128_0x5c7ea8(0x1df)),util=require(a128_0x5c7ea8(0x1ba)),constants=require(a128_0x5c7ea8(0x204));class RequestQueueHandler{static [a128_0x5c7ea8(0x215)];[a128_0x5c7ea8(0x21d)]=0x0;constructor(){const _0x8a2208=a128_0x5c7ea8,_0x49b028={};_0x49b028[_0x8a2208(0x206)]=_0x8a2208(0x1b2),_0x49b028['BzvlP']=_0x8a2208(0x1b0),_0x49b028[_0x8a2208(0x1ac)]=_0x8a2208(0x1ea),_0x49b028[_0x8a2208(0x1ad)]=_0x8a2208(0x1f9),_0x49b028[_0x8a2208(0x1f4)]='TestRunFinished',_0x49b028['ZWNKt']=_0x8a2208(0x1cb),_0x49b028[_0x8a2208(0x1e5)]='HookRunFinished',_0x49b028[_0x8a2208(0x1d9)]=_0x8a2208(0x219),_0x49b028[_0x8a2208(0x218)]=_0x8a2208(0x20c),_0x49b028[_0x8a2208(0x1ee)]=_0x8a2208(0x21a),_0x49b028[_0x8a2208(0x1d3)]=_0x8a2208(0x1d7);const _0x140be8=_0x49b028,_0x1bc640=_0x140be8[_0x8a2208(0x206)][_0x8a2208(0x1b9)]('|');let _0x4a5a6e=0x0;while(!![]){switch(_0x1bc640[_0x4a5a6e++]){case'0':this['queue']=[];continue;case'1':this[_0x8a2208(0x1fa)]=_0x140be8['BzvlP'];continue;case'2':this['BATCH_EVENT_TYPES']=[_0x140be8[_0x8a2208(0x1ac)],_0x140be8[_0x8a2208(0x1ad)],_0x140be8[_0x8a2208(0x1f4)],_0x140be8[_0x8a2208(0x1bb)],_0x140be8[_0x8a2208(0x1e5)],_0x140be8[_0x8a2208(0x1d9)],_0x140be8[_0x8a2208(0x218)]];continue;case'3':this[_0x8a2208(0x1e9)]=_0x140be8[_0x8a2208(0x1ee)];continue;case'4':this[_0x8a2208(0x1d2)]=![];continue;case'5':this[_0x8a2208(0x21b)]=null;continue;case'6':this[_0x8a2208(0x1c5)]=_0x140be8[_0x8a2208(0x1d3)];continue;}break;}}static[a128_0x5c7ea8(0x1d4)](){const _0x45ece1=a128_0x5c7ea8;return!RequestQueueHandler['instance']&&(RequestQueueHandler['instance']=new RequestQueueHandler()),RequestQueueHandler[_0x45ece1(0x215)];}[a128_0x5c7ea8(0x1af)]=()=>{const _0x40b3c5=a128_0x5c7ea8;!this[_0x40b3c5(0x1d2)]&&(this['started']=!![],this[_0x40b3c5(0x211)]());};[a128_0x5c7ea8(0x1f6)]=_0x3622c8=>{const _0x1048dd=a128_0x5c7ea8,_0x11c029={'tWlcv':function(_0x2368e1,_0x47a104){return _0x2368e1===_0x47a104;},'heNQO':_0x1048dd(0x213),'xGfjW':function(_0x65f236,_0x1ea30d){return _0x65f236>_0x1ea30d;},'KfrtI':_0x1048dd(0x1e0),'zPsGx':function(_0x454bb7,_0xb507a){return _0x454bb7!==_0xb507a;},'jMtQQ':_0x1048dd(0x1fd),'xLYEv':function(_0x2f248f,_0x2802a7){return _0x2f248f(_0x2802a7);},'JbENP':_0x1048dd(0x1d1)};if(this['BATCH_EVENT_TYPES'][_0x1048dd(0x1b4)](_0x3622c8[_0x1048dd(0x220)])){if(_0x3622c8[_0x1048dd(0x1b7)]&&_0x3622c8[_0x1048dd(0x1b7)][0x0]&&_0x11c029['tWlcv'](_0x3622c8['logs'][0x0][_0x1048dd(0x1d0)],_0x11c029[_0x1048dd(0x1e1)])){const _0x4f44ff={};return _0x4f44ff['shouldProceed']=!![],_0x4f44ff[_0x1048dd(0x1f3)]=[_0x3622c8],_0x4f44ff[_0x1048dd(0x1f1)]=this[_0x1048dd(0x1fa)],_0x4f44ff;}if(_0x3622c8[_0x1048dd(0x1b7)]&&_0x11c029['xGfjW'](_0x3622c8[_0x1048dd(0x1b7)][_0x1048dd(0x1bf)],0x0)&&_0x11c029[_0x1048dd(0x1f2)](_0x3622c8['logs'][0x0][_0x1048dd(0x1d0)],_0x11c029[_0x1048dd(0x1f0)])&&_0x11c029[_0x1048dd(0x1bd)](_0x3622c8['event_type'],_0x11c029['jMtQQ'])){const _0x18cd7f={};return _0x18cd7f[_0x1048dd(0x21f)]=!![],_0x18cd7f[_0x1048dd(0x1f3)]=[_0x3622c8],_0x18cd7f[_0x1048dd(0x1f1)]=this[_0x1048dd(0x1e9)],_0x18cd7f;}this[_0x1048dd(0x1e7)][_0x1048dd(0x207)](_0x3622c8);let _0x5ca3c8=null;const _0x1220ac=this['shouldProceed']();_0x1220ac&&(_0x11c029[_0x1048dd(0x1ca)](trace,_0x11c029[_0x1048dd(0x1da)]),_0x5ca3c8=this['queue']['slice'](0x0,BATCH_SIZE),this[_0x1048dd(0x1e7)][_0x1048dd(0x208)](0x0,BATCH_SIZE),this['resetEventBatchPolling']());const _0x4197ec={};return _0x4197ec['shouldProceed']=_0x1220ac,_0x4197ec['proceedWithData']=_0x5ca3c8,_0x4197ec[_0x1048dd(0x1f1)]=this[_0x1048dd(0x1c5)],_0x4197ec;}const _0x5e2695={};return _0x5e2695[_0x1048dd(0x21f)]=!![],_0x5e2695;};[a128_0x5c7ea8(0x21e)]=async()=>{const _0x5ead8f=a128_0x5c7ea8,_0x1a2f30={'fAhTK':_0x5ead8f(0x1b6),'DuUxf':function(_0x198d6f,_0x1bf4fa){return _0x198d6f>_0x1bf4fa;},'cZumM':'Shutdown-Queue','oAXcv':function(_0x1cb327,_0x20a0e9){return _0x1cb327>_0x20a0e9;},'Oanff':function(_0x591fde,_0x7993fd){return _0x591fde(_0x7993fd);}};await this[_0x5ead8f(0x1c3)](),this[_0x5ead8f(0x201)](_0x1a2f30['fAhTK']);while(_0x1a2f30[_0x5ead8f(0x1b1)](this[_0x5ead8f(0x1e7)][_0x5ead8f(0x1bf)],0x0)){const _0x1adbe8=this[_0x5ead8f(0x1e7)][_0x5ead8f(0x1f7)](0x0,BATCH_SIZE);this[_0x5ead8f(0x1e7)][_0x5ead8f(0x208)](0x0,BATCH_SIZE),await this[_0x5ead8f(0x1de)](this[_0x5ead8f(0x1c5)],_0x1a2f30[_0x5ead8f(0x1e8)],_0x1adbe8);}_0x1a2f30[_0x5ead8f(0x1c8)](this[_0x5ead8f(0x21d)],0x0)&&_0x1a2f30[_0x5ead8f(0x1b3)](debug,_0x5ead8f(0x1ef)+this[_0x5ead8f(0x21d)]);};[a128_0x5c7ea8(0x1de)]=async(_0x35238d,_0x1ee9ca,_0x2eefa5)=>{const _0x45321b=a128_0x5c7ea8,_0x36e6ec={'quDYo':function(_0x3808cf,_0x6f2f82){return _0x3808cf(_0x6f2f82);},'TDPQX':_0x45321b(0x1b5),'WAxgT':function(_0x4189e0,_0x2eed05){return _0x4189e0(_0x2eed05);},'BnXbm':function(_0x3b7386){return _0x3b7386();},'VrUVt':function(_0x5c9e18,_0x31045f,_0x2d8a69,_0x5e91fa,_0x4d9dee){return _0x5c9e18(_0x31045f,_0x2d8a69,_0x5e91fa,_0x4d9dee);},'SYeSO':_0x45321b(0x1fc),'dJtJl':function(_0x11f3d5,_0x4a3a2b){return _0x11f3d5-_0x4a3a2b;},'ARGtZ':function(_0x273d09,_0x32177d){return _0x273d09(_0x32177d);},'JQcPr':function(_0xe7ab50,_0x42a7f4){return _0xe7ab50-_0x42a7f4;}};let _0x3c30c9='';try{_0x3c30c9=_0x2eefa5['map'](_0x265cda=>'\x27'+_0x265cda[_0x45321b(0x220)]+'\x27:'+(nestedKeyValue(_0x265cda,[_0x45321b(0x20a),_0x45321b(0x200)])||nestedKeyValue(_0x265cda,['hook_run',_0x45321b(0x200)])))[_0x45321b(0x20e)](','),_0x36e6ec[_0x45321b(0x1db)](debug,'Processing\x20batch\x20events\x20for\x20'+_0x1ee9ca+_0x45321b(0x1dc)+Buffer[_0x45321b(0x205)](util[_0x45321b(0x1c2)]('%j',_0x2eefa5),_0x36e6ec['TDPQX'])+_0x45321b(0x214)+_0x3c30c9);}catch(_0xfb758f){_0x36e6ec[_0x45321b(0x1fe)](debug,_0x45321b(0x1f5)+util[_0x45321b(0x1c2)](_0xfb758f)+'}');}const _0x2ca6b2={'headers':_0x36e6ec[_0x45321b(0x1be)](getDefaultHeaders)};try{const _0x4a88cb=await _0x36e6ec[_0x45321b(0x1f8)](nodeRequest,_0x36e6ec[_0x45321b(0x1dd)],_0x35238d,_0x2eefa5,_0x2ca6b2);if(_0x4a88cb[_0x45321b(0x1ed)]['error']){const _0x213b1a={};_0x213b1a[_0x45321b(0x1ce)]=_0x4a88cb[_0x45321b(0x1ed)]['error'];throw _0x213b1a;}else _0x36e6ec[_0x45321b(0x1db)](debug,_0x1ee9ca+'\x20event\x20successful\x20for\x20events\x20'+_0x3c30c9+'\x20--\x20'+util[_0x45321b(0x1c2)]('%j',_0x4a88cb['data'])),this[_0x45321b(0x21d)]=Math[_0x45321b(0x1e3)](0x0,_0x36e6ec['dJtJl'](this[_0x45321b(0x21d)],_0x2eefa5[_0x45321b(0x1bf)]));}catch(_0x495501){_0x495501[_0x45321b(0x1d8)]?_0x36e6ec[_0x45321b(0x1fe)](debug,_0x45321b(0x20b)+_0x1ee9ca+_0x45321b(0x1cd)+constants[_0x45321b(0x1c1)]+_0x45321b(0x1c7)+_0x495501['response']['status']+'\x20'+_0x495501[_0x45321b(0x1d8)][_0x45321b(0x1eb)]+'\x20'+util['format']('%j',_0x495501[_0x45321b(0x1d8)])):_0x36e6ec[_0x45321b(0x1e4)](debug,_0x45321b(0x20b)+_0x1ee9ca+'\x20REQUEST\x20TO\x20'+constants[_0x45321b(0x1c1)]+_0x45321b(0x1c7)+(_0x495501['message']||_0x495501)),this[_0x45321b(0x21d)]=Math[_0x45321b(0x1e3)](0x0,_0x36e6ec[_0x45321b(0x1cc)](this['pendingUploads'],_0x2eefa5[_0x45321b(0x1bf)]));}};[a128_0x5c7ea8(0x211)]=()=>{const _0x368cd2=a128_0x5c7ea8,_0x4fcee6={'bsTPU':function(_0x21406f,_0x7bc357){return _0x21406f>_0x7bc357;},'BWSbH':function(_0x7ced4b,_0x5769d0){return _0x7ced4b(_0x5769d0);},'KGugo':_0x368cd2(0x1c0),'QvcMI':function(_0x1913e8,_0x36610f){return _0x1913e8(_0x36610f);},'bqDGO':function(_0x5769f2,_0x347304,_0x56db1d){return _0x5769f2(_0x347304,_0x56db1d);}};this[_0x368cd2(0x21b)]=_0x4fcee6[_0x368cd2(0x20f)](setInterval,async()=>{const _0x4f9104=_0x368cd2;if(_0x4fcee6[_0x4f9104(0x210)](this[_0x4f9104(0x1e7)][_0x4f9104(0x1bf)],0x0)){_0x4fcee6['BWSbH'](trace,_0x4f9104(0x1ae)+this[_0x4f9104(0x1e7)][_0x4f9104(0x1bf)]);const _0x5d9eec=this[_0x4f9104(0x1e7)][_0x4f9104(0x1f7)](0x0,BATCH_SIZE);this[_0x4f9104(0x1e7)]['splice'](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x4f9104(0x1c5)],_0x4fcee6[_0x4f9104(0x1ec)],_0x5d9eec),_0x4fcee6[_0x4f9104(0x1b8)](trace,_0x4f9104(0x209)+this[_0x4f9104(0x1e7)][_0x4f9104(0x1bf)]);}},BATCH_INTERVAL);};[a128_0x5c7ea8(0x21c)]=()=>{const _0x7f9b12=a128_0x5c7ea8,_0x22d9ef={};_0x22d9ef[_0x7f9b12(0x202)]=_0x7f9b12(0x216);const _0x266184=_0x22d9ef;this[_0x7f9b12(0x201)](_0x266184['KyEyn']),this['startEventBatchPolling']();};[a128_0x5c7ea8(0x201)]=_0x129791=>{const _0x4c5a7a=a128_0x5c7ea8,_0x37a51a={'jmGbg':function(_0x15b1ba,_0x4284cc){return _0x15b1ba(_0x4284cc);},'ZrcGU':function(_0x56d53d,_0x1f2d5a){return _0x56d53d===_0x1f2d5a;},'fUjsB':_0x4c5a7a(0x1b6)};this[_0x4c5a7a(0x21b)]&&(_0x37a51a[_0x4c5a7a(0x1bc)](clearInterval,this['pollEventBatchInterval']),this['pollEventBatchInterval']=null,_0x37a51a['ZrcGU'](_0x129791,_0x37a51a['fUjsB'])&&(this[_0x4c5a7a(0x1d2)]=![]));};['shouldProceed']=()=>{const _0x1bd285=a128_0x5c7ea8,_0x2ca65b={};_0x2ca65b[_0x1bd285(0x203)]=function(_0x1dc277,_0x33d9d3){return _0x1dc277>=_0x33d9d3;};const _0xa8514=_0x2ca65b;return _0xa8514[_0x1bd285(0x203)](this[_0x1bd285(0x1e7)][_0x1bd285(0x1bf)],BATCH_SIZE);};async[a128_0x5c7ea8(0x1c3)](_0x53c01f=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x1389c1=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x5c958c=a128_0x5c7ea8,_0x454f63={'wrWLm':function(_0x3281cc,_0xdea4ed){return _0x3281cc<=_0xdea4ed;},'UUncO':function(_0x3405da,_0xa21beb){return _0x3405da(_0xa21beb);},'SYYlo':function(_0x54d39d,_0x16cebe){return _0x54d39d-_0x16cebe;}};if(_0x454f63[_0x5c958c(0x1c4)](this[_0x5c958c(0x21d)],0x0)||_0x454f63[_0x5c958c(0x1c4)](_0x53c01f,0x0))return;return await _0x454f63['UUncO'](sleep,_0x1389c1),this[_0x5c958c(0x1c3)](_0x454f63[_0x5c958c(0x1c6)](_0x53c01f,_0x1389c1));}}function a128_0x3ae9(){const _0x3cc6bf=['bsTPU','startEventBatchPolling','./constants','TEST_SCREENSHOT','\x20bytes.\x20Events\x20are\x20','instance','RESETTING','456gBjsKM','yESLU','TestRunStarted','upload-attachments','pollEventBatchInterval','resetEventBatchPolling','pendingUploads','shutdown','shouldProceed','event_type','MxsSK','RYrdM','Processing\x20events.\x20Queue\x20Length\x20-\x20','start','api/v1/screenshots','DuUxf','0|4|6|1|3|2|5','Oanff','includes','utf8','REMOVING','logs','QvcMI','split','util','ZWNKt','jmGbg','zPsGx','BnXbm','length','Interval-Queue','TEST_REPORTING_ANALYTICS','format','uploadPending','wrWLm','eventUrl','SYYlo','\x20:\x20','oAXcv','389853coMGHc','xLYEv','TestRunSkipped','JQcPr','\x20REQUEST\x20TO\x20','message','935650wFOTTw','kind','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','started','haHZN','getInstance','5135uUKtgx','3582952fPsFWL','api/v1/batch','response','BHiqk','JbENP','quDYo','.\x20Request\x20Size\x20-\x20','SYeSO','batchAndPostEvents','../helper','TEST_ATTACHMENT','heNQO','2082388rfaaVf','max','ARGtZ','YxOan','16mLjNee','queue','cZumM','uploadAttachmentUrl','LogCreated','statusText','KGugo','data','KggNx','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','KfrtI','proceedWithUrl','tWlcv','proceedWithData','mEWOC','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','add','slice','VrUVt','CBTSessionCreated','screenshotEventUrl','556676NVMNvf','POST','TestRunFinished','WAxgT','1096586qZrHsU','uuid','removeEventBatchPolling','KyEyn','QWcQw','../../bin/utils/constants','byteLength','PdLwx','push','splice','Remaining\x20Queue\x20Length\x20-\x20','test_run','EXCEPTION\x20IN\x20','HookRunStarted','216DqduBS','join','bqDGO'];a128_0x3ae9=function(){return _0x3cc6bf;};return a128_0x3ae9();}function a128_0x578d(_0x2ea968,_0xcbf93){const _0x3ae913=a128_0x3ae9();return a128_0x578d=function(_0x578dc0,_0x5d2c3e){_0x578dc0=_0x578dc0-0x1ac;let _0x6aca23=_0x3ae913[_0x578dc0];return _0x6aca23;},a128_0x578d(_0x2ea968,_0xcbf93);}module['exports']=RequestQueueHandler;