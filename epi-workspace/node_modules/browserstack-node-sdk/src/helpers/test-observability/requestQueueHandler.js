const a128_0x1a3027=a128_0x45a3;(function(_0x322ebe,_0x1650ef){const _0x11103c=a128_0x45a3,_0x12cb2e=_0x322ebe();while(!![]){try{const _0x105ab5=parseInt(_0x11103c(0x194))/0x1*(-parseInt(_0x11103c(0x1cd))/0x2)+-parseInt(_0x11103c(0x1db))/0x3+parseInt(_0x11103c(0x19b))/0x4*(parseInt(_0x11103c(0x1c3))/0x5)+-parseInt(_0x11103c(0x173))/0x6+-parseInt(_0x11103c(0x19d))/0x7*(-parseInt(_0x11103c(0x1b1))/0x8)+parseInt(_0x11103c(0x1ac))/0x9+-parseInt(_0x11103c(0x1bc))/0xa;if(_0x105ab5===_0x1650ef)break;else _0x12cb2e['push'](_0x12cb2e['shift']());}catch(_0x170f42){_0x12cb2e['push'](_0x12cb2e['shift']());}}}(a128_0x443b,0xc9014));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a128_0x1a3027(0x195)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a128_0x1a3027(0x16c)),{nestedKeyValue}=require(a128_0x1a3027(0x1aa)),util=require(a128_0x1a3027(0x19a)),constants=require('../../bin/utils/constants');function a128_0x443b(){const _0x39f58a=['MWPmA','startEventBatchPolling','slice','\x20REQUEST\x20TO\x20','zFHbc','835817VULpXd','./constants','exports','format','getInstance','REMOVING','util','3908212wariRr','HookRunStarted','1312136iHZRKH','oFnJN','uRqOM','split','max','Remaining\x20Queue\x20Length\x20-\x20','ocuHU','EdNQm','KJEKO','api/v1/screenshots','TestRunSkipped','shouldProceed','HookRunFinished','../helper','EXCEPTION\x20IN\x20','13082364BWkMOX','Bzdvs','uploadAttachmentUrl','data','TestRunStarted','40jXRaFW','eventUrl','Processing\x20events.\x20Queue\x20Length\x20-\x20','5|3|6|2|1|4|0','uploadPending','bPNPZ','Shutdown-Queue','proceedWithData','logs','\x20event\x20successful\x20for\x20events\x20','BATCH_EVENT_TYPES','3291730RMAaoZ','XfQrD','POST','pollEventBatchInterval','pendingUploads','TEST_REPORTING_ANALYTICS','byteLength','5aXxSQz','TEST_SCREENSHOT','dSDoO','vhJBH','LogCreated','rvVre','test_run','IFUdZ','ZtvVU','dCNqK','2hmZCDf','statusText','Interval-Queue','event_type','instance','splice','wMeos','TestRunFinished','zeMKK','Uilyl','kind','NhtWv','cSoLw','lhldT','118839ymywoP','JtORL','MgYaJ','tXiSp','upload-attachments','proceedWithUrl','Processing\x20batch\x20events\x20for\x20','idVBp','./utils','includes','screenshotEventUrl','XpsMc','uuid','status','removeEventBatchPolling','8039820rhtclv','join','resetEventBatchPolling','add','message','api/v1/batch','started','EwRzL','TEST_ATTACHMENT','batchAndPostEvents','zJNnG','map','wYrcD','LDkmM','FRhjy','error','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','hook_run','DvIEp','ozLsE','\x20:\x20','queue','\x20bytes.\x20Events\x20are\x20','length','push','dAjtg','response','lqbSm'];a128_0x443b=function(){return _0x39f58a;};return a128_0x443b();}function a128_0x45a3(_0x4f7590,_0xab93e1){const _0x443bde=a128_0x443b();return a128_0x45a3=function(_0x45a3a3,_0x340c1b){_0x45a3a3=_0x45a3a3-0x166;let _0x132c21=_0x443bde[_0x45a3a3];return _0x132c21;},a128_0x45a3(_0x4f7590,_0xab93e1);}class RequestQueueHandler{static [a128_0x1a3027(0x1d1)];[a128_0x1a3027(0x1c0)]=0x0;constructor(){const _0x37f4c9=a128_0x1a3027,_0x5caf49={};_0x5caf49['zFHbc']=_0x37f4c9(0x1b4),_0x5caf49[_0x37f4c9(0x1da)]=_0x37f4c9(0x168),_0x5caf49[_0x37f4c9(0x1d6)]=_0x37f4c9(0x1a6),_0x5caf49[_0x37f4c9(0x185)]=_0x37f4c9(0x1c7),_0x5caf49[_0x37f4c9(0x1dc)]='CBTSessionCreated',_0x5caf49[_0x37f4c9(0x1c6)]=_0x37f4c9(0x1d4),_0x5caf49['KJEKO']=_0x37f4c9(0x1a7),_0x5caf49[_0x37f4c9(0x180)]=_0x37f4c9(0x1a9),_0x5caf49[_0x37f4c9(0x1a4)]=_0x37f4c9(0x1b0),_0x5caf49[_0x37f4c9(0x19e)]=_0x37f4c9(0x19c),_0x5caf49[_0x37f4c9(0x1d9)]=_0x37f4c9(0x178);const _0x1c8575=_0x5caf49,_0x28ab9b=_0x1c8575[_0x37f4c9(0x193)][_0x37f4c9(0x1a0)]('|');let _0x2e692b=0x0;while(!![]){switch(_0x28ab9b[_0x2e692b++]){case'0':this[_0x37f4c9(0x1bf)]=null;continue;case'1':this[_0x37f4c9(0x1ae)]=_0x1c8575[_0x37f4c9(0x1da)];continue;case'2':this['screenshotEventUrl']=_0x1c8575[_0x37f4c9(0x1d6)];continue;case'3':this[_0x37f4c9(0x179)]=![];continue;case'4':this[_0x37f4c9(0x1bb)]=[_0x1c8575[_0x37f4c9(0x185)],_0x1c8575[_0x37f4c9(0x1dc)],_0x1c8575[_0x37f4c9(0x1c6)],_0x1c8575[_0x37f4c9(0x1a5)],_0x1c8575[_0x37f4c9(0x180)],_0x1c8575[_0x37f4c9(0x1a4)],_0x1c8575['oFnJN']];continue;case'5':this[_0x37f4c9(0x188)]=[];continue;case'6':this[_0x37f4c9(0x1b2)]=_0x1c8575[_0x37f4c9(0x1d9)];continue;}break;}}static[a128_0x1a3027(0x198)](){const _0x14659e=a128_0x1a3027;return!RequestQueueHandler['instance']&&(RequestQueueHandler[_0x14659e(0x1d1)]=new RequestQueueHandler()),RequestQueueHandler[_0x14659e(0x1d1)];}['start']=()=>{const _0x5f194b=a128_0x1a3027;!this[_0x5f194b(0x179)]&&(this[_0x5f194b(0x179)]=!![],this[_0x5f194b(0x190)]());};[a128_0x1a3027(0x176)]=_0x3d27f6=>{const _0x42f325=a128_0x1a3027,_0xf6472d={'zeMKK':function(_0x1e5ece,_0x5ebb1e){return _0x1e5ece===_0x5ebb1e;},'IFUdZ':_0x42f325(0x1c4),'FRhjy':function(_0x3cc886,_0x3eae1f){return _0x3cc886>_0x3eae1f;},'fMTNU':_0x42f325(0x17b),'bYpFO':function(_0x37c60b,_0x400ed3){return _0x37c60b!==_0x400ed3;},'duGYJ':'TestRunFinished','MgYaJ':function(_0x12d49e,_0x9c06a3){return _0x12d49e(_0x9c06a3);},'rvVre':'Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..'};if(this[_0x42f325(0x1bb)][_0x42f325(0x16d)](_0x3d27f6[_0x42f325(0x1d0)])){if(_0x3d27f6[_0x42f325(0x1b9)]&&_0x3d27f6[_0x42f325(0x1b9)][0x0]&&_0xf6472d[_0x42f325(0x1d5)](_0x3d27f6[_0x42f325(0x1b9)][0x0]['kind'],_0xf6472d[_0x42f325(0x1ca)])){const _0x131014={};return _0x131014[_0x42f325(0x1a8)]=!![],_0x131014['proceedWithData']=[_0x3d27f6],_0x131014[_0x42f325(0x169)]=this[_0x42f325(0x16e)],_0x131014;}if(_0x3d27f6[_0x42f325(0x1b9)]&&_0xf6472d[_0x42f325(0x181)](_0x3d27f6[_0x42f325(0x1b9)]['length'],0x0)&&_0xf6472d[_0x42f325(0x1d5)](_0x3d27f6[_0x42f325(0x1b9)][0x0][_0x42f325(0x1d7)],_0xf6472d['fMTNU'])&&_0xf6472d['bYpFO'](_0x3d27f6[_0x42f325(0x1d0)],_0xf6472d['duGYJ'])){const _0x6ab781={};return _0x6ab781[_0x42f325(0x1a8)]=!![],_0x6ab781[_0x42f325(0x1b8)]=[_0x3d27f6],_0x6ab781[_0x42f325(0x169)]=this[_0x42f325(0x1ae)],_0x6ab781;}this['queue'][_0x42f325(0x18b)](_0x3d27f6);let _0x221067=null;const _0x45d631=this[_0x42f325(0x1a8)]();_0x45d631&&(_0xf6472d[_0x42f325(0x166)](trace,_0xf6472d[_0x42f325(0x1c8)]),_0x221067=this[_0x42f325(0x188)][_0x42f325(0x191)](0x0,BATCH_SIZE),this[_0x42f325(0x188)][_0x42f325(0x1d2)](0x0,BATCH_SIZE),this[_0x42f325(0x175)]());const _0x2a1fcf={};return _0x2a1fcf[_0x42f325(0x1a8)]=_0x45d631,_0x2a1fcf['proceedWithData']=_0x221067,_0x2a1fcf[_0x42f325(0x169)]=this[_0x42f325(0x1b2)],_0x2a1fcf;}const _0x556d5d={};return _0x556d5d[_0x42f325(0x1a8)]=!![],_0x556d5d;};['shutdown']=async()=>{const _0x229da4=a128_0x1a3027,_0x2313c3={'ocuHU':_0x229da4(0x199),'zJNnG':function(_0x27badd,_0x3db33c){return _0x27badd>_0x3db33c;},'wYrcD':_0x229da4(0x1b7),'FSMau':function(_0x27bbe6,_0x53d3cf){return _0x27bbe6>_0x53d3cf;},'EwRzL':function(_0xbc3cd5,_0x4088df){return _0xbc3cd5(_0x4088df);}};await this[_0x229da4(0x1b5)](),this[_0x229da4(0x172)](_0x2313c3[_0x229da4(0x1a3)]);while(_0x2313c3[_0x229da4(0x17d)](this[_0x229da4(0x188)][_0x229da4(0x18a)],0x0)){const _0x4638d9=this[_0x229da4(0x188)][_0x229da4(0x191)](0x0,BATCH_SIZE);this[_0x229da4(0x188)][_0x229da4(0x1d2)](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x229da4(0x1b2)],_0x2313c3[_0x229da4(0x17f)],_0x4638d9);}_0x2313c3['FSMau'](this[_0x229da4(0x1c0)],0x0)&&_0x2313c3[_0x229da4(0x17a)](debug,_0x229da4(0x183)+this[_0x229da4(0x1c0)]);};[a128_0x1a3027(0x17c)]=async(_0x31c04d,_0x44973c,_0x46a2de)=>{const _0x45a001=a128_0x1a3027,_0xf4ec36={'ZtvVU':function(_0x256f1a,_0x498b32){return _0x256f1a(_0x498b32);},'tXiSp':'utf8','dCNqK':function(_0x212f4b){return _0x212f4b();},'rWtaY':function(_0x382ec4,_0xe92946,_0x2c6d28,_0x5625b2,_0xee12f7){return _0x382ec4(_0xe92946,_0x2c6d28,_0x5625b2,_0xee12f7);},'eCqoG':_0x45a001(0x1be),'XpsMc':function(_0x3657d8,_0x4598d5){return _0x3657d8-_0x4598d5;},'ozLsE':function(_0x2bbae0,_0x32a251){return _0x2bbae0(_0x32a251);},'MWPmA':function(_0x3b0470,_0x27e2ae){return _0x3b0470-_0x27e2ae;}};let _0x1ace72='';try{_0x1ace72=_0x46a2de[_0x45a001(0x17e)](_0xf6154f=>'\x27'+_0xf6154f['event_type']+'\x27:'+(nestedKeyValue(_0xf6154f,[_0x45a001(0x1c9),_0x45a001(0x170)])||nestedKeyValue(_0xf6154f,[_0x45a001(0x184),'uuid'])))[_0x45a001(0x174)](','),_0xf4ec36['ZtvVU'](debug,_0x45a001(0x16a)+_0x44973c+'.\x20Request\x20Size\x20-\x20'+Buffer[_0x45a001(0x1c2)](util[_0x45a001(0x197)]('%j',_0x46a2de),_0xf4ec36[_0x45a001(0x167)])+_0x45a001(0x189)+_0x1ace72);}catch(_0x4010ff){_0xf4ec36['ZtvVU'](debug,'Exception\x20in\x20logging\x20batch\x20events\x20--\x20'+util[_0x45a001(0x197)](_0x4010ff)+'}');}const _0x3a2110={'headers':_0xf4ec36[_0x45a001(0x1cc)](getDefaultHeaders)};try{const _0x43e17f=await _0xf4ec36['rWtaY'](nodeRequest,_0xf4ec36['eCqoG'],_0x31c04d,_0x46a2de,_0x3a2110);if(_0x43e17f[_0x45a001(0x1af)][_0x45a001(0x182)]){const _0x38c451={};_0x38c451['message']=_0x43e17f[_0x45a001(0x1af)]['error'];throw _0x38c451;}else _0xf4ec36[_0x45a001(0x1cb)](debug,_0x44973c+_0x45a001(0x1ba)+_0x1ace72+'\x20--\x20'+util[_0x45a001(0x197)]('%j',_0x43e17f['data'])),this[_0x45a001(0x1c0)]=Math[_0x45a001(0x1a1)](0x0,_0xf4ec36[_0x45a001(0x16f)](this[_0x45a001(0x1c0)],_0x46a2de[_0x45a001(0x18a)]));}catch(_0x5cb8b1){_0x5cb8b1['response']?_0xf4ec36[_0x45a001(0x186)](debug,_0x45a001(0x1ab)+_0x44973c+_0x45a001(0x192)+constants[_0x45a001(0x1c1)]+_0x45a001(0x187)+_0x5cb8b1[_0x45a001(0x18d)][_0x45a001(0x171)]+'\x20'+_0x5cb8b1['response'][_0x45a001(0x1ce)]+'\x20'+util[_0x45a001(0x197)]('%j',_0x5cb8b1[_0x45a001(0x18d)])):_0xf4ec36[_0x45a001(0x1cb)](debug,'EXCEPTION\x20IN\x20'+_0x44973c+_0x45a001(0x192)+constants['TEST_REPORTING_ANALYTICS']+_0x45a001(0x187)+(_0x5cb8b1[_0x45a001(0x177)]||_0x5cb8b1)),this[_0x45a001(0x1c0)]=Math['max'](0x0,_0xf4ec36[_0x45a001(0x18f)](this[_0x45a001(0x1c0)],_0x46a2de[_0x45a001(0x18a)]));}};[a128_0x1a3027(0x190)]=()=>{const _0x317aa2=a128_0x1a3027,_0x28c1ab={'ZUodn':function(_0x32caca,_0x2b17b3){return _0x32caca>_0x2b17b3;},'NhtWv':function(_0x4f01c0,_0x5c611c){return _0x4f01c0(_0x5c611c);},'dSDoO':_0x317aa2(0x1cf),'Bzdvs':function(_0x25c21e,_0x5392d7,_0x4b0cce){return _0x25c21e(_0x5392d7,_0x4b0cce);}};this[_0x317aa2(0x1bf)]=_0x28c1ab[_0x317aa2(0x1ad)](setInterval,async()=>{const _0x5cab27=_0x317aa2;if(_0x28c1ab['ZUodn'](this[_0x5cab27(0x188)][_0x5cab27(0x18a)],0x0)){_0x28c1ab[_0x5cab27(0x1d8)](trace,_0x5cab27(0x1b3)+this['queue'][_0x5cab27(0x18a)]);const _0x5883b2=this[_0x5cab27(0x188)][_0x5cab27(0x191)](0x0,BATCH_SIZE);this[_0x5cab27(0x188)][_0x5cab27(0x1d2)](0x0,BATCH_SIZE),await this[_0x5cab27(0x17c)](this[_0x5cab27(0x1b2)],_0x28c1ab[_0x5cab27(0x1c5)],_0x5883b2),_0x28c1ab[_0x5cab27(0x1d8)](trace,_0x5cab27(0x1a2)+this[_0x5cab27(0x188)][_0x5cab27(0x18a)]);}},BATCH_INTERVAL);};[a128_0x1a3027(0x175)]=()=>{const _0xeb4fac=a128_0x1a3027,_0x4ab012={};_0x4ab012[_0xeb4fac(0x1b6)]='RESETTING';const _0x209cb8=_0x4ab012;this[_0xeb4fac(0x172)](_0x209cb8['bPNPZ']),this['startEventBatchPolling']();};['removeEventBatchPolling']=_0x28ba49=>{const _0xb1e39d=a128_0x1a3027,_0x2f6666={'STqwL':function(_0x31e965,_0x492ec0){return _0x31e965(_0x492ec0);},'uRqOM':function(_0x1d0e6e,_0x5da6a5){return _0x1d0e6e===_0x5da6a5;},'GtkEQ':'REMOVING'};this[_0xb1e39d(0x1bf)]&&(_0x2f6666['STqwL'](clearInterval,this['pollEventBatchInterval']),this[_0xb1e39d(0x1bf)]=null,_0x2f6666[_0xb1e39d(0x19f)](_0x28ba49,_0x2f6666['GtkEQ'])&&(this[_0xb1e39d(0x179)]=![]));};['shouldProceed']=()=>{const _0x545748=a128_0x1a3027,_0x30116d={};_0x30116d[_0x545748(0x1d3)]=function(_0x5a9275,_0x4c961f){return _0x5a9275>=_0x4c961f;};const _0x4fc03e=_0x30116d;return _0x4fc03e['wMeos'](this[_0x545748(0x188)][_0x545748(0x18a)],BATCH_SIZE);};async[a128_0x1a3027(0x1b5)](_0xaca9f7=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x1fadf7=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x97d251=a128_0x1a3027,_0x4d77d7={'lqbSm':function(_0x4e0d5a,_0x52bc01){return _0x4e0d5a<=_0x52bc01;},'dAjtg':function(_0x5b5439,_0x1f0c8e){return _0x5b5439<=_0x1f0c8e;},'idVBp':function(_0x2d9291,_0x543b2d){return _0x2d9291(_0x543b2d);},'XfQrD':function(_0x405c7b,_0x4d887b){return _0x405c7b-_0x4d887b;}};if(_0x4d77d7[_0x97d251(0x18e)](this[_0x97d251(0x1c0)],0x0)||_0x4d77d7[_0x97d251(0x18c)](_0xaca9f7,0x0))return;return await _0x4d77d7[_0x97d251(0x16b)](sleep,_0x1fadf7),this[_0x97d251(0x1b5)](_0x4d77d7[_0x97d251(0x1bd)](_0xaca9f7,_0x1fadf7));}}module[a128_0x1a3027(0x196)]=RequestQueueHandler;