const a86_0x565e6d=a86_0x5872;(function(_0x2259b9,_0x13b292){const _0x53316e=a86_0x5872,_0x3cb60a=_0x2259b9();while(!![]){try{const _0x341980=-parseInt(_0x53316e(0x1bd))/0x1*(parseInt(_0x53316e(0x186))/0x2)+-parseInt(_0x53316e(0x1c9))/0x3*(parseInt(_0x53316e(0x1ad))/0x4)+-parseInt(_0x53316e(0x188))/0x5+-parseInt(_0x53316e(0x18b))/0x6*(-parseInt(_0x53316e(0x1c7))/0x7)+-parseInt(_0x53316e(0x17d))/0x8+-parseInt(_0x53316e(0x185))/0x9*(parseInt(_0x53316e(0x179))/0xa)+parseInt(_0x53316e(0x1ab))/0xb*(parseInt(_0x53316e(0x161))/0xc);if(_0x341980===_0x13b292)break;else _0x3cb60a['push'](_0x3cb60a['shift']());}catch(_0x3141ad){_0x3cb60a['push'](_0x3cb60a['shift']());}}}(a86_0x91b8,0x932ab));function a86_0x5872(_0x353304,_0x58730f){const _0x91b81b=a86_0x91b8();return a86_0x5872=function(_0x58722e,_0x2102dc){_0x58722e=_0x58722e-0x160;let _0x1dc1c1=_0x91b81b[_0x58722e];return _0x1dc1c1;},a86_0x5872(_0x353304,_0x58730f);}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a86_0x565e6d(0x192)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require('../helper'),util=require(a86_0x565e6d(0x1a5));function a86_0x91b8(){const _0x4a6176=['mjvXj','PBdbM','BATCH_EVENT_TYPES','pendingUploads','xfXzd','lqVHC','\x20event\x20successful\x20for\x20events\x20','Remaining\x20Queue\x20Length\x20-\x20','shutdown','HookRunStarted','YOvpZ','bnzUz','1382CnyGkE','byteLength','data','\x20--\x20','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','queue','split','nRpLo','GNeeX','event_type','238SRnzRx','api/v1/batch','283941QUQHDZ','logs','TEST_SCREENSHOT','uIQtI','statusText','proceedWithData','RESETTING','resetEventBatchPolling','PxMpE','HookRunFinished','Processing\x20events.\x20Queue\x20Length\x20-\x20','EXCEPTION\x20IN\x20','enCxH','2220CkeNOr','removeEventBatchPolling','hook_run','Processing\x20batch\x20events\x20for\x20','join','exports','rhuIh','REMOVING','TestRunStarted','slice','GPozV','push','instance','add','DeCwT','max','qtXOQ','includes','.\x20Request\x20Size\x20-\x20','started','PKxWS','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','Knbwg','getInstance','10kYIoEU','TestRunSkipped','CcdAr','FDEDl','6672648EeXmIy','eventUrl','Shutdown-Queue','bpSIa','0|5|3|6|4|1|2','upload-attachments','gYmBe','status','3434679AQgtxn','1468gzBOEw','vZfSU','4933600MVchpv','utf8','pollEventBatchInterval','67866mSpIaV','YFbMG','GqlEJ','batchAndPostEvents','HDfDi','tQsay','oErHz','./constants','ClyQY','startEventBatchPolling','shouldProceed','qaQvL','POST','screenshotEventUrl','lEqIy','kind','message','pVIhy','PTUhX','ackXs','response','format','proceedWithUrl','uuid','splice','RzhlL','util','Interval-Queue','length','MAhNL','api/v1/screenshots','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','215501SbpTsZ','uploadPending','8tHxlrW','Zzqay','TestRunFinished','uploadAttachmentUrl'];a86_0x91b8=function(){return _0x4a6176;};return a86_0x91b8();}class RequestQueueHandler{static [a86_0x565e6d(0x16d)];[a86_0x565e6d(0x1b4)]=0x0;constructor(){const _0x418946=a86_0x565e6d,_0x3e632e={};_0x3e632e[_0x418946(0x180)]=_0x418946(0x181),_0x3e632e['lEqIy']='LogCreated',_0x3e632e[_0x418946(0x16f)]='CBTSessionCreated',_0x3e632e[_0x418946(0x1c5)]=_0x418946(0x1af),_0x3e632e[_0x418946(0x187)]=_0x418946(0x17a),_0x3e632e[_0x418946(0x18c)]=_0x418946(0x1d2),_0x3e632e[_0x418946(0x183)]=_0x418946(0x169),_0x3e632e[_0x418946(0x1b2)]=_0x418946(0x1ba),_0x3e632e[_0x418946(0x1bb)]=_0x418946(0x1c8),_0x3e632e['tQsay']=_0x418946(0x182),_0x3e632e[_0x418946(0x171)]=_0x418946(0x1a9);const _0x2d59a7=_0x3e632e,_0x45327e=_0x2d59a7['bpSIa'][_0x418946(0x1c3)]('|');let _0x587322=0x0;while(!![]){switch(_0x45327e[_0x587322++]){case'0':this[_0x418946(0x1c2)]=[];continue;case'1':this[_0x418946(0x1b3)]=[_0x2d59a7[_0x418946(0x199)],_0x2d59a7[_0x418946(0x16f)],_0x2d59a7['GNeeX'],_0x2d59a7[_0x418946(0x187)],_0x2d59a7[_0x418946(0x18c)],_0x2d59a7['gYmBe'],_0x2d59a7['PBdbM']];continue;case'2':this['pollEventBatchInterval']=null;continue;case'3':this[_0x418946(0x17e)]=_0x2d59a7[_0x418946(0x1bb)];continue;case'4':this['uploadAttachmentUrl']=_0x2d59a7[_0x418946(0x190)];continue;case'5':this[_0x418946(0x174)]=![];continue;case'6':this['screenshotEventUrl']=_0x2d59a7[_0x418946(0x171)];continue;}break;}}static[a86_0x565e6d(0x178)](){const _0x4bf1c1=a86_0x565e6d;return!RequestQueueHandler['instance']&&(RequestQueueHandler[_0x4bf1c1(0x16d)]=new RequestQueueHandler()),RequestQueueHandler['instance'];}['start']=()=>{const _0x4f9eff=a86_0x565e6d;!this['started']&&(this[_0x4f9eff(0x174)]=!![],this[_0x4f9eff(0x194)]());};[a86_0x565e6d(0x16e)]=_0xaa57f9=>{const _0x8ebbe8=a86_0x565e6d,_0x1ec4b6={'pVIhy':function(_0x585099,_0x3feeb0){return _0x585099===_0x3feeb0;},'CcdAr':_0x8ebbe8(0x1cb),'JlKxV':function(_0x4a1ba4,_0x1b2641){return _0x4a1ba4>_0x1b2641;},'PTUhX':'TEST_ATTACHMENT','rhuIh':function(_0xf247f0,_0x5b30de){return _0xf247f0!==_0x5b30de;},'PKxWS':_0x8ebbe8(0x1af),'enCxH':function(_0x22e7e8,_0x1f0486){return _0x22e7e8(_0x1f0486);},'qaQvL':_0x8ebbe8(0x1c1)};if(this[_0x8ebbe8(0x1b3)][_0x8ebbe8(0x172)](_0xaa57f9[_0x8ebbe8(0x1c6)])){if(_0xaa57f9[_0x8ebbe8(0x1ca)]&&_0xaa57f9['logs'][0x0]&&_0x1ec4b6[_0x8ebbe8(0x19c)](_0xaa57f9[_0x8ebbe8(0x1ca)][0x0]['kind'],_0x1ec4b6[_0x8ebbe8(0x17b)])){const _0x3c421f={};return _0x3c421f[_0x8ebbe8(0x195)]=!![],_0x3c421f['proceedWithData']=[_0xaa57f9],_0x3c421f['proceedWithUrl']=this[_0x8ebbe8(0x198)],_0x3c421f;}if(_0xaa57f9['logs']&&_0x1ec4b6['JlKxV'](_0xaa57f9['logs'][_0x8ebbe8(0x1a7)],0x0)&&_0x1ec4b6[_0x8ebbe8(0x19c)](_0xaa57f9[_0x8ebbe8(0x1ca)][0x0][_0x8ebbe8(0x19a)],_0x1ec4b6[_0x8ebbe8(0x19d)])&&_0x1ec4b6[_0x8ebbe8(0x167)](_0xaa57f9['event_type'],_0x1ec4b6[_0x8ebbe8(0x175)])){const _0x5a2156={};return _0x5a2156[_0x8ebbe8(0x195)]=!![],_0x5a2156['proceedWithData']=[_0xaa57f9],_0x5a2156[_0x8ebbe8(0x1a1)]=this[_0x8ebbe8(0x1b0)],_0x5a2156;}this[_0x8ebbe8(0x1c2)][_0x8ebbe8(0x16c)](_0xaa57f9);let _0x3acf83=null;const _0x2721c5=this[_0x8ebbe8(0x195)]();_0x2721c5&&(_0x1ec4b6[_0x8ebbe8(0x160)](trace,_0x1ec4b6[_0x8ebbe8(0x196)]),_0x3acf83=this[_0x8ebbe8(0x1c2)][_0x8ebbe8(0x16a)](0x0,BATCH_SIZE),this[_0x8ebbe8(0x1c2)][_0x8ebbe8(0x1a3)](0x0,BATCH_SIZE),this[_0x8ebbe8(0x1d0)]());const _0x2a9f05={};return _0x2a9f05['shouldProceed']=_0x2721c5,_0x2a9f05[_0x8ebbe8(0x1ce)]=_0x3acf83,_0x2a9f05['proceedWithUrl']=this[_0x8ebbe8(0x17e)],_0x2a9f05;}const _0x4c6333={};return _0x4c6333['shouldProceed']=!![],_0x4c6333;};[a86_0x565e6d(0x1b9)]=async()=>{const _0x2e1f8d=a86_0x565e6d,_0x3c9137={'oErHz':_0x2e1f8d(0x168),'ackXs':function(_0x17f858,_0x23ae3b){return _0x17f858>_0x23ae3b;},'bnzUz':_0x2e1f8d(0x17f),'zQIWJ':function(_0x602902,_0x1e4a4d){return _0x602902(_0x1e4a4d);}};await this['uploadPending'](),this[_0x2e1f8d(0x162)](_0x3c9137[_0x2e1f8d(0x191)]);while(_0x3c9137['ackXs'](this[_0x2e1f8d(0x1c2)][_0x2e1f8d(0x1a7)],0x0)){const _0x4e4c99=this['queue'][_0x2e1f8d(0x16a)](0x0,BATCH_SIZE);this[_0x2e1f8d(0x1c2)][_0x2e1f8d(0x1a3)](0x0,BATCH_SIZE),await this[_0x2e1f8d(0x18e)](this[_0x2e1f8d(0x17e)],_0x3c9137[_0x2e1f8d(0x1bc)],_0x4e4c99);}_0x3c9137[_0x2e1f8d(0x19e)](this[_0x2e1f8d(0x1b4)],0x0)&&_0x3c9137['zQIWJ'](debug,_0x2e1f8d(0x176)+this[_0x2e1f8d(0x1b4)]);};[a86_0x565e6d(0x18e)]=async(_0x206730,_0x183ae2,_0x568e77)=>{const _0x1281bc=a86_0x565e6d,_0x5da08e={'Knbwg':function(_0x5efbbb,_0x37ed3d){return _0x5efbbb(_0x37ed3d);},'MAhNL':_0x1281bc(0x189),'NLVml':function(_0x2510ee){return _0x2510ee();},'lqVHC':function(_0x512596,_0x10b0ca,_0x3228d0,_0x17184d,_0x210557){return _0x512596(_0x10b0ca,_0x3228d0,_0x17184d,_0x210557);},'AYpTa':_0x1281bc(0x197),'PxMpE':function(_0x2f02f6,_0x3daddf){return _0x2f02f6-_0x3daddf;},'GqlEJ':function(_0x12eb30,_0x3017ea){return _0x12eb30(_0x3017ea);}};let _0x485c8d='';try{_0x485c8d=_0x568e77['map'](_0x5b822c=>'\x27'+_0x5b822c[_0x1281bc(0x1c6)]+'\x27:'+(nestedKeyValue(_0x5b822c,['test_run','uuid'])||nestedKeyValue(_0x5b822c,[_0x1281bc(0x163),_0x1281bc(0x1a2)])))[_0x1281bc(0x165)](','),_0x5da08e[_0x1281bc(0x177)](debug,_0x1281bc(0x164)+_0x183ae2+_0x1281bc(0x173)+Buffer[_0x1281bc(0x1be)](util[_0x1281bc(0x1a0)]('%j',_0x568e77),_0x5da08e[_0x1281bc(0x1a8)])+'\x20bytes.\x20Events\x20are\x20'+_0x485c8d);}catch(_0x3ea4f8){_0x5da08e[_0x1281bc(0x177)](debug,'Exception\x20in\x20logging\x20batch\x20events\x20--\x20'+util[_0x1281bc(0x1a0)](_0x3ea4f8)+'}');}const _0x341e22={'headers':_0x5da08e['NLVml'](getDefaultHeaders)};try{const _0x3bacd9=await _0x5da08e[_0x1281bc(0x1b6)](nodeRequest,_0x5da08e['AYpTa'],_0x206730,_0x568e77,_0x341e22);if(_0x3bacd9[_0x1281bc(0x1bf)]['error']){const _0x457d09={};_0x457d09[_0x1281bc(0x19b)]=_0x3bacd9[_0x1281bc(0x1bf)]['error'];throw _0x457d09;}else _0x5da08e['Knbwg'](debug,_0x183ae2+_0x1281bc(0x1b7)+_0x485c8d+_0x1281bc(0x1c0)+util[_0x1281bc(0x1a0)]('%j',_0x3bacd9[_0x1281bc(0x1bf)])),this[_0x1281bc(0x1b4)]=Math[_0x1281bc(0x170)](0x0,_0x5da08e[_0x1281bc(0x1d1)](this['pendingUploads'],_0x568e77[_0x1281bc(0x1a7)]));}catch(_0x1fe94e){_0x1fe94e[_0x1281bc(0x19f)]?_0x5da08e[_0x1281bc(0x18d)](debug,_0x1281bc(0x1d4)+_0x183ae2+_0x1281bc(0x1aa)+_0x1fe94e[_0x1281bc(0x19f)][_0x1281bc(0x184)]+'\x20'+_0x1fe94e[_0x1281bc(0x19f)][_0x1281bc(0x1cd)]+'\x20'+util[_0x1281bc(0x1a0)]('%j',_0x1fe94e['response'])):_0x5da08e[_0x1281bc(0x18d)](debug,_0x1281bc(0x1d4)+_0x183ae2+_0x1281bc(0x1aa)+(_0x1fe94e[_0x1281bc(0x19b)]||_0x1fe94e)),this[_0x1281bc(0x1b4)]=Math[_0x1281bc(0x170)](0x0,_0x5da08e[_0x1281bc(0x1d1)](this[_0x1281bc(0x1b4)],_0x568e77[_0x1281bc(0x1a7)]));}};[a86_0x565e6d(0x194)]=()=>{const _0x39a6f7=a86_0x565e6d,_0x45606b={'FDEDl':function(_0x387636,_0x1c92aa){return _0x387636>_0x1c92aa;},'xfXzd':function(_0x551ae4,_0x1458ed){return _0x551ae4(_0x1458ed);},'nRpLo':_0x39a6f7(0x1a6),'BzwuI':function(_0x14540b,_0x3546db){return _0x14540b(_0x3546db);},'HDfDi':function(_0x2f3517,_0x1a134b,_0x41a3cd){return _0x2f3517(_0x1a134b,_0x41a3cd);}};this[_0x39a6f7(0x18a)]=_0x45606b[_0x39a6f7(0x18f)](setInterval,async()=>{const _0x283d75=_0x39a6f7;if(_0x45606b[_0x283d75(0x17c)](this[_0x283d75(0x1c2)][_0x283d75(0x1a7)],0x0)){_0x45606b[_0x283d75(0x1b5)](trace,_0x283d75(0x1d3)+this[_0x283d75(0x1c2)][_0x283d75(0x1a7)]);const _0x1abe44=this[_0x283d75(0x1c2)][_0x283d75(0x16a)](0x0,BATCH_SIZE);this[_0x283d75(0x1c2)][_0x283d75(0x1a3)](0x0,BATCH_SIZE),await this[_0x283d75(0x18e)](this[_0x283d75(0x17e)],_0x45606b[_0x283d75(0x1c4)],_0x1abe44),_0x45606b['BzwuI'](trace,_0x283d75(0x1b8)+this[_0x283d75(0x1c2)][_0x283d75(0x1a7)]);}},BATCH_INTERVAL);};[a86_0x565e6d(0x1d0)]=()=>{const _0x4873b0=a86_0x565e6d,_0x1a8ae2={};_0x1a8ae2['orrho']=_0x4873b0(0x1cf);const _0x8551bb=_0x1a8ae2;this[_0x4873b0(0x162)](_0x8551bb['orrho']),this[_0x4873b0(0x194)]();};[a86_0x565e6d(0x162)]=_0x374964=>{const _0x897ef4=a86_0x565e6d,_0x285f94={'uIQtI':function(_0x153a9a,_0x10e8c9){return _0x153a9a(_0x10e8c9);},'Zzqay':function(_0x223dd1,_0x307597){return _0x223dd1===_0x307597;},'ClyQY':_0x897ef4(0x168)};this['pollEventBatchInterval']&&(_0x285f94[_0x897ef4(0x1cc)](clearInterval,this[_0x897ef4(0x18a)]),this[_0x897ef4(0x18a)]=null,_0x285f94[_0x897ef4(0x1ae)](_0x374964,_0x285f94[_0x897ef4(0x193)])&&(this[_0x897ef4(0x174)]=![]));};[a86_0x565e6d(0x195)]=()=>{const _0x19d542=a86_0x565e6d,_0x10cbf3={};_0x10cbf3['GPozV']=function(_0x2fdfa4,_0x33a3ca){return _0x2fdfa4>=_0x33a3ca;};const _0x2ba0f1=_0x10cbf3;return _0x2ba0f1[_0x19d542(0x16b)](this[_0x19d542(0x1c2)][_0x19d542(0x1a7)],BATCH_SIZE);};async[a86_0x565e6d(0x1ac)](_0x57d57b=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x5e1dc9=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x5427ce=a86_0x565e6d,_0x89dac0={'mjvXj':function(_0x5a6cf0,_0x47fe64){return _0x5a6cf0<=_0x47fe64;},'RzhlL':function(_0x2f159a,_0x507eb1){return _0x2f159a<=_0x507eb1;},'SCnQN':function(_0x3c6e97,_0xf2d737){return _0x3c6e97(_0xf2d737);},'Abmxf':function(_0x40db0c,_0x31a807){return _0x40db0c-_0x31a807;}};if(_0x89dac0[_0x5427ce(0x1b1)](this[_0x5427ce(0x1b4)],0x0)||_0x89dac0[_0x5427ce(0x1a4)](_0x57d57b,0x0))return;return await _0x89dac0['SCnQN'](sleep,_0x5e1dc9),this[_0x5427ce(0x1ac)](_0x89dac0['Abmxf'](_0x57d57b,_0x5e1dc9));}}module[a86_0x565e6d(0x166)]=RequestQueueHandler;