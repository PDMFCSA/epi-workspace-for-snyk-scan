const a86_0x49574a=a86_0x59c7;(function(_0x42d14b,_0x32df54){const _0xd5f1f0=a86_0x59c7,_0x3f3986=_0x42d14b();while(!![]){try{const _0x396dac=-parseInt(_0xd5f1f0(0x1c2))/0x1*(parseInt(_0xd5f1f0(0x195))/0x2)+parseInt(_0xd5f1f0(0x1a8))/0x3*(parseInt(_0xd5f1f0(0x1e5))/0x4)+-parseInt(_0xd5f1f0(0x1b7))/0x5+-parseInt(_0xd5f1f0(0x1ce))/0x6+-parseInt(_0xd5f1f0(0x1ae))/0x7*(-parseInt(_0xd5f1f0(0x1b1))/0x8)+-parseInt(_0xd5f1f0(0x18f))/0x9+parseInt(_0xd5f1f0(0x1a0))/0xa;if(_0x396dac===_0x32df54)break;else _0x3f3986['push'](_0x3f3986['shift']());}catch(_0x144700){_0x3f3986['push'](_0x3f3986['shift']());}}}(a86_0x5579,0x7a111));function a86_0x59c7(_0x54afda,_0x4bd4b1){const _0x5579f7=a86_0x5579();return a86_0x59c7=function(_0x59c70e,_0x39f134){_0x59c70e=_0x59c70e-0x182;let _0x56dbc3=_0x5579f7[_0x59c70e];return _0x56dbc3;},a86_0x59c7(_0x54afda,_0x4bd4b1);}function a86_0x5579(){const _0x3837ee=['ugFsl','16828QBnaME','queue','SbKPl','eventUrl','split','splice','mJNLe','bPquy','OGcmD','\x20bytes.\x20Events\x20are\x20','Processing\x20events.\x20Queue\x20Length\x20-\x20','format','logs','status','batchAndPostEvents','pendingUploads','error','instance','WLaXR','\x20event\x20successful\x20for\x20events\x20','kJAZS','test_run','api/v1/screenshots','getInstance','BATCH_EVENT_TYPES','1397754YwPPNA','started','3|4|0|5|2|6|1','CBTSessionCreated','.\x20Request\x20Size\x20-\x20','add','1088ZZLiGF','startEventBatchPolling','Interval-Queue','xzByt','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','pollEventBatchInterval','vrcdw','uuid','dyAEz','POST','message','6277170SbQzXK','PuyFx','YXusx','shouldProceed','utf8','upload-attachments','kind','removeEventBatchPolling','426siIlYD','vDFTm','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','mTsjo','proceedWithUrl','start','28DrMqrj','length','ZBUmo','491032tUwTfZ','slice','lwauL','goTGw','proceedWithData','jfEVU','84415jOaNSF','data','WcTFX','REMOVING','oRvTI','wEygB','TestRunSkipped','hook_run','taODn','util','\x20--\x20','634bPFmdO','IfSwq','XXEbD','event_type','uploadAttachmentUrl','max','TestRunFinished','QLQmv','MHXal','yNMXY','xCVVc','pFGcv','2721342GmyfKg','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','jqDpY','JbKKg','uploadPending','MKIzC','DsoHU','TEST_SCREENSHOT','YqXHZ','byteLength','push','EXCEPTION\x20IN\x20','../helper','exports','response','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','rpuYc','zocsy','qQCAj','IwTCD','BMnqG','screenshotEventUrl'];a86_0x5579=function(){return _0x3837ee;};return a86_0x5579();}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require('./constants'),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require(a86_0x49574a(0x1da)),util=require(a86_0x49574a(0x1c0));class RequestQueueHandler{static [a86_0x49574a(0x187)];[a86_0x49574a(0x185)]=0x0;constructor(){const _0x3c1adf=a86_0x49574a,_0xdd3872={};_0xdd3872['jfEVU']=_0x3c1adf(0x191),_0xdd3872['rpuYc']='api/v1/batch',_0xdd3872[_0x3c1adf(0x1cb)]=_0x3c1adf(0x1a5),_0xdd3872[_0x3c1adf(0x1ed)]=_0x3c1adf(0x18c),_0xdd3872[_0x3c1adf(0x1e0)]='LogCreated',_0xdd3872[_0x3c1adf(0x1a2)]=_0x3c1adf(0x192),_0xdd3872[_0x3c1adf(0x198)]=_0x3c1adf(0x1c8),_0xdd3872[_0x3c1adf(0x1d0)]=_0x3c1adf(0x1bd),_0xdd3872['WfXos']='HookRunFinished',_0xdd3872[_0x3c1adf(0x1e4)]='TestRunStarted',_0xdd3872[_0x3c1adf(0x1d1)]='HookRunStarted';const _0x403718=_0xdd3872,_0x4f2992=_0x403718[_0x3c1adf(0x1b6)][_0x3c1adf(0x1e9)]('|');let _0x2d2539=0x0;while(!![]){switch(_0x4f2992[_0x2d2539++]){case'0':this[_0x3c1adf(0x1e8)]=_0x403718[_0x3c1adf(0x1de)];continue;case'1':this[_0x3c1adf(0x19a)]=null;continue;case'2':this[_0x3c1adf(0x1c6)]=_0x403718['yNMXY'];continue;case'3':this[_0x3c1adf(0x1e6)]=[];continue;case'4':this['started']=![];continue;case'5':this['screenshotEventUrl']=_0x403718['OGcmD'];continue;case'6':this[_0x3c1adf(0x18e)]=[_0x403718[_0x3c1adf(0x1e0)],_0x403718[_0x3c1adf(0x1a2)],_0x403718[_0x3c1adf(0x198)],_0x403718['jqDpY'],_0x403718['WfXos'],_0x403718[_0x3c1adf(0x1e4)],_0x403718[_0x3c1adf(0x1d1)]];continue;}break;}}static[a86_0x49574a(0x18d)](){const _0x1ebadf=a86_0x49574a;return!RequestQueueHandler[_0x1ebadf(0x187)]&&(RequestQueueHandler['instance']=new RequestQueueHandler()),RequestQueueHandler[_0x1ebadf(0x187)];}[a86_0x49574a(0x1ad)]=()=>{const _0x202605=a86_0x49574a;!this['started']&&(this['started']=!![],this[_0x202605(0x196)]());};[a86_0x49574a(0x194)]=_0x5b2016=>{const _0x490677=a86_0x49574a,_0x348e97={'mTsjo':function(_0x9b21fb,_0x2a6250){return _0x9b21fb===_0x2a6250;},'YQzfK':_0x490677(0x1d5),'mJNLe':function(_0x44a018,_0x266979){return _0x44a018>_0x266979;},'TTWbk':function(_0x37407f,_0x1cc04f){return _0x37407f===_0x1cc04f;},'ZBUmo':'TEST_ATTACHMENT','IwTCD':function(_0x2d0b52,_0x10a988){return _0x2d0b52!==_0x10a988;},'IfSwq':_0x490677(0x1c8),'DsoHU':function(_0x127c87,_0x4cb26f){return _0x127c87(_0x4cb26f);},'BMnqG':_0x490677(0x199)};if(this[_0x490677(0x18e)]['includes'](_0x5b2016[_0x490677(0x1c5)])){if(_0x5b2016[_0x490677(0x182)]&&_0x5b2016[_0x490677(0x182)][0x0]&&_0x348e97[_0x490677(0x1ab)](_0x5b2016[_0x490677(0x182)][0x0][_0x490677(0x1a6)],_0x348e97['YQzfK'])){const _0x1eae13={};return _0x1eae13[_0x490677(0x1a3)]=!![],_0x1eae13[_0x490677(0x1b5)]=[_0x5b2016],_0x1eae13['proceedWithUrl']=this[_0x490677(0x1e3)],_0x1eae13;}if(_0x5b2016[_0x490677(0x182)]&&_0x348e97[_0x490677(0x1eb)](_0x5b2016['logs'][_0x490677(0x1af)],0x0)&&_0x348e97['TTWbk'](_0x5b2016['logs'][0x0][_0x490677(0x1a6)],_0x348e97[_0x490677(0x1b0)])&&_0x348e97[_0x490677(0x1e1)](_0x5b2016[_0x490677(0x1c5)],_0x348e97[_0x490677(0x1c3)])){const _0x2e2eb0={};return _0x2e2eb0[_0x490677(0x1a3)]=!![],_0x2e2eb0[_0x490677(0x1b5)]=[_0x5b2016],_0x2e2eb0[_0x490677(0x1ac)]=this[_0x490677(0x1c6)],_0x2e2eb0;}this[_0x490677(0x1e6)][_0x490677(0x1d8)](_0x5b2016);let _0x32c43a=null;const _0xe93176=this[_0x490677(0x1a3)]();_0xe93176&&(_0x348e97[_0x490677(0x1d4)](trace,_0x348e97[_0x490677(0x1e2)]),_0x32c43a=this['queue']['slice'](0x0,BATCH_SIZE),this[_0x490677(0x1e6)][_0x490677(0x1ea)](0x0,BATCH_SIZE),this['resetEventBatchPolling']());const _0x6dce03={};return _0x6dce03[_0x490677(0x1a3)]=_0xe93176,_0x6dce03[_0x490677(0x1b5)]=_0x32c43a,_0x6dce03[_0x490677(0x1ac)]=this[_0x490677(0x1e8)],_0x6dce03;}const _0x4086fe={};return _0x4086fe[_0x490677(0x1a3)]=!![],_0x4086fe;};['shutdown']=async()=>{const _0x41ecb4=a86_0x49574a,_0x2d06a1={'goTGw':_0x41ecb4(0x1ba),'bPquy':function(_0x3e462a,_0x20d4d1){return _0x3e462a>_0x20d4d1;},'lMRNH':'Shutdown-Queue','zocsy':function(_0x286df1,_0x924cfb){return _0x286df1>_0x924cfb;},'ViCLj':function(_0x3fa2e0,_0x1798de){return _0x3fa2e0(_0x1798de);}};await this['uploadPending'](),this[_0x41ecb4(0x1a7)](_0x2d06a1[_0x41ecb4(0x1b4)]);while(_0x2d06a1[_0x41ecb4(0x1ec)](this[_0x41ecb4(0x1e6)][_0x41ecb4(0x1af)],0x0)){const _0x3cf31c=this['queue'][_0x41ecb4(0x1b2)](0x0,BATCH_SIZE);this[_0x41ecb4(0x1e6)]['splice'](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x41ecb4(0x1e8)],_0x2d06a1['lMRNH'],_0x3cf31c);}_0x2d06a1[_0x41ecb4(0x1df)](this[_0x41ecb4(0x185)],0x0)&&_0x2d06a1['ViCLj'](debug,_0x41ecb4(0x1aa)+this[_0x41ecb4(0x185)]);};['batchAndPostEvents']=async(_0x478777,_0x425aa,_0x2bf981)=>{const _0x35005d=a86_0x49574a,_0x98b273={'YqXHZ':function(_0x47d05b,_0x1b9cea){return _0x47d05b(_0x1b9cea);},'WLaXR':_0x35005d(0x1a4),'dyAEz':function(_0x483ea5,_0x2cad2c){return _0x483ea5(_0x2cad2c);},'iLJuW':function(_0x59f978){return _0x59f978();},'SbKPl':function(_0xf9c824,_0xeda38c,_0xfa380a,_0x5e3978,_0x49e016){return _0xf9c824(_0xeda38c,_0xfa380a,_0x5e3978,_0x49e016);},'WcTFX':_0x35005d(0x19e),'zxgZx':function(_0x500081,_0x428948){return _0x500081(_0x428948);},'kJAZS':function(_0x331519,_0x4d3f92){return _0x331519-_0x4d3f92;},'lwauL':function(_0x5f4080,_0x1a6c4b){return _0x5f4080(_0x1a6c4b);},'QLQmv':function(_0x2fda5f,_0x361487){return _0x2fda5f(_0x361487);}};let _0x426871='';try{_0x426871=_0x2bf981['map'](_0x5581d0=>'\x27'+_0x5581d0[_0x35005d(0x1c5)]+'\x27:'+(nestedKeyValue(_0x5581d0,[_0x35005d(0x18b),_0x35005d(0x19c)])||nestedKeyValue(_0x5581d0,[_0x35005d(0x1be),_0x35005d(0x19c)])))['join'](','),_0x98b273[_0x35005d(0x1d6)](debug,'Processing\x20batch\x20events\x20for\x20'+_0x425aa+_0x35005d(0x193)+Buffer[_0x35005d(0x1d7)](util[_0x35005d(0x1f0)]('%j',_0x2bf981),_0x98b273[_0x35005d(0x188)])+_0x35005d(0x1ee)+_0x426871);}catch(_0x32583a){_0x98b273[_0x35005d(0x19d)](debug,_0x35005d(0x1dd)+util[_0x35005d(0x1f0)](_0x32583a)+'}');}const _0x1c3e0e={'headers':_0x98b273['iLJuW'](getDefaultHeaders)};try{const _0x48c820=await _0x98b273[_0x35005d(0x1e7)](nodeRequest,_0x98b273[_0x35005d(0x1b9)],_0x478777,_0x2bf981,_0x1c3e0e);if(_0x48c820[_0x35005d(0x1b8)][_0x35005d(0x186)]){const _0x40c1c4={};_0x40c1c4['message']=_0x48c820[_0x35005d(0x1b8)][_0x35005d(0x186)];throw _0x40c1c4;}else _0x98b273['zxgZx'](debug,_0x425aa+_0x35005d(0x189)+_0x426871+_0x35005d(0x1c1)+util[_0x35005d(0x1f0)]('%j',_0x48c820['data'])),this['pendingUploads']=Math[_0x35005d(0x1c7)](0x0,_0x98b273[_0x35005d(0x18a)](this[_0x35005d(0x185)],_0x2bf981[_0x35005d(0x1af)]));}catch(_0x313c9b){_0x313c9b[_0x35005d(0x1dc)]?_0x98b273[_0x35005d(0x1b3)](debug,_0x35005d(0x1d9)+_0x425aa+'\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20'+_0x313c9b[_0x35005d(0x1dc)][_0x35005d(0x183)]+'\x20'+_0x313c9b[_0x35005d(0x1dc)]['statusText']+'\x20'+util['format']('%j',_0x313c9b['response'])):_0x98b273[_0x35005d(0x1c9)](debug,_0x35005d(0x1d9)+_0x425aa+_0x35005d(0x1cf)+(_0x313c9b[_0x35005d(0x19f)]||_0x313c9b)),this[_0x35005d(0x185)]=Math[_0x35005d(0x1c7)](0x0,_0x98b273[_0x35005d(0x18a)](this['pendingUploads'],_0x2bf981[_0x35005d(0x1af)]));}};[a86_0x49574a(0x196)]=()=>{const _0x5d94d2=a86_0x49574a,_0x1ec1fa={'oRvTI':function(_0x33a33d,_0x22d553){return _0x33a33d>_0x22d553;},'MHXal':function(_0xce25d5,_0x1ded12){return _0xce25d5(_0x1ded12);},'jlgdF':_0x5d94d2(0x197),'PuyFx':function(_0x563c4d,_0x55118,_0x496875){return _0x563c4d(_0x55118,_0x496875);}};this['pollEventBatchInterval']=_0x1ec1fa[_0x5d94d2(0x1a1)](setInterval,async()=>{const _0x8a5a2e=_0x5d94d2;if(_0x1ec1fa[_0x8a5a2e(0x1bb)](this['queue'][_0x8a5a2e(0x1af)],0x0)){_0x1ec1fa[_0x8a5a2e(0x1ca)](trace,_0x8a5a2e(0x1ef)+this[_0x8a5a2e(0x1e6)]['length']);const _0x328e1f=this[_0x8a5a2e(0x1e6)][_0x8a5a2e(0x1b2)](0x0,BATCH_SIZE);this['queue'][_0x8a5a2e(0x1ea)](0x0,BATCH_SIZE),await this[_0x8a5a2e(0x184)](this[_0x8a5a2e(0x1e8)],_0x1ec1fa['jlgdF'],_0x328e1f),_0x1ec1fa[_0x8a5a2e(0x1ca)](trace,'Remaining\x20Queue\x20Length\x20-\x20'+this[_0x8a5a2e(0x1e6)]['length']);}},BATCH_INTERVAL);};['resetEventBatchPolling']=()=>{const _0xe0e9bb=a86_0x49574a,_0x410587={};_0x410587[_0xe0e9bb(0x1a9)]='RESETTING';const _0x2cc781=_0x410587;this[_0xe0e9bb(0x1a7)](_0x2cc781[_0xe0e9bb(0x1a9)]),this['startEventBatchPolling']();};[a86_0x49574a(0x1a7)]=_0x1d8773=>{const _0x5683c0=a86_0x49574a,_0x3d5156={'taODn':function(_0x5d8b5b,_0x4a7322){return _0x5d8b5b(_0x4a7322);},'XXEbD':function(_0x1b41d6,_0x21f298){return _0x1b41d6===_0x21f298;},'pFGcv':'REMOVING'};this['pollEventBatchInterval']&&(_0x3d5156[_0x5683c0(0x1bf)](clearInterval,this[_0x5683c0(0x19a)]),this[_0x5683c0(0x19a)]=null,_0x3d5156[_0x5683c0(0x1c4)](_0x1d8773,_0x3d5156[_0x5683c0(0x1cd)])&&(this[_0x5683c0(0x190)]=![]));};[a86_0x49574a(0x1a3)]=()=>{const _0x282697=a86_0x49574a,_0x2e99db={};_0x2e99db[_0x282697(0x1bc)]=function(_0x5c018b,_0x121aae){return _0x5c018b>=_0x121aae;};const _0x36ccbe=_0x2e99db;return _0x36ccbe['wEygB'](this[_0x282697(0x1e6)][_0x282697(0x1af)],BATCH_SIZE);};async['uploadPending'](_0x15af6c=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x55d6f9=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x1137bd=a86_0x49574a,_0x1befc6={'vrcdw':function(_0x4baa64,_0x380d28){return _0x4baa64<=_0x380d28;},'xCVVc':function(_0x1a17ab,_0xa13d53){return _0x1a17ab(_0xa13d53);},'MKIzC':function(_0x3943d6,_0x5217ef){return _0x3943d6-_0x5217ef;}};if(_0x1befc6[_0x1137bd(0x19b)](this[_0x1137bd(0x185)],0x0)||_0x1befc6[_0x1137bd(0x19b)](_0x15af6c,0x0))return;return await _0x1befc6[_0x1137bd(0x1cc)](sleep,_0x55d6f9),this[_0x1137bd(0x1d2)](_0x1befc6[_0x1137bd(0x1d3)](_0x15af6c,_0x55d6f9));}}module[a86_0x49574a(0x1db)]=RequestQueueHandler;