const a118_0x4aab05=a118_0x2875;(function(_0x53a098,_0x519f74){const _0x28ebc1=a118_0x2875,_0x15ac76=_0x53a098();while(!![]){try{const _0x12abcd=-parseInt(_0x28ebc1(0x140))/0x1+-parseInt(_0x28ebc1(0x13c))/0x2*(-parseInt(_0x28ebc1(0x10c))/0x3)+-parseInt(_0x28ebc1(0xd0))/0x4+parseInt(_0x28ebc1(0x105))/0x5+parseInt(_0x28ebc1(0x123))/0x6*(parseInt(_0x28ebc1(0xfe))/0x7)+-parseInt(_0x28ebc1(0xc8))/0x8*(-parseInt(_0x28ebc1(0x124))/0x9)+-parseInt(_0x28ebc1(0xcc))/0xa;if(_0x12abcd===_0x519f74)break;else _0x15ac76['push'](_0x15ac76['shift']());}catch(_0x4289d8){_0x15ac76['push'](_0x15ac76['shift']());}}}(a118_0x5d33,0x5df04));function a118_0x2875(_0x43149b,_0x5a4654){const _0x5d33cf=a118_0x5d33();return a118_0x2875=function(_0x287523,_0x373dd0){_0x287523=_0x287523-0xc7;let _0x2b4e65=_0x5d33cf[_0x287523];return _0x2b4e65;},a118_0x2875(_0x43149b,_0x5a4654);}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a118_0x4aab05(0xe6)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require('../helper'),util=require(a118_0x4aab05(0x137)),constants=require(a118_0x4aab05(0x138));class RequestQueueHandler{static ['instance'];[a118_0x4aab05(0x131)]=0x0;constructor(){const _0x1733d5=a118_0x4aab05,_0x8b9d25={};_0x8b9d25[_0x1733d5(0x101)]=_0x1733d5(0xed),_0x8b9d25[_0x1733d5(0xe2)]='api/v1/screenshots',_0x8b9d25[_0x1733d5(0xfa)]=_0x1733d5(0xff),_0x8b9d25[_0x1733d5(0xf5)]=_0x1733d5(0xe5),_0x8b9d25[_0x1733d5(0x11e)]='LogCreated',_0x8b9d25[_0x1733d5(0xf6)]=_0x1733d5(0xfd),_0x8b9d25[_0x1733d5(0x12b)]=_0x1733d5(0x11a),_0x8b9d25[_0x1733d5(0x121)]=_0x1733d5(0x122),_0x8b9d25['NOpQT']=_0x1733d5(0x133),_0x8b9d25['nkyas']=_0x1733d5(0x104),_0x8b9d25['aTLsR']=_0x1733d5(0x10b);const _0x1d552b=_0x8b9d25,_0x41c843=_0x1d552b[_0x1733d5(0x101)][_0x1733d5(0xf8)]('|');let _0x4dde85=0x0;while(!![]){switch(_0x41c843[_0x4dde85++]){case'0':this[_0x1733d5(0x119)]=_0x1d552b[_0x1733d5(0xe2)];continue;case'1':this[_0x1733d5(0xd3)]=_0x1d552b['YIhzZ'];continue;case'2':this[_0x1733d5(0xdc)]=_0x1d552b[_0x1733d5(0xf5)];continue;case'3':this[_0x1733d5(0x114)]=[];continue;case'4':this['pollEventBatchInterval']=null;continue;case'5':this['started']=![];continue;case'6':this['BATCH_EVENT_TYPES']=[_0x1d552b['qjojH'],_0x1d552b[_0x1733d5(0xf6)],_0x1d552b[_0x1733d5(0x12b)],_0x1d552b[_0x1733d5(0x121)],_0x1d552b[_0x1733d5(0x135)],_0x1d552b[_0x1733d5(0xe7)],_0x1d552b[_0x1733d5(0xd8)]];continue;}break;}}static[a118_0x4aab05(0x127)](){const _0x55ca6d=a118_0x4aab05;return!RequestQueueHandler[_0x55ca6d(0x13b)]&&(RequestQueueHandler[_0x55ca6d(0x13b)]=new RequestQueueHandler()),RequestQueueHandler[_0x55ca6d(0x13b)];}[a118_0x4aab05(0x12a)]=()=>{const _0x511546=a118_0x4aab05;!this[_0x511546(0x110)]&&(this['started']=!![],this['startEventBatchPolling']());};['add']=_0x4ce844=>{const _0x54a625=a118_0x4aab05,_0x459b06={'rhcyj':function(_0x562d18,_0x18252b){return _0x562d18===_0x18252b;},'sfLZT':_0x54a625(0xe4),'EFQzl':function(_0x232de3,_0xa4f120){return _0x232de3>_0xa4f120;},'hcQSE':_0x54a625(0xf1),'GafTy':function(_0x156f4f,_0x196b06){return _0x156f4f!==_0x196b06;},'qJgOs':'TestRunFinished','RwYiX':function(_0x115811,_0x4bf2c3){return _0x115811(_0x4bf2c3);},'jeCpl':_0x54a625(0x116)};if(this[_0x54a625(0x11b)][_0x54a625(0xfb)](_0x4ce844['event_type'])){if(_0x4ce844[_0x54a625(0x136)]&&_0x4ce844[_0x54a625(0x136)][0x0]&&_0x459b06[_0x54a625(0x13f)](_0x4ce844[_0x54a625(0x136)][0x0][_0x54a625(0xf0)],_0x459b06['sfLZT'])){const _0xb6a806={};return _0xb6a806['shouldProceed']=!![],_0xb6a806[_0x54a625(0x134)]=[_0x4ce844],_0xb6a806['proceedWithUrl']=this[_0x54a625(0x119)],_0xb6a806;}if(_0x4ce844[_0x54a625(0x136)]&&_0x459b06['EFQzl'](_0x4ce844[_0x54a625(0x136)]['length'],0x0)&&_0x459b06[_0x54a625(0x13f)](_0x4ce844[_0x54a625(0x136)][0x0][_0x54a625(0xf0)],_0x459b06[_0x54a625(0x112)])&&_0x459b06[_0x54a625(0x12e)](_0x4ce844['event_type'],_0x459b06[_0x54a625(0x108)])){const _0x5760f1={};return _0x5760f1['shouldProceed']=!![],_0x5760f1['proceedWithData']=[_0x4ce844],_0x5760f1[_0x54a625(0x141)]=this[_0x54a625(0xdc)],_0x5760f1;}this[_0x54a625(0x114)][_0x54a625(0x139)](_0x4ce844);let _0x443a1c=null;const _0x5bdc7a=this['shouldProceed']();_0x5bdc7a&&(_0x459b06['RwYiX'](trace,_0x459b06[_0x54a625(0x109)]),_0x443a1c=this['queue'][_0x54a625(0xd1)](0x0,BATCH_SIZE),this[_0x54a625(0x114)][_0x54a625(0x115)](0x0,BATCH_SIZE),this['resetEventBatchPolling']());const _0x11f869={};return _0x11f869[_0x54a625(0xd6)]=_0x5bdc7a,_0x11f869['proceedWithData']=_0x443a1c,_0x11f869[_0x54a625(0x141)]=this[_0x54a625(0xd3)],_0x11f869;}const _0x1810af={};return _0x1810af[_0x54a625(0xd6)]=!![],_0x1810af;};['shutdown']=async()=>{const _0x5112ed=a118_0x4aab05,_0x31d02c={'lkwLP':_0x5112ed(0x13d),'FDsXi':function(_0x4b222c,_0x2bc6d3){return _0x4b222c>_0x2bc6d3;},'gvGUp':_0x5112ed(0xf2),'DehYN':function(_0x5eacb9,_0x3c4364){return _0x5eacb9>_0x3c4364;},'QynHP':function(_0x27b71c,_0x22980c){return _0x27b71c(_0x22980c);}};await this[_0x5112ed(0x11c)](),this[_0x5112ed(0x10f)](_0x31d02c[_0x5112ed(0x13e)]);while(_0x31d02c[_0x5112ed(0x106)](this[_0x5112ed(0x114)][_0x5112ed(0xc7)],0x0)){const _0x31e266=this[_0x5112ed(0x114)]['slice'](0x0,BATCH_SIZE);this['queue']['splice'](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x5112ed(0xd3)],_0x31d02c[_0x5112ed(0xd5)],_0x31e266);}_0x31d02c[_0x5112ed(0xfc)](this['pendingUploads'],0x0)&&_0x31d02c[_0x5112ed(0x12f)](debug,_0x5112ed(0x12c)+this['pendingUploads']);};[a118_0x4aab05(0xee)]=async(_0x59e86a,_0xbaadd6,_0x2212d9)=>{const _0x1d2a09=a118_0x4aab05,_0x3ce3f5={'mRIIf':function(_0x1a0d32,_0x2fe173){return _0x1a0d32(_0x2fe173);},'jWBDf':'utf8','wPiuF':function(_0x2c1adb,_0x2b4df9){return _0x2c1adb(_0x2b4df9);},'UtPTo':function(_0x47d146){return _0x47d146();},'XqEkc':function(_0x59b36f,_0x3a586d,_0x19b462,_0x526571,_0x34ae43){return _0x59b36f(_0x3a586d,_0x19b462,_0x526571,_0x34ae43);},'cFxuw':_0x1d2a09(0x113),'gZweD':function(_0x446e14,_0x226dd0){return _0x446e14-_0x226dd0;},'ugnSW':function(_0x29e6e7,_0x1c9972){return _0x29e6e7(_0x1c9972);},'xGWoC':function(_0x526e07,_0x249e6d){return _0x526e07(_0x249e6d);}};let _0xa7b65c='';try{_0xa7b65c=_0x2212d9[_0x1d2a09(0xef)](_0x1e8974=>'\x27'+_0x1e8974[_0x1d2a09(0x118)]+'\x27:'+(nestedKeyValue(_0x1e8974,[_0x1d2a09(0xdf),_0x1d2a09(0xf9)])||nestedKeyValue(_0x1e8974,[_0x1d2a09(0x130),_0x1d2a09(0xf9)])))[_0x1d2a09(0x128)](','),_0x3ce3f5[_0x1d2a09(0x10d)](debug,_0x1d2a09(0xe3)+_0xbaadd6+_0x1d2a09(0xcd)+Buffer['byteLength'](util[_0x1d2a09(0xd4)]('%j',_0x2212d9),_0x3ce3f5[_0x1d2a09(0x10a)])+_0x1d2a09(0x132)+_0xa7b65c);}catch(_0x356d55){_0x3ce3f5[_0x1d2a09(0x117)](debug,_0x1d2a09(0xeb)+util[_0x1d2a09(0xd4)](_0x356d55)+'}');}const _0x3c63fe={'headers':_0x3ce3f5[_0x1d2a09(0xde)](getDefaultHeaders)};try{const _0x9718e7=await _0x3ce3f5['XqEkc'](nodeRequest,_0x3ce3f5[_0x1d2a09(0xd7)],_0x59e86a,_0x2212d9,_0x3c63fe);if(_0x9718e7[_0x1d2a09(0xd2)]['error']){const _0x4cabe0={};_0x4cabe0[_0x1d2a09(0x107)]=_0x9718e7[_0x1d2a09(0xd2)][_0x1d2a09(0x11f)];throw _0x4cabe0;}else _0x3ce3f5[_0x1d2a09(0x10d)](debug,_0xbaadd6+_0x1d2a09(0x126)+_0xa7b65c+_0x1d2a09(0xce)+util[_0x1d2a09(0xd4)]('%j',_0x9718e7[_0x1d2a09(0xd2)])),this[_0x1d2a09(0x131)]=Math['max'](0x0,_0x3ce3f5['gZweD'](this[_0x1d2a09(0x131)],_0x2212d9['length']));}catch(_0x242ace){_0x242ace[_0x1d2a09(0x10e)]?_0x3ce3f5[_0x1d2a09(0xc9)](debug,_0x1d2a09(0xe1)+_0xbaadd6+_0x1d2a09(0x11d)+constants['TEST_REPORTING_ANALYTICS']+'\x20:\x20'+_0x242ace[_0x1d2a09(0x10e)]['status']+'\x20'+_0x242ace['response'][_0x1d2a09(0x120)]+'\x20'+util[_0x1d2a09(0xd4)]('%j',_0x242ace['response'])):_0x3ce3f5['xGWoC'](debug,_0x1d2a09(0xe1)+_0xbaadd6+_0x1d2a09(0x11d)+constants[_0x1d2a09(0xe9)]+_0x1d2a09(0xe0)+(_0x242ace[_0x1d2a09(0x107)]||_0x242ace)),this['pendingUploads']=Math[_0x1d2a09(0x13a)](0x0,_0x3ce3f5['gZweD'](this[_0x1d2a09(0x131)],_0x2212d9[_0x1d2a09(0xc7)]));}};[a118_0x4aab05(0xd9)]=()=>{const _0x39de75=a118_0x4aab05,_0x3a7221={'uBOKP':function(_0x4fffb6,_0x3fed30){return _0x4fffb6>_0x3fed30;},'XpuJm':function(_0x2ee32a,_0x3f6a37){return _0x2ee32a(_0x3f6a37);},'AeCDp':_0x39de75(0x102),'HyEMt':function(_0x19f073,_0x2a5614){return _0x19f073(_0x2a5614);},'sMWyg':function(_0x1cab8a,_0x3031aa,_0x5d5c2b){return _0x1cab8a(_0x3031aa,_0x5d5c2b);}};this[_0x39de75(0xf4)]=_0x3a7221[_0x39de75(0xdd)](setInterval,async()=>{const _0x1b3e50=_0x39de75;if(_0x3a7221[_0x1b3e50(0xdb)](this[_0x1b3e50(0x114)][_0x1b3e50(0xc7)],0x0)){_0x3a7221[_0x1b3e50(0xe8)](trace,_0x1b3e50(0x103)+this[_0x1b3e50(0x114)][_0x1b3e50(0xc7)]);const _0x1e4925=this[_0x1b3e50(0x114)][_0x1b3e50(0xd1)](0x0,BATCH_SIZE);this[_0x1b3e50(0x114)][_0x1b3e50(0x115)](0x0,BATCH_SIZE),await this[_0x1b3e50(0xee)](this[_0x1b3e50(0xd3)],_0x3a7221[_0x1b3e50(0x125)],_0x1e4925),_0x3a7221['HyEMt'](trace,_0x1b3e50(0x129)+this[_0x1b3e50(0x114)][_0x1b3e50(0xc7)]);}},BATCH_INTERVAL);};[a118_0x4aab05(0x12d)]=()=>{const _0x33a0db=a118_0x4aab05,_0x4fad49={};_0x4fad49[_0x33a0db(0x111)]=_0x33a0db(0xf3);const _0x366b75=_0x4fad49;this['removeEventBatchPolling'](_0x366b75[_0x33a0db(0x111)]),this['startEventBatchPolling']();};[a118_0x4aab05(0x10f)]=_0x1288e5=>{const _0x510167=a118_0x4aab05,_0x152681={'utTaX':function(_0x19d321,_0x4ae391){return _0x19d321(_0x4ae391);},'bMuMS':function(_0x3a0af2,_0x34d081){return _0x3a0af2===_0x34d081;},'DCaNl':'REMOVING'};this['pollEventBatchInterval']&&(_0x152681[_0x510167(0x100)](clearInterval,this[_0x510167(0xf4)]),this[_0x510167(0xf4)]=null,_0x152681[_0x510167(0xf7)](_0x1288e5,_0x152681[_0x510167(0xea)])&&(this[_0x510167(0x110)]=![]));};[a118_0x4aab05(0xd6)]=()=>{const _0x2130eb=a118_0x4aab05,_0x57991f={};_0x57991f[_0x2130eb(0xca)]=function(_0x5b7a37,_0x2088f4){return _0x5b7a37>=_0x2088f4;};const _0x429c3b=_0x57991f;return _0x429c3b[_0x2130eb(0xca)](this[_0x2130eb(0x114)][_0x2130eb(0xc7)],BATCH_SIZE);};async[a118_0x4aab05(0x11c)](_0x481f9a=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x1fd67b=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x223094=a118_0x4aab05,_0x4ce60a={'claaJ':function(_0x3a7eb8,_0xafb13f){return _0x3a7eb8<=_0xafb13f;},'aCdHt':function(_0x21a351,_0x5e5e61){return _0x21a351(_0x5e5e61);},'ewaHS':function(_0x34ff42,_0x34155f){return _0x34ff42-_0x34155f;}};if(_0x4ce60a[_0x223094(0xcb)](this[_0x223094(0x131)],0x0)||_0x4ce60a[_0x223094(0xcb)](_0x481f9a,0x0))return;return await _0x4ce60a[_0x223094(0xec)](sleep,_0x1fd67b),this[_0x223094(0x11c)](_0x4ce60a[_0x223094(0xcf)](_0x481f9a,_0x1fd67b));}}module[a118_0x4aab05(0xda)]=RequestQueueHandler;function a118_0x5d33(){const _0xaee9e=['shouldProceed','cFxuw','aTLsR','startEventBatchPolling','exports','uBOKP','uploadAttachmentUrl','sMWyg','UtPTo','test_run','\x20:\x20','EXCEPTION\x20IN\x20','GPauW','Processing\x20batch\x20events\x20for\x20','TEST_SCREENSHOT','upload-attachments','./constants','nkyas','XpuJm','TEST_REPORTING_ANALYTICS','DCaNl','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','aCdHt','3|5|1|0|2|6|4','batchAndPostEvents','map','kind','TEST_ATTACHMENT','Shutdown-Queue','RESETTING','pollEventBatchInterval','fsXDZ','ipSSf','bMuMS','split','uuid','YIhzZ','includes','DehYN','CBTSessionCreated','68572iXHUUl','api/v1/batch','utTaX','keuWG','Interval-Queue','Processing\x20events.\x20Queue\x20Length\x20-\x20','TestRunStarted','3241135pXwcKO','FDsXi','message','qJgOs','jeCpl','jWBDf','HookRunStarted','2223657MwgyDE','mRIIf','response','removeEventBatchPolling','started','ozdKz','hcQSE','POST','queue','splice','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','wPiuF','event_type','screenshotEventUrl','TestRunFinished','BATCH_EVENT_TYPES','uploadPending','\x20REQUEST\x20TO\x20','qjojH','error','statusText','DCzds','TestRunSkipped','78zXGUvM','1332eZhAyH','AeCDp','\x20event\x20successful\x20for\x20events\x20','getInstance','join','Remaining\x20Queue\x20Length\x20-\x20','start','gFfpb','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','resetEventBatchPolling','GafTy','QynHP','hook_run','pendingUploads','\x20bytes.\x20Events\x20are\x20','HookRunFinished','proceedWithData','NOpQT','logs','util','../../bin/utils/constants','push','max','instance','2NqZbnh','REMOVING','lkwLP','rhcyj','576571WswYzp','proceedWithUrl','length','9448TzkWxu','ugnSW','sTWaP','claaJ','3497000XaZrfK','.\x20Request\x20Size\x20-\x20','\x20--\x20','ewaHS','1522156RgaKjN','slice','data','eventUrl','format','gvGUp'];a118_0x5d33=function(){return _0xaee9e;};return a118_0x5d33();}