function a86_0x2eed(){const _0x3d1437=['KaiGM','queue','REMOVING','slice','pollEventBatchInterval','4|3|1|6|5|2|0','swwhc','event_type','includes','18SYvcat','vzQyo','154244ZFvIEA','Interval-Queue','dyEXq','nYKMH','1804216nnQyVT','ZposY','CBTSessionCreated','282nTtHZH','TEST_SCREENSHOT','join','message','kind','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','status','oFpgr','wNVCK','Zpyft','uploadAttachmentUrl','3035xNzIXA','hook_run','VAVGA','jONdM','uploadPending','util','hdabC','test_run','oMCnA','XpMdv','started','sHQxP','data','utf8','max','mthnl','api/v1/batch','3242eHwscw','HookRunFinished','LogCreated','JBbpL','TestRunSkipped','proceedWithUrl','logs','batchAndPostEvents','statusText','EjYNw','\x20event\x20successful\x20for\x20events\x20','9880244KhEEOZ','eventUrl','NWWpC','EXCEPTION\x20IN\x20','vaSHe','uPRdq','DBdra','QeKCJ','instance','uuid','response','TestRunFinished','screenshotEventUrl','push','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','267456UGYDfa','splice','shouldProceed','BgaXg','removeEventBatchPolling','BqbRY','proceedWithData','pendingUploads','CEUrN','Shutdown-Queue','xLfRt','HookRunStarted','POST','BrWQy','HfQId','TEST_ATTACHMENT','NruLK','1838280HJodMP','39RIFAHT','map','3PTyJXW','\x20bytes.\x20Events\x20are\x20','format','poeUA','TestRunStarted','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','\x20--\x20','YNMCZ','error','start','startEventBatchPolling','length','ZaugG','api/v1/screenshots','upload-attachments','vhxYZ'];a86_0x2eed=function(){return _0x3d1437;};return a86_0x2eed();}const a86_0xf9126f=a86_0x44aa;(function(_0x583d1d,_0x32ea8a){const _0x34495a=a86_0x44aa,_0x4d954a=_0x583d1d();while(!![]){try{const _0x5e051a=parseInt(_0x34495a(0xda))/0x1*(parseInt(_0x34495a(0x118))/0x2)+-parseInt(_0x34495a(0xd8))/0x3*(-parseInt(_0x34495a(0xf5))/0x4)+-parseInt(_0x34495a(0x107))/0x5*(-parseInt(_0x34495a(0xfc))/0x6)+parseInt(_0x34495a(0xc6))/0x7+-parseInt(_0x34495a(0xf9))/0x8*(-parseInt(_0x34495a(0xf3))/0x9)+parseInt(_0x34495a(0xd7))/0xa+-parseInt(_0x34495a(0xb7))/0xb;if(_0x5e051a===_0x32ea8a)break;else _0x4d954a['push'](_0x4d954a['shift']());}catch(_0x5a1bfd){_0x4d954a['push'](_0x4d954a['shift']());}}}(a86_0x2eed,0x4b943));function a86_0x44aa(_0x32edcf,_0xc73367){const _0x2eed13=a86_0x2eed();return a86_0x44aa=function(_0x44aaf9,_0x153b08){_0x44aaf9=_0x44aaf9-0xb6;let _0x5aafa2=_0x2eed13[_0x44aaf9];return _0x5aafa2;},a86_0x44aa(_0x32edcf,_0xc73367);}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require('./constants'),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require('./utils'),{nestedKeyValue}=require('../helper'),util=require(a86_0xf9126f(0x10c));class RequestQueueHandler{static [a86_0xf9126f(0xbf)];[a86_0xf9126f(0xcd)]=0x0;constructor(){const _0x1424ab=a86_0xf9126f,_0x36b3ab={};_0x36b3ab[_0x1424ab(0xbb)]=_0x1424ab(0xef),_0x36b3ab[_0x1424ab(0xe6)]=_0x1424ab(0x117),_0x36b3ab[_0x1424ab(0xe9)]=_0x1424ab(0x11a),_0x36b3ab[_0x1424ab(0xce)]=_0x1424ab(0xfb),_0x36b3ab[_0x1424ab(0x10d)]=_0x1424ab(0xc2),_0x36b3ab['mthnl']=_0x1424ab(0x11c),_0x36b3ab['ZposY']=_0x1424ab(0x119),_0x36b3ab[_0x1424ab(0x121)]=_0x1424ab(0xde),_0x36b3ab[_0x1424ab(0xc9)]=_0x1424ab(0xd1),_0x36b3ab[_0x1424ab(0x112)]=_0x1424ab(0xe8),_0x36b3ab['dyEXq']=_0x1424ab(0xe7);const _0x5efca3=_0x36b3ab,_0x111b63=_0x5efca3[_0x1424ab(0xbb)]['split']('|');let _0x3dc96a=0x0;while(!![]){switch(_0x111b63[_0x3dc96a++]){case'0':this[_0x1424ab(0xee)]=null;continue;case'1':this[_0x1424ab(0xb8)]=_0x5efca3[_0x1424ab(0xe6)];continue;case'2':this['BATCH_EVENT_TYPES']=[_0x5efca3[_0x1424ab(0xe9)],_0x5efca3[_0x1424ab(0xce)],_0x5efca3['hdabC'],_0x5efca3[_0x1424ab(0x116)],_0x5efca3[_0x1424ab(0xfa)],_0x5efca3[_0x1424ab(0x121)],_0x5efca3[_0x1424ab(0xc9)]];continue;case'3':this[_0x1424ab(0x111)]=![];continue;case'4':this['queue']=[];continue;case'5':this[_0x1424ab(0x106)]=_0x5efca3[_0x1424ab(0x112)];continue;case'6':this[_0x1424ab(0xc3)]=_0x5efca3[_0x1424ab(0xf7)];continue;}break;}}static['getInstance'](){const _0x5bd2a8=a86_0xf9126f;return!RequestQueueHandler[_0x5bd2a8(0xbf)]&&(RequestQueueHandler[_0x5bd2a8(0xbf)]=new RequestQueueHandler()),RequestQueueHandler[_0x5bd2a8(0xbf)];}[a86_0xf9126f(0xe3)]=()=>{const _0x4eb489=a86_0xf9126f;!this[_0x4eb489(0x111)]&&(this[_0x4eb489(0x111)]=!![],this[_0x4eb489(0xe4)]());};['add']=_0x161b73=>{const _0x4a22c7=a86_0xf9126f,_0x1126f2={'XpMdv':function(_0x335965,_0xbce90e){return _0x335965===_0xbce90e;},'BqbRY':_0x4a22c7(0xfd),'xLfRt':function(_0x113929,_0xbd7bab){return _0x113929>_0xbd7bab;},'HfQId':_0x4a22c7(0xd5),'oFpgr':function(_0x5aa465,_0x5e9322){return _0x5aa465!==_0x5e9322;},'LxaHl':_0x4a22c7(0xc2),'CpqVf':function(_0x8a16eb,_0x118c04){return _0x8a16eb(_0x118c04);},'wegCf':_0x4a22c7(0x101)};if(this['BATCH_EVENT_TYPES'][_0x4a22c7(0xf2)](_0x161b73[_0x4a22c7(0xf1)])){if(_0x161b73[_0x4a22c7(0x11e)]&&_0x161b73[_0x4a22c7(0x11e)][0x0]&&_0x1126f2[_0x4a22c7(0x110)](_0x161b73[_0x4a22c7(0x11e)][0x0]['kind'],_0x1126f2[_0x4a22c7(0xcb)])){const _0x444f15={};return _0x444f15[_0x4a22c7(0xc8)]=!![],_0x444f15[_0x4a22c7(0xcc)]=[_0x161b73],_0x444f15[_0x4a22c7(0x11d)]=this[_0x4a22c7(0xc3)],_0x444f15;}if(_0x161b73[_0x4a22c7(0x11e)]&&_0x1126f2[_0x4a22c7(0xd0)](_0x161b73[_0x4a22c7(0x11e)][_0x4a22c7(0xe5)],0x0)&&_0x1126f2['XpMdv'](_0x161b73[_0x4a22c7(0x11e)][0x0][_0x4a22c7(0x100)],_0x1126f2[_0x4a22c7(0xd4)])&&_0x1126f2[_0x4a22c7(0x103)](_0x161b73[_0x4a22c7(0xf1)],_0x1126f2['LxaHl'])){const _0x161e51={};return _0x161e51['shouldProceed']=!![],_0x161e51[_0x4a22c7(0xcc)]=[_0x161b73],_0x161e51['proceedWithUrl']=this[_0x4a22c7(0x106)],_0x161e51;}this[_0x4a22c7(0xeb)][_0x4a22c7(0xc4)](_0x161b73);let _0xd4dea1=null;const _0x1d0034=this[_0x4a22c7(0xc8)]();_0x1d0034&&(_0x1126f2['CpqVf'](trace,_0x1126f2['wegCf']),_0xd4dea1=this['queue'][_0x4a22c7(0xed)](0x0,BATCH_SIZE),this[_0x4a22c7(0xeb)][_0x4a22c7(0xc7)](0x0,BATCH_SIZE),this['resetEventBatchPolling']());const _0x340b41={};return _0x340b41[_0x4a22c7(0xc8)]=_0x1d0034,_0x340b41[_0x4a22c7(0xcc)]=_0xd4dea1,_0x340b41['proceedWithUrl']=this[_0x4a22c7(0xb8)],_0x340b41;}const _0x295dc8={};return _0x295dc8[_0x4a22c7(0xc8)]=!![],_0x295dc8;};['shutdown']=async()=>{const _0x2ff187=a86_0xf9126f,_0x2c4939={'poeUA':_0x2ff187(0xec),'Zpyft':function(_0x118b4f,_0x5c641e){return _0x118b4f>_0x5c641e;},'IRPeO':_0x2ff187(0xcf),'BrWQy':function(_0x555a40,_0x429442){return _0x555a40>_0x429442;},'oMCnA':function(_0x41e213,_0x2b0576){return _0x41e213(_0x2b0576);}};await this[_0x2ff187(0x10b)](),this[_0x2ff187(0xca)](_0x2c4939[_0x2ff187(0xdd)]);while(_0x2c4939[_0x2ff187(0x105)](this[_0x2ff187(0xeb)]['length'],0x0)){const _0x36dad2=this[_0x2ff187(0xeb)][_0x2ff187(0xed)](0x0,BATCH_SIZE);this[_0x2ff187(0xeb)][_0x2ff187(0xc7)](0x0,BATCH_SIZE),await this[_0x2ff187(0x11f)](this[_0x2ff187(0xb8)],_0x2c4939['IRPeO'],_0x36dad2);}_0x2c4939[_0x2ff187(0xd3)](this[_0x2ff187(0xcd)],0x0)&&_0x2c4939[_0x2ff187(0x10f)](debug,'Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20'+this[_0x2ff187(0xcd)]);};['batchAndPostEvents']=async(_0x3309ee,_0x32302c,_0x14abb7)=>{const _0x11c084=a86_0xf9126f,_0x5780c7={'DBdra':function(_0x32b337,_0x4e3392){return _0x32b337(_0x4e3392);},'wXtqL':_0x11c084(0x114),'ZpxoD':function(_0x1d34ec){return _0x1d34ec();},'swwhc':function(_0x1dec2a,_0x1ae77c,_0x1668a9,_0x5bf6cb,_0x57a370){return _0x1dec2a(_0x1ae77c,_0x1668a9,_0x5bf6cb,_0x57a370);},'VAVGA':_0x11c084(0xd2),'mgEHu':function(_0x5d043a,_0x5a8342){return _0x5d043a-_0x5a8342;},'QeKCJ':function(_0x28737d,_0x1eab3e){return _0x28737d(_0x1eab3e);},'jONdM':function(_0x49e2bb,_0x10ea79){return _0x49e2bb-_0x10ea79;}};let _0x12205f='';try{_0x12205f=_0x14abb7[_0x11c084(0xd9)](_0xe2ba5e=>'\x27'+_0xe2ba5e['event_type']+'\x27:'+(nestedKeyValue(_0xe2ba5e,[_0x11c084(0x10e),_0x11c084(0xc0)])||nestedKeyValue(_0xe2ba5e,[_0x11c084(0x108),_0x11c084(0xc0)])))[_0x11c084(0xfe)](','),_0x5780c7[_0x11c084(0xbd)](debug,'Processing\x20batch\x20events\x20for\x20'+_0x32302c+'.\x20Request\x20Size\x20-\x20'+Buffer['byteLength'](util[_0x11c084(0xdc)]('%j',_0x14abb7),_0x5780c7['wXtqL'])+_0x11c084(0xdb)+_0x12205f);}catch(_0x20d557){_0x5780c7[_0x11c084(0xbd)](debug,_0x11c084(0xdf)+util[_0x11c084(0xdc)](_0x20d557)+'}');}const _0x499756={'headers':_0x5780c7['ZpxoD'](getDefaultHeaders)};try{const _0x4b4c4e=await _0x5780c7[_0x11c084(0xf0)](nodeRequest,_0x5780c7[_0x11c084(0x109)],_0x3309ee,_0x14abb7,_0x499756);if(_0x4b4c4e[_0x11c084(0x113)][_0x11c084(0xe2)]){const _0x56786b={};_0x56786b[_0x11c084(0xff)]=_0x4b4c4e['data'][_0x11c084(0xe2)];throw _0x56786b;}else _0x5780c7[_0x11c084(0xbd)](debug,_0x32302c+_0x11c084(0xb6)+_0x12205f+_0x11c084(0xe0)+util['format']('%j',_0x4b4c4e[_0x11c084(0x113)])),this[_0x11c084(0xcd)]=Math[_0x11c084(0x115)](0x0,_0x5780c7['mgEHu'](this[_0x11c084(0xcd)],_0x14abb7[_0x11c084(0xe5)]));}catch(_0x5cd566){_0x5cd566[_0x11c084(0xc1)]?_0x5780c7[_0x11c084(0xbe)](debug,_0x11c084(0xba)+_0x32302c+_0x11c084(0xc5)+_0x5cd566[_0x11c084(0xc1)][_0x11c084(0x102)]+'\x20'+_0x5cd566['response'][_0x11c084(0x120)]+'\x20'+util[_0x11c084(0xdc)]('%j',_0x5cd566[_0x11c084(0xc1)])):_0x5780c7[_0x11c084(0xbe)](debug,_0x11c084(0xba)+_0x32302c+_0x11c084(0xc5)+(_0x5cd566['message']||_0x5cd566)),this[_0x11c084(0xcd)]=Math['max'](0x0,_0x5780c7[_0x11c084(0x10a)](this[_0x11c084(0xcd)],_0x14abb7[_0x11c084(0xe5)]));}};[a86_0xf9126f(0xe4)]=()=>{const _0x1843dc=a86_0xf9126f,_0x1d4f1b={'lLlHg':function(_0x38e78f,_0x44f3f1){return _0x38e78f>_0x44f3f1;},'uPRdq':function(_0x3d9393,_0x3c2fff){return _0x3d9393(_0x3c2fff);},'MBPQN':_0x1843dc(0xf6),'KaiGM':function(_0xc396f9,_0x5365e9){return _0xc396f9(_0x5365e9);},'JBbpL':function(_0x5ae92e,_0x3a1e,_0x195bb8){return _0x5ae92e(_0x3a1e,_0x195bb8);}};this[_0x1843dc(0xee)]=_0x1d4f1b[_0x1843dc(0x11b)](setInterval,async()=>{const _0x54c4d1=_0x1843dc;if(_0x1d4f1b['lLlHg'](this['queue'][_0x54c4d1(0xe5)],0x0)){_0x1d4f1b[_0x54c4d1(0xbc)](trace,'Processing\x20events.\x20Queue\x20Length\x20-\x20'+this[_0x54c4d1(0xeb)][_0x54c4d1(0xe5)]);const _0x1ed038=this[_0x54c4d1(0xeb)][_0x54c4d1(0xed)](0x0,BATCH_SIZE);this['queue'][_0x54c4d1(0xc7)](0x0,BATCH_SIZE),await this[_0x54c4d1(0x11f)](this[_0x54c4d1(0xb8)],_0x1d4f1b['MBPQN'],_0x1ed038),_0x1d4f1b[_0x54c4d1(0xea)](trace,'Remaining\x20Queue\x20Length\x20-\x20'+this['queue']['length']);}},BATCH_INTERVAL);};['resetEventBatchPolling']=()=>{const _0x72bdb=a86_0xf9126f,_0x40584e={};_0x40584e[_0x72bdb(0x104)]='RESETTING';const _0x1986f6=_0x40584e;this[_0x72bdb(0xca)](_0x1986f6[_0x72bdb(0x104)]),this[_0x72bdb(0xe4)]();};[a86_0xf9126f(0xca)]=_0x2d293e=>{const _0x415923=a86_0xf9126f,_0x56edff={'NWWpC':function(_0x584d89,_0x53e49d){return _0x584d89(_0x53e49d);},'NskpU':function(_0x84de04,_0x5460df){return _0x84de04===_0x5460df;},'nYKMH':'REMOVING'};this[_0x415923(0xee)]&&(_0x56edff[_0x415923(0xb9)](clearInterval,this['pollEventBatchInterval']),this['pollEventBatchInterval']=null,_0x56edff['NskpU'](_0x2d293e,_0x56edff[_0x415923(0xf8)])&&(this[_0x415923(0x111)]=![]));};[a86_0xf9126f(0xc8)]=()=>{const _0x51e45a=a86_0xf9126f,_0x2066af={};_0x2066af[_0x51e45a(0xd6)]=function(_0x32cfdb,_0x141728){return _0x32cfdb>=_0x141728;};const _0x4470a6=_0x2066af;return _0x4470a6[_0x51e45a(0xd6)](this[_0x51e45a(0xeb)][_0x51e45a(0xe5)],BATCH_SIZE);};async[a86_0xf9126f(0x10b)](_0x468e55=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x286a1e=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x45edcc=a86_0xf9126f,_0x2af28b={'fWLDR':function(_0x2e222d,_0x515606){return _0x2e222d<=_0x515606;},'YNMCZ':function(_0xc57190,_0x5323cc){return _0xc57190<=_0x5323cc;},'vzQyo':function(_0x4647cf,_0x55c853){return _0x4647cf(_0x55c853);},'JEFDs':function(_0x3cdaec,_0x2199aa){return _0x3cdaec-_0x2199aa;}};if(_0x2af28b['fWLDR'](this[_0x45edcc(0xcd)],0x0)||_0x2af28b[_0x45edcc(0xe1)](_0x468e55,0x0))return;return await _0x2af28b[_0x45edcc(0xf4)](sleep,_0x286a1e),this[_0x45edcc(0x10b)](_0x2af28b['JEFDs'](_0x468e55,_0x286a1e));}}module['exports']=RequestQueueHandler;