const a127_0x17f0d3=a127_0x333a;(function(_0x2833fc,_0x5ddc2d){const _0x5ec677=a127_0x333a,_0x458258=_0x2833fc();while(!![]){try{const _0x5c84a8=parseInt(_0x5ec677(0x100))/0x1*(parseInt(_0x5ec677(0xfc))/0x2)+parseInt(_0x5ec677(0xf4))/0x3*(-parseInt(_0x5ec677(0xac))/0x4)+parseInt(_0x5ec677(0xd5))/0x5*(parseInt(_0x5ec677(0xde))/0x6)+-parseInt(_0x5ec677(0xe7))/0x7*(-parseInt(_0x5ec677(0xef))/0x8)+-parseInt(_0x5ec677(0x103))/0x9*(parseInt(_0x5ec677(0xa5))/0xa)+-parseInt(_0x5ec677(0xee))/0xb*(-parseInt(_0x5ec677(0x8e))/0xc)+-parseInt(_0x5ec677(0xb9))/0xd*(parseInt(_0x5ec677(0xd9))/0xe);if(_0x5c84a8===_0x5ddc2d)break;else _0x458258['push'](_0x458258['shift']());}catch(_0x475785){_0x458258['push'](_0x458258['shift']());}}}(a127_0x5852,0xa8040));function a127_0x333a(_0x186d9a,_0x2db262){const _0x5852f2=a127_0x5852();return a127_0x333a=function(_0x333afa,_0xf858fc){_0x333afa=_0x333afa-0x89;let _0x21064d=_0x5852f2[_0x333afa];return _0x21064d;},a127_0x333a(_0x186d9a,_0x2db262);}function a127_0x5852(){const _0x2c50cb=['add','12jIUwtO','TEST_ATTACHMENT','Processing\x20events.\x20Queue\x20Length\x20-\x20','instance','pendingUploads','\x20event\x20successful\x20for\x20events\x20','VWcwA','Processing\x20batch\x20events\x20for\x20','.\x20Request\x20Size\x20-\x20','pollEventBatchInterval','LqiIu','EXCEPTION\x20IN\x20','CBTSessionCreated','2184403yheMBE','pYIUX','../helper','queue','MiNqI','splice','CPvrx','GCMhq','\x20REQUEST\x20TO\x20','REMOVING','Zsgau','PxnWO','lSDua','PrycJ','HookRunStarted','proceedWithUrl','Shutdown-Queue','rhyPv','SdVuq','uuid','hook_run','TEST_REPORTING_ANALYTICS','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','sUFbF','eczDK','data','split','removeEventBatchPolling','5bhsdTa','IUbjc','UvhHq','nLknz','196BsvgqL','PGJGR','ervXs','join','getInstance','813528aKqLIP','Remaining\x20Queue\x20Length\x20-\x20','Interval-Queue','shouldProceed','response','batchAndPostEvents','length','uploadAttachmentUrl','sJudm','857710MXsEyr','\x20:\x20','test_run','includes','event_type','utf8','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','77oSqLeQ','72SDNQrh','BATCH_EVENT_TYPES','logs','Ehwek','Jvkav','45351TSuzZy','slice','map','UUfiT','TestRunStarted','tmNcv','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','kvPob','1228SJuBkW','eventUrl','RESETTING','byteLength','1268GrbwKq','kind','vfIIZ','3771BsUVYV','resetEventBatchPolling','uploadPending','\x20bytes.\x20Events\x20are\x20','status','POST','2294544XZiPOz','error','Sbmbc','nwBzg','util','TestRunFinished','format','statusText','max','proceedWithData','RjCkQ','start','zBPpH','exZzf','TestRunSkipped','GsAZm','ZXxna','../../bin/utils/constants','./constants','api/v1/screenshots','GBnPS','OJSGo','roFBp','6430aZoZHd','screenshotEventUrl','./utils','started','startEventBatchPolling','message'];a127_0x5852=function(){return _0x2c50cb;};return a127_0x5852();}const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a127_0x17f0d3(0xa0)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a127_0x17f0d3(0xa7)),{nestedKeyValue}=require(a127_0x17f0d3(0xbb)),util=require(a127_0x17f0d3(0x92)),constants=require(a127_0x17f0d3(0x9f));class RequestQueueHandler{static ['instance'];[a127_0x17f0d3(0xb0)]=0x0;constructor(){const _0x3a9d23=a127_0x17f0d3,_0x19cc65={};_0x19cc65[_0x3a9d23(0xca)]='4|1|5|0|6|3|2',_0x19cc65[_0x3a9d23(0xf3)]=_0x3a9d23(0xa1),_0x19cc65['bHvha']='LogCreated',_0x19cc65['nwBzg']=_0x3a9d23(0xb8),_0x19cc65[_0x3a9d23(0xc0)]=_0x3a9d23(0x93),_0x19cc65[_0x3a9d23(0xba)]=_0x3a9d23(0x9c),_0x19cc65[_0x3a9d23(0xd1)]='HookRunFinished',_0x19cc65[_0x3a9d23(0xc4)]=_0x3a9d23(0xf8),_0x19cc65['DQZnk']=_0x3a9d23(0xc7),_0x19cc65[_0x3a9d23(0xfb)]='api/v1/batch',_0x19cc65[_0x3a9d23(0xc3)]='upload-attachments';const _0x5b0a4a=_0x19cc65,_0x303347=_0x5b0a4a[_0x3a9d23(0xca)][_0x3a9d23(0xd3)]('|');let _0x54723f=0x0;while(!![]){switch(_0x303347[_0x54723f++]){case'0':this[_0x3a9d23(0xa6)]=_0x5b0a4a[_0x3a9d23(0xf3)];continue;case'1':this[_0x3a9d23(0xa8)]=![];continue;case'2':this[_0x3a9d23(0xb5)]=null;continue;case'3':this[_0x3a9d23(0xf0)]=[_0x5b0a4a['bHvha'],_0x5b0a4a[_0x3a9d23(0x91)],_0x5b0a4a[_0x3a9d23(0xc0)],_0x5b0a4a[_0x3a9d23(0xba)],_0x5b0a4a[_0x3a9d23(0xd1)],_0x5b0a4a['PxnWO'],_0x5b0a4a['DQZnk']];continue;case'4':this[_0x3a9d23(0xbc)]=[];continue;case'5':this['eventUrl']=_0x5b0a4a['kvPob'];continue;case'6':this['uploadAttachmentUrl']=_0x5b0a4a[_0x3a9d23(0xc3)];continue;}break;}}static[a127_0x17f0d3(0xdd)](){const _0x101f05=a127_0x17f0d3;return!RequestQueueHandler[_0x101f05(0xaf)]&&(RequestQueueHandler['instance']=new RequestQueueHandler()),RequestQueueHandler[_0x101f05(0xaf)];}[a127_0x17f0d3(0x99)]=()=>{const _0x782faa=a127_0x17f0d3;!this['started']&&(this[_0x782faa(0xa8)]=!![],this[_0x782faa(0xa9)]());};[a127_0x17f0d3(0xab)]=_0x573bee=>{const _0x2d8289=a127_0x17f0d3,_0xaaf9e5={'sJudm':function(_0x212d2b,_0x99c06c){return _0x212d2b===_0x99c06c;},'vfIIZ':'TEST_SCREENSHOT','zBPpH':function(_0x4af958,_0x410d7d){return _0x4af958>_0x410d7d;},'UUfiT':_0x2d8289(0xad),'LqiIu':function(_0x5ec05c,_0x3efc29){return _0x5ec05c!==_0x3efc29;},'wrAbs':_0x2d8289(0x93),'JsVrR':function(_0x2797f2,_0x586f9d){return _0x2797f2(_0x586f9d);},'lSDua':_0x2d8289(0xcf)};if(this['BATCH_EVENT_TYPES'][_0x2d8289(0xea)](_0x573bee[_0x2d8289(0xeb)])){if(_0x573bee[_0x2d8289(0xf1)]&&_0x573bee['logs'][0x0]&&_0xaaf9e5[_0x2d8289(0xe6)](_0x573bee['logs'][0x0][_0x2d8289(0x101)],_0xaaf9e5[_0x2d8289(0x102)])){const _0x87b55c={};return _0x87b55c[_0x2d8289(0xe1)]=!![],_0x87b55c[_0x2d8289(0x97)]=[_0x573bee],_0x87b55c[_0x2d8289(0xc8)]=this['screenshotEventUrl'],_0x87b55c;}if(_0x573bee[_0x2d8289(0xf1)]&&_0xaaf9e5[_0x2d8289(0x9a)](_0x573bee[_0x2d8289(0xf1)][_0x2d8289(0xe4)],0x0)&&_0xaaf9e5[_0x2d8289(0xe6)](_0x573bee[_0x2d8289(0xf1)][0x0][_0x2d8289(0x101)],_0xaaf9e5[_0x2d8289(0xf7)])&&_0xaaf9e5[_0x2d8289(0xb6)](_0x573bee['event_type'],_0xaaf9e5['wrAbs'])){const _0x563f77={};return _0x563f77['shouldProceed']=!![],_0x563f77['proceedWithData']=[_0x573bee],_0x563f77[_0x2d8289(0xc8)]=this[_0x2d8289(0xe5)],_0x563f77;}this['queue']['push'](_0x573bee);let _0x264595=null;const _0x8194b9=this[_0x2d8289(0xe1)]();_0x8194b9&&(_0xaaf9e5['JsVrR'](trace,_0xaaf9e5[_0x2d8289(0xc5)]),_0x264595=this[_0x2d8289(0xbc)]['slice'](0x0,BATCH_SIZE),this[_0x2d8289(0xbc)][_0x2d8289(0xbe)](0x0,BATCH_SIZE),this[_0x2d8289(0x89)]());const _0xeba895={};return _0xeba895[_0x2d8289(0xe1)]=_0x8194b9,_0xeba895[_0x2d8289(0x97)]=_0x264595,_0xeba895[_0x2d8289(0xc8)]=this[_0x2d8289(0xfd)],_0xeba895;}const _0x8e84c4={};return _0x8e84c4['shouldProceed']=!![],_0x8e84c4;};['shutdown']=async()=>{const _0x274460=a127_0x17f0d3,_0x41d550={'PrycJ':'REMOVING','BFlec':function(_0x1a2aba,_0x4507e9){return _0x1a2aba>_0x4507e9;},'RjCkQ':_0x274460(0xc9),'Tmnia':function(_0x5e45d5,_0x403b4d){return _0x5e45d5>_0x403b4d;},'GBnPS':function(_0x33c11f,_0x4d4b61){return _0x33c11f(_0x4d4b61);}};await this[_0x274460(0x8a)](),this['removeEventBatchPolling'](_0x41d550[_0x274460(0xc6)]);while(_0x41d550['BFlec'](this[_0x274460(0xbc)]['length'],0x0)){const _0x267f00=this['queue'][_0x274460(0xf5)](0x0,BATCH_SIZE);this[_0x274460(0xbc)][_0x274460(0xbe)](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this['eventUrl'],_0x41d550[_0x274460(0x98)],_0x267f00);}_0x41d550['Tmnia'](this[_0x274460(0xb0)],0x0)&&_0x41d550[_0x274460(0xa2)](debug,_0x274460(0xfa)+this['pendingUploads']);};[a127_0x17f0d3(0xe3)]=async(_0x27473b,_0x30139a,_0x3dd2de)=>{const _0x2b57c1=a127_0x17f0d3,_0x575ad8={'ToMPh':function(_0x23de0f,_0x38dfb5){return _0x23de0f(_0x38dfb5);},'roFBp':_0x2b57c1(0xec),'Sbmbc':function(_0x3215c6){return _0x3215c6();},'tmNcv':function(_0x1d513d,_0x40dbeb,_0x3e83ab,_0x1a9ec3,_0x5df7dc){return _0x1d513d(_0x40dbeb,_0x3e83ab,_0x1a9ec3,_0x5df7dc);},'PGJGR':_0x2b57c1(0x8d),'nLknz':function(_0x2ceb52,_0x16a3dc){return _0x2ceb52(_0x16a3dc);},'ZXxna':function(_0x2d33e5,_0x4bcdd2){return _0x2d33e5-_0x4bcdd2;},'AHiio':function(_0x548fe7,_0xc83f7b){return _0x548fe7(_0xc83f7b);},'lLqCt':function(_0x3e4853,_0x1ff1c6){return _0x3e4853-_0x1ff1c6;}};let _0x3e94ae='';try{_0x3e94ae=_0x3dd2de[_0x2b57c1(0xf6)](_0x16c095=>'\x27'+_0x16c095[_0x2b57c1(0xeb)]+'\x27:'+(nestedKeyValue(_0x16c095,[_0x2b57c1(0xe9),_0x2b57c1(0xcc)])||nestedKeyValue(_0x16c095,[_0x2b57c1(0xcd),_0x2b57c1(0xcc)])))[_0x2b57c1(0xdc)](','),_0x575ad8['ToMPh'](debug,_0x2b57c1(0xb3)+_0x30139a+_0x2b57c1(0xb4)+Buffer[_0x2b57c1(0xff)](util['format']('%j',_0x3dd2de),_0x575ad8[_0x2b57c1(0xa4)])+_0x2b57c1(0x8b)+_0x3e94ae);}catch(_0x17ae58){_0x575ad8['ToMPh'](debug,_0x2b57c1(0xed)+util[_0x2b57c1(0x94)](_0x17ae58)+'}');}const _0x2953ba={'headers':_0x575ad8[_0x2b57c1(0x90)](getDefaultHeaders)};try{const _0x405cd4=await _0x575ad8[_0x2b57c1(0xf9)](nodeRequest,_0x575ad8[_0x2b57c1(0xda)],_0x27473b,_0x3dd2de,_0x2953ba);if(_0x405cd4[_0x2b57c1(0xd2)][_0x2b57c1(0x8f)]){const _0x37b0a8={};_0x37b0a8[_0x2b57c1(0xaa)]=_0x405cd4[_0x2b57c1(0xd2)]['error'];throw _0x37b0a8;}else _0x575ad8['nLknz'](debug,_0x30139a+_0x2b57c1(0xb1)+_0x3e94ae+'\x20--\x20'+util[_0x2b57c1(0x94)]('%j',_0x405cd4[_0x2b57c1(0xd2)])),this[_0x2b57c1(0xb0)]=Math[_0x2b57c1(0x96)](0x0,_0x575ad8[_0x2b57c1(0x9e)](this['pendingUploads'],_0x3dd2de[_0x2b57c1(0xe4)]));}catch(_0x43f8b7){_0x43f8b7[_0x2b57c1(0xe2)]?_0x575ad8['AHiio'](debug,_0x2b57c1(0xb7)+_0x30139a+_0x2b57c1(0xc1)+constants[_0x2b57c1(0xce)]+'\x20:\x20'+_0x43f8b7[_0x2b57c1(0xe2)][_0x2b57c1(0x8c)]+'\x20'+_0x43f8b7['response'][_0x2b57c1(0x95)]+'\x20'+util[_0x2b57c1(0x94)]('%j',_0x43f8b7['response'])):_0x575ad8[_0x2b57c1(0xd8)](debug,_0x2b57c1(0xb7)+_0x30139a+_0x2b57c1(0xc1)+constants['TEST_REPORTING_ANALYTICS']+_0x2b57c1(0xe8)+(_0x43f8b7[_0x2b57c1(0xaa)]||_0x43f8b7)),this[_0x2b57c1(0xb0)]=Math[_0x2b57c1(0x96)](0x0,_0x575ad8['lLqCt'](this[_0x2b57c1(0xb0)],_0x3dd2de[_0x2b57c1(0xe4)]));}};['startEventBatchPolling']=()=>{const _0x5ac758=a127_0x17f0d3,_0x15912a={'UvhHq':function(_0xda621d,_0x5d9a6f){return _0xda621d>_0x5d9a6f;},'MiNqI':function(_0x1b024e,_0x507c0c){return _0x1b024e(_0x507c0c);},'sUFbF':_0x5ac758(0xe0),'VWcwA':function(_0x5e70af,_0x2e9eef,_0x2d0235){return _0x5e70af(_0x2e9eef,_0x2d0235);}};this[_0x5ac758(0xb5)]=_0x15912a[_0x5ac758(0xb2)](setInterval,async()=>{const _0x1327c9=_0x5ac758;if(_0x15912a[_0x1327c9(0xd7)](this[_0x1327c9(0xbc)][_0x1327c9(0xe4)],0x0)){_0x15912a['MiNqI'](trace,_0x1327c9(0xae)+this[_0x1327c9(0xbc)][_0x1327c9(0xe4)]);const _0xaa5e8d=this[_0x1327c9(0xbc)][_0x1327c9(0xf5)](0x0,BATCH_SIZE);this[_0x1327c9(0xbc)]['splice'](0x0,BATCH_SIZE),await this[_0x1327c9(0xe3)](this[_0x1327c9(0xfd)],_0x15912a[_0x1327c9(0xd0)],_0xaa5e8d),_0x15912a[_0x1327c9(0xbd)](trace,_0x1327c9(0xdf)+this[_0x1327c9(0xbc)][_0x1327c9(0xe4)]);}},BATCH_INTERVAL);};[a127_0x17f0d3(0x89)]=()=>{const _0x3c7241=a127_0x17f0d3,_0xb16d0d={};_0xb16d0d[_0x3c7241(0xf2)]=_0x3c7241(0xfe);const _0x239c8c=_0xb16d0d;this[_0x3c7241(0xd4)](_0x239c8c['Ehwek']),this[_0x3c7241(0xa9)]();};[a127_0x17f0d3(0xd4)]=_0x48a78c=>{const _0x5e1abd=a127_0x17f0d3,_0x493c88={'IUbjc':function(_0x14d22e,_0x5bba10){return _0x14d22e(_0x5bba10);},'SdVuq':function(_0x233abd,_0x54cab0){return _0x233abd===_0x54cab0;},'ervXs':_0x5e1abd(0xc2)};this[_0x5e1abd(0xb5)]&&(_0x493c88[_0x5e1abd(0xd6)](clearInterval,this[_0x5e1abd(0xb5)]),this['pollEventBatchInterval']=null,_0x493c88[_0x5e1abd(0xcb)](_0x48a78c,_0x493c88[_0x5e1abd(0xdb)])&&(this[_0x5e1abd(0xa8)]=![]));};['shouldProceed']=()=>{const _0x345215=a127_0x17f0d3,_0x27bb70={};_0x27bb70['GsAZm']=function(_0x353105,_0x56d56f){return _0x353105>=_0x56d56f;};const _0x225abf=_0x27bb70;return _0x225abf[_0x345215(0x9d)](this['queue'][_0x345215(0xe4)],BATCH_SIZE);};async['uploadPending'](_0x2d41de=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x22e4f8=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x4d384a=a127_0x17f0d3,_0x23e06e={'exZzf':function(_0x41b1e9,_0x23e82f){return _0x41b1e9<=_0x23e82f;},'zyguM':function(_0x39412a,_0x5d75ac){return _0x39412a<=_0x5d75ac;},'CPvrx':function(_0x2bbc16,_0x1cbb96){return _0x2bbc16(_0x1cbb96);},'OJSGo':function(_0x4e5e7c,_0x1637a9){return _0x4e5e7c-_0x1637a9;}};if(_0x23e06e[_0x4d384a(0x9b)](this[_0x4d384a(0xb0)],0x0)||_0x23e06e['zyguM'](_0x2d41de,0x0))return;return await _0x23e06e[_0x4d384a(0xbf)](sleep,_0x22e4f8),this[_0x4d384a(0x8a)](_0x23e06e[_0x4d384a(0xa3)](_0x2d41de,_0x22e4f8));}}module['exports']=RequestQueueHandler;