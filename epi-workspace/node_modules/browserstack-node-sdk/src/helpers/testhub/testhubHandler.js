const a129_0x4a5e99=a129_0x4d43;(function(_0x1d8df2,_0xd0176c){const _0x5ad9e6=a129_0x4d43,_0x39410c=_0x1d8df2();while(!![]){try{const _0x1be5e5=-parseInt(_0x5ad9e6(0xb4))/0x1+-parseInt(_0x5ad9e6(0xc8))/0x2+parseInt(_0x5ad9e6(0xc4))/0x3*(parseInt(_0x5ad9e6(0xf1))/0x4)+-parseInt(_0x5ad9e6(0xbc))/0x5*(parseInt(_0x5ad9e6(0xea))/0x6)+-parseInt(_0x5ad9e6(0x9c))/0x7+-parseInt(_0x5ad9e6(0x103))/0x8+parseInt(_0x5ad9e6(0x10e))/0x9;if(_0x1be5e5===_0xd0176c)break;else _0x39410c['push'](_0x39410c['shift']());}catch(_0x27e419){_0x39410c['push'](_0x39410c['shift']());}}}(a129_0x7b69,0x6015f));function a129_0x7b69(){const _0x127a08=['fFJDq','forEach','bupaK','allSettled','logBuildError','qVzsT','../../bin/utils/constants.js','hYplR','xzSzv','BROWSERSTACK_PRODUCT_MAP','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','stringify','data','qBvnU','jwt','getAccessibilityOptions','oKBma','fFXmc','accessibility','../../bin/playwright/reporter/pwUtils.js','1330973ozljRc','gJZjG','GRUBC','ctePf','password','PERCY_SUPPORTED_FRAMEWORKS','../logger','../../bin/playwright/reporter/test-details.js','false','DlDjP','BROWSERSTACK_ACCESSIBILITY','buildStopSent','env','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','projectName','getAccessibilityValueFromYml','api/v1/builds/','getTestOrchestrationBuildStartData','checkAndSetupPercy','PUT','FgeUJ','BROWSERSTACK_LINKED_BUILD_UUID','START','isAccessibilityEnabled','772245BmVkeS','PgbQX','message','BROWSERSTACK_TEST_OBSERVABILITY','waitForBuildStatus','Testhub\x20started\x20with\x20id:\x20','getTraceFilePaths','toISOString','33235cMureQ','settings','token','getFrameworkDetails','isBrowserstackInfra','finished_metadata','BROWSERSTACK_TEST_ACCESSIBILITY_PLATFORM','XfMuD','3exOtQU','zYhJW','../helper','bESoF','1161026HHUsxK','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','mECwI','status','stopBuildUpstream\x20event\x20successful!','cuUpt','getProductMap','ENrsj','username','getGitMetaData','XgIne','push','../performance/performance-tester.js','authToken','exports','buildIdentifier','\x20framework','config','percy','BS_TESTOPS_BUILD_COMPLETED','Percy\x20is\x20not\x20supported\x20for\x20','error','fPBGj','job_id','cwd','./utils.js','includeEncodedExtension','success','getUserName','../helper.js','buildDescription','ACCESSIBILITY','NwBES','XzAfb','282ZmcoOz','cvjLN','All\x20trace\x20zip\x20send\x20events\x20complete','../test-observability/utils','OBSERVABILITY','./constants.js','ENV_VAR','2848056KfvbJc','hXoho','lcnc','BROWSERSTACK_RERUN','generateBuildUpstreamData','null','format','getCiInfo','debug','measureWrapper','/stop','BROWSERSTACK_TESTHUB_JWT','riTKj','winstonLogger','statusText','STOP','accessibilityOptions','info','871768VjhIKZ','response','TESTHUB_BUILD_API','getConfig','processTraceZips','YhnUP','launchBuild','qhJIL','central_scanner','framework','Error\x20while\x20waiting\x20for\x20events:\x20','14812470fiHrvS','BROWSERSTACK_TESTHUB_UUID','ruIzJ','LLfDA','auth','VKvqK','buildHashedId','../performance/constants','getInstance','BROWSERSTACK_BUILD_RUN_IDENTIFIER','HWvnr','basename','allowScreenshot','BROWSERSTACK_CENTRAL_SCANNER_JWT','getProductMapForBuildStartCall','path','user_killed','BROWSERSTACK_CENTRAL_SCANNER_JOBID','true','../test-observability/sessionHandler.js','extractDataFromResponse','WrqEV','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','noIhM','assign','getHostInfo'];a129_0x7b69=function(){return _0x127a08;};return a129_0x7b69();}const bsSetupHelper=require(a129_0x4a5e99(0xc6)),path=require(a129_0x4a5e99(0x11d)),util=require('util'),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require(a129_0x4a5e99(0xed)),testhubUtils=require(a129_0x4a5e99(0xe1)),testHubConstants=require(a129_0x4a5e99(0xef)),constants=require(a129_0x4a5e99(0x8e)),RequestQueueHandler=require('../test-observability/requestQueueHandler.js'),logger=require(a129_0x4a5e99(0xa2))[a129_0x4a5e99(0xfe)],SessionHandler=require(a129_0x4a5e99(0x121)),PerformanceTester=require(a129_0x4a5e99(0xd4)),{TESTHUB_EVENTS:PerformanceEvents}=require(a129_0x4a5e99(0x115)),TestDetails=require(a129_0x4a5e99(0xa3)),{uploadTraceZip}=require(a129_0x4a5e99(0x9b)),{isTurboScaleSession}=require(a129_0x4a5e99(0xe5)),BrowserstackCLI=require('../../bin/v2/browserstackCLI'),OngoingEvents=new Set();let processedTraceZips=![];function a129_0x4d43(_0x234bd9,_0x1026b3){const _0x7b69f7=a129_0x7b69();return a129_0x4d43=function(_0x4d4396,_0x240546){_0x4d4396=_0x4d4396-0x86;let _0x270f95=_0x7b69f7[_0x4d4396];return _0x270f95;},a129_0x4d43(_0x234bd9,_0x1026b3);}const addEvent=_0xd5fb9c=>{OngoingEvents['add'](_0xd5fb9c);},awaitAllEvents=async()=>{const _0x54c7f1=a129_0x4a5e99;return Promise[_0x54c7f1(0x8b)](OngoingEvents);};class TestHubHandler{static [a129_0x4a5e99(0xa7)]=![];static async[a129_0x4a5e99(0x109)](_0x5536a1,_0x16989b){const _0x538c2d=a129_0x4a5e99,_0x3dfb0f={'FgeUJ':function(_0x59eda8,_0x4db79d){return _0x59eda8||_0x4db79d;},'gJZjG':function(_0x1b0bc2,_0x2363ea){return _0x1b0bc2===_0x2363ea;},'BINcY':function(_0xa84e14){return _0xa84e14();},'zYhJW':_0x538c2d(0x92),'qVzsT':_0x538c2d(0xa4),'PgbQX':_0x538c2d(0xc9),'cvjLN':function(_0x2ab3b9,_0x28bc00,_0x1ad7d6,_0x54c812,_0x588f8d){return _0x2ab3b9(_0x28bc00,_0x1ad7d6,_0x54c812,_0x588f8d);},'oKBma':'POST','xzSzv':function(_0x487744,_0x1978c7){return _0x487744===_0x1978c7;},'VKvqK':'accessibility','YhnUP':_0x538c2d(0x120)};await PerformanceTester[_0x538c2d(0xfa)](PerformanceEvents[_0x538c2d(0xb2)],async()=>{const _0x215123=_0x538c2d,_0x35fb0c=Object[_0x215123(0x86)]({},_0x16989b[_0x215123(0xd9)],{'root_dir_path':'','framework':_0x16989b[_0x215123(0x10c)]}),_0x4a4e98=bsSetupHelper[_0x215123(0xe4)](_0x35fb0c),_0x5d9ee1=bsSetupHelper['getAccessKey'](_0x35fb0c),_0x21d495=_0x3dfb0f[_0x215123(0xb0)](_0x4a4e98,'')+':'+_0x3dfb0f[_0x215123(0xb0)](_0x5d9ee1,''),_0x604a21=testhubUtils[_0x215123(0xce)](_0x35fb0c);process[_0x215123(0xa8)][_0x215123(0x91)]=JSON[_0x215123(0x93)](_0x604a21);if(_0x3dfb0f[_0x215123(0x9d)](_0x21d495,':'))return _0x3dfb0f['BINcY'](isTestObservabilitySession)&&(logger[_0x215123(0xf9)](_0x3dfb0f[_0x215123(0xc5)]),process[_0x215123(0xa8)][_0x215123(0xdb)]=_0x3dfb0f[_0x215123(0x8d)]),testhubUtils['isAccessibilityEnabled'](_0x35fb0c)&&logger[_0x215123(0xf9)](_0x3dfb0f[_0x215123(0xb5)]),[null,null];try{const _0x284982=await this['generateBuildUpstreamData'](_0x35fb0c,_0x5536a1),_0x46014a=this[_0x215123(0x106)](_0x4a4e98,_0x5d9ee1),_0xf8a032=await _0x3dfb0f[_0x215123(0xeb)](nodeRequest,_0x3dfb0f[_0x215123(0x98)],testHubConstants[_0x215123(0x105)],_0x284982,_0x46014a),_0x543403=this[_0x215123(0x122)](_0x35fb0c,_0xf8a032,_0x46014a);await this[_0x215123(0xae)](_0x16989b,_0x5536a1);if(_0x3dfb0f[_0x215123(0x90)](testhubUtils[_0x215123(0xab)](_0x16989b[_0x215123(0xd9)]),null)){const _0x443906=_0x543403[_0x3dfb0f[_0x215123(0x113)]];_0x443906&&_0x443906[_0x215123(0xd5)]&&_0x443906[_0x215123(0x114)]&&(_0x16989b[_0x215123(0xd9)][_0x215123(0x9a)]=!![],process[_0x215123(0xa8)][_0x215123(0xc2)]=_0x3dfb0f[_0x215123(0x108)]);}return _0x543403;}catch(_0x48605b){if(_0x3dfb0f['gJZjG'](_0x48605b['success'],![])){testhubUtils[_0x215123(0x8c)](_0x48605b);return;}}})();}static async[a129_0x4a5e99(0x107)](){const _0x1907b7=a129_0x4a5e99,_0x35cde0={'GRUBC':function(_0x3af50a,_0x4fc41a,_0x49c224){return _0x3af50a(_0x4fc41a,_0x49c224);},'hYplR':function(_0x55437b,_0xe840e){return _0x55437b(_0xe840e);},'mECwI':function(_0x2f0d8c){return _0x2f0d8c();},'iCbTK':_0x1907b7(0xec)};if(processedTraceZips)return;const _0x13a009=TestDetails[_0x1907b7(0xba)]();_0x13a009[_0x1907b7(0x89)](({testUId:_0x2993d1,filePath:_0x4cf4a0})=>{const _0xf10ec=_0x1907b7;var _0x4d88a3=_0x35cde0[_0xf10ec(0x9e)](uploadTraceZip,_0x4cf4a0,_0x2993d1);_0x35cde0[_0xf10ec(0x8f)](addEvent,_0x4d88a3);});try{await _0x35cde0[_0x1907b7(0xca)](awaitAllEvents),logger[_0x1907b7(0xf9)](_0x35cde0['iCbTK']),processedTraceZips=!![];}catch(_0x28c563){logger[_0x1907b7(0xdd)](_0x1907b7(0x10d)+util[_0x1907b7(0xf7)](_0x28c563));}}static async[a129_0x4a5e99(0xae)](_0x2e50ea,_0x566bd4){const _0x55e339=a129_0x4a5e99;if(constants[_0x55e339(0xa1)]['includes'](_0x566bd4)){await _0x2e50ea['setupPercy']();return;}_0x2e50ea['config'][_0x55e339(0xda)]&&logger[_0x55e339(0xf9)](_0x55e339(0xdc)+_0x566bd4+_0x55e339(0xd8));}static[a129_0x4a5e99(0x97)](_0x3490a9){const _0x591f80=a129_0x4a5e99,_0x270f17={'WrqEV':function(_0x5d9f07,_0x3ed158){return _0x5d9f07(_0x3ed158);},'XzAfb':_0x591f80(0x120)};let _0x16ce2b;if(_0x3490a9['accessibilityOptions']){const _0x4d7bdc={};_0x4d7bdc['settings']=_0x3490a9[_0x591f80(0x101)],_0x16ce2b=_0x4d7bdc;}else{const _0x594f2b={};_0x594f2b[_0x591f80(0xbd)]={},_0x16ce2b=_0x594f2b;}if((!bsSetupHelper[_0x591f80(0xc0)]()||_0x270f17[_0x591f80(0x123)](isTurboScaleSession,_0x3490a9))&&testhubUtils[_0x591f80(0xb3)](_0x3490a9)){const _0x843799={};_0x843799[_0x591f80(0xe2)]=_0x270f17[_0x591f80(0xe9)],Object['assign'](_0x16ce2b[_0x591f80(0xbd)],_0x843799);}return _0x16ce2b;}static[a129_0x4a5e99(0x106)](_0x4df6ec,_0x388c9e){const _0x3a2aaf=a129_0x4a5e99,_0x938499={'XgIne':function(_0xbf6621,_0x42f7a5){return _0xbf6621(_0x42f7a5);}},_0x5cfdca={};return _0x5cfdca[_0x3a2aaf(0xd0)]=_0x4df6ec,_0x5cfdca[_0x3a2aaf(0xa0)]=_0x388c9e,{'auth':_0x5cfdca,'headers':_0x938499[_0x3a2aaf(0xd2)](getDefaultHeaders,![])};}static async[a129_0x4a5e99(0xf5)](_0x4f3373,_0x91c519){const _0x395011=a129_0x4a5e99,_0x4013c0={'bupaK':'Generating\x20build\x20upstream\x20data\x20for\x20TestHub','fFXmc':function(_0x5a778b,_0x392b6b){return _0x5a778b(_0x392b6b);}};logger[_0x395011(0xf9)](_0x4013c0[_0x395011(0x8a)]);const _0x4655e8={'project_name':_0x4f3373[_0x395011(0xaa)]||'','name':_0x4f3373['buildName']||path[_0x395011(0x119)](path['resolve'](process[_0x395011(0xe0)]())),'build_identifier':_0x4f3373[_0x395011(0xd7)],'description':_0x4f3373[_0x395011(0xe6)]||'','started_at':new Date()[_0x395011(0xbb)](),'tags':_0x4013c0[_0x395011(0x99)](getCustomTags,_0x4f3373),'host_info':bsSetupHelper[_0x395011(0x87)](),'ci_info':bsSetupHelper[_0x395011(0xf8)](),'build_run_identifier':process[_0x395011(0xa8)][_0x395011(0x117)],'failed_tests_rerun':process[_0x395011(0xa8)][_0x395011(0xf4)]||![],'linked_build_uuid':process['env'][_0x395011(0xb1)]||'','version_control':await bsSetupHelper[_0x395011(0xd1)](),'accessibility':this['getAccessibilityOptions'](_0x4f3373),'framework_details':testhubUtils[_0x395011(0xbf)](_0x4f3373,_0x91c519),'product_map':testhubUtils[_0x395011(0x11c)](_0x4f3373),'browserstackAutomation':bsSetupHelper[_0x395011(0xc0)](),'grouping_identifier':process[_0x395011(0xa8)]['BROWSERSTACK_BUILD_GROUPING_IDENTIFIER'],'test_orchestration':testhubUtils[_0x395011(0xad)](_0x4f3373)};if(bsSetupHelper['getCentralUser']()[_0x395011(0x10b)]||bsSetupHelper['getCentralUser']()[_0x395011(0xf3)]){const _0xb28138={};_0xb28138[_0x395011(0xdf)]=process[_0x395011(0xa8)][_0x395011(0x11f)],_0xb28138[_0x395011(0xbe)]=process[_0x395011(0xa8)][_0x395011(0x11b)],_0x4655e8[_0x395011(0x10b)]=_0xb28138;}return _0x4655e8;}static[a129_0x4a5e99(0x122)](_0x41c52a,_0x5384a0,_0x4208fe){const _0x46fcaf=a129_0x4a5e99,_0x984132={'hXoho':function(_0x55613f){return _0x55613f();},'bESoF':function(_0x2534e2,_0x543696){return _0x2534e2&&_0x543696;},'NwBES':_0x46fcaf(0x120),'qhJIL':_0x46fcaf(0xa4)},_0x39752f={};if(_0x984132[_0x46fcaf(0xf2)](isTestObservabilitySession)){const [_0x3b7a4f,_0x42a26b,_0x477ee1]=testhubUtils['setTestObservabilityVariables'](_0x5384a0[_0x46fcaf(0x94)],_0x4208fe[_0x46fcaf(0x112)]);if(_0x984132[_0x46fcaf(0xc7)](_0x3b7a4f,_0x42a26b)){const _0x2be161={};_0x2be161[_0x46fcaf(0x96)]=_0x3b7a4f,_0x2be161['buildHashedId']=_0x42a26b,_0x2be161[_0x46fcaf(0x11a)]=_0x477ee1,_0x39752f[testHubConstants[_0x46fcaf(0xee)]]=_0x2be161,process[_0x46fcaf(0xa8)][_0x46fcaf(0xb7)]=_0x984132[_0x46fcaf(0xe8)];}else _0x39752f[testHubConstants['OBSERVABILITY']]={},process[_0x46fcaf(0xa8)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x984132[_0x46fcaf(0x10a)];}else process[_0x46fcaf(0xa8)][_0x46fcaf(0xb7)]=_0x984132[_0x46fcaf(0x10a)];const [_0x5a3d0d,_0x3f1a13]=testhubUtils['setAccessibilityVariables'](_0x5384a0[_0x46fcaf(0x94)]);if(_0x984132[_0x46fcaf(0xc7)](_0x5a3d0d,_0x3f1a13)){const _0x477fbd={};_0x477fbd['authToken']=_0x5a3d0d,_0x477fbd[_0x46fcaf(0x114)]=_0x3f1a13,_0x39752f[testHubConstants[_0x46fcaf(0xe7)]]=_0x477fbd,process[_0x46fcaf(0xa8)][_0x46fcaf(0xa6)]=_0x984132['NwBES'];}else _0x39752f[testHubConstants[_0x46fcaf(0xe7)]]={},process[_0x46fcaf(0xa8)]['BROWSERSTACK_ACCESSIBILITY']=_0x984132[_0x46fcaf(0x10a)];return testhubUtils['setTestHubCommonMetaInfo'](_0x5384a0[_0x46fcaf(0x94)]),logger[_0x46fcaf(0x102)](_0x46fcaf(0xb9)+process['env'][_0x46fcaf(0x10f)]),_0x39752f;}static async['stop'](_0x399c19){const _0x104268=a129_0x4a5e99,_0x16367f={'qBvnU':function(_0x407fa6,_0x1ddf75){return _0x407fa6===_0x1ddf75;},'ENrsj':_0x104268(0xa4),'riTKj':_0x104268(0xf6),'fPBGj':_0x104268(0x124),'LLfDA':_0x104268(0xdd),'ctePf':_0x104268(0xa9),'fFJDq':_0x104268(0xc1),'XfMuD':_0x104268(0x11e),'ruIzJ':function(_0x27a3de){return _0x27a3de();},'cuUpt':function(_0x13b584,_0x1464c3,_0x3f66e5,_0x1e82dd,_0x15a270,_0x39db5f){return _0x13b584(_0x1464c3,_0x3f66e5,_0x1e82dd,_0x15a270,_0x39db5f);},'HWvnr':_0x104268(0xaf),'DlDjP':_0x104268(0xcc),'noIhM':_0x104268(0xe3)};await PerformanceTester['measureWrapper'](PerformanceEvents[_0x104268(0x100)],async()=>{const _0x54b134=_0x104268;if(_0x16367f[_0x54b134(0x95)](process[_0x54b134(0xa8)][_0x54b134(0xdb)],_0x16367f[_0x54b134(0xcf)])||TestHubHandler['buildStopSent']||bsSetupHelper['isUndefined'](process[_0x54b134(0xa8)][testHubConstants[_0x54b134(0xf0)][_0x54b134(0xfc)]]))return;TestHubHandler['buildStopSent']=!![];if(BrowserstackCLI[_0x54b134(0x116)]()['isRunning']())return;await this[_0x54b134(0x107)](),await RequestQueueHandler[_0x54b134(0x116)]()['uploadPending'](),await SessionHandler[_0x54b134(0xb8)]();if(_0x16367f[_0x54b134(0x95)](process[_0x54b134(0xa8)][testHubConstants[_0x54b134(0xf0)][_0x54b134(0xfc)]],_0x16367f[_0x54b134(0xfd)])||_0x16367f[_0x54b134(0x95)](process[_0x54b134(0xa8)][testHubConstants[_0x54b134(0xf0)][_0x54b134(0x10f)]],_0x16367f[_0x54b134(0xfd)])){logger['debug'](_0x16367f[_0x54b134(0xde)]);const _0x1237dd={};return _0x1237dd[_0x54b134(0xcb)]=_0x16367f[_0x54b134(0x111)],_0x1237dd[_0x54b134(0xb6)]=_0x16367f[_0x54b134(0x9f)],_0x1237dd;}const _0x2a128c={'finished_at':new Date()[_0x54b134(0xbb)](),'finished_metadata':[]};!!_0x399c19&&_0x2a128c[_0x16367f[_0x54b134(0x88)]][_0x54b134(0xd3)]({'reason':_0x16367f[_0x54b134(0xc3)],'signal':_0x399c19,'failure_data':''});const _0x3a853f={'headers':_0x16367f[_0x54b134(0x110)](getDefaultHeaders)};try{const _0x9dde18=await _0x16367f[_0x54b134(0xcd)](nodeRequest,_0x16367f[_0x54b134(0x118)],_0x54b134(0xac)+process[_0x54b134(0xa8)][testHubConstants['ENV_VAR']['BROWSERSTACK_TESTHUB_UUID']]+_0x54b134(0xfb),_0x2a128c,_0x3a853f,![]);if(_0x9dde18['data']&&_0x9dde18[_0x54b134(0x94)][_0x54b134(0xdd)]){const _0x38317d={};_0x38317d['message']=_0x9dde18[_0x54b134(0x94)][_0x54b134(0xdd)];throw _0x38317d;}else{logger[_0x54b134(0xf9)](_0x16367f[_0x54b134(0xa5)]);const _0x157cb5={};return _0x157cb5['status']=_0x16367f[_0x54b134(0x125)],_0x157cb5['message']='',_0x157cb5;}}catch(_0x2409a2){_0x2409a2[_0x54b134(0x104)]?logger['debug']('EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20'+_0x2409a2[_0x54b134(0x104)][_0x54b134(0xcb)]+'\x20'+_0x2409a2[_0x54b134(0x104)][_0x54b134(0xff)]+'\x20'+JSON['stringify'](_0x2409a2[_0x54b134(0x104)]['data'])):logger['debug']('EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20'+(_0x2409a2['message']||_0x2409a2));const _0x5b9ab6={};return _0x5b9ab6[_0x54b134(0xcb)]=_0x16367f['LLfDA'],_0x5b9ab6[_0x54b134(0xb6)]=_0x2409a2[_0x54b134(0xb6)]||_0x2409a2[_0x54b134(0x104)]?_0x2409a2[_0x54b134(0x104)][_0x54b134(0xcb)]+':'+_0x2409a2[_0x54b134(0x104)][_0x54b134(0xff)]:_0x2409a2,_0x5b9ab6;}})();}}module[a129_0x4a5e99(0xd6)]=TestHubHandler;