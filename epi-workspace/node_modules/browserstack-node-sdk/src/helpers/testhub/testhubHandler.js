const a90_0x4daca0=a90_0x1abd;(function(_0x39cb3b,_0x4eaf69){const _0x58ab75=a90_0x1abd,_0x4e8425=_0x39cb3b();while(!![]){try{const _0x2149fc=parseInt(_0x58ab75(0x14a))/0x1*(-parseInt(_0x58ab75(0x11c))/0x2)+parseInt(_0x58ab75(0x11e))/0x3+-parseInt(_0x58ab75(0x143))/0x4*(parseInt(_0x58ab75(0x154))/0x5)+-parseInt(_0x58ab75(0x155))/0x6*(parseInt(_0x58ab75(0x111))/0x7)+parseInt(_0x58ab75(0x14f))/0x8+-parseInt(_0x58ab75(0xf8))/0x9+parseInt(_0x58ab75(0x133))/0xa;if(_0x2149fc===_0x4eaf69)break;else _0x4e8425['push'](_0x4e8425['shift']());}catch(_0x2eafec){_0x4e8425['push'](_0x4e8425['shift']());}}}(a90_0xa551,0xf0116));const bsSetupHelper=require(a90_0x4daca0(0x11b)),path=require(a90_0x4daca0(0x134)),util=require(a90_0x4daca0(0x14b)),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require('../test-observability/utils'),testhubUtils=require(a90_0x4daca0(0x158)),testHubConstants=require(a90_0x4daca0(0x121)),constants=require('../../bin/utils/constants.js'),RequestQueueHandler=require('../test-observability/requestQueueHandler.js'),logger=require(a90_0x4daca0(0x132))[a90_0x4daca0(0xee)],SessionHandler=require(a90_0x4daca0(0x161)),PerformanceTester=require(a90_0x4daca0(0x122)),{TESTHUB_EVENTS:PerformanceEvents}=require(a90_0x4daca0(0x13c)),TestDetails=require('../../bin/playwright/reporter/test-details.js'),{uploadTraceZip}=require(a90_0x4daca0(0x136)),OngoingEvents=new Set();let processedTraceZips=![];function a90_0x1abd(_0x333e6f,_0x45037c){const _0xa551f4=a90_0xa551();return a90_0x1abd=function(_0x1abde0,_0x573b52){_0x1abde0=_0x1abde0-0xda;let _0x373e7e=_0xa551f4[_0x1abde0];return _0x373e7e;},a90_0x1abd(_0x333e6f,_0x45037c);}const addEvent=_0x335e40=>{const _0xb09fb1=a90_0x4daca0;OngoingEvents[_0xb09fb1(0xfa)](_0x335e40);},awaitAllEvents=async()=>{const _0x5dd6e3=a90_0x4daca0;return Promise[_0x5dd6e3(0x163)](OngoingEvents);};class TestHubHandler{static [a90_0x4daca0(0x100)]=![];static async[a90_0x4daca0(0x141)](_0x5ed7fc,_0x226566){const _0x44894f=a90_0x4daca0,_0x2d91d7={'QoBew':function(_0x12d28d,_0x38faaa){return _0x12d28d||_0x38faaa;},'wbYBc':function(_0x4ed1ce,_0x31d678){return _0x4ed1ce===_0x31d678;},'IylJH':function(_0x3b94ab){return _0x3b94ab();},'WpuCI':'EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','fbvoc':_0x44894f(0x12a),'lnZdo':_0x44894f(0x10f),'pqdlQ':function(_0x1c8157,_0x450cac,_0x397705,_0x2b28d2,_0x192f42){return _0x1c8157(_0x450cac,_0x397705,_0x2b28d2,_0x192f42);},'zIdML':'POST','UWrzD':function(_0x4e4d1a,_0x111b78){return _0x4e4d1a===_0x111b78;}};await PerformanceTester[_0x44894f(0x124)](PerformanceEvents[_0x44894f(0x15b)],async()=>{const _0x9b782a=_0x44894f,_0x749998=Object[_0x9b782a(0x152)]({},_0x226566[_0x9b782a(0xe6)],{'root_dir_path':'','framework':_0x226566[_0x9b782a(0x153)]}),_0x136c18=bsSetupHelper[_0x9b782a(0xfb)](_0x749998),_0x1b61ed=bsSetupHelper[_0x9b782a(0xed)](_0x749998),_0x58ee82=_0x2d91d7[_0x9b782a(0x140)](_0x136c18,'')+':'+_0x2d91d7['QoBew'](_0x1b61ed,''),_0x5c06d5=testhubUtils[_0x9b782a(0x15e)](_0x749998);process[_0x9b782a(0x11a)][_0x9b782a(0xe3)]=JSON[_0x9b782a(0x14e)](_0x5c06d5);if(_0x2d91d7[_0x9b782a(0x10a)](_0x58ee82,':'))return _0x2d91d7[_0x9b782a(0x11d)](isTestObservabilitySession)&&(logger[_0x9b782a(0x126)](_0x2d91d7[_0x9b782a(0x118)]),process['env'][_0x9b782a(0x15a)]=_0x2d91d7['fbvoc']),testhubUtils[_0x9b782a(0x117)](_0x749998)&&logger[_0x9b782a(0x126)](_0x2d91d7['lnZdo']),[null,null];try{const _0x643d6a=await this[_0x9b782a(0xef)](_0x749998,_0x5ed7fc),_0x1f0d35=this[_0x9b782a(0x12b)](_0x136c18,_0x1b61ed),_0x2aeaaf=await _0x2d91d7['pqdlQ'](nodeRequest,_0x2d91d7[_0x9b782a(0xfc)],testHubConstants[_0x9b782a(0x13e)],_0x643d6a,_0x1f0d35),_0x5a898b=this[_0x9b782a(0x139)](_0x749998,_0x2aeaaf,_0x1f0d35);return await this[_0x9b782a(0x12f)](_0x226566,_0x5ed7fc),_0x5a898b;}catch(_0x28f252){if(_0x2d91d7[_0x9b782a(0x119)](_0x28f252[_0x9b782a(0x146)],![])){testhubUtils[_0x9b782a(0x12e)](_0x28f252);return;}}})();}static async[a90_0x4daca0(0x105)](){const _0x2cd2ed=a90_0x4daca0,_0x550543={'yUyuh':function(_0x39afcb,_0x5c9d18,_0x18ed5d){return _0x39afcb(_0x5c9d18,_0x18ed5d);},'egeVR':function(_0x2e6fbc,_0x18af73){return _0x2e6fbc(_0x18af73);},'DZnca':function(_0x3092f4){return _0x3092f4();},'YfnPg':_0x2cd2ed(0x145)};if(processedTraceZips)return;const _0x27655d=TestDetails[_0x2cd2ed(0x12d)]();_0x27655d[_0x2cd2ed(0x112)](({testUId:_0x41820b,filePath:_0x5a85e2})=>{const _0x407766=_0x2cd2ed;var _0x379db7=_0x550543[_0x407766(0x15d)](uploadTraceZip,_0x5a85e2,_0x41820b);_0x550543[_0x407766(0xf3)](addEvent,_0x379db7);});try{await _0x550543[_0x2cd2ed(0x102)](awaitAllEvents),logger[_0x2cd2ed(0x126)](_0x550543[_0x2cd2ed(0xf6)]),processedTraceZips=!![];}catch(_0x22a6c4){logger[_0x2cd2ed(0xdd)](_0x2cd2ed(0x144)+util[_0x2cd2ed(0x10d)](_0x22a6c4));}}static async[a90_0x4daca0(0x12f)](_0x310b68,_0x2afa7c){const _0x36635e=a90_0x4daca0;if(constants['PERCY_SUPPORTED_FRAMEWORKS']['includes'](_0x2afa7c)){await _0x310b68[_0x36635e(0x10e)]();return;}_0x310b68[_0x36635e(0xe6)][_0x36635e(0xf2)]&&logger[_0x36635e(0x126)](_0x36635e(0x157)+_0x2afa7c+_0x36635e(0x164));}static[a90_0x4daca0(0xdf)](_0x548482){const _0x5cc1bd=a90_0x4daca0,_0x261ef6={};_0x261ef6[_0x5cc1bd(0x159)]=_0x548482[_0x5cc1bd(0xf9)];const _0x39a653=_0x261ef6;return _0x39a653;}static[a90_0x4daca0(0x12b)](_0x5a70e0,_0x285814){const _0x1bd6cb=a90_0x4daca0,_0x2341fa={'UHmRb':function(_0x459048,_0x3fb697){return _0x459048(_0x3fb697);}},_0xe17d7b={};return _0xe17d7b['username']=_0x5a70e0,_0xe17d7b[_0x1bd6cb(0x101)]=_0x285814,{'auth':_0xe17d7b,'headers':_0x2341fa[_0x1bd6cb(0x142)](getDefaultHeaders,![])};}static async[a90_0x4daca0(0xef)](_0x34f899,_0x170ccc){const _0xdf5967=a90_0x4daca0,_0x14286b={'lXRpq':function(_0x59940a,_0x5ab880){return _0x59940a(_0x5ab880);}},_0x1d4881={'project_name':_0x34f899['projectName']||'','name':_0x34f899['buildName']||path[_0xdf5967(0xe5)](path['resolve'](process[_0xdf5967(0x13a)]())),'build_identifier':_0x34f899['buildIdentifier'],'description':_0x34f899[_0xdf5967(0xf7)]||'','started_at':new Date()[_0xdf5967(0x13d)](),'tags':_0x14286b['lXRpq'](getCustomTags,_0x34f899),'host_info':bsSetupHelper[_0xdf5967(0x151)](),'ci_info':bsSetupHelper[_0xdf5967(0x138)](),'build_run_identifier':process[_0xdf5967(0x11a)][_0xdf5967(0xea)],'failed_tests_rerun':process['env'][_0xdf5967(0x11f)]||![],'version_control':await bsSetupHelper[_0xdf5967(0xda)](),'accessibility':this['getAccessibilityOptions'](_0x34f899),'framework_details':testhubUtils[_0xdf5967(0x125)](_0x34f899,_0x170ccc),'product_map':testhubUtils[_0xdf5967(0x15e)](_0x34f899),'browserstackAutomation':bsSetupHelper['isBrowserstackInfra'](),'grouping_identifier':process[_0xdf5967(0x11a)]['BROWSERSTACK_BUILD_GROUPING_IDENTIFIER']};if(bsSetupHelper[_0xdf5967(0xe9)]()[_0xdf5967(0xf4)]||bsSetupHelper[_0xdf5967(0xe9)]()[_0xdf5967(0xdb)]){const _0x14ab3b={};_0x14ab3b[_0xdf5967(0x147)]=process['env'][_0xdf5967(0x129)],_0x14ab3b['token']=process[_0xdf5967(0x11a)]['BROWSERSTACK_CENTRAL_SCANNER_JWT'],_0x1d4881[_0xdf5967(0xf4)]=_0x14ab3b;}return _0x1d4881;}static[a90_0x4daca0(0x139)](_0xa56df1,_0x5d7822,_0x36cf3c){const _0x1b2b98=a90_0x4daca0,_0x4a524c={'Utflp':function(_0x8fa458){return _0x8fa458();},'gMjVP':function(_0x242619,_0x4451fb){return _0x242619&&_0x4451fb;},'LNBpM':_0x1b2b98(0x149),'xuiNf':'false'},_0x2848f0={};if(_0x4a524c[_0x1b2b98(0x137)](isTestObservabilitySession)){const [_0x1fa982,_0xd58674,_0x357a29]=testhubUtils[_0x1b2b98(0xe8)](_0x5d7822[_0x1b2b98(0xff)],_0x36cf3c[_0x1b2b98(0x116)]);if(_0x4a524c[_0x1b2b98(0x15f)](_0x1fa982,_0xd58674)){const _0x3600f5={};_0x3600f5[_0x1b2b98(0xfd)]=_0x1fa982,_0x3600f5[_0x1b2b98(0x160)]=_0xd58674,_0x3600f5[_0x1b2b98(0x14c)]=_0x357a29,_0x2848f0[testHubConstants[_0x1b2b98(0x128)]]=_0x3600f5,process[_0x1b2b98(0x11a)][_0x1b2b98(0xe1)]=_0x4a524c[_0x1b2b98(0xde)];}else _0x2848f0[testHubConstants[_0x1b2b98(0x128)]]={},process[_0x1b2b98(0x11a)][_0x1b2b98(0xe1)]=_0x4a524c[_0x1b2b98(0x13b)];}else process[_0x1b2b98(0x11a)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x4a524c['xuiNf'];if(testhubUtils['isAccessibilityEnabled'](_0xa56df1)){const [_0x3e04e0,_0x10c3dd]=testhubUtils[_0x1b2b98(0x114)](_0x5d7822[_0x1b2b98(0xff)]);if(_0x4a524c[_0x1b2b98(0x15f)](_0x3e04e0,_0x10c3dd)){const _0x3e8b6b={};_0x3e8b6b[_0x1b2b98(0x127)]=_0x3e04e0,_0x3e8b6b[_0x1b2b98(0x160)]=_0x10c3dd,_0x2848f0[testHubConstants[_0x1b2b98(0x148)]]=_0x3e8b6b,process[_0x1b2b98(0x11a)][_0x1b2b98(0x109)]=_0x4a524c[_0x1b2b98(0xde)];}else _0x2848f0[testHubConstants[_0x1b2b98(0x148)]]={},process[_0x1b2b98(0x11a)][_0x1b2b98(0x109)]=_0x4a524c[_0x1b2b98(0x13b)];}else process[_0x1b2b98(0x11a)][_0x1b2b98(0x109)]=_0x4a524c['xuiNf'];return testhubUtils[_0x1b2b98(0x113)](_0x5d7822[_0x1b2b98(0xff)]),logger[_0x1b2b98(0x104)](_0x1b2b98(0x162)+process['env'][_0x1b2b98(0xdc)]),_0x2848f0;}static async[a90_0x4daca0(0x10b)](_0x3f6435){const _0x245d21=a90_0x4daca0,_0x496447={'Vlykk':function(_0x194021,_0x45efed){return _0x194021===_0x45efed;},'SaHnM':_0x245d21(0x12a),'pFxhw':_0x245d21(0x130),'krtFT':_0x245d21(0xe0),'SMyZd':_0x245d21(0xdd),'ZlaPq':_0x245d21(0x14d),'wwjgu':_0x245d21(0x10c),'ViPEj':_0x245d21(0xeb),'WaeHx':function(_0x3f49d9){return _0x3f49d9();},'cjnEE':function(_0x51659b,_0x49aa45,_0x3d0088,_0x101dde,_0x242e85,_0x34b460){return _0x51659b(_0x49aa45,_0x3d0088,_0x101dde,_0x242e85,_0x34b460);},'RYpGX':'PUT','sJqtW':'stopBuildUpstream\x20event\x20successful!','euuuz':_0x245d21(0x146)};await this[_0x245d21(0x105)](),await PerformanceTester[_0x245d21(0x124)](PerformanceEvents[_0x245d21(0x12c)],async()=>{const _0x132d6e=_0x245d21;if(_0x496447[_0x132d6e(0x156)](process[_0x132d6e(0x11a)][_0x132d6e(0x15a)],_0x496447[_0x132d6e(0xf0)])||TestHubHandler[_0x132d6e(0x100)]||bsSetupHelper['isUndefined'](process[_0x132d6e(0x11a)][testHubConstants[_0x132d6e(0x103)][_0x132d6e(0xe7)]]))return;TestHubHandler[_0x132d6e(0x100)]=!![],await RequestQueueHandler['getInstance']()[_0x132d6e(0x107)](),await SessionHandler[_0x132d6e(0x13f)]();if(_0x496447['Vlykk'](process[_0x132d6e(0x11a)][testHubConstants['ENV_VAR'][_0x132d6e(0xe7)]],_0x496447[_0x132d6e(0x150)])||_0x496447[_0x132d6e(0x156)](process[_0x132d6e(0x11a)][testHubConstants['ENV_VAR'][_0x132d6e(0xdc)]],_0x496447['pFxhw'])){logger[_0x132d6e(0x126)](_0x496447[_0x132d6e(0xe4)]);const _0x7a7119={};return _0x7a7119[_0x132d6e(0x131)]=_0x496447['SMyZd'],_0x7a7119[_0x132d6e(0x106)]=_0x496447[_0x132d6e(0xfe)],_0x7a7119;}const _0x4bfe6e={'finished_at':new Date()[_0x132d6e(0x13d)](),'finished_metadata':[]};!!_0x3f6435&&_0x4bfe6e[_0x496447[_0x132d6e(0xf1)]]['push']({'reason':_0x496447[_0x132d6e(0x110)],'signal':_0x3f6435,'failure_data':''});const _0x350503={'headers':_0x496447[_0x132d6e(0xec)](getDefaultHeaders)};try{const _0x5f195b=await _0x496447[_0x132d6e(0x15c)](nodeRequest,_0x496447['RYpGX'],'api/v1/builds/'+process[_0x132d6e(0x11a)][testHubConstants['ENV_VAR']['BROWSERSTACK_TESTHUB_UUID']]+_0x132d6e(0x123),_0x4bfe6e,_0x350503,![]);if(_0x5f195b['data']&&_0x5f195b[_0x132d6e(0xff)][_0x132d6e(0xdd)]){const _0x57284f={};_0x57284f[_0x132d6e(0x106)]=_0x5f195b['data'][_0x132d6e(0xdd)];throw _0x57284f;}else{logger[_0x132d6e(0x126)](_0x496447['sJqtW']);const _0x2a993f={};return _0x2a993f[_0x132d6e(0x131)]=_0x496447[_0x132d6e(0xe2)],_0x2a993f[_0x132d6e(0x106)]='',_0x2a993f;}}catch(_0xf69d54){_0xf69d54[_0x132d6e(0x135)]?logger[_0x132d6e(0x126)](_0x132d6e(0xf5)+_0xf69d54[_0x132d6e(0x135)][_0x132d6e(0x131)]+'\x20'+_0xf69d54[_0x132d6e(0x135)][_0x132d6e(0x108)]+'\x20'+JSON[_0x132d6e(0x14e)](_0xf69d54[_0x132d6e(0x135)][_0x132d6e(0xff)])):logger[_0x132d6e(0x126)](_0x132d6e(0xf5)+(_0xf69d54[_0x132d6e(0x106)]||_0xf69d54));const _0x16091e={};return _0x16091e[_0x132d6e(0x131)]=_0x496447[_0x132d6e(0x115)],_0x16091e['message']=_0xf69d54[_0x132d6e(0x106)]||_0xf69d54[_0x132d6e(0x135)]?_0xf69d54['response']['status']+':'+_0xf69d54[_0x132d6e(0x135)]['statusText']:_0xf69d54,_0x16091e;}})();}}module[a90_0x4daca0(0x120)]=TestHubHandler;function a90_0xa551(){const _0xe449f3=['IylJH','4578561XqDPdg','BROWSERSTACK_RERUN','exports','./constants.js','../performance/performance-tester.js','/stop','measureWrapper','getFrameworkDetails','debug','authToken','OBSERVABILITY','BROWSERSTACK_CENTRAL_SCANNER_JOBID','false','getConfig','STOP','getTraceFilePaths','logBuildError','checkAndSetupPercy','null','status','../logger','13064880kCTFSg','path','response','../../bin/playwright/reporter/pwUtils.js','Utflp','getCiInfo','extractDataFromResponse','cwd','xuiNf','../performance/constants','toISOString','TESTHUB_BUILD_API','waitForBuildStatus','QoBew','launchBuild','UHmRb','4XClvEM','Error\x20while\x20waiting\x20for\x20events:\x20','All\x20trace\x20zip\x20send\x20events\x20complete','success','job_id','ACCESSIBILITY','true','187154NrCwdi','util','allowScreenshot','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','stringify','8457632TxLoJg','pFxhw','getHostInfo','assign','framework','2387545pjyhZc','1681962dwdwQP','Vlykk','Percy\x20is\x20not\x20supported\x20for\x20','./utils.js','settings','BS_TESTOPS_BUILD_COMPLETED','START','cjnEE','yUyuh','getProductMap','gMjVP','buildHashedId','../test-observability/sessionHandler.js','Testhub\x20started\x20with\x20id:\x20','allSettled','\x20framework','getGitMetaData','lcnc','BROWSERSTACK_TESTHUB_UUID','error','LNBpM','getAccessibilityOptions','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','BROWSERSTACK_TEST_OBSERVABILITY','euuuz','BROWSERSTACK_PRODUCT_MAP','krtFT','basename','config','BROWSERSTACK_TESTHUB_JWT','setTestObservabilityVariables','getCentralUser','BROWSERSTACK_BUILD_RUN_IDENTIFIER','user_killed','WaeHx','getAccessKey','winstonLogger','generateBuildUpstreamData','SaHnM','wwjgu','percy','egeVR','central_scanner','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','YfnPg','buildDescription','2509209BVyUqr','accessibilityOptions','add','getUserName','zIdML','jwt','ZlaPq','data','buildStopSent','password','DZnca','ENV_VAR','info','processTraceZips','message','uploadPending','statusText','BROWSERSTACK_ACCESSIBILITY','wbYBc','stop','finished_metadata','format','setupPercy','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','ViPEj','35JUixdt','forEach','setTestHubCommonMetaInfo','setAccessibilityVariables','SMyZd','auth','isAccessibilityEnabled','WpuCI','UWrzD','env','../helper','8ujTbAK'];a90_0xa551=function(){return _0xe449f3;};return a90_0xa551();}