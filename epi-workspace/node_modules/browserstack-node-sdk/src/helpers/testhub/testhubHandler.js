const a126_0x1986a9=a126_0x2cc0;function a126_0x2cc0(_0x9e7e22,_0x1e1e11){const _0x5d7949=a126_0x5d79();return a126_0x2cc0=function(_0x2cc067,_0x4042bc){_0x2cc067=_0x2cc067-0x1d9;let _0x58d8d1=_0x5d7949[_0x2cc067];return _0x58d8d1;},a126_0x2cc0(_0x9e7e22,_0x1e1e11);}function a126_0x5d79(){const _0x2b09ae=['env','allSettled','getInstance','response','false','IuBIh','assign','accessibility','job_id','statusText','jwbnU','isUndefined','error','qXsSJ','projectName','setupPercy','resolve','../performance/performance-tester.js','1770512Smwqxu','success','PERCY_SUPPORTED_FRAMEWORKS','TbzKq','Vanly','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','push','info','BFsUd','./constants.js','isAccessibilityEnabled','username','WUZWR','wKtlr','6762025AVyDcC','getUserName','uploadPending','central_scanner','exports','kevjt','../helper','getCiInfo','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','getHostInfo','winstonLogger','includes','../performance/constants','Percy\x20is\x20not\x20supported\x20for\x20','../test-observability/sessionHandler.js','isRunning','data','extractDataFromResponse','user_killed','message','api/v1/builds/','framework','PUT','../../bin/playwright/reporter/pwUtils.js','getAccessibilityValueFromYml','logBuildError','stopBuildUpstream\x20event\x20successful!','getCentralUser','3806jRDLHR','./utils.js','getProductMap','util','authToken','getTestOrchestrationBuildStartData','lcoHW','27SnejxE','TzyEK','true','../../bin/playwright/reporter/test-details.js','getAccessibilityOptions','dsdMT','POST','BROWSERSTACK_TESTHUB_JWT','Jchcs','format','getTraceFilePaths','BROWSERSTACK_LINKED_BUILD_UUID','cwd','toISOString','stop','buildStopSent','basename','debug','6ilFdJW','finished_metadata','BROWSERSTACK_CENTRAL_SCANNER_JWT','config','1746028cUqTFr','/stop','token','BROWSERSTACK_TESTHUB_UUID','includeEncodedExtension','ENV_VAR','hfZEK','7iWxiTz','All\x20trace\x20zip\x20send\x20events\x20complete','generateBuildUpstreamData','accessibilityOptions','status','setTestHubCommonMetaInfo','../helper.js','buildHashedId','path','BS_TESTOPS_BUILD_COMPLETED','sTgXa','waitForBuildStatus','\x20framework','../test-observability/requestQueueHandler.js','setTestObservabilityVariables','RXyWL','BROWSERSTACK_BUILD_GROUPING_IDENTIFIER','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','HhAUk','1679542IOrDVf','Generating\x20build\x20upstream\x20data\x20for\x20TestHub','TDamP','password','WLZJv','XOJib','BROWSERSTACK_ACCESSIBILITY','vpUKA','JlIOP','ElVvl','1590222Ygjlzk','TESTHUB_BUILD_API','isBrowserstackInfra','settings','forEach','lcnc','OBSERVABILITY','getGitMetaData','null','Error\x20while\x20waiting\x20for\x20events:\x20','6130vdDMKY','launchBuild','BROWSERSTACK_RERUN','pFUqz','buildDescription','../logger','measureWrapper','ACCESSIBILITY','1355256YPbtpo','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','BROWSERSTACK_TEST_OBSERVABILITY','getFrameworkDetails','UXYUW','getConfig','gEzPB','STOP','START'];a126_0x5d79=function(){return _0x2b09ae;};return a126_0x5d79();}(function(_0x4d633b,_0x3542ba){const _0x221f53=a126_0x2cc0,_0x118fa9=_0x4d633b();while(!![]){try{const _0x74311d=-parseInt(_0x221f53(0x20f))/0x1+-parseInt(_0x221f53(0x229))/0x2*(-parseInt(_0x221f53(0x20b))/0x3)+parseInt(_0x221f53(0x245))/0x4+parseInt(_0x221f53(0x26e))/0x5+-parseInt(_0x221f53(0x233))/0x6*(parseInt(_0x221f53(0x216))/0x7)+-parseInt(_0x221f53(0x260))/0x8*(parseInt(_0x221f53(0x1f9))/0x9)+-parseInt(_0x221f53(0x23d))/0xa*(-parseInt(_0x221f53(0x1f2))/0xb);if(_0x74311d===_0x3542ba)break;else _0x118fa9['push'](_0x118fa9['shift']());}catch(_0x105c6a){_0x118fa9['push'](_0x118fa9['shift']());}}}(a126_0x5d79,0xdda4c));const bsSetupHelper=require(a126_0x1986a9(0x1dc)),path=require(a126_0x1986a9(0x21e)),util=require(a126_0x1986a9(0x1f5)),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require('../test-observability/utils'),testhubUtils=require(a126_0x1986a9(0x1f3)),testHubConstants=require(a126_0x1986a9(0x269)),constants=require('../../bin/utils/constants.js'),RequestQueueHandler=require(a126_0x1986a9(0x223)),logger=require(a126_0x1986a9(0x242))[a126_0x1986a9(0x1e0)],SessionHandler=require(a126_0x1986a9(0x1e4)),PerformanceTester=require(a126_0x1986a9(0x25f)),{TESTHUB_EVENTS:PerformanceEvents}=require(a126_0x1986a9(0x1e2)),TestDetails=require(a126_0x1986a9(0x1fc)),{uploadTraceZip}=require(a126_0x1986a9(0x1ed)),{isTurboScaleSession}=require(a126_0x1986a9(0x21c)),BrowserstackCLI=require('../../bin/v2/browserstackCLI'),OngoingEvents=new Set();let processedTraceZips=![];const addEvent=_0x3e29b1=>{OngoingEvents['add'](_0x3e29b1);},awaitAllEvents=async()=>{const _0x5888b5=a126_0x1986a9;return Promise[_0x5888b5(0x24f)](OngoingEvents);};class TestHubHandler{static [a126_0x1986a9(0x208)]=![];static async[a126_0x1986a9(0x23e)](_0x1054fd,_0xb28a92){const _0x1d52a8=a126_0x1986a9,_0x32275f={'sTgXa':function(_0x3ea056,_0x388c21){return _0x3ea056||_0x388c21;},'WLZJv':function(_0x57296f,_0x85e423){return _0x57296f||_0x85e423;},'hfZEK':function(_0x3b8324,_0x28c3f0){return _0x3b8324===_0x28c3f0;},'wIqNA':function(_0x479c5f){return _0x479c5f();},'Jchcs':_0x1d52a8(0x246),'VfdrG':_0x1d52a8(0x252),'UXYUW':'Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','pJgDf':function(_0x41ab3f,_0x195e33,_0x438f9b,_0x2372d0,_0x8c8df5){return _0x41ab3f(_0x195e33,_0x438f9b,_0x2372d0,_0x8c8df5);},'wKtlr':_0x1d52a8(0x1ff),'pFUqz':_0x1d52a8(0x255),'ZKmmK':_0x1d52a8(0x1fb)};await PerformanceTester[_0x1d52a8(0x243)](PerformanceEvents[_0x1d52a8(0x24d)],async()=>{const _0xec263a=_0x1d52a8,_0x5edf21=Object[_0xec263a(0x254)]({},_0xb28a92[_0xec263a(0x20e)],{'root_dir_path':'','framework':_0xb28a92[_0xec263a(0x1eb)]}),_0x3f1f01=bsSetupHelper[_0xec263a(0x26f)](_0x5edf21),_0x43994b=bsSetupHelper['getAccessKey'](_0x5edf21),_0x125988=_0x32275f[_0xec263a(0x220)](_0x3f1f01,'')+':'+_0x32275f[_0xec263a(0x22d)](_0x43994b,''),_0x297ae5=testhubUtils[_0xec263a(0x1f4)](_0x5edf21);process[_0xec263a(0x24e)]['BROWSERSTACK_PRODUCT_MAP']=JSON['stringify'](_0x297ae5);if(_0x32275f[_0xec263a(0x215)](_0x125988,':'))return _0x32275f['wIqNA'](isTestObservabilitySession)&&(logger[_0xec263a(0x20a)](_0x32275f[_0xec263a(0x201)]),process[_0xec263a(0x24e)][_0xec263a(0x21f)]=_0x32275f['VfdrG']),testhubUtils[_0xec263a(0x26a)](_0x5edf21)&&logger[_0xec263a(0x20a)](_0x32275f[_0xec263a(0x249)]),[null,null];try{const _0x2939af=await this['generateBuildUpstreamData'](_0x5edf21,_0x1054fd),_0x2f3314=this[_0xec263a(0x24a)](_0x3f1f01,_0x43994b),_0x7acf76=await _0x32275f['pJgDf'](nodeRequest,_0x32275f[_0xec263a(0x26d)],testHubConstants[_0xec263a(0x234)],_0x2939af,_0x2f3314),_0x30de08=this[_0xec263a(0x1e7)](_0x5edf21,_0x7acf76,_0x2f3314);await this['checkAndSetupPercy'](_0xb28a92,_0x1054fd);if(_0x32275f['hfZEK'](testhubUtils[_0xec263a(0x1ee)](_0xb28a92['config']),null)){const _0x2defb8=_0x30de08[_0x32275f[_0xec263a(0x240)]];_0x2defb8&&_0x2defb8['authToken']&&_0x2defb8[_0xec263a(0x21d)]&&(_0xb28a92[_0xec263a(0x20e)][_0xec263a(0x255)]=!![],process[_0xec263a(0x24e)]['BROWSERSTACK_TEST_ACCESSIBILITY_PLATFORM']=_0x32275f['ZKmmK']);}return _0x30de08;}catch(_0x5d8fc9){if(_0x32275f['hfZEK'](_0x5d8fc9[_0xec263a(0x261)],![])){testhubUtils[_0xec263a(0x1ef)](_0x5d8fc9);return;}}})();}static async['processTraceZips'](){const _0xae27e1=a126_0x1986a9,_0x3ee327={'XOJib':function(_0x3c8086,_0x4833ed,_0x4aba16){return _0x3c8086(_0x4833ed,_0x4aba16);},'vpUKA':function(_0x5817bf,_0xef1b02){return _0x5817bf(_0xef1b02);},'fzqnk':function(_0x3561c6){return _0x3561c6();},'uxNGa':_0xae27e1(0x217)};if(processedTraceZips)return;const _0x1e7231=TestDetails[_0xae27e1(0x203)]();_0x1e7231[_0xae27e1(0x237)](({testUId:_0x56a535,filePath:_0x242ebf})=>{const _0x3f002e=_0xae27e1;var _0x33606d=_0x3ee327[_0x3f002e(0x22e)](uploadTraceZip,_0x242ebf,_0x56a535);_0x3ee327[_0x3f002e(0x230)](addEvent,_0x33606d);});try{await _0x3ee327['fzqnk'](awaitAllEvents),logger['debug'](_0x3ee327['uxNGa']),processedTraceZips=!![];}catch(_0x55dedd){logger['error'](_0xae27e1(0x23c)+util[_0xae27e1(0x202)](_0x55dedd));}}static async['checkAndSetupPercy'](_0x2ea01f,_0x3180c8){const _0x3093fb=a126_0x1986a9;if(constants[_0x3093fb(0x262)][_0x3093fb(0x1e1)](_0x3180c8)){await _0x2ea01f[_0x3093fb(0x25d)]();return;}_0x2ea01f['config']['percy']&&logger[_0x3093fb(0x20a)](_0x3093fb(0x1e3)+_0x3180c8+_0x3093fb(0x222));}static['getAccessibilityOptions'](_0x2a3763){const _0x3327bc=a126_0x1986a9,_0x1b07dd={'oraOU':function(_0xcd5196,_0x2fce35){return _0xcd5196(_0x2fce35);},'JlIOP':'true'};let _0x2f0dbd;if(_0x2a3763[_0x3327bc(0x219)]){const _0x12e34c={};_0x12e34c['settings']=_0x2a3763[_0x3327bc(0x219)],_0x2f0dbd=_0x12e34c;}else{const _0x2fc710={};_0x2fc710[_0x3327bc(0x236)]={},_0x2f0dbd=_0x2fc710;}if((!bsSetupHelper[_0x3327bc(0x235)]()||_0x1b07dd['oraOU'](isTurboScaleSession,_0x2a3763))&&testhubUtils[_0x3327bc(0x26a)](_0x2a3763)){const _0x2b77ca={};_0x2b77ca[_0x3327bc(0x213)]=_0x1b07dd[_0x3327bc(0x231)],Object[_0x3327bc(0x254)](_0x2f0dbd[_0x3327bc(0x236)],_0x2b77ca);}return _0x2f0dbd;}static[a126_0x1986a9(0x24a)](_0x288f68,_0x44cd88){const _0x3399ed=a126_0x1986a9,_0x357ee0={'FOjVW':function(_0x3b6d7d,_0x1012bc){return _0x3b6d7d(_0x1012bc);}},_0x583e4f={};return _0x583e4f[_0x3399ed(0x26b)]=_0x288f68,_0x583e4f[_0x3399ed(0x22c)]=_0x44cd88,{'auth':_0x583e4f,'headers':_0x357ee0['FOjVW'](getDefaultHeaders,![])};}static async[a126_0x1986a9(0x218)](_0x2ea2a8,_0x2f6417){const _0x72690c=a126_0x1986a9,_0x1072ee={'dsdMT':_0x72690c(0x22a),'TDamP':function(_0x128203,_0x1a865e){return _0x128203(_0x1a865e);}};logger[_0x72690c(0x20a)](_0x1072ee[_0x72690c(0x1fe)]);const _0x20d1e5={'project_name':_0x2ea2a8[_0x72690c(0x25c)]||'','name':_0x2ea2a8['buildName']||path[_0x72690c(0x209)](path[_0x72690c(0x25e)](process[_0x72690c(0x205)]())),'build_identifier':_0x2ea2a8['buildIdentifier'],'description':_0x2ea2a8[_0x72690c(0x241)]||'','started_at':new Date()[_0x72690c(0x206)](),'tags':_0x1072ee[_0x72690c(0x22b)](getCustomTags,_0x2ea2a8),'host_info':bsSetupHelper[_0x72690c(0x1df)](),'ci_info':bsSetupHelper[_0x72690c(0x1dd)](),'build_run_identifier':process[_0x72690c(0x24e)]['BROWSERSTACK_BUILD_RUN_IDENTIFIER'],'failed_tests_rerun':process[_0x72690c(0x24e)][_0x72690c(0x23f)]||![],'linked_build_uuid':process[_0x72690c(0x24e)][_0x72690c(0x204)]||'','version_control':await bsSetupHelper[_0x72690c(0x23a)](),'accessibility':this[_0x72690c(0x1fd)](_0x2ea2a8),'framework_details':testhubUtils[_0x72690c(0x248)](_0x2ea2a8,_0x2f6417),'product_map':testhubUtils['getProductMapForBuildStartCall'](_0x2ea2a8),'browserstackAutomation':bsSetupHelper[_0x72690c(0x235)](),'grouping_identifier':process[_0x72690c(0x24e)][_0x72690c(0x226)],'test_orchestration':testhubUtils[_0x72690c(0x1f7)](_0x2ea2a8)};if(bsSetupHelper[_0x72690c(0x1f1)]()[_0x72690c(0x1d9)]||bsSetupHelper[_0x72690c(0x1f1)]()[_0x72690c(0x238)]){const _0x148158={};_0x148158[_0x72690c(0x256)]=process[_0x72690c(0x24e)]['BROWSERSTACK_CENTRAL_SCANNER_JOBID'],_0x148158[_0x72690c(0x211)]=process[_0x72690c(0x24e)][_0x72690c(0x20d)],_0x20d1e5[_0x72690c(0x1d9)]=_0x148158;}return _0x20d1e5;}static[a126_0x1986a9(0x1e7)](_0x92cf17,_0x12e288,_0x4871b7){const _0xd9916=a126_0x1986a9,_0xe798eb={'qXsSJ':function(_0x57117c){return _0x57117c();},'kevjt':function(_0x40df0c,_0x348377){return _0x40df0c&&_0x348377;},'jwbnU':_0xd9916(0x1fb),'RXyWL':_0xd9916(0x252)},_0x244c38={};if(_0xe798eb[_0xd9916(0x25b)](isTestObservabilitySession)){const [_0xd7226,_0x503e,_0x2e7a66]=testhubUtils[_0xd9916(0x224)](_0x12e288[_0xd9916(0x1e6)],_0x4871b7['auth']);if(_0xe798eb[_0xd9916(0x1db)](_0xd7226,_0x503e)){const _0x45adef={};_0x45adef['jwt']=_0xd7226,_0x45adef[_0xd9916(0x21d)]=_0x503e,_0x45adef['allowScreenshot']=_0x2e7a66,_0x244c38[testHubConstants['OBSERVABILITY']]=_0x45adef,process[_0xd9916(0x24e)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0xe798eb[_0xd9916(0x258)];}else _0x244c38[testHubConstants[_0xd9916(0x239)]]={},process[_0xd9916(0x24e)][_0xd9916(0x247)]=_0xe798eb[_0xd9916(0x225)];}else process[_0xd9916(0x24e)][_0xd9916(0x247)]=_0xe798eb[_0xd9916(0x225)];const [_0x59ab6f,_0x3def91]=testhubUtils['setAccessibilityVariables'](_0x12e288[_0xd9916(0x1e6)]);if(_0xe798eb[_0xd9916(0x1db)](_0x59ab6f,_0x3def91)){const _0x58eb9b={};_0x58eb9b[_0xd9916(0x1f6)]=_0x59ab6f,_0x58eb9b[_0xd9916(0x21d)]=_0x3def91,_0x244c38[testHubConstants[_0xd9916(0x244)]]=_0x58eb9b,process[_0xd9916(0x24e)]['BROWSERSTACK_ACCESSIBILITY']=_0xe798eb[_0xd9916(0x258)];}else _0x244c38[testHubConstants[_0xd9916(0x244)]]={},process[_0xd9916(0x24e)][_0xd9916(0x22f)]=_0xe798eb[_0xd9916(0x225)];return testhubUtils[_0xd9916(0x21b)](_0x12e288[_0xd9916(0x1e6)]),logger[_0xd9916(0x267)]('Testhub\x20started\x20with\x20id:\x20'+process[_0xd9916(0x24e)][_0xd9916(0x212)]),_0x244c38;}static async[a126_0x1986a9(0x207)](_0x3f17dd){const _0x459838=a126_0x1986a9,_0x20b95={'KKraK':function(_0xc70df0,_0x127a53){return _0xc70df0===_0x127a53;},'ElVvl':_0x459838(0x252),'MZwXG':function(_0x87fb5b,_0x11bbc7){return _0x87fb5b===_0x11bbc7;},'WUZWR':_0x459838(0x23b),'IuBIh':_0x459838(0x227),'lcoHW':_0x459838(0x25a),'gEzPB':_0x459838(0x1de),'Vanly':_0x459838(0x20c),'HhAUk':_0x459838(0x1e8),'pwDjZ':function(_0x423565){return _0x423565();},'TbzKq':function(_0x37ec4a,_0x4d5973,_0xebf735,_0x2adda1,_0x1b4d07,_0x23a60d){return _0x37ec4a(_0x4d5973,_0xebf735,_0x2adda1,_0x1b4d07,_0x23a60d);},'BFsUd':_0x459838(0x1ec),'mtPqH':_0x459838(0x1f0),'TzyEK':_0x459838(0x261)};await PerformanceTester[_0x459838(0x243)](PerformanceEvents[_0x459838(0x24c)],async()=>{const _0x3de27b=_0x459838;if(_0x20b95['KKraK'](process['env']['BS_TESTOPS_BUILD_COMPLETED'],_0x20b95[_0x3de27b(0x232)])||TestHubHandler[_0x3de27b(0x208)]||bsSetupHelper[_0x3de27b(0x259)](process[_0x3de27b(0x24e)][testHubConstants['ENV_VAR'][_0x3de27b(0x200)]]))return;TestHubHandler[_0x3de27b(0x208)]=!![];if(BrowserstackCLI[_0x3de27b(0x250)]()[_0x3de27b(0x1e5)]())return;await this['processTraceZips'](),await RequestQueueHandler[_0x3de27b(0x250)]()[_0x3de27b(0x270)](),await SessionHandler[_0x3de27b(0x221)]();if(_0x20b95['MZwXG'](process[_0x3de27b(0x24e)][testHubConstants[_0x3de27b(0x214)][_0x3de27b(0x200)]],_0x20b95[_0x3de27b(0x26c)])||_0x20b95['MZwXG'](process['env'][testHubConstants['ENV_VAR'][_0x3de27b(0x212)]],_0x20b95[_0x3de27b(0x26c)])){logger['debug'](_0x20b95[_0x3de27b(0x253)]);const _0x5a7356={};return _0x5a7356[_0x3de27b(0x21a)]=_0x20b95[_0x3de27b(0x1f8)],_0x5a7356[_0x3de27b(0x1e9)]=_0x20b95[_0x3de27b(0x24b)],_0x5a7356;}const _0x2e309c={'finished_at':new Date()[_0x3de27b(0x206)](),'finished_metadata':[]};!!_0x3f17dd&&_0x2e309c[_0x20b95[_0x3de27b(0x264)]][_0x3de27b(0x266)]({'reason':_0x20b95[_0x3de27b(0x228)],'signal':_0x3f17dd,'failure_data':''});const _0x2fc2de={'headers':_0x20b95['pwDjZ'](getDefaultHeaders)};try{const _0x586d16=await _0x20b95[_0x3de27b(0x263)](nodeRequest,_0x20b95[_0x3de27b(0x268)],_0x3de27b(0x1ea)+process[_0x3de27b(0x24e)][testHubConstants['ENV_VAR']['BROWSERSTACK_TESTHUB_UUID']]+_0x3de27b(0x210),_0x2e309c,_0x2fc2de,![]);if(_0x586d16[_0x3de27b(0x1e6)]&&_0x586d16['data'][_0x3de27b(0x25a)]){const _0x369ac6={};_0x369ac6[_0x3de27b(0x1e9)]=_0x586d16['data'][_0x3de27b(0x25a)];throw _0x369ac6;}else{logger['debug'](_0x20b95['mtPqH']);const _0x27bbc4={};return _0x27bbc4[_0x3de27b(0x21a)]=_0x20b95[_0x3de27b(0x1fa)],_0x27bbc4[_0x3de27b(0x1e9)]='',_0x27bbc4;}}catch(_0x5bf4db){_0x5bf4db[_0x3de27b(0x251)]?logger['debug'](_0x3de27b(0x265)+_0x5bf4db[_0x3de27b(0x251)][_0x3de27b(0x21a)]+'\x20'+_0x5bf4db[_0x3de27b(0x251)]['statusText']+'\x20'+JSON['stringify'](_0x5bf4db[_0x3de27b(0x251)][_0x3de27b(0x1e6)])):logger[_0x3de27b(0x20a)](_0x3de27b(0x265)+(_0x5bf4db[_0x3de27b(0x1e9)]||_0x5bf4db));const _0x6b9675={};return _0x6b9675[_0x3de27b(0x21a)]=_0x20b95['lcoHW'],_0x6b9675[_0x3de27b(0x1e9)]=_0x5bf4db[_0x3de27b(0x1e9)]||_0x5bf4db[_0x3de27b(0x251)]?_0x5bf4db[_0x3de27b(0x251)][_0x3de27b(0x21a)]+':'+_0x5bf4db[_0x3de27b(0x251)][_0x3de27b(0x257)]:_0x5bf4db,_0x6b9675;}})();}}module[a126_0x1986a9(0x1da)]=TestHubHandler;