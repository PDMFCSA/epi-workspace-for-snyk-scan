function a124_0x4bcf(){const _0x1cc7e0=['processTraceZips','../logger','getTestOrchestrationBuildStartData','/stop','./constants.js','TVYJm','includes','isBrowserstackInfra','user_killed','isAccessibilityEnabled','CYJzT','../test-observability/utils','STOP','getCiInfo','BROWSERSTACK_TESTHUB_JWT','getCentralUser','34495tVgHDu','gyisL','OBSERVABILITY','UCQjq','resolve','2331468vhcJZd','Percy\x20is\x20not\x20supported\x20for\x20','RxprE','Wkmdy','setTestHubCommonMetaInfo','Testhub\x20started\x20with\x20id:\x20','BS_TESTOPS_BUILD_COMPLETED','path','setupPercy','getInstance','getAccessibilityValueFromYml','BROWSERSTACK_RERUN','winstonLogger','../performance/performance-tester.js','xmuPZ','getConfig','DPsWI','umFRl','stopBuildUpstream\x20event\x20successful!','finished_metadata','includeEncodedExtension','getAccessKey','buildIdentifier','../helper.js','xIVfk','setTestObservabilityVariables','1879691hdEVrY','launchBuild','username','BROWSERSTACK_CENTRAL_SCANNER_JOBID','isUndefined','waitForBuildStatus','null','201512tJAaaj','../../bin/playwright/reporter/pwUtils.js','BROWSERSTACK_TEST_ACCESSIBILITY_PLATFORM','PERCY_SUPPORTED_FRAMEWORKS','basename','ACCESSIBILITY','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','success','TZlvK','8SgWZYg','settings','config','eWlzh','error','accessibilityOptions','PUT','response','qPjXl','getHostInfo','66EjGEyh','checkAndSetupPercy','getAccessibilityOptions','\x20framework','stringify','logBuildError','All\x20trace\x20zip\x20send\x20events\x20complete','util','add','BROWSERSTACK_ACCESSIBILITY','XFfAc','info','env','buildName','../test-observability/sessionHandler.js','data','stop','678129nalYkz','piqut','statusText','BROWSERSTACK_BUILD_RUN_IDENTIFIER','measureWrapper','token','cMqGG','format','xHjgd','buildHashedId','jwt','getTraceFilePaths','message','../performance/constants','zPKhB','Smeef','exports','Generating\x20build\x20upstream\x20data\x20for\x20TestHub','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','getProductMapForBuildStartCall','framework','api/v1/builds/','BROWSERSTACK_TESTHUB_UUID','cwd','authToken','debug','ICMxV','xlyUA','BROWSERSTACK_TEST_OBSERVABILITY','xFacW','izWPe','hmqQH','Error\x20while\x20waiting\x20for\x20events:\x20','true','false','../../bin/playwright/reporter/test-details.js','80LYAfMu','2455844HqWSpN','auth','START','arhpc','7acqYha','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','206705bylfAO','getUserName','BROWSERSTACK_LINKED_BUILD_UUID','status','getFrameworkDetails','EZAiD','./utils.js','rPotT','central_scanner','XMxXa','ZSWYO','BROWSERSTACK_BUILD_GROUPING_IDENTIFIER','password','accessibility','BROWSERSTACK_PRODUCT_MAP','ENV_VAR','percy','buildStopSent','assign','getProductMap','job_id','ZfrEO','generateBuildUpstreamData','toISOString','forEach'];a124_0x4bcf=function(){return _0x1cc7e0;};return a124_0x4bcf();}const a124_0x23091e=a124_0x179c;(function(_0x1f055f,_0x56bcea){const _0x2becbd=a124_0x179c,_0x385998=_0x1f055f();while(!![]){try{const _0x1888a2=parseInt(_0x2becbd(0x106))/0x1*(parseInt(_0x2becbd(0x135))/0x2)+parseInt(_0x2becbd(0x150))/0x3+parseInt(_0x2becbd(0x175))/0x4+parseInt(_0x2becbd(0x17b))/0x5*(parseInt(_0x2becbd(0x13f))/0x6)+parseInt(_0x2becbd(0x179))/0x7*(parseInt(_0x2becbd(0x12c))/0x8)+parseInt(_0x2becbd(0x10b))/0x9+-parseInt(_0x2becbd(0x174))/0xa*(parseInt(_0x2becbd(0x125))/0xb);if(_0x1888a2===_0x56bcea)break;else _0x385998['push'](_0x385998['shift']());}catch(_0x287cb7){_0x385998['push'](_0x385998['shift']());}}}(a124_0x4bcf,0x556e8));const bsSetupHelper=require('../helper'),path=require(a124_0x23091e(0x112)),util=require(a124_0x23091e(0x146)),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require(a124_0x23091e(0x101)),testhubUtils=require(a124_0x23091e(0x181)),testHubConstants=require(a124_0x23091e(0xfa)),constants=require('../../bin/utils/constants.js'),RequestQueueHandler=require('../test-observability/requestQueueHandler.js'),logger=require(a124_0x23091e(0xf7))[a124_0x23091e(0x117)],SessionHandler=require(a124_0x23091e(0x14d)),PerformanceTester=require(a124_0x23091e(0x118)),{TESTHUB_EVENTS:PerformanceEvents}=require(a124_0x23091e(0x15d)),TestDetails=require(a124_0x23091e(0x173)),{uploadTraceZip}=require(a124_0x23091e(0x12d)),{isTurboScaleSession}=require(a124_0x23091e(0x122)),BrowserstackCLI=require('../../bin/v2/browserstackCLI'),OngoingEvents=new Set();function a124_0x179c(_0x4b0d50,_0x37f221){const _0x4bcfb0=a124_0x4bcf();return a124_0x179c=function(_0x179cda,_0x5acada){_0x179cda=_0x179cda-0xed;let _0x13997a=_0x4bcfb0[_0x179cda];return _0x13997a;},a124_0x179c(_0x4b0d50,_0x37f221);}let processedTraceZips=![];const addEvent=_0x5639c9=>{const _0x594f19=a124_0x23091e;OngoingEvents[_0x594f19(0x147)](_0x5639c9);},awaitAllEvents=async()=>{return Promise['allSettled'](OngoingEvents);};class TestHubHandler{static [a124_0x23091e(0xee)]=![];static async[a124_0x23091e(0x126)](_0x35b545,_0x3557e9){const _0x3f4684=a124_0x23091e,_0x4bf255={'xHjgd':function(_0x81d4f1,_0x432f88){return _0x81d4f1||_0x432f88;},'cMqGG':function(_0x4d255a,_0x42ef6f){return _0x4d255a===_0x42ef6f;},'ZSWYO':function(_0x4bd75b){return _0x4bd75b();},'DPsWI':_0x3f4684(0x132),'HvykU':'false','xmuPZ':_0x3f4684(0x162),'xlyUA':function(_0xf76aae,_0x5112bb,_0x3e4675,_0x180766,_0x44e13e){return _0xf76aae(_0x5112bb,_0x3e4675,_0x180766,_0x44e13e);},'gyisL':'POST','mLVcV':'accessibility','zPKhB':_0x3f4684(0x171)};await PerformanceTester[_0x3f4684(0x154)](PerformanceEvents[_0x3f4684(0x177)],async()=>{const _0x589a1c=_0x3f4684,_0x1081fa=Object[_0x589a1c(0xef)]({},_0x3557e9[_0x589a1c(0x137)],{'root_dir_path':'','framework':_0x3557e9[_0x589a1c(0x164)]}),_0x408f8c=bsSetupHelper[_0x589a1c(0x17c)](_0x1081fa),_0x14e831=bsSetupHelper[_0x589a1c(0x120)](_0x1081fa),_0x1999da=_0x4bf255[_0x589a1c(0x158)](_0x408f8c,'')+':'+_0x4bf255[_0x589a1c(0x158)](_0x14e831,''),_0x398c88=testhubUtils[_0x589a1c(0xf0)](_0x1081fa);process['env'][_0x589a1c(0x189)]=JSON['stringify'](_0x398c88);if(_0x4bf255['cMqGG'](_0x1999da,':'))return _0x4bf255[_0x589a1c(0x185)](isTestObservabilitySession)&&(logger[_0x589a1c(0x169)](_0x4bf255[_0x589a1c(0x11b)]),process[_0x589a1c(0x14b)][_0x589a1c(0x111)]=_0x4bf255['HvykU']),testhubUtils[_0x589a1c(0xff)](_0x1081fa)&&logger[_0x589a1c(0x169)](_0x4bf255[_0x589a1c(0x119)]),[null,null];try{const _0x3ec220=await this[_0x589a1c(0xf3)](_0x1081fa,_0x35b545),_0x141b32=this[_0x589a1c(0x11a)](_0x408f8c,_0x14e831),_0x4f27ee=await _0x4bf255[_0x589a1c(0x16b)](nodeRequest,_0x4bf255[_0x589a1c(0x107)],testHubConstants['TESTHUB_BUILD_API'],_0x3ec220,_0x141b32),_0x4f0126=this['extractDataFromResponse'](_0x1081fa,_0x4f27ee,_0x141b32);await this[_0x589a1c(0x140)](_0x3557e9,_0x35b545);if(_0x4bf255['cMqGG'](testhubUtils[_0x589a1c(0x115)](_0x3557e9[_0x589a1c(0x137)]),null)){const _0x3209a9=_0x4f0126[_0x4bf255['mLVcV']];_0x3209a9&&_0x3209a9[_0x589a1c(0x168)]&&_0x3209a9[_0x589a1c(0x159)]&&(_0x3557e9[_0x589a1c(0x137)][_0x589a1c(0x188)]=!![],process[_0x589a1c(0x14b)][_0x589a1c(0x12e)]=_0x4bf255[_0x589a1c(0x15e)]);}return _0x4f0126;}catch(_0xe7ded6){if(_0x4bf255[_0x589a1c(0x156)](_0xe7ded6[_0x589a1c(0x133)],![])){testhubUtils[_0x589a1c(0x144)](_0xe7ded6);return;}}})();}static async[a124_0x23091e(0xf6)](){const _0x121bc5=a124_0x23091e,_0x5cb7b6={'KHnAS':function(_0x2085f9,_0x5403df,_0x3c41ef){return _0x2085f9(_0x5403df,_0x3c41ef);},'xbFAn':function(_0xf6ee66,_0x28ef43){return _0xf6ee66(_0x28ef43);},'qPjXl':function(_0x22856a){return _0x22856a();},'xIVfk':_0x121bc5(0x145)};if(processedTraceZips)return;const _0x3de7cc=TestDetails[_0x121bc5(0x15b)]();_0x3de7cc[_0x121bc5(0xf5)](({testUId:_0x5a46d8,filePath:_0x264474})=>{var _0xc9429c=_0x5cb7b6['KHnAS'](uploadTraceZip,_0x264474,_0x5a46d8);_0x5cb7b6['xbFAn'](addEvent,_0xc9429c);});try{await _0x5cb7b6[_0x121bc5(0x13d)](awaitAllEvents),logger['debug'](_0x5cb7b6[_0x121bc5(0x123)]),processedTraceZips=!![];}catch(_0x54db19){logger[_0x121bc5(0x139)](_0x121bc5(0x170)+util[_0x121bc5(0x157)](_0x54db19));}}static async[a124_0x23091e(0x140)](_0x203949,_0x5e404b){const _0x3bb78c=a124_0x23091e;if(constants[_0x3bb78c(0x12f)][_0x3bb78c(0xfc)](_0x5e404b)){await _0x203949[_0x3bb78c(0x113)]();return;}_0x203949['config'][_0x3bb78c(0xed)]&&logger[_0x3bb78c(0x169)](_0x3bb78c(0x10c)+_0x5e404b+_0x3bb78c(0x142));}static[a124_0x23091e(0x141)](_0x5a0dd4){const _0x192748=a124_0x23091e,_0x133bab={'ubzww':function(_0x19ab0b,_0x456800){return _0x19ab0b(_0x456800);},'tHdMO':_0x192748(0x171)};let _0x503bb3;if(_0x5a0dd4[_0x192748(0x13a)]){const _0x5a141c={};_0x5a141c[_0x192748(0x136)]=_0x5a0dd4[_0x192748(0x13a)],_0x503bb3=_0x5a141c;}else{const _0x427505={};_0x427505['settings']={},_0x503bb3=_0x427505;}if((!bsSetupHelper[_0x192748(0xfd)]()||_0x133bab['ubzww'](isTurboScaleSession,_0x5a0dd4))&&testhubUtils[_0x192748(0xff)](_0x5a0dd4)){const _0xb55cb7={};_0xb55cb7[_0x192748(0x11f)]=_0x133bab['tHdMO'],Object[_0x192748(0xef)](_0x503bb3['settings'],_0xb55cb7);}return _0x503bb3;}static['getConfig'](_0x3875da,_0x1c9db5){const _0x52b2b8=a124_0x23091e,_0x4b3f86={'CYJzT':function(_0x39bd18,_0x3ea762){return _0x39bd18(_0x3ea762);}},_0x12f496={};return _0x12f496[_0x52b2b8(0x127)]=_0x3875da,_0x12f496[_0x52b2b8(0x187)]=_0x1c9db5,{'auth':_0x12f496,'headers':_0x4b3f86[_0x52b2b8(0x100)](getDefaultHeaders,![])};}static async['generateBuildUpstreamData'](_0x3b25fd,_0x5dcb4d){const _0x438b44=a124_0x23091e,_0x20b82d={'ZfrEO':_0x438b44(0x161),'xFacW':function(_0x5f1c25,_0x6357f1){return _0x5f1c25(_0x6357f1);}};logger[_0x438b44(0x169)](_0x20b82d[_0x438b44(0xf2)]);const _0x4eac2f={'project_name':_0x3b25fd['projectName']||'','name':_0x3b25fd[_0x438b44(0x14c)]||path[_0x438b44(0x130)](path[_0x438b44(0x10a)](process[_0x438b44(0x167)]())),'build_identifier':_0x3b25fd[_0x438b44(0x121)],'description':_0x3b25fd['buildDescription']||'','started_at':new Date()[_0x438b44(0xf4)](),'tags':_0x20b82d[_0x438b44(0x16d)](getCustomTags,_0x3b25fd),'host_info':bsSetupHelper[_0x438b44(0x13e)](),'ci_info':bsSetupHelper[_0x438b44(0x103)](),'build_run_identifier':process[_0x438b44(0x14b)][_0x438b44(0x153)],'failed_tests_rerun':process[_0x438b44(0x14b)][_0x438b44(0x116)]||![],'linked_build_uuid':process[_0x438b44(0x14b)][_0x438b44(0x17d)]||'','version_control':await bsSetupHelper['getGitMetaData'](),'accessibility':this[_0x438b44(0x141)](_0x3b25fd),'framework_details':testhubUtils[_0x438b44(0x17f)](_0x3b25fd,_0x5dcb4d),'product_map':testhubUtils[_0x438b44(0x163)](_0x3b25fd),'browserstackAutomation':bsSetupHelper[_0x438b44(0xfd)](),'grouping_identifier':process[_0x438b44(0x14b)][_0x438b44(0x186)],'test_orchestration':testhubUtils[_0x438b44(0xf8)](_0x3b25fd)};if(bsSetupHelper[_0x438b44(0x105)]()['central_scanner']||bsSetupHelper['getCentralUser']()['lcnc']){const _0x3deac2={};_0x3deac2[_0x438b44(0xf1)]=process[_0x438b44(0x14b)][_0x438b44(0x128)],_0x3deac2[_0x438b44(0x155)]=process[_0x438b44(0x14b)]['BROWSERSTACK_CENTRAL_SCANNER_JWT'],_0x4eac2f[_0x438b44(0x183)]=_0x3deac2;}return _0x4eac2f;}static['extractDataFromResponse'](_0x43772d,_0x44bca2,_0x43c860){const _0x5dab02=a124_0x23091e,_0x18cc86={'ICMxV':function(_0x4ec7a5){return _0x4ec7a5();},'UCQjq':function(_0x337227,_0x54953d){return _0x337227&&_0x54953d;},'TZlvK':_0x5dab02(0x171),'piqut':_0x5dab02(0x172)},_0x3f2f58={};if(_0x18cc86[_0x5dab02(0x16a)](isTestObservabilitySession)){const [_0x530485,_0x1929af,_0x2778d3]=testhubUtils[_0x5dab02(0x124)](_0x44bca2['data'],_0x43c860[_0x5dab02(0x176)]);if(_0x18cc86[_0x5dab02(0x109)](_0x530485,_0x1929af)){const _0x6ec27e={};_0x6ec27e[_0x5dab02(0x15a)]=_0x530485,_0x6ec27e[_0x5dab02(0x159)]=_0x1929af,_0x6ec27e['allowScreenshot']=_0x2778d3,_0x3f2f58[testHubConstants[_0x5dab02(0x108)]]=_0x6ec27e,process[_0x5dab02(0x14b)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x18cc86[_0x5dab02(0x134)];}else _0x3f2f58[testHubConstants['OBSERVABILITY']]={},process[_0x5dab02(0x14b)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x18cc86[_0x5dab02(0x151)];}else process[_0x5dab02(0x14b)][_0x5dab02(0x16c)]=_0x18cc86[_0x5dab02(0x151)];const [_0x31c295,_0x1774f6]=testhubUtils['setAccessibilityVariables'](_0x44bca2['data']);if(_0x18cc86['UCQjq'](_0x31c295,_0x1774f6)){const _0x132c22={};_0x132c22[_0x5dab02(0x168)]=_0x31c295,_0x132c22[_0x5dab02(0x159)]=_0x1774f6,_0x3f2f58[testHubConstants[_0x5dab02(0x131)]]=_0x132c22,process[_0x5dab02(0x14b)][_0x5dab02(0x148)]=_0x18cc86['TZlvK'];}else _0x3f2f58[testHubConstants[_0x5dab02(0x131)]]={},process[_0x5dab02(0x14b)][_0x5dab02(0x148)]=_0x18cc86['piqut'];return testhubUtils[_0x5dab02(0x10f)](_0x44bca2[_0x5dab02(0x14e)]),logger[_0x5dab02(0x14a)](_0x5dab02(0x110)+process[_0x5dab02(0x14b)][_0x5dab02(0x166)]),_0x3f2f58;}static async[a124_0x23091e(0x14f)](_0x5ce12a){const _0x1a19db=a124_0x23091e,_0x23569c={'arhpc':function(_0xca6ab,_0x5543b9){return _0xca6ab===_0x5543b9;},'rPotT':'false','Wkmdy':_0x1a19db(0x12b),'YXvzc':function(_0x58a01d,_0x2be8c7){return _0x58a01d===_0x2be8c7;},'Smeef':'EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','EZAiD':_0x1a19db(0x139),'umFRl':'Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','RxprE':_0x1a19db(0x11e),'eWlzh':_0x1a19db(0xfe),'hmqQH':function(_0x5bb13f){return _0x5bb13f();},'XFfAc':function(_0xedb770,_0x380e31,_0x1d6752,_0x60e8c2,_0x3a68e1,_0x1799cc){return _0xedb770(_0x380e31,_0x1d6752,_0x60e8c2,_0x3a68e1,_0x1799cc);},'TVYJm':_0x1a19db(0x13b),'izWPe':_0x1a19db(0x11d),'XMxXa':_0x1a19db(0x133)};!BrowserstackCLI[_0x1a19db(0x114)]()['isRunning']()&&await this[_0x1a19db(0xf6)](),await PerformanceTester[_0x1a19db(0x154)](PerformanceEvents[_0x1a19db(0x102)],async()=>{const _0xd4453b=_0x1a19db;if(_0x23569c[_0xd4453b(0x178)](process['env'][_0xd4453b(0x111)],_0x23569c[_0xd4453b(0x182)])||TestHubHandler[_0xd4453b(0xee)]||bsSetupHelper[_0xd4453b(0x129)](process[_0xd4453b(0x14b)][testHubConstants[_0xd4453b(0x18a)][_0xd4453b(0x104)]]))return;TestHubHandler['buildStopSent']=!![],await RequestQueueHandler['getInstance']()['uploadPending'](),await SessionHandler[_0xd4453b(0x12a)]();if(_0x23569c[_0xd4453b(0x178)](process[_0xd4453b(0x14b)][testHubConstants[_0xd4453b(0x18a)][_0xd4453b(0x104)]],_0x23569c[_0xd4453b(0x10e)])||_0x23569c['YXvzc'](process[_0xd4453b(0x14b)][testHubConstants['ENV_VAR'][_0xd4453b(0x166)]],_0x23569c['Wkmdy'])){logger['debug'](_0x23569c[_0xd4453b(0x15f)]);const _0x2d7b24={};return _0x2d7b24[_0xd4453b(0x17e)]=_0x23569c[_0xd4453b(0x180)],_0x2d7b24['message']=_0x23569c[_0xd4453b(0x11c)],_0x2d7b24;}const _0x5ad843={'finished_at':new Date()[_0xd4453b(0xf4)](),'finished_metadata':[]};!!_0x5ce12a&&_0x5ad843[_0x23569c[_0xd4453b(0x10d)]]['push']({'reason':_0x23569c[_0xd4453b(0x138)],'signal':_0x5ce12a,'failure_data':''});const _0x3198c4={'headers':_0x23569c[_0xd4453b(0x16f)](getDefaultHeaders)};try{const _0xab307f=await _0x23569c[_0xd4453b(0x149)](nodeRequest,_0x23569c[_0xd4453b(0xfb)],_0xd4453b(0x165)+process['env'][testHubConstants['ENV_VAR'][_0xd4453b(0x166)]]+_0xd4453b(0xf9),_0x5ad843,_0x3198c4,![]);if(_0xab307f[_0xd4453b(0x14e)]&&_0xab307f[_0xd4453b(0x14e)][_0xd4453b(0x139)]){const _0x4fefda={};_0x4fefda['message']=_0xab307f[_0xd4453b(0x14e)]['error'];throw _0x4fefda;}else{logger['debug'](_0x23569c[_0xd4453b(0x16e)]);const _0x42e0d0={};return _0x42e0d0[_0xd4453b(0x17e)]=_0x23569c[_0xd4453b(0x184)],_0x42e0d0[_0xd4453b(0x15c)]='',_0x42e0d0;}}catch(_0x336561){_0x336561[_0xd4453b(0x13c)]?logger[_0xd4453b(0x169)](_0xd4453b(0x17a)+_0x336561[_0xd4453b(0x13c)][_0xd4453b(0x17e)]+'\x20'+_0x336561[_0xd4453b(0x13c)][_0xd4453b(0x152)]+'\x20'+JSON[_0xd4453b(0x143)](_0x336561[_0xd4453b(0x13c)][_0xd4453b(0x14e)])):logger[_0xd4453b(0x169)]('EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20'+(_0x336561[_0xd4453b(0x15c)]||_0x336561));const _0x29633e={};return _0x29633e[_0xd4453b(0x17e)]=_0x23569c['EZAiD'],_0x29633e['message']=_0x336561[_0xd4453b(0x15c)]||_0x336561[_0xd4453b(0x13c)]?_0x336561[_0xd4453b(0x13c)]['status']+':'+_0x336561[_0xd4453b(0x13c)][_0xd4453b(0x152)]:_0x336561,_0x29633e;}})();}}module[a124_0x23091e(0x160)]=TestHubHandler;