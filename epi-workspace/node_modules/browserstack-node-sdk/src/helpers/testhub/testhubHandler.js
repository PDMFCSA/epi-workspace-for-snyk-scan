function a90_0x2021(_0xd1b6ab,_0x4697b6){const _0x2127a3=a90_0x2127();return a90_0x2021=function(_0x20213a,_0x959c0e){_0x20213a=_0x20213a-0x1a8;let _0x47a7fc=_0x2127a3[_0x20213a];return _0x47a7fc;},a90_0x2021(_0xd1b6ab,_0x4697b6);}const a90_0x19f435=a90_0x2021;(function(_0x3e2efc,_0x336243){const _0x59313a=a90_0x2021,_0x50b0b9=_0x3e2efc();while(!![]){try{const _0x2b13c6=-parseInt(_0x59313a(0x1dc))/0x1+parseInt(_0x59313a(0x1ba))/0x2+parseInt(_0x59313a(0x20d))/0x3*(parseInt(_0x59313a(0x20a))/0x4)+parseInt(_0x59313a(0x1ce))/0x5+-parseInt(_0x59313a(0x1b3))/0x6+-parseInt(_0x59313a(0x20c))/0x7*(parseInt(_0x59313a(0x1cd))/0x8)+-parseInt(_0x59313a(0x1e4))/0x9*(parseInt(_0x59313a(0x1d9))/0xa);if(_0x2b13c6===_0x336243)break;else _0x50b0b9['push'](_0x50b0b9['shift']());}catch(_0x590c7e){_0x50b0b9['push'](_0x50b0b9['shift']());}}}(a90_0x2127,0xc3796));const bsSetupHelper=require(a90_0x19f435(0x1eb)),path=require(a90_0x19f435(0x1b7)),util=require(a90_0x19f435(0x1e7)),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require('../test-observability/utils'),testhubUtils=require(a90_0x19f435(0x1cf)),testHubConstants=require('./constants.js'),constants=require('../../bin/utils/constants.js'),RequestQueueHandler=require('../test-observability/requestQueueHandler.js'),logger=require(a90_0x19f435(0x1f7))[a90_0x19f435(0x1bc)],SessionHandler=require(a90_0x19f435(0x222)),PerformanceTester=require(a90_0x19f435(0x1e1)),{TESTHUB_EVENTS:PerformanceEvents}=require(a90_0x19f435(0x204)),TestDetails=require(a90_0x19f435(0x1c8)),{uploadTraceZip}=require(a90_0x19f435(0x213)),OngoingEvents=new Set();let processedTraceZips=![];const addEvent=_0x2e17f5=>{const _0x1970b9=a90_0x19f435;OngoingEvents[_0x1970b9(0x1c0)](_0x2e17f5);},awaitAllEvents=async()=>{const _0x244ba8=a90_0x19f435;return Promise[_0x244ba8(0x207)](OngoingEvents);};class TestHubHandler{static [a90_0x19f435(0x1b8)]=![];static async['launchBuild'](_0x4a7258,_0x8719df){const _0x1e762e=a90_0x19f435,_0x2cd12d={'mbvJb':function(_0x4a5348,_0x446bcd){return _0x4a5348||_0x446bcd;},'oxsoi':function(_0x1011c7,_0x20edf5){return _0x1011c7===_0x20edf5;},'Kmjtn':function(_0x395d04){return _0x395d04();},'Uiskn':_0x1e762e(0x1e6),'lJgwo':'false','pBIPT':_0x1e762e(0x216),'jrEGZ':function(_0x9e59ee,_0x277cea,_0xb467f0,_0x3a0ffc,_0x3ee14f){return _0x9e59ee(_0x277cea,_0xb467f0,_0x3a0ffc,_0x3ee14f);},'APTmG':'POST','OUGKa':function(_0xb76e75,_0x2ef8fb){return _0xb76e75===_0x2ef8fb;}};await PerformanceTester[_0x1e762e(0x1c1)](PerformanceEvents[_0x1e762e(0x1e0)],async()=>{const _0x1a5572=_0x1e762e,_0x2f2589=Object[_0x1a5572(0x21e)]({},_0x8719df[_0x1a5572(0x1be)],{'root_dir_path':'','framework':_0x8719df['framework']}),_0x63937e=bsSetupHelper[_0x1a5572(0x1c6)](_0x2f2589),_0x40c08c=bsSetupHelper[_0x1a5572(0x202)](_0x2f2589),_0x1340a0=_0x2cd12d[_0x1a5572(0x1ff)](_0x63937e,'')+':'+_0x2cd12d['mbvJb'](_0x40c08c,''),_0x53839d=testhubUtils[_0x1a5572(0x1c5)](_0x2f2589);process[_0x1a5572(0x201)][_0x1a5572(0x1d8)]=JSON[_0x1a5572(0x1fd)](_0x53839d);if(_0x2cd12d[_0x1a5572(0x1ac)](_0x1340a0,':'))return _0x2cd12d[_0x1a5572(0x1e2)](isTestObservabilitySession)&&(logger[_0x1a5572(0x228)](_0x2cd12d['Uiskn']),process[_0x1a5572(0x201)][_0x1a5572(0x1b4)]=_0x2cd12d[_0x1a5572(0x1db)]),testhubUtils['isAccessibilityEnabled'](_0x2f2589)&&logger[_0x1a5572(0x228)](_0x2cd12d[_0x1a5572(0x22f)]),[null,null];try{const _0x1faf3e=await this[_0x1a5572(0x203)](_0x2f2589,_0x4a7258),_0x1eb772=this[_0x1a5572(0x1f1)](_0x63937e,_0x40c08c),_0x30cfb9=await _0x2cd12d[_0x1a5572(0x1e3)](nodeRequest,_0x2cd12d[_0x1a5572(0x1c7)],testHubConstants[_0x1a5572(0x231)],_0x1faf3e,_0x1eb772),_0x9fc1a2=this[_0x1a5572(0x1d7)](_0x2f2589,_0x30cfb9,_0x1eb772);return await this[_0x1a5572(0x1f5)](_0x8719df,_0x4a7258),_0x9fc1a2;}catch(_0x2494e2){if(_0x2cd12d['OUGKa'](_0x2494e2[_0x1a5572(0x1df)],![])){testhubUtils[_0x1a5572(0x210)](_0x2494e2);return;}}})();}static async[a90_0x19f435(0x1f2)](){const _0x4f5d50=a90_0x19f435,_0x48efce={'wvnEr':function(_0x59f169,_0x501cc9,_0x44b417){return _0x59f169(_0x501cc9,_0x44b417);},'bPvDe':function(_0x306d0d,_0x22bd86){return _0x306d0d(_0x22bd86);},'ywADU':function(_0xf8090e){return _0xf8090e();},'CIgKJ':'All\x20trace\x20zip\x20send\x20events\x20complete'};if(processedTraceZips)return;const _0x41fe0e=TestDetails[_0x4f5d50(0x200)]();_0x41fe0e[_0x4f5d50(0x1ee)](({testUId:_0x23d7a8,filePath:_0x2923eb})=>{const _0x3eb7a4=_0x4f5d50;var _0x48dd0c=_0x48efce[_0x3eb7a4(0x1fe)](uploadTraceZip,_0x2923eb,_0x23d7a8);_0x48efce[_0x3eb7a4(0x22b)](addEvent,_0x48dd0c);});try{await _0x48efce[_0x4f5d50(0x1d1)](awaitAllEvents),logger[_0x4f5d50(0x228)](_0x48efce[_0x4f5d50(0x212)]),processedTraceZips=!![];}catch(_0x17324a){logger[_0x4f5d50(0x1b0)](_0x4f5d50(0x20b)+util[_0x4f5d50(0x1d2)](_0x17324a));}}static async[a90_0x19f435(0x1f5)](_0x4d3169,_0x2afa0e){const _0x4ca44e=a90_0x19f435;if(constants[_0x4ca44e(0x1f3)][_0x4ca44e(0x1f8)](_0x2afa0e)){await _0x4d3169['setupPercy']();return;}_0x4d3169['config'][_0x4ca44e(0x1e9)]&&logger[_0x4ca44e(0x228)](_0x4ca44e(0x1e5)+_0x2afa0e+_0x4ca44e(0x1ef));}static[a90_0x19f435(0x211)](_0x205753){const _0x225b48=a90_0x19f435,_0x6eba0b={};_0x6eba0b['settings']=_0x205753[_0x225b48(0x20e)];const _0x367941=_0x6eba0b;return _0x367941;}static[a90_0x19f435(0x1f1)](_0x4ee316,_0x30ee9e){const _0x59098c=a90_0x19f435,_0x4917eb={'NxInl':function(_0x5e916b,_0x217e20){return _0x5e916b(_0x217e20);}},_0x18d37d={};return _0x18d37d['username']=_0x4ee316,_0x18d37d[_0x59098c(0x22a)]=_0x30ee9e,{'auth':_0x18d37d,'headers':_0x4917eb[_0x59098c(0x1dd)](getDefaultHeaders,![])};}static async[a90_0x19f435(0x203)](_0xadb8f,_0x36a71d){const _0x5b83fe=a90_0x19f435,_0x29e01e={'VHuJK':function(_0x4fa77c,_0xc91a15){return _0x4fa77c(_0xc91a15);}},_0x5a51d0={'project_name':_0xadb8f[_0x5b83fe(0x1cc)]||'','name':_0xadb8f[_0x5b83fe(0x1da)]||path[_0x5b83fe(0x232)](path[_0x5b83fe(0x1c2)](process[_0x5b83fe(0x1fb)]())),'build_identifier':_0xadb8f[_0x5b83fe(0x1b2)],'description':_0xadb8f[_0x5b83fe(0x230)]||'','started_at':new Date()[_0x5b83fe(0x21f)](),'tags':_0x29e01e['VHuJK'](getCustomTags,_0xadb8f),'host_info':bsSetupHelper[_0x5b83fe(0x1ad)](),'ci_info':bsSetupHelper[_0x5b83fe(0x1c3)](),'build_run_identifier':process[_0x5b83fe(0x201)][_0x5b83fe(0x1a9)],'failed_tests_rerun':process[_0x5b83fe(0x201)]['BROWSERSTACK_RERUN']||![],'version_control':await bsSetupHelper['getGitMetaData'](),'accessibility':this[_0x5b83fe(0x211)](_0xadb8f),'framework_details':testhubUtils[_0x5b83fe(0x21d)](_0xadb8f,_0x36a71d),'product_map':testhubUtils['getProductMap'](_0xadb8f),'browserstackAutomation':bsSetupHelper['isBrowserstackInfra'](),'grouping_identifier':process[_0x5b83fe(0x201)][_0x5b83fe(0x22d)]};if(bsSetupHelper[_0x5b83fe(0x1b1)]()[_0x5b83fe(0x21a)]||bsSetupHelper[_0x5b83fe(0x1b1)]()[_0x5b83fe(0x1f0)]){const _0x20b916={};_0x20b916[_0x5b83fe(0x1ec)]=process[_0x5b83fe(0x201)]['BROWSERSTACK_CENTRAL_SCANNER_JOBID'],_0x20b916[_0x5b83fe(0x1d5)]=process['env'][_0x5b83fe(0x1bb)],_0x5a51d0[_0x5b83fe(0x21a)]=_0x20b916;}return _0x5a51d0;}static[a90_0x19f435(0x1d7)](_0x7a9682,_0x7ce417,_0x1faf8d){const _0x569928=a90_0x19f435,_0x1594b5={'PLmck':function(_0x584aaf){return _0x584aaf();},'YoSlg':function(_0x58cbdc,_0x20bc29){return _0x58cbdc&&_0x20bc29;},'RqHyN':'true','yfmpu':_0x569928(0x1e8)},_0x2cc63e={};if(_0x1594b5[_0x569928(0x22c)](isTestObservabilitySession)){const [_0x17509f,_0x1d1a00,_0x1bb54d]=testhubUtils[_0x569928(0x1f9)](_0x7ce417[_0x569928(0x1bf)],_0x1faf8d[_0x569928(0x1d6)]);if(_0x1594b5[_0x569928(0x1b5)](_0x17509f,_0x1d1a00)){const _0x4041d9={};_0x4041d9['jwt']=_0x17509f,_0x4041d9[_0x569928(0x1ab)]=_0x1d1a00,_0x4041d9['allowScreenshot']=_0x1bb54d,_0x2cc63e[testHubConstants[_0x569928(0x21b)]]=_0x4041d9,process[_0x569928(0x201)][_0x569928(0x20f)]=_0x1594b5[_0x569928(0x220)];}else _0x2cc63e[testHubConstants[_0x569928(0x21b)]]={},process['env'][_0x569928(0x20f)]=_0x1594b5['yfmpu'];}else process[_0x569928(0x201)][_0x569928(0x20f)]=_0x1594b5[_0x569928(0x1aa)];if(testhubUtils[_0x569928(0x1a8)](_0x7a9682)){const [_0x3da68f,_0x197739]=testhubUtils[_0x569928(0x217)](_0x7ce417[_0x569928(0x1bf)]);if(_0x1594b5['YoSlg'](_0x3da68f,_0x197739)){const _0x467c68={};_0x467c68[_0x569928(0x1de)]=_0x3da68f,_0x467c68[_0x569928(0x1ab)]=_0x197739,_0x2cc63e[testHubConstants[_0x569928(0x206)]]=_0x467c68,process[_0x569928(0x201)][_0x569928(0x225)]=_0x1594b5[_0x569928(0x220)];}else _0x2cc63e[testHubConstants[_0x569928(0x206)]]={},process[_0x569928(0x201)][_0x569928(0x225)]=_0x1594b5[_0x569928(0x1aa)];}else process[_0x569928(0x201)][_0x569928(0x225)]=_0x1594b5[_0x569928(0x1aa)];return testhubUtils['setTestHubCommonMetaInfo'](_0x7ce417[_0x569928(0x1bf)]),logger[_0x569928(0x226)](_0x569928(0x227)+process['env']['BROWSERSTACK_TESTHUB_UUID']),_0x2cc63e;}static async[a90_0x19f435(0x1ae)](_0x53220b){const _0x5bac1c=a90_0x19f435,_0x1d8dca={'TMwFa':function(_0x2bcb67,_0x1281db){return _0x2bcb67===_0x1281db;},'bERFa':'false','pdLmc':_0x5bac1c(0x1cb),'zJTeJ':_0x5bac1c(0x1ea),'eYzqK':_0x5bac1c(0x1b0),'bhyBj':_0x5bac1c(0x1f6),'zHHiu':'finished_metadata','ccpDF':'user_killed','qtOlz':function(_0x533149){return _0x533149();},'uKfin':function(_0x5aaf9d,_0xc8d9d7,_0x362fb3,_0x17b006,_0x4d476a,_0x5c37fc){return _0x5aaf9d(_0xc8d9d7,_0x362fb3,_0x17b006,_0x4d476a,_0x5c37fc);},'OavIP':_0x5bac1c(0x21c),'FmrMB':_0x5bac1c(0x1fa),'VXNdm':_0x5bac1c(0x1df)};await this[_0x5bac1c(0x1f2)](),await PerformanceTester[_0x5bac1c(0x1c1)](PerformanceEvents[_0x5bac1c(0x1b9)],async()=>{const _0xf82078=_0x5bac1c;if(_0x1d8dca['TMwFa'](process[_0xf82078(0x201)][_0xf82078(0x1b4)],_0x1d8dca[_0xf82078(0x1ed)])||TestHubHandler[_0xf82078(0x1b8)]||bsSetupHelper['isUndefined'](process['env'][testHubConstants['ENV_VAR'][_0xf82078(0x223)]]))return;TestHubHandler['buildStopSent']=!![],await RequestQueueHandler[_0xf82078(0x1d0)]()[_0xf82078(0x1fc)](),await SessionHandler[_0xf82078(0x205)]();if(_0x1d8dca['TMwFa'](process[_0xf82078(0x201)][testHubConstants[_0xf82078(0x221)][_0xf82078(0x223)]],_0x1d8dca['pdLmc'])||_0x1d8dca[_0xf82078(0x1d4)](process[_0xf82078(0x201)][testHubConstants[_0xf82078(0x221)][_0xf82078(0x1c4)]],_0x1d8dca[_0xf82078(0x1ca)])){logger[_0xf82078(0x228)](_0x1d8dca[_0xf82078(0x214)]);const _0x11b5b4={};return _0x11b5b4[_0xf82078(0x224)]=_0x1d8dca[_0xf82078(0x1f4)],_0x11b5b4[_0xf82078(0x208)]=_0x1d8dca[_0xf82078(0x218)],_0x11b5b4;}const _0x5443e8={'finished_at':new Date()[_0xf82078(0x21f)](),'finished_metadata':[]};!!_0x53220b&&_0x5443e8[_0x1d8dca[_0xf82078(0x1bd)]][_0xf82078(0x219)]({'reason':_0x1d8dca['ccpDF'],'signal':_0x53220b,'failure_data':''});const _0x578eb0={'headers':_0x1d8dca['qtOlz'](getDefaultHeaders)};try{const _0x4b565d=await _0x1d8dca[_0xf82078(0x1c9)](nodeRequest,_0x1d8dca['OavIP'],_0xf82078(0x1d3)+process['env'][testHubConstants[_0xf82078(0x221)]['BROWSERSTACK_TESTHUB_UUID']]+_0xf82078(0x209),_0x5443e8,_0x578eb0,![]);if(_0x4b565d[_0xf82078(0x1bf)]&&_0x4b565d['data']['error']){const _0x1fa0d0={};_0x1fa0d0[_0xf82078(0x208)]=_0x4b565d[_0xf82078(0x1bf)]['error'];throw _0x1fa0d0;}else{logger[_0xf82078(0x228)](_0x1d8dca['FmrMB']);const _0x2cf301={};return _0x2cf301['status']=_0x1d8dca[_0xf82078(0x229)],_0x2cf301[_0xf82078(0x208)]='',_0x2cf301;}}catch(_0x27b152){_0x27b152[_0xf82078(0x215)]?logger[_0xf82078(0x228)](_0xf82078(0x1b6)+_0x27b152['response'][_0xf82078(0x224)]+'\x20'+_0x27b152[_0xf82078(0x215)][_0xf82078(0x1af)]+'\x20'+JSON[_0xf82078(0x1fd)](_0x27b152['response'][_0xf82078(0x1bf)])):logger['debug'](_0xf82078(0x1b6)+(_0x27b152[_0xf82078(0x208)]||_0x27b152));const _0x3e4eee={};return _0x3e4eee[_0xf82078(0x224)]=_0x1d8dca[_0xf82078(0x1f4)],_0x3e4eee[_0xf82078(0x208)]=_0x27b152[_0xf82078(0x208)]||_0x27b152['response']?_0x27b152[_0xf82078(0x215)][_0xf82078(0x224)]+':'+_0x27b152[_0xf82078(0x215)][_0xf82078(0x1af)]:_0x27b152,_0x3e4eee;}})();}}module[a90_0x19f435(0x22e)]=TestHubHandler;function a90_0x2127(){const _0x56fc56=['TESTHUB_BUILD_API','basename','isAccessibilityEnabled','BROWSERSTACK_BUILD_RUN_IDENTIFIER','yfmpu','buildHashedId','oxsoi','getHostInfo','stop','statusText','error','getCentralUser','buildIdentifier','3590136NpRSqC','BS_TESTOPS_BUILD_COMPLETED','YoSlg','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','path','buildStopSent','STOP','2073758pMlwZI','BROWSERSTACK_CENTRAL_SCANNER_JWT','winstonLogger','zHHiu','config','data','add','measureWrapper','resolve','getCiInfo','BROWSERSTACK_TESTHUB_UUID','getProductMap','getUserName','APTmG','../../bin/playwright/reporter/test-details.js','uKfin','pdLmc','null','projectName','56nJBoUV','6116955TLbXNp','./utils.js','getInstance','ywADU','format','api/v1/builds/','TMwFa','token','auth','extractDataFromResponse','BROWSERSTACK_PRODUCT_MAP','100bLDYDf','buildName','lJgwo','934098uUtXzP','NxInl','authToken','success','START','../performance/performance-tester.js','Kmjtn','jrEGZ','370611zYMWyr','Percy\x20is\x20not\x20supported\x20for\x20','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','util','false','percy','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','../helper','job_id','bERFa','forEach','\x20framework','lcnc','getConfig','processTraceZips','PERCY_SUPPORTED_FRAMEWORKS','eYzqK','checkAndSetupPercy','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','../logger','includes','setTestObservabilityVariables','stopBuildUpstream\x20event\x20successful!','cwd','uploadPending','stringify','wvnEr','mbvJb','getTraceFilePaths','env','getAccessKey','generateBuildUpstreamData','../performance/constants','waitForBuildStatus','ACCESSIBILITY','allSettled','message','/stop','254580wVMRMf','Error\x20while\x20waiting\x20for\x20events:\x20','724619sExRfC','57nYyaai','accessibilityOptions','BROWSERSTACK_TEST_OBSERVABILITY','logBuildError','getAccessibilityOptions','CIgKJ','../../bin/playwright/reporter/pwUtils.js','zJTeJ','response','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','setAccessibilityVariables','bhyBj','push','central_scanner','OBSERVABILITY','PUT','getFrameworkDetails','assign','toISOString','RqHyN','ENV_VAR','../test-observability/sessionHandler.js','BROWSERSTACK_TESTHUB_JWT','status','BROWSERSTACK_ACCESSIBILITY','info','Testhub\x20started\x20with\x20id:\x20','debug','VXNdm','password','bPvDe','PLmck','BROWSERSTACK_BUILD_GROUPING_IDENTIFIER','exports','pBIPT','buildDescription'];a90_0x2127=function(){return _0x56fc56;};return a90_0x2127();}