function a90_0x5b86(){const _0x9c4d7e=['1067132ZgVQyH','133ZaDMZC','../performance/constants','BROWSERSTACK_ACCESSIBILITY','Error\x20while\x20waiting\x20for\x20events:\x20','1044hKXAzG','api/v1/builds/','EAsaV','740gUKXHH','AXcPc','Percy\x20is\x20not\x20supported\x20for\x20','GipHa','isUndefined','../test-observability/requestQueueHandler.js','false','getProductMap','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','data','WSYpk','getConfig','username','../../bin/playwright/reporter/pwUtils.js','includes','BROWSERSTACK_CENTRAL_SCANNER_JWT','3FvEBDz','launchBuild','format','../../bin/playwright/reporter/test-details.js','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','\x20framework','true','env','toISOString','processTraceZips','auth','../helper','isBrowserstackInfra','exports','token','ItmjI','extractDataFromResponse','waitForBuildStatus','percy','120019NdfRzB','measureWrapper','accessibilityOptions','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','password','1020395TSxhGf','message','PERCY_SUPPORTED_FRAMEWORKS','jivwV','setTestObservabilityVariables','ptLTJ','BROWSERSTACK_TEST_OBSERVABILITY','statusText','jwt','ILJwp','DNTvl','getCentralUser','BROWSERSTACK_TESTHUB_UUID','MfUCL','2486264cPBXdZ','Testhub\x20started\x20with\x20id:\x20','fYryd','FZbtC','138282pNUxCU','stringify','finished_metadata','logBuildError','../test-observability/utils','../../bin/utils/constants.js','winstonLogger','wSyrE','oKszJ','uvOMs','../test-observability/sessionHandler.js','vFNJo','response','job_id','HFkBJ','buildHashedId','BROWSERSTACK_RERUN','IoAZM','setTestHubCommonMetaInfo','getUserName','STOP','PUT','resolve','BROWSERSTACK_TESTHUB_JWT','getGitMetaData','EDQEf','getTraceFilePaths','config','XmwnY','/stop','../logger','stop','38202LBuqBF','info','null','settings','ENV_VAR','checkAndSetupPercy','user_killed','ACCESSIBILITY','getAccessKey','allSettled','MoDZj','buildIdentifier','getHostInfo','generateBuildUpstreamData','ZKGMM','BROWSERSTACK_PRODUCT_MAP','getFrameworkDetails','error','POST','status','START','buildStopSent','basename','setupPercy','qUFAZ','authToken','gKWLR','EVWHp','debug','setAccessibilityVariables','add','BS_TESTOPS_BUILD_COMPLETED','BROWSERSTACK_BUILD_RUN_IDENTIFIER','central_scanner','SQump','xhQNJ','getCiInfo','../performance/performance-tester.js','stopBuildUpstream\x20event\x20successful!'];a90_0x5b86=function(){return _0x9c4d7e;};return a90_0x5b86();}const a90_0x46ace9=a90_0x346c;(function(_0x5f19b9,_0x501116){const _0x3eba77=a90_0x346c,_0x515040=_0x5f19b9();while(!![]){try{const _0x3aad75=parseInt(_0x3eba77(0x135))/0x1+parseInt(_0x3eba77(0x14c))/0x2*(parseInt(_0x3eba77(0x122))/0x3)+-parseInt(_0x3eba77(0x10a))/0x4+-parseInt(_0x3eba77(0x13a))/0x5+parseInt(_0x3eba77(0x16c))/0x6*(parseInt(_0x3eba77(0x10b))/0x7)+parseInt(_0x3eba77(0x148))/0x8+parseInt(_0x3eba77(0x10f))/0x9*(parseInt(_0x3eba77(0x112))/0xa);if(_0x3aad75===_0x501116)break;else _0x515040['push'](_0x515040['shift']());}catch(_0x3d7106){_0x515040['push'](_0x515040['shift']());}}}(a90_0x5b86,0x26bae));function a90_0x346c(_0x1a8ddc,_0x562a14){const _0x5b86db=a90_0x5b86();return a90_0x346c=function(_0x346cbf,_0x201d5b){_0x346cbf=_0x346cbf-0xe8;let _0x10778a=_0x5b86db[_0x346cbf];return _0x10778a;},a90_0x346c(_0x1a8ddc,_0x562a14);}const bsSetupHelper=require(a90_0x46ace9(0x12d)),path=require('path'),util=require('util'),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require(a90_0x46ace9(0x150)),testhubUtils=require('./utils.js'),testHubConstants=require('./constants.js'),constants=require(a90_0x46ace9(0x151)),RequestQueueHandler=require(a90_0x46ace9(0x117)),logger=require(a90_0x46ace9(0x16a))[a90_0x46ace9(0x152)],SessionHandler=require(a90_0x46ace9(0x156)),PerformanceTester=require(a90_0x46ace9(0x108)),{TESTHUB_EVENTS:PerformanceEvents}=require(a90_0x46ace9(0x10c)),TestDetails=require(a90_0x46ace9(0x125)),{uploadTraceZip}=require(a90_0x46ace9(0x11f)),OngoingEvents=new Set();let processedTraceZips=![];const addEvent=_0x2b845e=>{const _0x14250d=a90_0x46ace9;OngoingEvents[_0x14250d(0x101)](_0x2b845e);},awaitAllEvents=async()=>{const _0x1c00f9=a90_0x46ace9;return Promise[_0x1c00f9(0xec)](OngoingEvents);};class TestHubHandler{static [a90_0x46ace9(0xf8)]=![];static async[a90_0x46ace9(0x123)](_0x923322,_0x199981){const _0x21f58b=a90_0x46ace9,_0x4435c7={'HFkBJ':function(_0x180c46,_0x2faf61){return _0x180c46||_0x2faf61;},'EVWHp':function(_0x11061b,_0x28c405){return _0x11061b===_0x28c405;},'SQump':function(_0x2c8b3a){return _0x2c8b3a();},'ZKGMM':_0x21f58b(0x11a),'MfUCL':'false','gKWLR':'Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','vFNJo':function(_0xc7fb5,_0x1a1008,_0x1cc54f,_0xd62186,_0x5967ad){return _0xc7fb5(_0x1a1008,_0x1cc54f,_0xd62186,_0x5967ad);},'WSYpk':_0x21f58b(0xf5)};await PerformanceTester[_0x21f58b(0x136)](PerformanceEvents[_0x21f58b(0xf7)],async()=>{const _0x4be362=_0x21f58b,_0x2fc417=Object['assign']({},_0x199981[_0x4be362(0x167)],{'root_dir_path':'','framework':_0x199981['framework']}),_0xa24cbd=bsSetupHelper[_0x4be362(0x15f)](_0x2fc417),_0x3dca42=bsSetupHelper[_0x4be362(0xeb)](_0x2fc417),_0x3c635c=_0x4435c7[_0x4be362(0x15a)](_0xa24cbd,'')+':'+_0x4435c7[_0x4be362(0x15a)](_0x3dca42,''),_0x237350=testhubUtils['getProductMap'](_0x2fc417);process['env'][_0x4be362(0xf2)]=JSON[_0x4be362(0x14d)](_0x237350);if(_0x4435c7[_0x4be362(0xfe)](_0x3c635c,':'))return _0x4435c7[_0x4be362(0x105)](isTestObservabilitySession)&&(logger['debug'](_0x4435c7[_0x4be362(0xf1)]),process[_0x4be362(0x129)][_0x4be362(0x102)]=_0x4435c7[_0x4be362(0x147)]),testhubUtils['isAccessibilityEnabled'](_0x2fc417)&&logger[_0x4be362(0xff)](_0x4435c7[_0x4be362(0xfd)]),[null,null];try{const _0x16291e=await this[_0x4be362(0xf0)](_0x2fc417,_0x923322),_0x4c546b=this[_0x4be362(0x11d)](_0xa24cbd,_0x3dca42),_0x2b6e1d=await _0x4435c7[_0x4be362(0x157)](nodeRequest,_0x4435c7[_0x4be362(0x11c)],testHubConstants['TESTHUB_BUILD_API'],_0x16291e,_0x4c546b),_0xb610ec=this[_0x4be362(0x132)](_0x2fc417,_0x2b6e1d,_0x4c546b);return await this[_0x4be362(0xe8)](_0x199981,_0x923322),_0xb610ec;}catch(_0x5f3b16){if(_0x4435c7[_0x4be362(0xfe)](_0x5f3b16['success'],![])){testhubUtils[_0x4be362(0x14f)](_0x5f3b16);return;}}})();}static async[a90_0x46ace9(0x12b)](){const _0x5f11f3=a90_0x46ace9,_0x5d4fd1={'ptLTJ':function(_0x211ba2,_0x234256,_0x20091e){return _0x211ba2(_0x234256,_0x20091e);},'EDQEf':function(_0x2265c7,_0x571c0e){return _0x2265c7(_0x571c0e);},'vXQFw':function(_0x1ba3da){return _0x1ba3da();},'lexmT':'All\x20trace\x20zip\x20send\x20events\x20complete'};if(processedTraceZips)return;const _0x590e08=TestDetails[_0x5f11f3(0x166)]();_0x590e08['forEach'](({testUId:_0x4d94d4,filePath:_0x2419ab})=>{const _0x10fa01=_0x5f11f3;var _0x40e78c=_0x5d4fd1[_0x10fa01(0x13f)](uploadTraceZip,_0x2419ab,_0x4d94d4);_0x5d4fd1[_0x10fa01(0x165)](addEvent,_0x40e78c);});try{await _0x5d4fd1['vXQFw'](awaitAllEvents),logger['debug'](_0x5d4fd1['lexmT']),processedTraceZips=!![];}catch(_0x12d444){logger[_0x5f11f3(0xf4)](_0x5f11f3(0x10e)+util[_0x5f11f3(0x124)](_0x12d444));}}static async[a90_0x46ace9(0xe8)](_0xf1dd5c,_0x469c9d){const _0x47f785=a90_0x46ace9;if(constants[_0x47f785(0x13c)][_0x47f785(0x120)](_0x469c9d)){await _0xf1dd5c[_0x47f785(0xfa)]();return;}_0xf1dd5c[_0x47f785(0x167)][_0x47f785(0x134)]&&logger[_0x47f785(0xff)](_0x47f785(0x114)+_0x469c9d+_0x47f785(0x127));}static['getAccessibilityOptions'](_0x473095){const _0x653b9=a90_0x46ace9,_0x2e29d1={};_0x2e29d1[_0x653b9(0x16f)]=_0x473095[_0x653b9(0x137)];const _0x58cd35=_0x2e29d1;return _0x58cd35;}static[a90_0x46ace9(0x11d)](_0x5495a9,_0x5dd5df){const _0x486bd7=a90_0x46ace9,_0x398d04={'wSyrE':function(_0x38d41e,_0x55ea88){return _0x38d41e(_0x55ea88);}},_0x253817={};return _0x253817[_0x486bd7(0x11e)]=_0x5495a9,_0x253817[_0x486bd7(0x139)]=_0x5dd5df,{'auth':_0x253817,'headers':_0x398d04[_0x486bd7(0x153)](getDefaultHeaders,![])};}static async[a90_0x46ace9(0xf0)](_0x42dab4,_0x14027d){const _0x1a44a1=a90_0x46ace9,_0x2297e3={'jivwV':function(_0xd41f89,_0xb8f483){return _0xd41f89(_0xb8f483);}},_0x8468a2={'project_name':_0x42dab4['projectName']||'','name':_0x42dab4['buildName']||path[_0x1a44a1(0xf9)](path[_0x1a44a1(0x162)](process['cwd']())),'build_identifier':_0x42dab4[_0x1a44a1(0xee)],'description':_0x42dab4['buildDescription']||'','started_at':new Date()[_0x1a44a1(0x12a)](),'tags':_0x2297e3[_0x1a44a1(0x13d)](getCustomTags,_0x42dab4),'host_info':bsSetupHelper[_0x1a44a1(0xef)](),'ci_info':bsSetupHelper[_0x1a44a1(0x107)](),'build_run_identifier':process[_0x1a44a1(0x129)][_0x1a44a1(0x103)],'failed_tests_rerun':process[_0x1a44a1(0x129)][_0x1a44a1(0x15c)]||![],'version_control':await bsSetupHelper[_0x1a44a1(0x164)](),'accessibility':this['getAccessibilityOptions'](_0x42dab4),'framework_details':testhubUtils[_0x1a44a1(0xf3)](_0x42dab4,_0x14027d),'product_map':testhubUtils[_0x1a44a1(0x119)](_0x42dab4),'browserstackAutomation':bsSetupHelper[_0x1a44a1(0x12e)](),'grouping_identifier':process[_0x1a44a1(0x129)]['BROWSERSTACK_BUILD_GROUPING_IDENTIFIER']};if(bsSetupHelper['getCentralUser']()[_0x1a44a1(0x104)]||bsSetupHelper[_0x1a44a1(0x145)]()['lcnc']){const _0x58e607={};_0x58e607[_0x1a44a1(0x159)]=process[_0x1a44a1(0x129)]['BROWSERSTACK_CENTRAL_SCANNER_JOBID'],_0x58e607[_0x1a44a1(0x130)]=process[_0x1a44a1(0x129)][_0x1a44a1(0x121)],_0x8468a2[_0x1a44a1(0x104)]=_0x58e607;}return _0x8468a2;}static[a90_0x46ace9(0x132)](_0x11199a,_0x3ccd9f,_0x472277){const _0x3c9f92=a90_0x46ace9,_0x670078={'ItmjI':function(_0x4d3b4a){return _0x4d3b4a();},'AhGUw':function(_0x3887cf,_0x35a738){return _0x3887cf&&_0x35a738;},'ILJwp':_0x3c9f92(0x128),'uvOMs':'false','EAsaV':function(_0x57d511,_0xcb401a){return _0x57d511&&_0xcb401a;}},_0x1b9820={};if(_0x670078[_0x3c9f92(0x131)](isTestObservabilitySession)){const [_0x873291,_0x4f0281,_0x4bad04]=testhubUtils[_0x3c9f92(0x13e)](_0x3ccd9f['data'],_0x472277[_0x3c9f92(0x12c)]);if(_0x670078['AhGUw'](_0x873291,_0x4f0281)){const _0x261b2c={};_0x261b2c[_0x3c9f92(0x142)]=_0x873291,_0x261b2c[_0x3c9f92(0x15b)]=_0x4f0281,_0x261b2c['allowScreenshot']=_0x4bad04,_0x1b9820[testHubConstants['OBSERVABILITY']]=_0x261b2c,process['env'][_0x3c9f92(0x140)]=_0x670078[_0x3c9f92(0x143)];}else _0x1b9820[testHubConstants['OBSERVABILITY']]={},process[_0x3c9f92(0x129)][_0x3c9f92(0x140)]=_0x670078[_0x3c9f92(0x155)];}else process[_0x3c9f92(0x129)][_0x3c9f92(0x140)]=_0x670078[_0x3c9f92(0x155)];if(testhubUtils['isAccessibilityEnabled'](_0x11199a)){const [_0x248013,_0x54e5da]=testhubUtils[_0x3c9f92(0x100)](_0x3ccd9f[_0x3c9f92(0x11b)]);if(_0x670078[_0x3c9f92(0x111)](_0x248013,_0x54e5da)){const _0x3adcf0={};_0x3adcf0[_0x3c9f92(0xfc)]=_0x248013,_0x3adcf0[_0x3c9f92(0x15b)]=_0x54e5da,_0x1b9820[testHubConstants[_0x3c9f92(0xea)]]=_0x3adcf0,process[_0x3c9f92(0x129)][_0x3c9f92(0x10d)]=_0x670078['ILJwp'];}else _0x1b9820[testHubConstants[_0x3c9f92(0xea)]]={},process[_0x3c9f92(0x129)][_0x3c9f92(0x10d)]=_0x670078['uvOMs'];}else process[_0x3c9f92(0x129)][_0x3c9f92(0x10d)]=_0x670078[_0x3c9f92(0x155)];return testhubUtils[_0x3c9f92(0x15e)](_0x3ccd9f[_0x3c9f92(0x11b)]),logger[_0x3c9f92(0x16d)](_0x3c9f92(0x149)+process[_0x3c9f92(0x129)]['BROWSERSTACK_TESTHUB_UUID']),_0x1b9820;}static async[a90_0x46ace9(0x16b)](_0x1baa42){const _0x3bc9ce=a90_0x46ace9,_0x492ca2={'yBdyd':function(_0x4db042,_0x496824){return _0x4db042===_0x496824;},'AXcPc':_0x3bc9ce(0x118),'fYryd':_0x3bc9ce(0x16e),'XmwnY':function(_0x4bb959,_0x2d3732){return _0x4bb959===_0x2d3732;},'DNTvl':'EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','IoAZM':_0x3bc9ce(0xf4),'Kkluq':_0x3bc9ce(0x126),'eVIuv':_0x3bc9ce(0x14e),'qUFAZ':_0x3bc9ce(0xe9),'GipHa':function(_0x8430bd){return _0x8430bd();},'FZbtC':function(_0x5dbc1d,_0x351640,_0x1e064a,_0x53196a,_0x5baeca,_0x1d344e){return _0x5dbc1d(_0x351640,_0x1e064a,_0x53196a,_0x5baeca,_0x1d344e);},'MoDZj':_0x3bc9ce(0x161),'xhQNJ':_0x3bc9ce(0x109),'oKszJ':'success'};await this[_0x3bc9ce(0x12b)](),await PerformanceTester['measureWrapper'](PerformanceEvents[_0x3bc9ce(0x160)],async()=>{const _0x162636=_0x3bc9ce;if(_0x492ca2['yBdyd'](process[_0x162636(0x129)][_0x162636(0x102)],_0x492ca2[_0x162636(0x113)])||TestHubHandler['buildStopSent']||bsSetupHelper[_0x162636(0x116)](process[_0x162636(0x129)][testHubConstants[_0x162636(0x170)][_0x162636(0x163)]]))return;TestHubHandler[_0x162636(0xf8)]=!![],await RequestQueueHandler['getInstance']()['uploadPending'](),await SessionHandler[_0x162636(0x133)]();if(_0x492ca2['yBdyd'](process['env'][testHubConstants[_0x162636(0x170)][_0x162636(0x163)]],_0x492ca2['fYryd'])||_0x492ca2[_0x162636(0x168)](process[_0x162636(0x129)][testHubConstants[_0x162636(0x170)][_0x162636(0x146)]],_0x492ca2[_0x162636(0x14a)])){logger[_0x162636(0xff)](_0x492ca2[_0x162636(0x144)]);const _0x365787={};return _0x365787[_0x162636(0xf6)]=_0x492ca2[_0x162636(0x15d)],_0x365787[_0x162636(0x13b)]=_0x492ca2['Kkluq'],_0x365787;}const _0x44fd2e={'finished_at':new Date()['toISOString'](),'finished_metadata':[]};!!_0x1baa42&&_0x44fd2e[_0x492ca2['eVIuv']]['push']({'reason':_0x492ca2[_0x162636(0xfb)],'signal':_0x1baa42,'failure_data':''});const _0x19f305={'headers':_0x492ca2[_0x162636(0x115)](getDefaultHeaders)};try{const _0x10e4fb=await _0x492ca2[_0x162636(0x14b)](nodeRequest,_0x492ca2[_0x162636(0xed)],_0x162636(0x110)+process['env'][testHubConstants[_0x162636(0x170)][_0x162636(0x146)]]+_0x162636(0x169),_0x44fd2e,_0x19f305,![]);if(_0x10e4fb['data']&&_0x10e4fb[_0x162636(0x11b)][_0x162636(0xf4)]){const _0x1e5db1={};_0x1e5db1[_0x162636(0x13b)]=_0x10e4fb['data'][_0x162636(0xf4)];throw _0x1e5db1;}else{logger[_0x162636(0xff)](_0x492ca2[_0x162636(0x106)]);const _0x2f4d32={};return _0x2f4d32['status']=_0x492ca2[_0x162636(0x154)],_0x2f4d32[_0x162636(0x13b)]='',_0x2f4d32;}}catch(_0x213392){_0x213392[_0x162636(0x158)]?logger['debug'](_0x162636(0x138)+_0x213392[_0x162636(0x158)][_0x162636(0xf6)]+'\x20'+_0x213392[_0x162636(0x158)][_0x162636(0x141)]+'\x20'+JSON[_0x162636(0x14d)](_0x213392['response']['data'])):logger[_0x162636(0xff)]('EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20'+(_0x213392[_0x162636(0x13b)]||_0x213392));const _0x38a039={};return _0x38a039[_0x162636(0xf6)]=_0x492ca2[_0x162636(0x15d)],_0x38a039[_0x162636(0x13b)]=_0x213392[_0x162636(0x13b)]||_0x213392['response']?_0x213392[_0x162636(0x158)][_0x162636(0xf6)]+':'+_0x213392[_0x162636(0x158)][_0x162636(0x141)]:_0x213392,_0x38a039;}})();}}module[a90_0x46ace9(0x12f)]=TestHubHandler;