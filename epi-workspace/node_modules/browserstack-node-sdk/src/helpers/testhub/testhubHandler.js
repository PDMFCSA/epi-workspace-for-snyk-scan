const a90_0x397166=a90_0x393c;(function(_0x43acf9,_0x1d321c){const _0x303f3e=a90_0x393c,_0xdd2528=_0x43acf9();while(!![]){try{const _0xf46cb4=-parseInt(_0x303f3e(0x1e8))/0x1+parseInt(_0x303f3e(0x16a))/0x2*(parseInt(_0x303f3e(0x197))/0x3)+-parseInt(_0x303f3e(0x19b))/0x4+parseInt(_0x303f3e(0x1e0))/0x5*(parseInt(_0x303f3e(0x1bf))/0x6)+parseInt(_0x303f3e(0x1b0))/0x7+-parseInt(_0x303f3e(0x163))/0x8+parseInt(_0x303f3e(0x1d4))/0x9*(parseInt(_0x303f3e(0x1ae))/0xa);if(_0xf46cb4===_0x1d321c)break;else _0xdd2528['push'](_0xdd2528['shift']());}catch(_0xf59d1b){_0xdd2528['push'](_0xdd2528['shift']());}}}(a90_0x30de,0xc366c));const bsSetupHelper=require(a90_0x397166(0x1c5)),path=require('path'),util=require('util'),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require('../test-observability/utils'),testhubUtils=require(a90_0x397166(0x198)),testHubConstants=require(a90_0x397166(0x174)),constants=require('../../bin/utils/constants.js'),RequestQueueHandler=require(a90_0x397166(0x173)),logger=require(a90_0x397166(0x1c6))[a90_0x397166(0x183)],SessionHandler=require('../test-observability/sessionHandler.js'),PerformanceTester=require(a90_0x397166(0x17a)),{TESTHUB_EVENTS:PerformanceEvents}=require(a90_0x397166(0x1de)),TestDetails=require('../../bin/playwright/reporter/test-details.js'),{uploadTraceZip}=require(a90_0x397166(0x1cf)),OngoingEvents=new Set();let processedTraceZips=![];const addEvent=_0x37cb39=>{const _0x2b869f=a90_0x397166;OngoingEvents[_0x2b869f(0x18b)](_0x37cb39);},awaitAllEvents=async()=>{const _0x2fbed3=a90_0x397166;return Promise[_0x2fbed3(0x1bd)](OngoingEvents);};function a90_0x393c(_0x5ca90d,_0x47c47b){const _0x30de87=a90_0x30de();return a90_0x393c=function(_0x393c91,_0x559d42){_0x393c91=_0x393c91-0x163;let _0x219f89=_0x30de87[_0x393c91];return _0x219f89;},a90_0x393c(_0x5ca90d,_0x47c47b);}class TestHubHandler{static [a90_0x397166(0x167)]=![];static async['launchBuild'](_0x429b0e,_0x48b8f7){const _0x1f40a2=a90_0x397166,_0x2abb12={'FWxQN':function(_0x26d021,_0x48694f){return _0x26d021||_0x48694f;},'fnYxc':function(_0x27583d,_0x172824){return _0x27583d||_0x172824;},'ZuzYe':function(_0x5b94fa,_0x44ff7d){return _0x5b94fa===_0x44ff7d;},'ZvMWz':function(_0xda2a8a){return _0xda2a8a();},'eRics':_0x1f40a2(0x175),'Gqsgz':'false','jBWAn':'Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','NkUrD':function(_0x3be809,_0x7e2503,_0x105426,_0x6f5ed9,_0x2e8ebb){return _0x3be809(_0x7e2503,_0x105426,_0x6f5ed9,_0x2e8ebb);},'qhCnZ':'POST','Nilia':function(_0x46193a,_0x409ab9){return _0x46193a===_0x409ab9;},'umGnr':_0x1f40a2(0x195),'jjQRB':_0x1f40a2(0x1b5)};await PerformanceTester['measureWrapper'](PerformanceEvents[_0x1f40a2(0x17f)],async()=>{const _0x11bc1e=_0x1f40a2,_0x375477=Object[_0x11bc1e(0x1c9)]({},_0x48b8f7['config'],{'root_dir_path':'','framework':_0x48b8f7[_0x11bc1e(0x1aa)]}),_0x1a2bf6=bsSetupHelper[_0x11bc1e(0x1b7)](_0x375477),_0x46c24d=bsSetupHelper[_0x11bc1e(0x1e7)](_0x375477),_0x3d5585=_0x2abb12[_0x11bc1e(0x1c0)](_0x1a2bf6,'')+':'+_0x2abb12[_0x11bc1e(0x1a8)](_0x46c24d,''),_0x31f45b=testhubUtils[_0x11bc1e(0x199)](_0x375477);process[_0x11bc1e(0x190)][_0x11bc1e(0x18f)]=JSON['stringify'](_0x31f45b);if(_0x2abb12[_0x11bc1e(0x16b)](_0x3d5585,':'))return _0x2abb12[_0x11bc1e(0x170)](isTestObservabilitySession)&&(logger[_0x11bc1e(0x181)](_0x2abb12[_0x11bc1e(0x196)]),process[_0x11bc1e(0x190)]['BS_TESTOPS_BUILD_COMPLETED']=_0x2abb12[_0x11bc1e(0x1da)]),testhubUtils[_0x11bc1e(0x1cb)](_0x375477)&&logger[_0x11bc1e(0x181)](_0x2abb12['jBWAn']),[null,null];try{const _0xe5eb4c=await this[_0x11bc1e(0x1db)](_0x375477,_0x429b0e),_0x5df71b=this[_0x11bc1e(0x1c8)](_0x1a2bf6,_0x46c24d),_0x25f732=await _0x2abb12[_0x11bc1e(0x166)](nodeRequest,_0x2abb12['qhCnZ'],testHubConstants[_0x11bc1e(0x1b9)],_0xe5eb4c,_0x5df71b),_0x21b548=this[_0x11bc1e(0x1af)](_0x375477,_0x25f732,_0x5df71b);await this['checkAndSetupPercy'](_0x48b8f7,_0x429b0e);if(_0x2abb12[_0x11bc1e(0x1d3)](testhubUtils[_0x11bc1e(0x164)](_0x48b8f7['config']),null)){const _0x2f9d75=_0x21b548[_0x2abb12['umGnr']];_0x2f9d75&&_0x2f9d75['authToken']&&_0x2f9d75[_0x11bc1e(0x1bb)]&&(_0x48b8f7[_0x11bc1e(0x1d6)][_0x11bc1e(0x195)]=!![],process['env']['BROWSERSTACK_TEST_ACCESSIBILITY_PLATFORM']=_0x2abb12[_0x11bc1e(0x1a6)]);}return _0x21b548;}catch(_0x3d3f9a){if(_0x2abb12[_0x11bc1e(0x1d3)](_0x3d3f9a[_0x11bc1e(0x188)],![])){testhubUtils[_0x11bc1e(0x1a3)](_0x3d3f9a);return;}}})();}static async[a90_0x397166(0x1ce)](){const _0x2f8148=a90_0x397166,_0x190422={'EbVbn':function(_0x3e1927,_0x35e243,_0x1e36f6){return _0x3e1927(_0x35e243,_0x1e36f6);},'UhoKT':function(_0x344cdc,_0x120fee){return _0x344cdc(_0x120fee);},'IXSdY':function(_0x13c3a3){return _0x13c3a3();},'TVWtl':_0x2f8148(0x17e)};if(processedTraceZips)return;const _0x265edf=TestDetails[_0x2f8148(0x1ec)]();_0x265edf[_0x2f8148(0x1d7)](({testUId:_0x4b6b0d,filePath:_0x25e5c7})=>{const _0x24f248=_0x2f8148;var _0x4a7eb9=_0x190422[_0x24f248(0x1d9)](uploadTraceZip,_0x25e5c7,_0x4b6b0d);_0x190422['UhoKT'](addEvent,_0x4a7eb9);});try{await _0x190422[_0x2f8148(0x1a0)](awaitAllEvents),logger['debug'](_0x190422[_0x2f8148(0x1e3)]),processedTraceZips=!![];}catch(_0x1ca186){logger[_0x2f8148(0x1a4)](_0x2f8148(0x1b2)+util[_0x2f8148(0x1dc)](_0x1ca186));}}static async[a90_0x397166(0x16d)](_0x2c44b9,_0x100c32){const _0x18c597=a90_0x397166;if(constants[_0x18c597(0x16e)][_0x18c597(0x1c3)](_0x100c32)){await _0x2c44b9['setupPercy']();return;}_0x2c44b9[_0x18c597(0x1d6)]['percy']&&logger['debug'](_0x18c597(0x169)+_0x100c32+_0x18c597(0x17c));}static[a90_0x397166(0x1d8)](_0x45fc84){const _0x216222=a90_0x397166,_0x155884={};_0x155884[_0x216222(0x1b4)]=_0x45fc84['accessibilityOptions'];const _0x4ab747=_0x155884;return _0x4ab747;}static['getConfig'](_0x29afc4,_0x5017f1){const _0x5a9241=a90_0x397166,_0x405f27={'LHIlB':function(_0x573ce7,_0xfbdd33){return _0x573ce7(_0xfbdd33);}},_0x28abc1={};return _0x28abc1['username']=_0x29afc4,_0x28abc1[_0x5a9241(0x1ad)]=_0x5017f1,{'auth':_0x28abc1,'headers':_0x405f27[_0x5a9241(0x1df)](getDefaultHeaders,![])};}static async[a90_0x397166(0x1db)](_0x24b01b,_0x28dbb4){const _0x4e6635=a90_0x397166,_0x17e32e={'iTfkJ':function(_0x1b79d0,_0x3b0fe3){return _0x1b79d0(_0x3b0fe3);}},_0x225b3c={'project_name':_0x24b01b[_0x4e6635(0x178)]||'','name':_0x24b01b[_0x4e6635(0x19a)]||path[_0x4e6635(0x193)](path['resolve'](process[_0x4e6635(0x16f)]())),'build_identifier':_0x24b01b[_0x4e6635(0x19c)],'description':_0x24b01b['buildDescription']||'','started_at':new Date()[_0x4e6635(0x1ab)](),'tags':_0x17e32e[_0x4e6635(0x191)](getCustomTags,_0x24b01b),'host_info':bsSetupHelper[_0x4e6635(0x1bc)](),'ci_info':bsSetupHelper[_0x4e6635(0x1e2)](),'build_run_identifier':process['env'][_0x4e6635(0x1b6)],'failed_tests_rerun':process[_0x4e6635(0x190)]['BROWSERSTACK_RERUN']||![],'version_control':await bsSetupHelper[_0x4e6635(0x176)](),'accessibility':this[_0x4e6635(0x1d8)](_0x24b01b),'framework_details':testhubUtils[_0x4e6635(0x1c7)](_0x24b01b,_0x28dbb4),'product_map':testhubUtils[_0x4e6635(0x1d2)](_0x24b01b),'browserstackAutomation':bsSetupHelper[_0x4e6635(0x19d)](),'grouping_identifier':process[_0x4e6635(0x190)][_0x4e6635(0x186)]};if(bsSetupHelper[_0x4e6635(0x172)]()[_0x4e6635(0x165)]||bsSetupHelper[_0x4e6635(0x172)]()[_0x4e6635(0x184)]){const _0x4d7c49={};_0x4d7c49[_0x4e6635(0x1ac)]=process[_0x4e6635(0x190)][_0x4e6635(0x1b3)],_0x4d7c49[_0x4e6635(0x17b)]=process['env'][_0x4e6635(0x1ed)],_0x225b3c[_0x4e6635(0x165)]=_0x4d7c49;}return _0x225b3c;}static[a90_0x397166(0x1af)](_0x248aa7,_0x3ff607,_0x292747){const _0x4a52bd=a90_0x397166,_0x5355b2={'BIjpe':function(_0x4d1545){return _0x4d1545();},'MGsjO':function(_0x44f08b,_0x4016a8){return _0x44f08b&&_0x4016a8;},'Bhaza':'true','FUVQh':_0x4a52bd(0x16c),'tySLq':function(_0x44e2db,_0x20ac3f){return _0x44e2db&&_0x20ac3f;}},_0x2c7eab={};if(_0x5355b2[_0x4a52bd(0x18d)](isTestObservabilitySession)){const [_0x61d4f1,_0x66286a,_0x1d5acf]=testhubUtils[_0x4a52bd(0x19f)](_0x3ff607[_0x4a52bd(0x171)],_0x292747[_0x4a52bd(0x1e5)]);if(_0x5355b2['MGsjO'](_0x61d4f1,_0x66286a)){const _0x59057d={};_0x59057d[_0x4a52bd(0x1eb)]=_0x61d4f1,_0x59057d[_0x4a52bd(0x1bb)]=_0x66286a,_0x59057d[_0x4a52bd(0x168)]=_0x1d5acf,_0x2c7eab[testHubConstants['OBSERVABILITY']]=_0x59057d,process[_0x4a52bd(0x190)][_0x4a52bd(0x1a2)]=_0x5355b2[_0x4a52bd(0x1ea)];}else _0x2c7eab[testHubConstants[_0x4a52bd(0x18c)]]={},process[_0x4a52bd(0x190)][_0x4a52bd(0x1a2)]=_0x5355b2[_0x4a52bd(0x1e1)];}else process[_0x4a52bd(0x190)][_0x4a52bd(0x1a2)]=_0x5355b2[_0x4a52bd(0x1e1)];const [_0x54357f,_0xd03ca6]=testhubUtils[_0x4a52bd(0x17d)](_0x3ff607[_0x4a52bd(0x171)]);if(_0x5355b2[_0x4a52bd(0x194)](_0x54357f,_0xd03ca6)){const _0x1582a5={};_0x1582a5['authToken']=_0x54357f,_0x1582a5[_0x4a52bd(0x1bb)]=_0xd03ca6,_0x2c7eab[testHubConstants[_0x4a52bd(0x1ca)]]=_0x1582a5,process[_0x4a52bd(0x190)][_0x4a52bd(0x1c4)]=_0x5355b2[_0x4a52bd(0x1ea)];}else _0x2c7eab[testHubConstants[_0x4a52bd(0x1ca)]]={},process['env'][_0x4a52bd(0x1c4)]=_0x5355b2[_0x4a52bd(0x1e1)];return testhubUtils[_0x4a52bd(0x1d1)](_0x3ff607[_0x4a52bd(0x171)]),logger['info'](_0x4a52bd(0x1be)+process[_0x4a52bd(0x190)]['BROWSERSTACK_TESTHUB_UUID']),_0x2c7eab;}static async[a90_0x397166(0x1b8)](_0x3e4f22){const _0x2d9385=a90_0x397166,_0x4dc8bd={'MlbIM':function(_0x3865af,_0x467f9c){return _0x3865af===_0x467f9c;},'CxWZm':'false','rlrDl':_0x2d9385(0x18a),'pRrUX':_0x2d9385(0x192),'svqnW':_0x2d9385(0x1a4),'IXmXK':'Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','fMNbM':_0x2d9385(0x1a5),'xyORp':_0x2d9385(0x1a9),'XbkPq':function(_0x1ecebd){return _0x1ecebd();},'pFsYh':function(_0x17e32a,_0x343483,_0x55e706,_0x4b993d,_0x360b3c,_0x3ec597){return _0x17e32a(_0x343483,_0x55e706,_0x4b993d,_0x360b3c,_0x3ec597);},'owdIZ':_0x2d9385(0x185),'UcCts':_0x2d9385(0x1cd),'qyxeL':_0x2d9385(0x188)};await this[_0x2d9385(0x1ce)](),await PerformanceTester['measureWrapper'](PerformanceEvents[_0x2d9385(0x1cc)],async()=>{const _0xf5c6eb=_0x2d9385;if(_0x4dc8bd[_0xf5c6eb(0x1d5)](process[_0xf5c6eb(0x190)]['BS_TESTOPS_BUILD_COMPLETED'],_0x4dc8bd[_0xf5c6eb(0x18e)])||TestHubHandler[_0xf5c6eb(0x167)]||bsSetupHelper['isUndefined'](process[_0xf5c6eb(0x190)][testHubConstants['ENV_VAR'][_0xf5c6eb(0x1a7)]]))return;TestHubHandler['buildStopSent']=!![],await RequestQueueHandler['getInstance']()[_0xf5c6eb(0x1e6)](),await SessionHandler[_0xf5c6eb(0x1e9)]();if(_0x4dc8bd[_0xf5c6eb(0x1d5)](process[_0xf5c6eb(0x190)][testHubConstants['ENV_VAR'][_0xf5c6eb(0x1a7)]],_0x4dc8bd[_0xf5c6eb(0x187)])||_0x4dc8bd[_0xf5c6eb(0x1d5)](process[_0xf5c6eb(0x190)][testHubConstants[_0xf5c6eb(0x1d0)]['BROWSERSTACK_TESTHUB_UUID']],_0x4dc8bd[_0xf5c6eb(0x187)])){logger[_0xf5c6eb(0x181)](_0x4dc8bd[_0xf5c6eb(0x182)]);const _0x3b4a51={};return _0x3b4a51['status']=_0x4dc8bd[_0xf5c6eb(0x19e)],_0x3b4a51['message']=_0x4dc8bd['IXmXK'],_0x3b4a51;}const _0x47a8bc={'finished_at':new Date()[_0xf5c6eb(0x1ab)](),'finished_metadata':[]};!!_0x3e4f22&&_0x47a8bc[_0x4dc8bd['fMNbM']][_0xf5c6eb(0x189)]({'reason':_0x4dc8bd[_0xf5c6eb(0x1a1)],'signal':_0x3e4f22,'failure_data':''});const _0x2a5ce4={'headers':_0x4dc8bd['XbkPq'](getDefaultHeaders)};try{const _0x4fc9c2=await _0x4dc8bd['pFsYh'](nodeRequest,_0x4dc8bd['owdIZ'],_0xf5c6eb(0x1c1)+process[_0xf5c6eb(0x190)][testHubConstants[_0xf5c6eb(0x1d0)][_0xf5c6eb(0x1b1)]]+_0xf5c6eb(0x1e4),_0x47a8bc,_0x2a5ce4,![]);if(_0x4fc9c2['data']&&_0x4fc9c2[_0xf5c6eb(0x171)][_0xf5c6eb(0x1a4)]){const _0x4033e3={};_0x4033e3[_0xf5c6eb(0x179)]=_0x4fc9c2[_0xf5c6eb(0x171)][_0xf5c6eb(0x1a4)];throw _0x4033e3;}else{logger[_0xf5c6eb(0x181)](_0x4dc8bd['UcCts']);const _0x33774a={};return _0x33774a[_0xf5c6eb(0x1ba)]=_0x4dc8bd['qyxeL'],_0x33774a[_0xf5c6eb(0x179)]='',_0x33774a;}}catch(_0x489ae1){_0x489ae1['response']?logger[_0xf5c6eb(0x181)]('EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20'+_0x489ae1[_0xf5c6eb(0x180)]['status']+'\x20'+_0x489ae1[_0xf5c6eb(0x180)][_0xf5c6eb(0x1dd)]+'\x20'+JSON['stringify'](_0x489ae1['response'][_0xf5c6eb(0x171)])):logger[_0xf5c6eb(0x181)](_0xf5c6eb(0x177)+(_0x489ae1[_0xf5c6eb(0x179)]||_0x489ae1));const _0x12833a={};return _0x12833a[_0xf5c6eb(0x1ba)]=_0x4dc8bd['svqnW'],_0x12833a[_0xf5c6eb(0x179)]=_0x489ae1['message']||_0x489ae1[_0xf5c6eb(0x180)]?_0x489ae1['response'][_0xf5c6eb(0x1ba)]+':'+_0x489ae1[_0xf5c6eb(0x180)][_0xf5c6eb(0x1dd)]:_0x489ae1,_0x12833a;}})();}}module[a90_0x397166(0x1c2)]=TestHubHandler;function a90_0x30de(){const _0x56e89f=['push','null','add','OBSERVABILITY','BIjpe','CxWZm','BROWSERSTACK_PRODUCT_MAP','env','iTfkJ','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','basename','tySLq','accessibility','eRics','49695yqsOgc','./utils.js','getProductMap','buildName','1237328uUNbwM','buildIdentifier','isBrowserstackInfra','svqnW','setTestObservabilityVariables','IXSdY','xyORp','BROWSERSTACK_TEST_OBSERVABILITY','logBuildError','error','finished_metadata','jjQRB','BROWSERSTACK_TESTHUB_JWT','fnYxc','user_killed','framework','toISOString','job_id','password','10ZIBGja','extractDataFromResponse','2135875JwPvjf','BROWSERSTACK_TESTHUB_UUID','Error\x20while\x20waiting\x20for\x20events:\x20','BROWSERSTACK_CENTRAL_SCANNER_JOBID','settings','true','BROWSERSTACK_BUILD_RUN_IDENTIFIER','getUserName','stop','TESTHUB_BUILD_API','status','buildHashedId','getHostInfo','allSettled','Testhub\x20started\x20with\x20id:\x20','6ZrTOOW','FWxQN','api/v1/builds/','exports','includes','BROWSERSTACK_ACCESSIBILITY','../helper','../logger','getFrameworkDetails','getConfig','assign','ACCESSIBILITY','isAccessibilityEnabled','STOP','stopBuildUpstream\x20event\x20successful!','processTraceZips','../../bin/playwright/reporter/pwUtils.js','ENV_VAR','setTestHubCommonMetaInfo','getProductMapForBuildStartCall','Nilia','8664129jFjicJ','MlbIM','config','forEach','getAccessibilityOptions','EbVbn','Gqsgz','generateBuildUpstreamData','format','statusText','../performance/constants','LHIlB','4447825xhUECi','FUVQh','getCiInfo','TVWtl','/stop','auth','uploadPending','getAccessKey','765316bKugyA','waitForBuildStatus','Bhaza','jwt','getTraceFilePaths','BROWSERSTACK_CENTRAL_SCANNER_JWT','2656432cYiLaK','getAccessibilityValueFromYml','central_scanner','NkUrD','buildStopSent','allowScreenshot','Percy\x20is\x20not\x20supported\x20for\x20','6bMqTSE','ZuzYe','false','checkAndSetupPercy','PERCY_SUPPORTED_FRAMEWORKS','cwd','ZvMWz','data','getCentralUser','../test-observability/requestQueueHandler.js','./constants.js','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','getGitMetaData','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','projectName','message','../performance/performance-tester.js','token','\x20framework','setAccessibilityVariables','All\x20trace\x20zip\x20send\x20events\x20complete','START','response','debug','pRrUX','winstonLogger','lcnc','PUT','BROWSERSTACK_BUILD_GROUPING_IDENTIFIER','rlrDl','success'];a90_0x30de=function(){return _0x56e89f;};return a90_0x30de();}