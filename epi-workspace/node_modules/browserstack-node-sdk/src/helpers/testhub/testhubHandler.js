function a89_0x20a6(){const _0x67fee9=['finished_metadata','BROWSERSTACK_TEST_OBSERVABILITY','12030WzwTlV','debug','job_id','PUT','QGPcU','../test-observability/sessionHandler.js','PwVnF','hbYSj','true','1624HfgACP','error','IkzXI','jwt','TESTHUB_BUILD_API','SFJUP','dZULc','Yihwv','BROWSERSTACK_TESTHUB_JWT','percy','false','BROWSERSTACK_CENTRAL_USER','accessibilityOptions','STOP','GcKDk','username','getAccessKey','waitForBuildStatus','../test-observability/requestQueueHandler.js','/stop','15032OtHKcG','BROWSERSTACK_CENTRAL_SCANNER_JWT','generateBuildUpstreamData','data','sEFQI','jZbqd','checkAndSetupPercy','response','stop','\x20framework','POST','OBSERVABILITY','getFrameworkDetails','resolve','RgYwm','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','33HKuhPI','uploadPending','BROWSERSTACK_TESTHUB_UUID','trFQn','getCiInfo','isUndefined','2793144pyeHMe','isAccessibilityEnabled','AwbKM','success','../logger','../test-observability/utils','OxQzm','allowScreenshot','auth','../helper','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','message','../../bin/utils/constants.js','env','UjamM','central_scanner','getHostInfo','2165OfNpNf','info','assign','Testhub\x20started\x20with\x20id:\x20','password','iXcQQ','stopBuildUpstream\x20event\x20successful!','buildStopSent','config','setTestObservabilityVariables','BS_TESTOPS_BUILD_COMPLETED','hCVGq','./constants.js','320520igwbVE','Percy\x20is\x20not\x20supported\x20for\x20','START','1511668cPRiTv','gJGTP','yplZw','user_killed','settings','measureWrapper','statusText','572404xbZSyN','BROWSERSTACK_BUILD_RUN_IDENTIFIER','token','toISOString','BROWSERSTACK_ACCESSIBILITY','path','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','getProductMap','XRrjV','api/v1/builds/','cwd','null','status','winstonLogger','Xlagd','BROWSERSTACK_CENTRAL_SCANNER_JOBID','buildDescription','getAccessibilityOptions','12BLfCoC','mCFqB','buildName','exports','../performance/constants','projectName','OOZCu','getConfig','ACCESSIBILITY','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','BROWSERSTACK_PRODUCT_MAP','push','5868ZYUvWr','getInstance','2868oIEdkx','buildIdentifier','WJEwG','launchBuild','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','ENV_VAR'];a89_0x20a6=function(){return _0x67fee9;};return a89_0x20a6();}const a89_0x5051f3=a89_0x44bc;(function(_0x58dfa1,_0x318466){const _0x1e23ce=a89_0x44bc,_0x5b109d=_0x58dfa1();while(!![]){try{const _0x202b80=-parseInt(_0x1e23ce(0x246))/0x1+parseInt(_0x1e23ce(0x23f))/0x2+parseInt(_0x1e23ce(0x23c))/0x3*(-parseInt(_0x1e23ce(0x258))/0x4)+parseInt(_0x1e23ce(0x22f))/0x5*(parseInt(_0x1e23ce(0x1e3))/0x6)+parseInt(_0x1e23ce(0x1f4))/0x7*(parseInt(_0x1e23ce(0x208))/0x8)+parseInt(_0x1e23ce(0x1e1))/0x9*(-parseInt(_0x1e23ce(0x1eb))/0xa)+-parseInt(_0x1e23ce(0x218))/0xb*(-parseInt(_0x1e23ce(0x21e))/0xc);if(_0x202b80===_0x318466)break;else _0x5b109d['push'](_0x5b109d['shift']());}catch(_0x32e8ec){_0x5b109d['push'](_0x5b109d['shift']());}}}(a89_0x20a6,0x6679e));const bsSetupHelper=require(a89_0x5051f3(0x227)),path=require(a89_0x5051f3(0x24b)),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require(a89_0x5051f3(0x223)),testhubUtils=require('./utils.js'),testHubConstants=require(a89_0x5051f3(0x23b)),constants=require(a89_0x5051f3(0x22a)),RequestQueueHandler=require(a89_0x5051f3(0x206)),logger=require(a89_0x5051f3(0x222))[a89_0x5051f3(0x253)],SessionHandler=require(a89_0x5051f3(0x1f0)),PerformanceTester=require('../performance/performance-tester.js'),{TESTHUB_EVENTS:PerformanceEvents}=require(a89_0x5051f3(0x25c));class TestHubHandler{static [a89_0x5051f3(0x236)]=![];static async[a89_0x5051f3(0x1e6)](_0xe2bd0,_0x31e55b){const _0x56fa40=a89_0x5051f3,_0x20bbce={'mCFqB':function(_0x494afc,_0x2881ae){return _0x494afc||_0x2881ae;},'Xlagd':function(_0x532b62,_0x5b4d10){return _0x532b62===_0x5b4d10;},'AwbKM':function(_0x32804e){return _0x32804e();},'rDGxD':_0x56fa40(0x217),'AMkmW':_0x56fa40(0x1fe),'jZbqd':_0x56fa40(0x1e7),'SFJUP':function(_0x3838d2,_0x27850c,_0xb313af,_0x16aa91,_0x54cf78){return _0x3838d2(_0x27850c,_0xb313af,_0x16aa91,_0x54cf78);},'WJEwG':_0x56fa40(0x212),'QGPcU':function(_0x4d4ccd,_0x5d85c9){return _0x4d4ccd===_0x5d85c9;}};await PerformanceTester[_0x56fa40(0x244)](PerformanceEvents[_0x56fa40(0x23e)],async()=>{const _0x26d2b6=_0x56fa40,_0x25702c=Object[_0x26d2b6(0x231)]({},_0x31e55b[_0x26d2b6(0x237)],{'root_dir_path':'','framework':_0x31e55b['framework']}),_0x194957=bsSetupHelper['getUserName'](_0x25702c),_0x4914cb=bsSetupHelper[_0x26d2b6(0x204)](_0x25702c),_0xe9e20e=_0x20bbce['mCFqB'](_0x194957,'')+':'+_0x20bbce[_0x26d2b6(0x259)](_0x4914cb,''),_0x331173=testhubUtils[_0x26d2b6(0x24d)](_0x25702c);process['env'][_0x26d2b6(0x1df)]=JSON['stringify'](_0x331173);if(_0x20bbce[_0x26d2b6(0x254)](_0xe9e20e,':'))return _0x20bbce[_0x26d2b6(0x220)](isTestObservabilitySession)&&(logger[_0x26d2b6(0x1ec)](_0x20bbce['rDGxD']),process['env'][_0x26d2b6(0x239)]=_0x20bbce['AMkmW']),testhubUtils[_0x26d2b6(0x21f)](_0x25702c)&&logger[_0x26d2b6(0x1ec)](_0x20bbce[_0x26d2b6(0x20d)]),[null,null];try{const _0x5b00fd=await this[_0x26d2b6(0x20a)](_0x25702c,_0xe2bd0),_0x1e8a6b=this[_0x26d2b6(0x1dc)](_0x194957,_0x4914cb),_0x2d3761=await _0x20bbce[_0x26d2b6(0x1f9)](nodeRequest,_0x20bbce[_0x26d2b6(0x1e5)],testHubConstants[_0x26d2b6(0x1f8)],_0x5b00fd,_0x1e8a6b);await this[_0x26d2b6(0x20e)](_0x31e55b,_0xe2bd0);const _0x4826f0=this['extractDataFromResponse'](_0x25702c,_0x2d3761,_0x1e8a6b);return _0x4826f0;}catch(_0x984fda){if(_0x20bbce[_0x26d2b6(0x1ef)](_0x984fda[_0x26d2b6(0x221)],![])){testhubUtils['logBuildError'](_0x984fda);return;}}})();}static async[a89_0x5051f3(0x20e)](_0xe603f7,_0x2e76d1){const _0x1c5446=a89_0x5051f3;if(constants['PERCY_SUPPORTED_FRAMEWORKS']['includes'](_0x2e76d1)){await _0xe603f7['setupPercy']();return;}_0xe603f7[_0x1c5446(0x237)][_0x1c5446(0x1fd)]&&logger[_0x1c5446(0x1ec)](_0x1c5446(0x23d)+_0x2e76d1+_0x1c5446(0x211));}static[a89_0x5051f3(0x257)](_0x1ce6be){const _0x559f29=a89_0x5051f3,_0x34c3f0={};_0x34c3f0[_0x559f29(0x243)]=_0x1ce6be[_0x559f29(0x200)];const _0xfc0253=_0x34c3f0;return _0xfc0253;}static[a89_0x5051f3(0x1dc)](_0x5aebac,_0x5792ea){const _0xace63f=a89_0x5051f3,_0x4fac44={'fQurE':function(_0x580b20,_0x22c078){return _0x580b20(_0x22c078);}},_0x581f1f={};return _0x581f1f[_0xace63f(0x203)]=_0x5aebac,_0x581f1f[_0xace63f(0x233)]=_0x5792ea,{'auth':_0x581f1f,'headers':_0x4fac44['fQurE'](getDefaultHeaders,![])};}static async['generateBuildUpstreamData'](_0x8dd910,_0x589adc){const _0x3e74cc=a89_0x5051f3,_0x5d160e={'hCVGq':function(_0x1f5b9d,_0x4c0710){return _0x1f5b9d(_0x4c0710);}},_0x5b7e0d={'project_name':_0x8dd910[_0x3e74cc(0x1da)]||'','name':_0x8dd910[_0x3e74cc(0x25a)]||path['basename'](path[_0x3e74cc(0x215)](process[_0x3e74cc(0x250)]())),'build_identifier':_0x8dd910[_0x3e74cc(0x1e4)],'description':_0x8dd910[_0x3e74cc(0x256)]||'','started_at':new Date()['toISOString'](),'tags':_0x5d160e[_0x3e74cc(0x23a)](getCustomTags,_0x8dd910),'host_info':bsSetupHelper[_0x3e74cc(0x22e)](),'ci_info':bsSetupHelper[_0x3e74cc(0x21c)](),'build_run_identifier':process[_0x3e74cc(0x22b)][_0x3e74cc(0x247)],'failed_tests_rerun':process[_0x3e74cc(0x22b)]['BROWSERSTACK_RERUN']||![],'version_control':await bsSetupHelper['getGitMetaData'](),'accessibility':this['getAccessibilityOptions'](_0x8dd910),'framework_details':testhubUtils[_0x3e74cc(0x214)](_0x8dd910,_0x589adc),'product_map':testhubUtils['getProductMap'](_0x8dd910),'browserstackAutomation':bsSetupHelper['isBrowserstackInfra']()};if(process[_0x3e74cc(0x22b)][_0x3e74cc(0x1ff)]){const _0x2cae61={};_0x2cae61[_0x3e74cc(0x1ed)]=process['env'][_0x3e74cc(0x255)],_0x2cae61[_0x3e74cc(0x248)]=process['env'][_0x3e74cc(0x209)],_0x5b7e0d[_0x3e74cc(0x22d)]=_0x2cae61;}return _0x5b7e0d;}static['extractDataFromResponse'](_0xb11231,_0x10100d,_0x40688a){const _0x3165a6=a89_0x5051f3,_0x1c7937={'UjamM':function(_0x314af5){return _0x314af5();},'sEFQI':function(_0x28eb96,_0xfb1ec3){return _0x28eb96&&_0xfb1ec3;},'idwHx':_0x3165a6(0x1f3),'Yihwv':_0x3165a6(0x1fe),'XRrjV':function(_0x30d6c4,_0xf7f3e4){return _0x30d6c4&&_0xf7f3e4;}},_0x4625e7={};if(_0x1c7937[_0x3165a6(0x22c)](isTestObservabilitySession)){const [_0x31a8a5,_0xb8e365,_0x49ab5a]=testhubUtils[_0x3165a6(0x238)](_0x10100d[_0x3165a6(0x20b)],_0x40688a[_0x3165a6(0x226)]);if(_0x1c7937[_0x3165a6(0x20c)](_0x31a8a5,_0xb8e365)){const _0x2af965={};_0x2af965[_0x3165a6(0x1f7)]=_0x31a8a5,_0x2af965['buildHashedId']=_0xb8e365,_0x2af965[_0x3165a6(0x225)]=_0x49ab5a,_0x4625e7[testHubConstants[_0x3165a6(0x213)]]=_0x2af965,process[_0x3165a6(0x22b)][_0x3165a6(0x1ea)]=_0x1c7937['idwHx'];}else _0x4625e7[testHubConstants['OBSERVABILITY']]={},process[_0x3165a6(0x22b)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x1c7937['Yihwv'];}else process[_0x3165a6(0x22b)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x1c7937['Yihwv'];if(testhubUtils[_0x3165a6(0x21f)](_0xb11231)){const [_0x386ba5,_0x266afc]=testhubUtils['setAccessibilityVariables'](_0x10100d['data']);if(_0x1c7937[_0x3165a6(0x24e)](_0x386ba5,_0x266afc)){const _0x484d58={};_0x484d58['authToken']=_0x386ba5,_0x484d58['buildHashedId']=_0x266afc,_0x4625e7[testHubConstants['ACCESSIBILITY']]=_0x484d58,process[_0x3165a6(0x22b)][_0x3165a6(0x24a)]=_0x1c7937['idwHx'];}else _0x4625e7[testHubConstants[_0x3165a6(0x1dd)]]={},process[_0x3165a6(0x22b)][_0x3165a6(0x24a)]=_0x1c7937[_0x3165a6(0x1fb)];}else process[_0x3165a6(0x22b)][_0x3165a6(0x24a)]=_0x1c7937[_0x3165a6(0x1fb)];return testhubUtils['setTestHubCommonMetaInfo'](_0x10100d[_0x3165a6(0x20b)]),logger[_0x3165a6(0x230)](_0x3165a6(0x232)+process['env'][_0x3165a6(0x21a)]),_0x4625e7;}static async[a89_0x5051f3(0x210)](_0x23ba46){const _0x510c33=a89_0x5051f3,_0x3f2935={'iXcQQ':function(_0x1fb8f6,_0x5dc893){return _0x1fb8f6===_0x5dc893;},'PwVnF':_0x510c33(0x1fe),'gJGTP':function(_0x54b703,_0x5dfb39){return _0x54b703===_0x5dfb39;},'yplZw':_0x510c33(0x251),'lNcfO':function(_0x8ad792,_0x40a8b3){return _0x8ad792===_0x40a8b3;},'hbYSj':_0x510c33(0x24c),'dZULc':_0x510c33(0x1f5),'dAoJi':_0x510c33(0x1de),'RgYwm':_0x510c33(0x1e9),'IkzXI':_0x510c33(0x242),'OOZCu':function(_0x2ca3d8){return _0x2ca3d8();},'MSQzm':function(_0x3735c7,_0x3a7f28,_0x4fc6ff,_0x267452,_0x2f7294,_0x72e44){return _0x3735c7(_0x3a7f28,_0x4fc6ff,_0x267452,_0x2f7294,_0x72e44);},'trFQn':_0x510c33(0x1ee),'GcKDk':_0x510c33(0x235),'OxQzm':_0x510c33(0x221)};await PerformanceTester['measureWrapper'](PerformanceEvents[_0x510c33(0x201)],async()=>{const _0x19f7a8=_0x510c33;if(_0x3f2935[_0x19f7a8(0x234)](process[_0x19f7a8(0x22b)][_0x19f7a8(0x239)],_0x3f2935[_0x19f7a8(0x1f1)])||TestHubHandler[_0x19f7a8(0x236)]||bsSetupHelper[_0x19f7a8(0x21d)](process[_0x19f7a8(0x22b)][testHubConstants[_0x19f7a8(0x1e8)][_0x19f7a8(0x1fc)]]))return;TestHubHandler[_0x19f7a8(0x236)]=!![],await RequestQueueHandler[_0x19f7a8(0x1e2)]()[_0x19f7a8(0x219)](),await SessionHandler[_0x19f7a8(0x205)]();if(_0x3f2935[_0x19f7a8(0x240)](process[_0x19f7a8(0x22b)][testHubConstants[_0x19f7a8(0x1e8)]['BROWSERSTACK_TESTHUB_JWT']],_0x3f2935[_0x19f7a8(0x241)])||_0x3f2935['lNcfO'](process[_0x19f7a8(0x22b)][testHubConstants[_0x19f7a8(0x1e8)][_0x19f7a8(0x21a)]],_0x3f2935[_0x19f7a8(0x241)])){logger['debug'](_0x3f2935[_0x19f7a8(0x1f2)]);const _0x40de65={};return _0x40de65[_0x19f7a8(0x252)]=_0x3f2935[_0x19f7a8(0x1fa)],_0x40de65[_0x19f7a8(0x229)]=_0x3f2935['dAoJi'],_0x40de65;}const _0x514803={'finished_at':new Date()[_0x19f7a8(0x249)](),'finished_metadata':[]};!!_0x23ba46&&_0x514803[_0x3f2935[_0x19f7a8(0x216)]][_0x19f7a8(0x1e0)]({'reason':_0x3f2935[_0x19f7a8(0x1f6)],'signal':_0x23ba46,'failure_data':''});const _0x2788d0={'headers':_0x3f2935[_0x19f7a8(0x1db)](getDefaultHeaders)};try{const _0x121851=await _0x3f2935['MSQzm'](nodeRequest,_0x3f2935[_0x19f7a8(0x21b)],_0x19f7a8(0x24f)+process[_0x19f7a8(0x22b)][testHubConstants[_0x19f7a8(0x1e8)][_0x19f7a8(0x21a)]]+_0x19f7a8(0x207),_0x514803,_0x2788d0,![]);if(_0x121851[_0x19f7a8(0x20b)]&&_0x121851[_0x19f7a8(0x20b)][_0x19f7a8(0x1f5)]){const _0x3e1f6d={};_0x3e1f6d[_0x19f7a8(0x229)]=_0x121851[_0x19f7a8(0x20b)][_0x19f7a8(0x1f5)];throw _0x3e1f6d;}else{logger['debug'](_0x3f2935[_0x19f7a8(0x202)]);const _0x4d5974={};return _0x4d5974[_0x19f7a8(0x252)]=_0x3f2935[_0x19f7a8(0x224)],_0x4d5974[_0x19f7a8(0x229)]='',_0x4d5974;}}catch(_0x4ca8d4){_0x4ca8d4[_0x19f7a8(0x20f)]?logger[_0x19f7a8(0x1ec)](_0x19f7a8(0x228)+_0x4ca8d4[_0x19f7a8(0x20f)][_0x19f7a8(0x252)]+'\x20'+_0x4ca8d4['response'][_0x19f7a8(0x245)]+'\x20'+JSON['stringify'](_0x4ca8d4[_0x19f7a8(0x20f)][_0x19f7a8(0x20b)])):logger[_0x19f7a8(0x1ec)](_0x19f7a8(0x228)+(_0x4ca8d4[_0x19f7a8(0x229)]||_0x4ca8d4));const _0x2fa877={};return _0x2fa877[_0x19f7a8(0x252)]=_0x3f2935[_0x19f7a8(0x1fa)],_0x2fa877[_0x19f7a8(0x229)]=_0x4ca8d4[_0x19f7a8(0x229)]||_0x4ca8d4[_0x19f7a8(0x20f)]?_0x4ca8d4[_0x19f7a8(0x20f)][_0x19f7a8(0x252)]+':'+_0x4ca8d4[_0x19f7a8(0x20f)]['statusText']:_0x4ca8d4,_0x2fa877;}})();}}function a89_0x44bc(_0x43ebb9,_0x55d969){const _0x20a673=a89_0x20a6();return a89_0x44bc=function(_0x44bc0d,_0x19151d){_0x44bc0d=_0x44bc0d-0x1da;let _0x3cc054=_0x20a673[_0x44bc0d];return _0x3cc054;},a89_0x44bc(_0x43ebb9,_0x55d969);}module[a89_0x5051f3(0x25b)]=TestHubHandler;