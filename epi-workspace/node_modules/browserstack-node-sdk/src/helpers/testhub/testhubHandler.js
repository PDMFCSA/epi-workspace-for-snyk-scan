const a90_0x252d48=a90_0x48b5;function a90_0xd757(){const _0xe4629d=['597699xwhKuu','push','api/v1/builds/','getConfig','1086099sNNgIN','isBrowserstackInfra','OBSERVABILITY','YYXES','Testhub\x20started\x20with\x20id:\x20','getCentralUser','null','generateBuildUpstreamData','xIgtC','getHostInfo','JawOF','logBuildError','buildHashedId','resolve','format','BROWSERSTACK_TESTHUB_UUID','message','osPcx','setupPercy','uploadPending','./constants.js','BROWSERSTACK_PRODUCT_MAP','HISyC','true','false','pMVuN','../test-observability/utils','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','waitForBuildStatus','/stop','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','uErsY','../helper','BROWSERSTACK_BUILD_RUN_IDENTIFIER','ZlOgV','83904bHjKZJ','\x20framework','kXaVm','GwOuY','checkAndSetupPercy','../performance/constants','exJff','5400540kHMdWC','config','buildStopSent','hzBnu','getGitMetaData','cbXKs','KApvA','launchBuild','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','framework','../test-observability/requestQueueHandler.js','../logger','cwd','debug','6035008GyBSwx','setAccessibilityVariables','job_id','settings','authToken','projectName','data','VWCZY','stringify','BROWSERSTACK_BUILD_GROUPING_IDENTIFIER','PUT','winstonLogger','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','BROWSERSTACK_ACCESSIBILITY','BS_TESTOPS_BUILD_COMPLETED','cLdxZ','Jnqyg','path','add','allowScreenshot','getInstance','All\x20trace\x20zip\x20send\x20events\x20complete','BROWSERSTACK_TEST_OBSERVABILITY','getProductMap','BROWSERSTACK_CENTRAL_SCANNER_JOBID','toISOString','stopBuildUpstream\x20event\x20successful!','central_scanner','QXmPh','info','getUserName','success','percy','STOP','HJJQt','exports','eqgJp','allSettled','LwhJa','bwTkW','../../bin/playwright/reporter/test-details.js','statusText','error','finished_metadata','assign','env','LNDhQ','getTraceFilePaths','5472612UwsXmA','getAccessKey','setTestObservabilityVariables','ACCESSIBILITY','isAccessibilityEnabled','2794492lqFOpG','status','TspAg','buildDescription','extractDataFromResponse','../performance/performance-tester.js','POST','username','util','yLsHX','password','includes','buildName','measureWrapper','ENV_VAR','START','OqiXK','basename','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','getCiInfo','getAccessibilityOptions','stop','BROWSERSTACK_TESTHUB_JWT','response','../test-observability/sessionHandler.js','auth','BtoeB'];a90_0xd757=function(){return _0xe4629d;};return a90_0xd757();}(function(_0xb0a5ae,_0x3ea762){const _0xefca81=a90_0x48b5,_0x596b16=_0xb0a5ae();while(!![]){try{const _0x54fb80=parseInt(_0xefca81(0x8a))/0x1+parseInt(_0xefca81(0xb1))/0x2+-parseInt(_0xefca81(0x8e))/0x3+-parseInt(_0xefca81(0xfb))/0x4+parseInt(_0xefca81(0xb8))/0x5+-parseInt(_0xefca81(0xf6))/0x6+parseInt(_0xefca81(0xc6))/0x7;if(_0x54fb80===_0x3ea762)break;else _0x596b16['push'](_0x596b16['shift']());}catch(_0x2e19c8){_0x596b16['push'](_0x596b16['shift']());}}}(a90_0xd757,0x94b79));const bsSetupHelper=require(a90_0x252d48(0xae)),path=require(a90_0x252d48(0xd7)),util=require(a90_0x252d48(0x77)),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require(a90_0x252d48(0xa8)),testhubUtils=require('./utils.js'),testHubConstants=require(a90_0x252d48(0xa2)),constants=require('../../bin/utils/constants.js'),RequestQueueHandler=require(a90_0x252d48(0xc2)),logger=require(a90_0x252d48(0xc3))[a90_0x252d48(0xd1)],SessionHandler=require(a90_0x252d48(0x87)),PerformanceTester=require(a90_0x252d48(0x100)),{TESTHUB_EVENTS:PerformanceEvents}=require(a90_0x252d48(0xb6)),TestDetails=require(a90_0x252d48(0xee)),{uploadTraceZip}=require('../../bin/playwright/reporter/pwUtils.js'),OngoingEvents=new Set();let processedTraceZips=![];function a90_0x48b5(_0x3fd3d4,_0x524f5e){const _0xd75779=a90_0xd757();return a90_0x48b5=function(_0x48b590,_0x3029ae){_0x48b590=_0x48b590-0x75;let _0x132409=_0xd75779[_0x48b590];return _0x132409;},a90_0x48b5(_0x3fd3d4,_0x524f5e);}const addEvent=_0xb5b1b1=>{const _0x10eec5=a90_0x252d48;OngoingEvents[_0x10eec5(0xd8)](_0xb5b1b1);},awaitAllEvents=async()=>{const _0x2122a9=a90_0x252d48;return Promise[_0x2122a9(0xeb)](OngoingEvents);};class TestHubHandler{static [a90_0x252d48(0xba)]=![];static async[a90_0x252d48(0xbf)](_0x5bca16,_0x5da86c){const _0x235c1d=a90_0x252d48,_0x5bb1fb={'HISyC':function(_0x37ea7d,_0x24b3a5){return _0x37ea7d||_0x24b3a5;},'LwhJa':function(_0x4ba4c6,_0x579a94){return _0x4ba4c6===_0x579a94;},'QXmPh':function(_0x28b9eb){return _0x28b9eb();},'cLdxZ':_0x235c1d(0xd2),'Dublf':_0x235c1d(0xa6),'hzBnu':_0x235c1d(0xac),'pMVuN':function(_0x4fdcee,_0x677dd0,_0x453b62,_0x4b17e5,_0x19b318){return _0x4fdcee(_0x677dd0,_0x453b62,_0x4b17e5,_0x19b318);},'YYXES':_0x235c1d(0x75),'HJJQt':function(_0x57058a,_0x559577){return _0x57058a===_0x559577;}};await PerformanceTester[_0x235c1d(0x7c)](PerformanceEvents[_0x235c1d(0x7e)],async()=>{const _0x270db3=_0x235c1d,_0x46b59a=Object[_0x270db3(0xf2)]({},_0x5da86c[_0x270db3(0xb9)],{'root_dir_path':'','framework':_0x5da86c[_0x270db3(0xc1)]}),_0x57726e=bsSetupHelper[_0x270db3(0xe4)](_0x46b59a),_0x5aed69=bsSetupHelper[_0x270db3(0xf7)](_0x46b59a),_0x3af7d6=_0x5bb1fb[_0x270db3(0xa4)](_0x57726e,'')+':'+_0x5bb1fb['HISyC'](_0x5aed69,''),_0x40cf3b=testhubUtils[_0x270db3(0xdd)](_0x46b59a);process[_0x270db3(0xf3)][_0x270db3(0xa3)]=JSON['stringify'](_0x40cf3b);if(_0x5bb1fb[_0x270db3(0xec)](_0x3af7d6,':'))return _0x5bb1fb[_0x270db3(0xe2)](isTestObservabilitySession)&&(logger[_0x270db3(0xc5)](_0x5bb1fb[_0x270db3(0xd5)]),process[_0x270db3(0xf3)][_0x270db3(0xd4)]=_0x5bb1fb['Dublf']),testhubUtils[_0x270db3(0xfa)](_0x46b59a)&&logger[_0x270db3(0xc5)](_0x5bb1fb[_0x270db3(0xbb)]),[null,null];try{const _0x5d8879=await this[_0x270db3(0x95)](_0x46b59a,_0x5bca16),_0x450706=this[_0x270db3(0x8d)](_0x57726e,_0x5aed69),_0x10dc7c=await _0x5bb1fb[_0x270db3(0xa7)](nodeRequest,_0x5bb1fb[_0x270db3(0x91)],testHubConstants['TESTHUB_BUILD_API'],_0x5d8879,_0x450706),_0xd31320=this[_0x270db3(0xff)](_0x46b59a,_0x10dc7c,_0x450706);return await this[_0x270db3(0xb5)](_0x5da86c,_0x5bca16),_0xd31320;}catch(_0x23d74b){if(_0x5bb1fb[_0x270db3(0xe8)](_0x23d74b[_0x270db3(0xe5)],![])){testhubUtils[_0x270db3(0x99)](_0x23d74b);return;}}})();}static async['processTraceZips'](){const _0x211dba=a90_0x252d48,_0x37d983={'exJff':function(_0x83acb6,_0x28705c,_0x1ac962){return _0x83acb6(_0x28705c,_0x1ac962);},'yLsHX':function(_0x44be9a,_0x31c634){return _0x44be9a(_0x31c634);},'nRXuB':function(_0x4c67f4){return _0x4c67f4();},'osPcx':_0x211dba(0xdb)};if(processedTraceZips)return;const _0x4c1c19=TestDetails[_0x211dba(0xf5)]();_0x4c1c19['forEach'](({testUId:_0x1cc95a,filePath:_0x1a98b2})=>{const _0x548683=_0x211dba;var _0x2d8adf=_0x37d983[_0x548683(0xb7)](uploadTraceZip,_0x1a98b2,_0x1cc95a);_0x37d983[_0x548683(0x78)](addEvent,_0x2d8adf);});try{await _0x37d983['nRXuB'](awaitAllEvents),logger[_0x211dba(0xc5)](_0x37d983[_0x211dba(0x9f)]),processedTraceZips=!![];}catch(_0x4a1366){logger[_0x211dba(0xf0)]('Error\x20while\x20waiting\x20for\x20events:\x20'+util[_0x211dba(0x9c)](_0x4a1366));}}static async[a90_0x252d48(0xb5)](_0x46bbef,_0x3888b8){const _0x23244b=a90_0x252d48;if(constants['PERCY_SUPPORTED_FRAMEWORKS'][_0x23244b(0x7a)](_0x3888b8)){await _0x46bbef[_0x23244b(0xa0)]();return;}_0x46bbef[_0x23244b(0xb9)][_0x23244b(0xe6)]&&logger[_0x23244b(0xc5)]('Percy\x20is\x20not\x20supported\x20for\x20'+_0x3888b8+_0x23244b(0xb2));}static[a90_0x252d48(0x83)](_0x191a44){const _0x2effe2=a90_0x252d48,_0x541cb7={};_0x541cb7[_0x2effe2(0xc9)]=_0x191a44['accessibilityOptions'];const _0x23e825=_0x541cb7;return _0x23e825;}static[a90_0x252d48(0x8d)](_0x58b155,_0x50253a){const _0x5c6fa3=a90_0x252d48,_0x31f820={'Xzvhu':function(_0x576041,_0x59fe35){return _0x576041(_0x59fe35);}},_0x4febb6={};return _0x4febb6[_0x5c6fa3(0x76)]=_0x58b155,_0x4febb6[_0x5c6fa3(0x79)]=_0x50253a,{'auth':_0x4febb6,'headers':_0x31f820['Xzvhu'](getDefaultHeaders,![])};}static async[a90_0x252d48(0x95)](_0x3d4a1b,_0x299c5c){const _0x17c321=a90_0x252d48,_0x552978={'uErsY':function(_0x44a847,_0x31db71){return _0x44a847(_0x31db71);}},_0x4a3f17={'project_name':_0x3d4a1b[_0x17c321(0xcb)]||'','name':_0x3d4a1b[_0x17c321(0x7b)]||path[_0x17c321(0x80)](path[_0x17c321(0x9b)](process[_0x17c321(0xc4)]())),'build_identifier':_0x3d4a1b['buildIdentifier'],'description':_0x3d4a1b[_0x17c321(0xfe)]||'','started_at':new Date()[_0x17c321(0xdf)](),'tags':_0x552978[_0x17c321(0xad)](getCustomTags,_0x3d4a1b),'host_info':bsSetupHelper[_0x17c321(0x97)](),'ci_info':bsSetupHelper[_0x17c321(0x82)](),'build_run_identifier':process[_0x17c321(0xf3)][_0x17c321(0xaf)],'failed_tests_rerun':process[_0x17c321(0xf3)]['BROWSERSTACK_RERUN']||![],'version_control':await bsSetupHelper[_0x17c321(0xbc)](),'accessibility':this[_0x17c321(0x83)](_0x3d4a1b),'framework_details':testhubUtils['getFrameworkDetails'](_0x3d4a1b,_0x299c5c),'product_map':testhubUtils[_0x17c321(0xdd)](_0x3d4a1b),'browserstackAutomation':bsSetupHelper[_0x17c321(0x8f)](),'grouping_identifier':process[_0x17c321(0xf3)][_0x17c321(0xcf)]};if(bsSetupHelper[_0x17c321(0x93)]()[_0x17c321(0xe1)]||bsSetupHelper[_0x17c321(0x93)]()['lcnc']){const _0x21bf64={};_0x21bf64[_0x17c321(0xc8)]=process[_0x17c321(0xf3)][_0x17c321(0xde)],_0x21bf64['token']=process[_0x17c321(0xf3)]['BROWSERSTACK_CENTRAL_SCANNER_JWT'],_0x4a3f17['central_scanner']=_0x21bf64;}return _0x4a3f17;}static[a90_0x252d48(0xff)](_0x3e2636,_0x3a2253,_0x579461){const _0x382cb0=a90_0x252d48,_0x496b6d={'aJcqS':function(_0xb2f2d){return _0xb2f2d();},'BtoeB':function(_0x548db6,_0x2d67b0){return _0x548db6&&_0x2d67b0;},'JawOF':_0x382cb0(0xa5),'OqiXK':_0x382cb0(0xa6),'kXaVm':function(_0x5911cb,_0x50eba4){return _0x5911cb&&_0x50eba4;}},_0x71caf3={};if(_0x496b6d['aJcqS'](isTestObservabilitySession)){const [_0x57b163,_0x47764a,_0x2396d7]=testhubUtils[_0x382cb0(0xf8)](_0x3a2253[_0x382cb0(0xcc)],_0x579461[_0x382cb0(0x88)]);if(_0x496b6d[_0x382cb0(0x89)](_0x57b163,_0x47764a)){const _0x5852f0={};_0x5852f0['jwt']=_0x57b163,_0x5852f0[_0x382cb0(0x9a)]=_0x47764a,_0x5852f0[_0x382cb0(0xd9)]=_0x2396d7,_0x71caf3[testHubConstants[_0x382cb0(0x90)]]=_0x5852f0,process[_0x382cb0(0xf3)][_0x382cb0(0xdc)]=_0x496b6d[_0x382cb0(0x98)];}else _0x71caf3[testHubConstants[_0x382cb0(0x90)]]={},process[_0x382cb0(0xf3)][_0x382cb0(0xdc)]=_0x496b6d[_0x382cb0(0x7f)];}else process[_0x382cb0(0xf3)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x496b6d[_0x382cb0(0x7f)];if(testhubUtils[_0x382cb0(0xfa)](_0x3e2636)){const [_0x57899e,_0x12a26b]=testhubUtils[_0x382cb0(0xc7)](_0x3a2253[_0x382cb0(0xcc)]);if(_0x496b6d[_0x382cb0(0xb3)](_0x57899e,_0x12a26b)){const _0x366c40={};_0x366c40[_0x382cb0(0xca)]=_0x57899e,_0x366c40[_0x382cb0(0x9a)]=_0x12a26b,_0x71caf3[testHubConstants[_0x382cb0(0xf9)]]=_0x366c40,process[_0x382cb0(0xf3)][_0x382cb0(0xd3)]=_0x496b6d[_0x382cb0(0x98)];}else _0x71caf3[testHubConstants[_0x382cb0(0xf9)]]={},process[_0x382cb0(0xf3)][_0x382cb0(0xd3)]=_0x496b6d[_0x382cb0(0x7f)];}else process[_0x382cb0(0xf3)]['BROWSERSTACK_ACCESSIBILITY']=_0x496b6d[_0x382cb0(0x7f)];return testhubUtils['setTestHubCommonMetaInfo'](_0x3a2253[_0x382cb0(0xcc)]),logger[_0x382cb0(0xe3)](_0x382cb0(0x92)+process[_0x382cb0(0xf3)]['BROWSERSTACK_TESTHUB_UUID']),_0x71caf3;}static async[a90_0x252d48(0x84)](_0x32e132){const _0x560871=a90_0x252d48,_0x2a567d={'Jnqyg':function(_0x38f9b7,_0x55a57e){return _0x38f9b7===_0x55a57e;},'oISgH':_0x560871(0xa6),'GwOuY':function(_0x10e0ab,_0x46c58d){return _0x10e0ab===_0x46c58d;},'oKfnu':_0x560871(0x94),'SjtQW':_0x560871(0xa9),'VWCZY':_0x560871(0xf0),'xIgtC':_0x560871(0x81),'ZlOgV':_0x560871(0xf1),'LNDhQ':'user_killed','bwTkW':function(_0x467b69){return _0x467b69();},'TspAg':function(_0x499b4f,_0xafdc0d,_0x322d2a,_0x1c1ced,_0x1a50ec,_0x18a112){return _0x499b4f(_0xafdc0d,_0x322d2a,_0x1c1ced,_0x1a50ec,_0x18a112);},'KApvA':_0x560871(0xd0),'cbXKs':_0x560871(0xe0),'eqgJp':_0x560871(0xe5)};await this['processTraceZips'](),await PerformanceTester[_0x560871(0x7c)](PerformanceEvents[_0x560871(0xe7)],async()=>{const _0x4ec1f7=_0x560871;if(_0x2a567d[_0x4ec1f7(0xd6)](process['env'][_0x4ec1f7(0xd4)],_0x2a567d['oISgH'])||TestHubHandler[_0x4ec1f7(0xba)]||bsSetupHelper['isUndefined'](process[_0x4ec1f7(0xf3)][testHubConstants[_0x4ec1f7(0x7d)][_0x4ec1f7(0x85)]]))return;TestHubHandler[_0x4ec1f7(0xba)]=!![],await RequestQueueHandler[_0x4ec1f7(0xda)]()[_0x4ec1f7(0xa1)](),await SessionHandler[_0x4ec1f7(0xaa)]();if(_0x2a567d[_0x4ec1f7(0xb4)](process[_0x4ec1f7(0xf3)][testHubConstants[_0x4ec1f7(0x7d)][_0x4ec1f7(0x85)]],_0x2a567d['oKfnu'])||_0x2a567d[_0x4ec1f7(0xb4)](process[_0x4ec1f7(0xf3)][testHubConstants['ENV_VAR'][_0x4ec1f7(0x9d)]],_0x2a567d['oKfnu'])){logger[_0x4ec1f7(0xc5)](_0x2a567d['SjtQW']);const _0x1f325b={};return _0x1f325b[_0x4ec1f7(0xfc)]=_0x2a567d[_0x4ec1f7(0xcd)],_0x1f325b[_0x4ec1f7(0x9e)]=_0x2a567d[_0x4ec1f7(0x96)],_0x1f325b;}const _0x7d433e={'finished_at':new Date()[_0x4ec1f7(0xdf)](),'finished_metadata':[]};!!_0x32e132&&_0x7d433e[_0x2a567d[_0x4ec1f7(0xb0)]][_0x4ec1f7(0x8b)]({'reason':_0x2a567d[_0x4ec1f7(0xf4)],'signal':_0x32e132,'failure_data':''});const _0x380968={'headers':_0x2a567d[_0x4ec1f7(0xed)](getDefaultHeaders)};try{const _0x251032=await _0x2a567d[_0x4ec1f7(0xfd)](nodeRequest,_0x2a567d[_0x4ec1f7(0xbe)],_0x4ec1f7(0x8c)+process['env'][testHubConstants[_0x4ec1f7(0x7d)]['BROWSERSTACK_TESTHUB_UUID']]+_0x4ec1f7(0xab),_0x7d433e,_0x380968,![]);if(_0x251032[_0x4ec1f7(0xcc)]&&_0x251032[_0x4ec1f7(0xcc)][_0x4ec1f7(0xf0)]){const _0x1c7c04={};_0x1c7c04[_0x4ec1f7(0x9e)]=_0x251032[_0x4ec1f7(0xcc)][_0x4ec1f7(0xf0)];throw _0x1c7c04;}else{logger[_0x4ec1f7(0xc5)](_0x2a567d[_0x4ec1f7(0xbd)]);const _0xe0db1e={};return _0xe0db1e[_0x4ec1f7(0xfc)]=_0x2a567d[_0x4ec1f7(0xea)],_0xe0db1e['message']='',_0xe0db1e;}}catch(_0x1c473f){_0x1c473f['response']?logger['debug'](_0x4ec1f7(0xc0)+_0x1c473f['response'][_0x4ec1f7(0xfc)]+'\x20'+_0x1c473f[_0x4ec1f7(0x86)]['statusText']+'\x20'+JSON[_0x4ec1f7(0xce)](_0x1c473f[_0x4ec1f7(0x86)][_0x4ec1f7(0xcc)])):logger['debug'](_0x4ec1f7(0xc0)+(_0x1c473f['message']||_0x1c473f));const _0x110822={};return _0x110822[_0x4ec1f7(0xfc)]=_0x2a567d[_0x4ec1f7(0xcd)],_0x110822[_0x4ec1f7(0x9e)]=_0x1c473f[_0x4ec1f7(0x9e)]||_0x1c473f[_0x4ec1f7(0x86)]?_0x1c473f[_0x4ec1f7(0x86)][_0x4ec1f7(0xfc)]+':'+_0x1c473f[_0x4ec1f7(0x86)][_0x4ec1f7(0xef)]:_0x1c473f,_0x110822;}})();}}module[a90_0x252d48(0xe9)]=TestHubHandler;