function a90_0x5466(){const _0x488f72=['buildName','44axNdhl','/stop','qXiQd','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','4765383CmmuBM','MJSgg','isAccessibilityEnabled','BROWSERSTACK_TESTHUB_UUID','getProductMapForBuildStartCall','rCAPm','status','lcnc','BS_TESTOPS_BUILD_COMPLETED','stop','push','statusText','ENV_VAR','1613810oNPCGq','buildHashedId','true','job_id','lTBNd','236VrTzaw','setAccessibilityVariables','5957262bgpkOa','processTraceZips','jwt','BROWSERSTACK_RERUN','BROWSERSTACK_PRODUCT_MAP','false','UMebV','../helper','UrQZj','finished_metadata','resolve','getFrameworkDetails','auth','All\x20trace\x20zip\x20send\x20events\x20complete','data','BROWSERSTACK_BUILD_GROUPING_IDENTIFIER','isBrowserstackInfra','setTestObservabilityVariables','user_killed','RXMaW','authToken','BROWSERSTACK_ACCESSIBILITY','setTestHubCommonMetaInfo','accessibility','zGzHl','BROWSERSTACK_TEST_ACCESSIBILITY_PLATFORM','stringify','null','generateBuildUpstreamData','FIGHr','getGitMetaData','./utils.js','ZBgoI','success','username','add','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','3430635HaKzqC','HJlyO','response','xxjEu','launchBuild','Error\x20while\x20waiting\x20for\x20events:\x20','HehaO','gdUVP','STOP','ACCESSIBILITY','env','error','Percy\x20is\x20not\x20supported\x20for\x20','XdLUF','api/v1/builds/','START','BROWSERSTACK_CENTRAL_SCANNER_JWT','MaFCT','config','./constants.js','getConfig','OBSERVABILITY','6QCCLab','framework','../logger','winstonLogger','NCTzA','NcJQa','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','getAccessKey','Testhub\x20started\x20with\x20id:\x20','extractDataFromResponse','sfgYm','152184rJoCxJ','includes','toISOString','message','getUserName','central_scanner','FZkrn','BROWSERSTACK_TEST_OBSERVABILITY','projectName','debug','uploadPending','BROWSERSTACK_BUILD_RUN_IDENTIFIER','EOWrx','pUcng','getHostInfo','percy','setupPercy','measureWrapper','../performance/constants','TJUCF','accessibilityOptions','18399lreOfA','assign','forEach','../../bin/playwright/reporter/test-details.js','basename','8JmgrEf','TAiNS','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','password','qIOGu','logBuildError','21525LYcBmJ','kMnsL','checkAndSetupPercy','../performance/performance-tester.js','buildIdentifier','getCentralUser','PERCY_SUPPORTED_FRAMEWORKS','EpaOM','isUndefined','BROWSERSTACK_TESTHUB_JWT','getAccessibilityOptions','buildStopSent','Zmxck','waitForBuildStatus','PUT','../test-observability/sessionHandler.js'];a90_0x5466=function(){return _0x488f72;};return a90_0x5466();}const a90_0x572599=a90_0x3652;(function(_0xca320c,_0x267436){const _0x1a79de=a90_0x3652,_0xb90b34=_0xca320c();while(!![]){try{const _0xf503f6=-parseInt(_0x1a79de(0xbb))/0x1+parseInt(_0x1a79de(0xe2))/0x2*(parseInt(_0x1a79de(0xb0))/0x3)+-parseInt(_0x1a79de(0x12a))/0x4+-parseInt(_0x1a79de(0x109))/0x5+parseInt(_0x1a79de(0x11f))/0x6*(-parseInt(_0x1a79de(0xd0))/0x7)+parseInt(_0x1a79de(0xb5))/0x8*(parseInt(_0x1a79de(0xe4))/0x9)+-parseInt(_0x1a79de(0xdd))/0xa*(-parseInt(_0x1a79de(0xcc))/0xb);if(_0xf503f6===_0x267436)break;else _0xb90b34['push'](_0xb90b34['shift']());}catch(_0x3242bc){_0xb90b34['push'](_0xb90b34['shift']());}}}(a90_0x5466,0x939fd));const bsSetupHelper=require(a90_0x572599(0xeb)),path=require('path'),util=require('util'),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require('../test-observability/utils'),testhubUtils=require(a90_0x572599(0x103)),testHubConstants=require(a90_0x572599(0x11c)),constants=require('../../bin/utils/constants.js'),RequestQueueHandler=require('../test-observability/requestQueueHandler.js'),logger=require(a90_0x572599(0x121))[a90_0x572599(0x122)],SessionHandler=require(a90_0x572599(0xca)),PerformanceTester=require(a90_0x572599(0xbe)),{TESTHUB_EVENTS:PerformanceEvents}=require(a90_0x572599(0xad)),TestDetails=require(a90_0x572599(0xb3)),{uploadTraceZip}=require('../../bin/playwright/reporter/pwUtils.js'),OngoingEvents=new Set();let processedTraceZips=![];function a90_0x3652(_0x361df4,_0x404d78){const _0x546645=a90_0x5466();return a90_0x3652=function(_0x3652d4,_0x5aff80){_0x3652d4=_0x3652d4-0x9f;let _0x4b7cf0=_0x546645[_0x3652d4];return _0x4b7cf0;},a90_0x3652(_0x361df4,_0x404d78);}const addEvent=_0x3feec1=>{const _0x2031f8=a90_0x572599;OngoingEvents[_0x2031f8(0x107)](_0x3feec1);},awaitAllEvents=async()=>{return Promise['allSettled'](OngoingEvents);};class TestHubHandler{static [a90_0x572599(0xc6)]=![];static async[a90_0x572599(0x10d)](_0x1f6d94,_0x5db6a4){const _0x382feb=a90_0x572599,_0xc9f8fd={'kMnsL':function(_0x5f4614,_0x2b412e){return _0x5f4614||_0x2b412e;},'pUcng':function(_0x4e9b82,_0x116e68){return _0x4e9b82||_0x116e68;},'HJlyO':function(_0x1cad9b,_0x2c8b59){return _0x1cad9b===_0x2c8b59;},'UMebV':function(_0x1e90c0){return _0x1e90c0();},'HehaO':_0x382feb(0x108),'NcJQa':_0x382feb(0xe9),'RXMaW':'Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','gdUVP':function(_0x16061f,_0x105674,_0x254bf8,_0x23ac5a,_0x23f2eb){return _0x16061f(_0x105674,_0x254bf8,_0x23ac5a,_0x23f2eb);},'NCTzA':'POST','EOWrx':_0x382feb(0xfb),'Zmxck':_0x382feb(0xdf)};await PerformanceTester['measureWrapper'](PerformanceEvents[_0x382feb(0x118)],async()=>{const _0x3d922f=_0x382feb,_0x38cd2b=Object[_0x3d922f(0xb1)]({},_0x5db6a4['config'],{'root_dir_path':'','framework':_0x5db6a4[_0x3d922f(0x120)]}),_0x2c8128=bsSetupHelper[_0x3d922f(0x9f)](_0x38cd2b),_0x4638b8=bsSetupHelper[_0x3d922f(0x126)](_0x38cd2b),_0x50bb01=_0xc9f8fd[_0x3d922f(0xbc)](_0x2c8128,'')+':'+_0xc9f8fd[_0x3d922f(0xa8)](_0x4638b8,''),_0x93e8d=testhubUtils['getProductMap'](_0x38cd2b);process[_0x3d922f(0x113)][_0x3d922f(0xe8)]=JSON[_0x3d922f(0xfe)](_0x93e8d);if(_0xc9f8fd[_0x3d922f(0x10a)](_0x50bb01,':'))return _0xc9f8fd[_0x3d922f(0xea)](isTestObservabilitySession)&&(logger['debug'](_0xc9f8fd[_0x3d922f(0x10f)]),process[_0x3d922f(0x113)][_0x3d922f(0xd8)]=_0xc9f8fd[_0x3d922f(0x124)]),testhubUtils[_0x3d922f(0xd2)](_0x38cd2b)&&logger[_0x3d922f(0xa4)](_0xc9f8fd[_0x3d922f(0xf7)]),[null,null];try{const _0x4e2978=await this['generateBuildUpstreamData'](_0x38cd2b,_0x1f6d94),_0x5d77df=this['getConfig'](_0x2c8128,_0x4638b8),_0x422fe7=await _0xc9f8fd[_0x3d922f(0x110)](nodeRequest,_0xc9f8fd[_0x3d922f(0x123)],testHubConstants['TESTHUB_BUILD_API'],_0x4e2978,_0x5d77df),_0x3d09b3=this['extractDataFromResponse'](_0x38cd2b,_0x422fe7,_0x5d77df);await this[_0x3d922f(0xbd)](_0x5db6a4,_0x1f6d94);if(_0xc9f8fd[_0x3d922f(0x10a)](testhubUtils['getAccessibilityValueFromYml'](_0x5db6a4[_0x3d922f(0x11b)]),null)){const _0x5514e1=_0x3d09b3[_0xc9f8fd[_0x3d922f(0xa7)]];_0x5514e1&&_0x5514e1[_0x3d922f(0xf8)]&&_0x5514e1[_0x3d922f(0xde)]&&(_0x5db6a4['config']['accessibility']=!![],process[_0x3d922f(0x113)][_0x3d922f(0xfd)]=_0xc9f8fd[_0x3d922f(0xc7)]);}return _0x3d09b3;}catch(_0x3afc53){if(_0xc9f8fd[_0x3d922f(0x10a)](_0x3afc53[_0x3d922f(0x105)],![])){testhubUtils[_0x3d922f(0xba)](_0x3afc53);return;}}})();}static async['processTraceZips'](){const _0x59a43b=a90_0x572599,_0x36e305={'FZkrn':function(_0x29b069,_0x1ea436,_0x539ec5){return _0x29b069(_0x1ea436,_0x539ec5);},'rCAPm':function(_0x1da221,_0x22eb70){return _0x1da221(_0x22eb70);},'MaFCT':function(_0x7fde94){return _0x7fde94();},'TAiNS':_0x59a43b(0xf1)};if(processedTraceZips)return;const _0x11ead2=TestDetails['getTraceFilePaths']();_0x11ead2[_0x59a43b(0xb2)](({testUId:_0x862f37,filePath:_0x2d81a5})=>{const _0x2a71e1=_0x59a43b;var _0x2db9c7=_0x36e305[_0x2a71e1(0xa1)](uploadTraceZip,_0x2d81a5,_0x862f37);_0x36e305[_0x2a71e1(0xd5)](addEvent,_0x2db9c7);});try{await _0x36e305[_0x59a43b(0x11a)](awaitAllEvents),logger[_0x59a43b(0xa4)](_0x36e305[_0x59a43b(0xb6)]),processedTraceZips=!![];}catch(_0x4e5f67){logger[_0x59a43b(0x114)](_0x59a43b(0x10e)+util['format'](_0x4e5f67));}}static async[a90_0x572599(0xbd)](_0xffdf60,_0x1b7178){const _0x2faec9=a90_0x572599;if(constants[_0x2faec9(0xc1)][_0x2faec9(0x12b)](_0x1b7178)){await _0xffdf60[_0x2faec9(0xab)]();return;}_0xffdf60[_0x2faec9(0x11b)][_0x2faec9(0xaa)]&&logger[_0x2faec9(0xa4)](_0x2faec9(0x115)+_0x1b7178+'\x20framework');}static[a90_0x572599(0xc5)](_0x27dad2){const _0x1acc2a=a90_0x572599,_0x40b0a5={};_0x40b0a5['settings']=_0x27dad2[_0x1acc2a(0xaf)];const _0xc0a3f4=_0x40b0a5;return _0xc0a3f4;}static[a90_0x572599(0x11d)](_0x25b031,_0x22c5e4){const _0x37fcff=a90_0x572599,_0x36e565={'qLGZn':function(_0x3332bc,_0x333b5d){return _0x3332bc(_0x333b5d);}},_0x19b011={};return _0x19b011[_0x37fcff(0x106)]=_0x25b031,_0x19b011[_0x37fcff(0xb8)]=_0x22c5e4,{'auth':_0x19b011,'headers':_0x36e565['qLGZn'](getDefaultHeaders,![])};}static async[a90_0x572599(0x100)](_0xa95d10,_0x20b94a){const _0x1c8447=a90_0x572599,_0xf02050={'sDFPX':function(_0x53d4f1,_0x215c33){return _0x53d4f1(_0x215c33);}},_0x136935={'project_name':_0xa95d10[_0x1c8447(0xa3)]||'','name':_0xa95d10[_0x1c8447(0xcb)]||path[_0x1c8447(0xb4)](path[_0x1c8447(0xee)](process['cwd']())),'build_identifier':_0xa95d10[_0x1c8447(0xbf)],'description':_0xa95d10['buildDescription']||'','started_at':new Date()[_0x1c8447(0x12c)](),'tags':_0xf02050['sDFPX'](getCustomTags,_0xa95d10),'host_info':bsSetupHelper[_0x1c8447(0xa9)](),'ci_info':bsSetupHelper['getCiInfo'](),'build_run_identifier':process[_0x1c8447(0x113)][_0x1c8447(0xa6)],'failed_tests_rerun':process['env'][_0x1c8447(0xe7)]||![],'version_control':await bsSetupHelper[_0x1c8447(0x102)](),'accessibility':this['getAccessibilityOptions'](_0xa95d10),'framework_details':testhubUtils[_0x1c8447(0xef)](_0xa95d10,_0x20b94a),'product_map':testhubUtils[_0x1c8447(0xd4)](_0xa95d10),'browserstackAutomation':bsSetupHelper[_0x1c8447(0xf4)](),'grouping_identifier':process['env'][_0x1c8447(0xf3)]};if(bsSetupHelper[_0x1c8447(0xc0)]()[_0x1c8447(0xa0)]||bsSetupHelper[_0x1c8447(0xc0)]()[_0x1c8447(0xd7)]){const _0x56be97={};_0x56be97[_0x1c8447(0xe0)]=process[_0x1c8447(0x113)]['BROWSERSTACK_CENTRAL_SCANNER_JOBID'],_0x56be97['token']=process[_0x1c8447(0x113)][_0x1c8447(0x119)],_0x136935['central_scanner']=_0x56be97;}return _0x136935;}static[a90_0x572599(0x128)](_0x2b2b63,_0x37fe5c,_0x9d598a){const _0x1a94ea=a90_0x572599,_0x3115f9={'nftJw':function(_0x2fcf47){return _0x2fcf47();},'lTBNd':function(_0x3efb17,_0x222a57){return _0x3efb17&&_0x222a57;},'qXiQd':_0x1a94ea(0xdf),'sfgYm':_0x1a94ea(0xe9),'RdUeo':function(_0x152429,_0x5caa2d){return _0x152429&&_0x5caa2d;}},_0x58cc35={};if(_0x3115f9['nftJw'](isTestObservabilitySession)){const [_0x1285a1,_0x3bcc1f,_0x4cae50]=testhubUtils[_0x1a94ea(0xf5)](_0x37fe5c[_0x1a94ea(0xf2)],_0x9d598a[_0x1a94ea(0xf0)]);if(_0x3115f9[_0x1a94ea(0xe1)](_0x1285a1,_0x3bcc1f)){const _0x5af902={};_0x5af902[_0x1a94ea(0xe6)]=_0x1285a1,_0x5af902['buildHashedId']=_0x3bcc1f,_0x5af902['allowScreenshot']=_0x4cae50,_0x58cc35[testHubConstants[_0x1a94ea(0x11e)]]=_0x5af902,process[_0x1a94ea(0x113)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x3115f9[_0x1a94ea(0xce)];}else _0x58cc35[testHubConstants['OBSERVABILITY']]={},process['env'][_0x1a94ea(0xa2)]=_0x3115f9[_0x1a94ea(0x129)];}else process[_0x1a94ea(0x113)][_0x1a94ea(0xa2)]=_0x3115f9['sfgYm'];const [_0x31a6ca,_0x38f95c]=testhubUtils[_0x1a94ea(0xe3)](_0x37fe5c[_0x1a94ea(0xf2)]);if(_0x3115f9['RdUeo'](_0x31a6ca,_0x38f95c)){const _0x24df09={};_0x24df09[_0x1a94ea(0xf8)]=_0x31a6ca,_0x24df09[_0x1a94ea(0xde)]=_0x38f95c,_0x58cc35[testHubConstants[_0x1a94ea(0x112)]]=_0x24df09,process[_0x1a94ea(0x113)][_0x1a94ea(0xf9)]=_0x3115f9[_0x1a94ea(0xce)];}else _0x58cc35[testHubConstants[_0x1a94ea(0x112)]]={},process[_0x1a94ea(0x113)][_0x1a94ea(0xf9)]=_0x3115f9['sfgYm'];return testhubUtils[_0x1a94ea(0xfa)](_0x37fe5c[_0x1a94ea(0xf2)]),logger['info'](_0x1a94ea(0x127)+process[_0x1a94ea(0x113)]['BROWSERSTACK_TESTHUB_UUID']),_0x58cc35;}static async[a90_0x572599(0xd9)](_0x51e839){const _0x193909=a90_0x572599,_0x1f1406={'xDCEL':function(_0x23374e,_0x3b65e6){return _0x23374e===_0x3b65e6;},'zGzHl':_0x193909(0xe9),'TJUCF':function(_0x17e66d,_0x4150e6){return _0x17e66d===_0x4150e6;},'ZBgoI':_0x193909(0xff),'EpaOM':_0x193909(0xcf),'MJSgg':_0x193909(0x114),'qIOGu':_0x193909(0x125),'UrQZj':_0x193909(0xed),'VgwYe':_0x193909(0xf6),'axAzp':function(_0x419f3c){return _0x419f3c();},'FIGHr':function(_0x5b0b7f,_0x3c4c03,_0x3c0336,_0x43fa0c,_0xa6e77b,_0x310c8e){return _0x5b0b7f(_0x3c4c03,_0x3c0336,_0x43fa0c,_0xa6e77b,_0x310c8e);},'xqMuR':_0x193909(0xc9),'xxjEu':'stopBuildUpstream\x20event\x20successful!','XdLUF':_0x193909(0x105)};await this[_0x193909(0xe5)](),await PerformanceTester[_0x193909(0xac)](PerformanceEvents[_0x193909(0x111)],async()=>{const _0x3b309c=_0x193909;if(_0x1f1406['xDCEL'](process[_0x3b309c(0x113)][_0x3b309c(0xd8)],_0x1f1406[_0x3b309c(0xfc)])||TestHubHandler['buildStopSent']||bsSetupHelper[_0x3b309c(0xc3)](process['env'][testHubConstants['ENV_VAR'][_0x3b309c(0xc4)]]))return;TestHubHandler[_0x3b309c(0xc6)]=!![],await RequestQueueHandler['getInstance']()[_0x3b309c(0xa5)](),await SessionHandler[_0x3b309c(0xc8)]();if(_0x1f1406[_0x3b309c(0xae)](process['env'][testHubConstants[_0x3b309c(0xdc)][_0x3b309c(0xc4)]],_0x1f1406[_0x3b309c(0x104)])||_0x1f1406[_0x3b309c(0xae)](process[_0x3b309c(0x113)][testHubConstants[_0x3b309c(0xdc)][_0x3b309c(0xd3)]],_0x1f1406['ZBgoI'])){logger['debug'](_0x1f1406[_0x3b309c(0xc2)]);const _0x4375c7={};return _0x4375c7[_0x3b309c(0xd6)]=_0x1f1406['MJSgg'],_0x4375c7['message']=_0x1f1406[_0x3b309c(0xb9)],_0x4375c7;}const _0x5787dc={'finished_at':new Date()['toISOString'](),'finished_metadata':[]};!!_0x51e839&&_0x5787dc[_0x1f1406[_0x3b309c(0xec)]][_0x3b309c(0xda)]({'reason':_0x1f1406['VgwYe'],'signal':_0x51e839,'failure_data':''});const _0x4feed0={'headers':_0x1f1406['axAzp'](getDefaultHeaders)};try{const _0x2eab66=await _0x1f1406[_0x3b309c(0x101)](nodeRequest,_0x1f1406['xqMuR'],_0x3b309c(0x117)+process[_0x3b309c(0x113)][testHubConstants['ENV_VAR'][_0x3b309c(0xd3)]]+_0x3b309c(0xcd),_0x5787dc,_0x4feed0,![]);if(_0x2eab66[_0x3b309c(0xf2)]&&_0x2eab66[_0x3b309c(0xf2)]['error']){const _0x48b3c4={};_0x48b3c4[_0x3b309c(0x12d)]=_0x2eab66['data'][_0x3b309c(0x114)];throw _0x48b3c4;}else{logger['debug'](_0x1f1406[_0x3b309c(0x10c)]);const _0x2fc66e={};return _0x2fc66e[_0x3b309c(0xd6)]=_0x1f1406[_0x3b309c(0x116)],_0x2fc66e[_0x3b309c(0x12d)]='',_0x2fc66e;}}catch(_0x13bf36){_0x13bf36[_0x3b309c(0x10b)]?logger[_0x3b309c(0xa4)](_0x3b309c(0xb7)+_0x13bf36[_0x3b309c(0x10b)][_0x3b309c(0xd6)]+'\x20'+_0x13bf36[_0x3b309c(0x10b)][_0x3b309c(0xdb)]+'\x20'+JSON[_0x3b309c(0xfe)](_0x13bf36[_0x3b309c(0x10b)]['data'])):logger[_0x3b309c(0xa4)](_0x3b309c(0xb7)+(_0x13bf36[_0x3b309c(0x12d)]||_0x13bf36));const _0x1fd544={};return _0x1fd544[_0x3b309c(0xd6)]=_0x1f1406[_0x3b309c(0xd1)],_0x1fd544[_0x3b309c(0x12d)]=_0x13bf36[_0x3b309c(0x12d)]||_0x13bf36[_0x3b309c(0x10b)]?_0x13bf36[_0x3b309c(0x10b)][_0x3b309c(0xd6)]+':'+_0x13bf36['response'][_0x3b309c(0xdb)]:_0x13bf36,_0x1fd544;}})();}}module['exports']=TestHubHandler;