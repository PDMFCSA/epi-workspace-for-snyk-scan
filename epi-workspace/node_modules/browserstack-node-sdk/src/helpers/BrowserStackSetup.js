const a90_0x12dde3=a90_0x9b86;(function(_0x39a76d,_0x2ba12e){const _0x353122=a90_0x9b86,_0x1b0016=_0x39a76d();while(!![]){try{const _0x406507=parseInt(_0x353122(0xd8))/0x1+-parseInt(_0x353122(0x148))/0x2+-parseInt(_0x353122(0xad))/0x3+-parseInt(_0x353122(0x196))/0x4*(parseInt(_0x353122(0xf7))/0x5)+-parseInt(_0x353122(0xae))/0x6+parseInt(_0x353122(0x104))/0x7+parseInt(_0x353122(0xd0))/0x8;if(_0x406507===_0x2ba12e)break;else _0x1b0016['push'](_0x1b0016['shift']());}catch(_0x17265a){_0x1b0016['push'](_0x1b0016['shift']());}}}(a90_0x5756,0x9ec9f));const util=require(a90_0x12dde3(0x14d)),os=require('os'),path=require('path'),{v4:uuidv4}=require('uuid'),fs=require('fs'),constants=require(a90_0x12dde3(0x136)),logger=require('./logger')[a90_0x12dde3(0xaf)],fileLogger=require(a90_0x12dde3(0xeb))['fileLogger'],{getLogDir}=require(a90_0x12dde3(0xeb)),helper=require(a90_0x12dde3(0x12b)),utilities=require(a90_0x12dde3(0x123)),percyHelper=require(a90_0x12dde3(0x19c)),hubAllocator=require(a90_0x12dde3(0x141)),PerformanceTester=require('./performance/performance-tester'),{EVENTS:PerformanceEvents,AUTOMATE_EVENTS:PerformanceAutEvents}=require(a90_0x12dde3(0xf3)),{setPercyFlag}=require('./testhub/utils'),TestHubHandler=require('./testhub/testhubHandler'),timeoutPromise=require(a90_0x12dde3(0x102)),BrowserstackCLI=require('../bin/v2/browserstackCLI'),{getEdsInstrumentationAPIUrl}=require('../bin/utils/apiUtilityMethods');function a90_0x9b86(_0x136cd1,_0x1c801d){const _0x5756eb=a90_0x5756();return a90_0x9b86=function(_0x9b86d1,_0x40c9b0){_0x9b86d1=_0x9b86d1-0xac;let _0x2f8cf5=_0x5756eb[_0x9b86d1];return _0x2f8cf5;},a90_0x9b86(_0x136cd1,_0x1c801d);}class BrowserStackSetup{constructor(_0x44e2d2,_0x35df91){const _0xb51424=a90_0x12dde3,_0x3460a7={'tCqVD':_0xb51424(0xe2),'WXfoK':_0xb51424(0x144),'pKFKQ':function(_0x3eb659){return _0x3eb659();}},_0xb8f0e4=_0x3460a7[_0xb51424(0x187)][_0xb51424(0x17d)]('|');let _0x4468a1=0x0;while(!![]){switch(_0xb8f0e4[_0x4468a1++]){case'0':this['config'][_0xb51424(0x108)][_0xb51424(0x19d)]=!helper[_0xb51424(0x17b)]()||helper[_0xb51424(0x199)](this['config']['testContextOptions']['skipSessionName']);continue;case'1':PerformanceTester[_0xb51424(0xf9)]();continue;case'2':this[_0xb51424(0x138)]=null;continue;case'3':helper[_0xb51424(0xb2)](this['config'],this[_0xb51424(0x118)]);continue;case'4':this[_0xb51424(0x118)]=helper[_0xb51424(0xc4)](_0x44e2d2);continue;case'5':helper[_0xb51424(0x160)](this[_0xb51424(0x100)],this[_0xb51424(0x118)],this['envConfig']);continue;case'6':helper['setLogDir'](this[_0xb51424(0x100)]);continue;case'7':this[_0xb51424(0x100)]=helper[_0xb51424(0xe7)](helper[_0xb51424(0x159)](_0x44e2d2));continue;case'8':helper[_0xb51424(0x172)]();continue;case'9':this['envConfig']=helper[_0xb51424(0x119)]();continue;case'10':if(this[_0xb51424(0x100)][_0xb51424(0xcc)])throw new Error(this[_0xb51424(0x100)][_0xb51424(0xcc)]);continue;case'11':this[_0xb51424(0x100)][_0xb51424(0x108)]=this['config'][_0xb51424(0x108)]||{};continue;case'12':if(helper[_0xb51424(0xbf)](this[_0xb51424(0x100)]))throw new Error(_0x3460a7[_0xb51424(0x121)]);continue;case'13':this[_0xb51424(0x100)][_0xb51424(0x108)][_0xb51424(0x10e)]=!helper[_0xb51424(0x17b)]()||helper[_0xb51424(0x199)](this[_0xb51424(0x100)]['testContextOptions']['skipSessionStatus']);continue;case'14':helper['getFinalCaps'](this['config'],this[_0xb51424(0x118)],this[_0xb51424(0x14f)]);continue;case'15':helper[_0xb51424(0xf5)](this['config']);continue;case'16':this[_0xb51424(0xfa)]={};continue;case'17':this[_0xb51424(0x100)]['platforms']=this[_0xb51424(0x100)]['platforms']||[];continue;case'18':this[_0xb51424(0x181)]=_0x3460a7[_0xb51424(0x12f)](uuidv4);continue;case'19':this[_0xb51424(0x110)]=_0x35df91;continue;case'20':global['framework']=_0x35df91;continue;case'21':this[_0xb51424(0xb8)]=[];continue;case'22':this[_0xb51424(0x1a0)]=null;continue;}break;}}[a90_0x12dde3(0xee)](_0xffab09){const _0x9e25d9=a90_0x12dde3,_0x4d60ed={'ftyRr':_0x9e25d9(0x12c),'OpkHm':function(_0x1ff1df,_0x2ff422){return _0x1ff1df===_0x2ff422;},'YqbyB':_0x9e25d9(0xbe),'eHAUc':_0x9e25d9(0xca),'dprDe':function(_0x165c39,_0x49a65e){return _0x165c39<_0x49a65e;},'ijYip':function(_0x1d5e76,_0x423b67){return _0x1d5e76(_0x423b67);},'tPkld':'selenium-webdriver','BlDIa':_0x9e25d9(0x169),'OzvOH':_0x9e25d9(0x157),'TasHT':_0x9e25d9(0xda),'JQfGa':_0x9e25d9(0x137),'frHQD':'SIGINT','leRHf':_0x9e25d9(0x149),'rSfpx':function(_0x1800e4,_0x3aa769){return _0x1800e4!==_0x3aa769;},'AtvmV':'win32','MHIxS':_0x9e25d9(0xf2),'MWWVq':_0x9e25d9(0x126),'FGieB':_0x9e25d9(0x117),'xfrBZ':'beforeExit'},_0x594c99=this[_0x9e25d9(0x110)];global[_0x9e25d9(0x100)]=this[_0x9e25d9(0x100)],helper[_0x9e25d9(0x15c)](this[_0x9e25d9(0x100)]),this[_0x9e25d9(0x15e)]=null,global['sdkRunId']=this[_0x9e25d9(0x181)],logger[_0x9e25d9(0xde)](_0x9e25d9(0x173)+this[_0x9e25d9(0x181)]),!this[_0x9e25d9(0x100)][_0x9e25d9(0x10f)]&&(this[_0x9e25d9(0x100)]['browserStackLocalOptions']=this['config'][_0x9e25d9(0x184)]||{});if(helper[_0x9e25d9(0xbf)](helper[_0x9e25d9(0x170)](this[_0x9e25d9(0x100)]))||helper[_0x9e25d9(0xbf)](helper[_0x9e25d9(0xc3)](this[_0x9e25d9(0x100)])))throw new Error(_0x4d60ed[_0x9e25d9(0x189)]);helper['getLocalConfig'](this[_0x9e25d9(0x100)])&&helper[_0x9e25d9(0xbf)](helper[_0x9e25d9(0xef)](this[_0x9e25d9(0x100)]))&&(!helper[_0x9e25d9(0xbf)](this['config'][_0x9e25d9(0x10f)])&&_0x4d60ed[_0x9e25d9(0x179)](this[_0x9e25d9(0x100)][_0x9e25d9(0x10f)]['constructor'],Object)?!helper['isTrue'](this[_0x9e25d9(0x100)][_0x9e25d9(0x10f)]['skipBinaryInitialisation'])&&(this[_0x9e25d9(0x100)][_0x9e25d9(0x10f)][_0x9e25d9(0x1a2)]=helper[_0x9e25d9(0x194)]()):this['config'][_0x9e25d9(0x10f)]={'localIdentifier':helper[_0x9e25d9(0x194)]()});this[_0x9e25d9(0x100)]['browserStackLocalOptions'][_0x9e25d9(0xdd)]=helper[_0x9e25d9(0x199)](this[_0x9e25d9(0x100)][_0x9e25d9(0x10f)][_0x9e25d9(0xdd)]),helper[_0x9e25d9(0xf4)](this[_0x9e25d9(0x100)]);if(_0x4d60ed[_0x9e25d9(0x179)](_0x594c99,_0x4d60ed[_0x9e25d9(0xdf)]))return;this[_0x9e25d9(0x124)]();process[_0x9e25d9(0x192)][_0x9e25d9(0x106)]&&(this['config'][_0x9e25d9(0x145)]=helper[_0x9e25d9(0x199)](process[_0x9e25d9(0x192)][_0x9e25d9(0x106)]),this['config'][_0x9e25d9(0xf6)]=this[_0x9e25d9(0x100)][_0x9e25d9(0xf6)]||{});helper['isTurboScaleSession'](this[_0x9e25d9(0x100)])&&(process[_0x9e25d9(0x192)]['BROWSERSTACK_TURBOSCALE']=!![]);if(!helper[_0x9e25d9(0x17b)]()){try{process['env'][_0x9e25d9(0xc0)]=_0x594c99,utilities['fireFunnelTestEvent'](_0x4d60ed[_0x9e25d9(0xcd)],{},this[_0x9e25d9(0x100)],this['framework']);}catch(_0x1fe9c5){logger[_0x9e25d9(0xb3)](_0x9e25d9(0xd4)+_0x1fe9c5);}return;}if(helper[_0x9e25d9(0x18a)](_0x594c99)){if(global['__isPlaywrightInstalled'])return;_0x4d60ed['dprDe'](_0x4d60ed[_0x9e25d9(0x116)](parseInt,helper[_0x9e25d9(0x1a5)](_0x4d60ed[_0x9e25d9(0x10c)])),0x3)&&(this['config'][_0x9e25d9(0x103)]=![]),_0x4d60ed[_0x9e25d9(0x179)](helper['compareVersions'](helper[_0x9e25d9(0x1a5)](_0x4d60ed[_0x9e25d9(0x10c)]),_0x4d60ed['BlDIa']),0x1)&&(this[_0x9e25d9(0x100)][_0x9e25d9(0x103)]=!![]);}(helper[_0x9e25d9(0xbf)](this[_0x9e25d9(0x100)]['platforms'])||helper['isUndefined'](this[_0x9e25d9(0x100)]['platforms']['length']))&&(helper[_0x9e25d9(0xbf)](this[_0x9e25d9(0x100)][_0x9e25d9(0xac)])?logger[_0x9e25d9(0xde)](_0x4d60ed[_0x9e25d9(0x107)]):logger[_0x9e25d9(0xb6)](_0x4d60ed[_0x9e25d9(0x10b)]),this[_0x9e25d9(0x100)][_0x9e25d9(0x186)]=[]);!this[_0x9e25d9(0x100)][_0x9e25d9(0x108)]&&(this['config'][_0x9e25d9(0x108)]={});try{process[_0x9e25d9(0x192)]['FRAMEWORK']=_0xffab09['_'][0x0],utilities['fireFunnelTestEvent'](_0x4d60ed['eHAUc'],{},this[_0x9e25d9(0x100)],this[_0x9e25d9(0x110)]);}catch(_0x293814){logger[_0x9e25d9(0xb3)]('Error\x20in\x20Fire\x20SDKTestAttempted.\x20Stacktrace:\x20'+_0x293814);}!this[_0x9e25d9(0x100)]['disableAutoCaptureLogs']&&logger['info'](constants[_0x9e25d9(0x11f)]),this[_0x9e25d9(0x130)]=this[_0x9e25d9(0x130)]['bind'](this),process['on'](_0x4d60ed['JQfGa'],this['intExitHandler']),process['on'](_0x4d60ed[_0x9e25d9(0x153)],this[_0x9e25d9(0x130)]),process['on'](_0x4d60ed[_0x9e25d9(0xb4)],this[_0x9e25d9(0x130)]),_0x4d60ed['rSfpx'](process['platform'],_0x4d60ed[_0x9e25d9(0x16b)])?(process['on'](_0x4d60ed[_0x9e25d9(0x115)],this['intExitHandler']),process['on'](_0x4d60ed[_0x9e25d9(0x17c)],this[_0x9e25d9(0x130)])):process['on'](_0x4d60ed[_0x9e25d9(0x14c)],this[_0x9e25d9(0x130)]),process['on'](_0x4d60ed[_0x9e25d9(0xfd)],this['exitHandler']());}async[a90_0x12dde3(0x109)](_0x497c26){const _0x4cf4f1=a90_0x12dde3,_0x41a31c={'pQsSZ':_0x4cf4f1(0x151),'tnliY':_0x4cf4f1(0x16f),'CSQDQ':_0x4cf4f1(0x17a),'PvcoW':function(_0x5d3565,_0x29ff7b){return _0x5d3565===_0x29ff7b;},'GGVrj':_0x4cf4f1(0x19e),'YhQSo':function(_0x352a55,_0x2a4323){return _0x352a55+_0x2a4323;},'cChwC':_0x4cf4f1(0x120),'NWFoB':function(_0x4375ba,_0x38ede8){return _0x4375ba(_0x38ede8);},'YHWRj':'codeceptjs'};this[_0x4cf4f1(0xee)](_0x497c26);if(helper[_0x4cf4f1(0x185)](this[_0x4cf4f1(0x100)])){const _0x5a7315=await helper[_0x4cf4f1(0x13d)](this[_0x4cf4f1(0x100)]);this[_0x4cf4f1(0x100)]['turboScaleGridDetails']=_0x5a7315,_0x5a7315['isTrialGrid']&&helper[_0x4cf4f1(0xce)](this[_0x4cf4f1(0x100)][_0x4cf4f1(0x1a0)])&&helper[_0x4cf4f1(0x199)](this[_0x4cf4f1(0x100)][_0x4cf4f1(0x1a0)])&&(this[_0x4cf4f1(0x100)]['browserStackLocalOptions'][_0x4cf4f1(0x1a2)]=_0x41a31c[_0x4cf4f1(0x190)],this[_0x4cf4f1(0x100)]['browserStackLocalOptions'][_0x41a31c['tnliY']]=_0x5a7315[_0x4cf4f1(0xe0)]['join'](','),this[_0x4cf4f1(0x100)][_0x4cf4f1(0x10f)][_0x4cf4f1(0x12e)]=_0x41a31c['CSQDQ']),this[_0x4cf4f1(0x100)][_0x4cf4f1(0xd5)]=_0x5a7315['url'],this['framework']&&_0x41a31c[_0x4cf4f1(0x18d)](this[_0x4cf4f1(0x110)][_0x4cf4f1(0x14e)](),_0x41a31c['GGVrj'])?this[_0x4cf4f1(0x100)][_0x4cf4f1(0xd5)]=_0x41a31c['YhQSo'](_0x5a7315['playwrightUrl'],_0x41a31c[_0x4cf4f1(0x152)]):constants[_0x4cf4f1(0x12a)]=helper[_0x4cf4f1(0x182)](this[_0x4cf4f1(0x100)]),logger[_0x4cf4f1(0xb3)](_0x4cf4f1(0xbb)+constants['hubUrl']);}helper[_0x4cf4f1(0x105)](this[_0x4cf4f1(0x100)]),this[_0x4cf4f1(0xe6)](),_0x41a31c[_0x4cf4f1(0x114)](setPercyFlag,this),await this[_0x4cf4f1(0x16c)](),![_0x41a31c['YHWRj'],_0x41a31c[_0x4cf4f1(0xc5)]][_0x4cf4f1(0x14b)](this[_0x4cf4f1(0x110)])&&!helper[_0x4cf4f1(0x185)](this[_0x4cf4f1(0x100)])&&!helper[_0x4cf4f1(0x13c)]()[_0x4cf4f1(0x15d)]&&await this['setUpHubUrl']();}async['setupPercy'](){const _0x10cc4e=a90_0x12dde3,_0x4e4499={};_0x4e4499[_0x10cc4e(0x14a)]=function(_0x41ced9,_0x2fcd19){return _0x41ced9===_0x2fcd19;},_0x4e4499['kaMCO']=_0x10cc4e(0x198),_0x4e4499[_0x10cc4e(0xc1)]=_0x10cc4e(0x13a),_0x4e4499[_0x10cc4e(0x11a)]=_0x10cc4e(0x19f),_0x4e4499[_0x10cc4e(0x146)]='true',_0x4e4499[_0x10cc4e(0x18b)]='beforeExit';const _0x55c391=_0x4e4499;if(helper['isTrue'](this[_0x10cc4e(0x100)][_0x10cc4e(0x138)])&&(!this['percy']||!this['percy'][_0x10cc4e(0x15f)]()))try{this[_0x10cc4e(0x138)]=await percyHelper['startPercy'](this[_0x10cc4e(0x100)]);if(!this[_0x10cc4e(0x138)]){process['env'][_0x10cc4e(0xe4)]=_0x55c391['kaMCO'];throw new Error(_0x55c391[_0x10cc4e(0xc1)]);}logger[_0x10cc4e(0xde)](_0x55c391['WZwjF']),process['env']['BROWSERSTACK_PERCY']=_0x55c391[_0x10cc4e(0x146)];let _0x332bc4=0x0;const _0x2305cb=async()=>{const _0x49eef9=_0x10cc4e;_0x332bc4++,_0x55c391['vgyYi'](_0x332bc4,0x1)&&await this[_0x49eef9(0x131)]();};process['on'](_0x55c391[_0x10cc4e(0x18b)],_0x2305cb);}catch(_0x3eeb93){process[_0x10cc4e(0x192)][_0x10cc4e(0xe4)]=_0x55c391['kaMCO'],logger['debug']('Error\x20in\x20percy\x20setup\x20'+_0x3eeb93);throw new Error(_0x3eeb93[_0x10cc4e(0x11b)]());}}async['stopPercy'](){const _0x2fe751=a90_0x12dde3,_0x511915={};_0x511915[_0x2fe751(0x12d)]='Percy\x20stopped',_0x511915['hBgxu']=_0x2fe751(0xd7);const _0x2e60e4=_0x511915;if(this[_0x2fe751(0x138)]&&this[_0x2fe751(0x138)][_0x2fe751(0x15f)]())try{await percyHelper[_0x2fe751(0x131)](this[_0x2fe751(0x138)]),logger[_0x2fe751(0xde)](_0x2e60e4[_0x2fe751(0x12d)]);}catch(_0x56319){logger[_0x2fe751(0xcc)](_0x2e60e4[_0x2fe751(0x156)],_0x56319[_0x2fe751(0xdb)]);}}async[a90_0x12dde3(0x16c)](){const _0x41bd45=a90_0x12dde3,_0x515ccd={};_0x515ccd[_0x41bd45(0x191)]=_0x41bd45(0x158),_0x515ccd['JTDGJ']=_0x41bd45(0xd9);const _0x878568=_0x515ccd;if(helper['isBrowserstackInfra']()&&helper[_0x41bd45(0x199)](this[_0x41bd45(0x100)]['browserstackLocal'])&&(!this[_0x41bd45(0x1a0)]||!this[_0x41bd45(0x1a0)][_0x41bd45(0x15f)]()))try{if(this[_0x41bd45(0x100)][_0x41bd45(0x10f)][_0x41bd45(0xdd)]){logger[_0x41bd45(0xb3)](_0x878568[_0x41bd45(0x191)]);return;}this[_0x41bd45(0x1a0)]=await helper[_0x41bd45(0xe5)](this['config']),logger[_0x41bd45(0xde)](_0x878568['JTDGJ']);}catch(_0x5801c3){logger[_0x41bd45(0xb3)](_0x5801c3);throw new Error(_0x5801c3[_0x41bd45(0x11b)]());}}async[a90_0x12dde3(0x134)](){const _0x1d9a1f=a90_0x12dde3,_0x37bb85={};_0x37bb85[_0x1d9a1f(0x180)]=_0x1d9a1f(0x17f),_0x37bb85[_0x1d9a1f(0x1a4)]=_0x1d9a1f(0x163);const _0x6a1241=_0x37bb85;if(this[_0x1d9a1f(0x1a0)]&&this[_0x1d9a1f(0x1a0)]['isRunning']())try{await helper[_0x1d9a1f(0x122)](this['browserstackLocal']),logger['info'](_0x6a1241[_0x1d9a1f(0x180)]);}catch(_0x4d5e09){logger['error'](_0x6a1241[_0x1d9a1f(0x1a4)],_0x4d5e09['message']);}}async[a90_0x12dde3(0x128)](){const _0x271e9f=a90_0x12dde3;return PerformanceTester[_0x271e9f(0x193)](PerformanceAutEvents['HUB_MANAGEMENT'],async()=>{const _0xb3fac5=_0x271e9f;await hubAllocator[_0xb3fac5(0x140)](this[_0xb3fac5(0x100)]);})();}async['setupTCGAuth'](){const _0x14e6cc=a90_0x12dde3,_0x20f743={'iZgju':function(_0x41f153,_0x39cb7d){return _0x41f153(_0x39cb7d);},'HLJQH':_0x14e6cc(0xf1),'xJvgW':function(_0xa2ba23,_0xc87ea7,_0x37c3af,_0x23fbb9,_0x270dec,_0x36d113,_0x577128){return _0xa2ba23(_0xc87ea7,_0x37c3af,_0x23fbb9,_0x270dec,_0x36d113,_0x577128);},'ctIIA':_0x14e6cc(0xb9),'HdBEG':'BrowserstackHealingInitFailed','BUnAr':'../../package.json','vkSoJ':_0x14e6cc(0xb7),'fxQFS':function(_0x4d4bbf,_0x34e320){return _0x4d4bbf(_0x34e320);},'nQcze':function(_0x407da9,_0x2c0928){return _0x407da9===_0x2c0928;},'pkoGm':_0x14e6cc(0x17a),'rQSMX':function(_0x34ac86,_0x32195f){return _0x34ac86===_0x32195f;},'WAtFz':'Please\x20upgrade\x20Browserstack\x20SDK\x20to\x20the\x20latest\x20version\x20to\x20use\x20the\x20self-healing\x20feature.','hJsQs':function(_0x20d8f7,_0x1e6586){return _0x20d8f7===_0x1e6586;},'cooBH':'Something\x20went\x20wrong.\x20Disabling\x20healing\x20for\x20this\x20session.\x20Please\x20try\x20again\x20later.','mLvlc':_0x14e6cc(0x154),'KdKqA':_0x14e6cc(0x15a),'hnOBi':function(_0xdd1aa6,_0x9e2a56){return _0xdd1aa6>=_0x9e2a56;},'QAMVL':function(_0x1d1f4d,_0x1df4a4){return _0x1d1f4d<_0x1df4a4;},'nMAEN':'tcg\x20config\x20setup\x20successful.','anqzl':_0x14e6cc(0x133),'dHrBG':function(_0x1a94cf){return _0x1a94cf();}},_0x4e8db5=PerformanceTester[_0x14e6cc(0x193)](_0x20f743[_0x14e6cc(0x127)],async()=>{const _0x3b81a4=_0x14e6cc;try{const _0x1913c6=new Date(),_0x4a2fdf=helper[_0x3b81a4(0x164)](this[_0x3b81a4(0x100)]),_0x4c1787=_0x20f743['iZgju'](require,path[_0x3b81a4(0x162)](__dirname,_0x20f743[_0x3b81a4(0x10d)])),_0x266d86=_0x20f743[_0x3b81a4(0xb1)](timeoutPromise,constants[_0x3b81a4(0x132)],_0x20f743[_0x3b81a4(0xdc)],_0x20f743['HdBEG'],_0x1913c6,this['config'],this[_0x3b81a4(0x110)]),_0x431231={'tcgUrl':constants[_0x3b81a4(0xb5)],'sdkVersion':_0x20f743['iZgju'](require,_0x20f743[_0x3b81a4(0xc6)])['version'],'methodUsed':_0x20f743[_0x3b81a4(0x197)],'proxyConfig':_0x4a2fdf,'os':os[_0x3b81a4(0x19a)]()};if(_0x4a2fdf&&_0x4a2fdf[_0x3b81a4(0x147)]){utilities[_0x3b81a4(0x142)](constants[_0x3b81a4(0xf0)],_0x431231,this[_0x3b81a4(0x100)],this[_0x3b81a4(0x110)]);return;}const _0x12a32c={};_0x12a32c['proxy']=_0x4a2fdf;const _0x4c4afb=await Promise['race']([_0x4c1787[_0x3b81a4(0xba)](this[_0x3b81a4(0x100)][_0x3b81a4(0xd1)],this[_0x3b81a4(0x100)][_0x3b81a4(0x11e)],constants[_0x3b81a4(0xb5)],_0x20f743[_0x3b81a4(0xe3)](require,_0x20f743[_0x3b81a4(0xc6)])[_0x3b81a4(0x13f)],_0x12a32c)['then'](_0x461327=>{const _0xcb70de=_0x3b81a4;return _0x266d86[_0xcb70de(0xf8)](),_0x461327;}),_0x266d86]);_0x4c4afb['isHealingEnabled']=_0x20f743[_0x3b81a4(0xc9)](_0x4c4afb[_0x3b81a4(0xd2)],_0x20f743['pkoGm'])||_0x20f743[_0x3b81a4(0xc9)](_0x4c4afb[_0x3b81a4(0xd2)],!![]);const _0x352e50=_0x20f743['nQcze'](this[_0x3b81a4(0x100)]['selfHeal'],!![])||_0x20f743[_0x3b81a4(0x18c)](this['config']['selfHeal'],_0x20f743[_0x3b81a4(0x177)]);if(_0x20f743['rQSMX'](_0x4c4afb[_0x3b81a4(0xdb)],constants[_0x3b81a4(0x1a3)])&&_0x352e50)logger[_0x3b81a4(0xde)](_0x20f743[_0x3b81a4(0xbd)]);else{if(!_0x4c4afb[_0x3b81a4(0xc2)]&&_0x20f743[_0x3b81a4(0x183)](_0x4c4afb[_0x3b81a4(0x150)],0x1f7)&&_0x352e50)logger['info'](_0x20f743['cooBH']),utilities[_0x3b81a4(0x142)](constants[_0x3b81a4(0xd3)],_0x431231,this[_0x3b81a4(0x100)],this['framework']);else{if(!_0x4c4afb['isAuthenticated']&&_0x352e50){logger[_0x3b81a4(0xde)](_0x20f743[_0x3b81a4(0x18f)]);const _0x5a93fb={'tcgUrl':constants['TCG_URL'],'sdkVersion':_0x20f743[_0x3b81a4(0x10a)](require,_0x20f743[_0x3b81a4(0xc6)])[_0x3b81a4(0x13f)],'methodUsed':_0x20f743['vkSoJ'],'proxyConfig':_0x4a2fdf,'os':os[_0x3b81a4(0x19a)]()};utilities[_0x3b81a4(0x142)](constants['TCG_AUTH_FAILURE'],_0x5a93fb,this['config'],this[_0x3b81a4(0x110)]);}else{if(_0x4c4afb[_0x3b81a4(0xc2)]&&!_0x4c4afb[_0x3b81a4(0xd2)]&&_0x352e50)logger[_0x3b81a4(0xde)](_0x20f743[_0x3b81a4(0x165)]);else{if(_0x20f743[_0x3b81a4(0x16e)](_0x4c4afb[_0x3b81a4(0x150)],0xc8)&&_0x20f743[_0x3b81a4(0x13e)](_0x4c4afb[_0x3b81a4(0x150)],0x12c))utilities[_0x3b81a4(0x142)](constants[_0x3b81a4(0xea)],_0x431231,this[_0x3b81a4(0x100)],this['framework']);else{if(_0x20f743['hnOBi'](_0x4c4afb[_0x3b81a4(0x150)],0x190))_0x431231[_0x3b81a4(0x150)]=_0x4c4afb[_0x3b81a4(0x150)],utilities[_0x3b81a4(0x142)](constants[_0x3b81a4(0x11d)],_0x431231,this[_0x3b81a4(0x100)],this[_0x3b81a4(0x110)]);else!_0x4c4afb['status']&&utilities['fireFunnelTestEvent'](constants['INVALID_INIT_RESP_WITH_USER_IMPACT'],_0x431231,this['config'],this[_0x3b81a4(0x110)]);}}}}}if(_0x4c4afb[_0x3b81a4(0xc2)]&&_0x4c4afb[_0x3b81a4(0xd2)]){const _0x16c599={};_0x16c599['tcgAuthConfig']=_0x4c4afb;const _0x5e93e1=_0x16c599;_0x4a2fdf&&(_0x5e93e1[_0x3b81a4(0xed)]=_0x4a2fdf),_0x5e93e1['framework']=this[_0x3b81a4(0x110)],_0x5e93e1['bstackConfig']=this[_0x3b81a4(0x100)],helper[_0x3b81a4(0x1a1)](_0x5e93e1),logger[_0x3b81a4(0xb3)](_0x20f743[_0x3b81a4(0x155)]);}}catch(_0x18a057){logger[_0x3b81a4(0xb3)]('Error\x20in\x20setting\x20up\x20tcg\x20authconfig.\x20Error:\x20'+(_0x18a057[_0x3b81a4(0xdb)]?_0x18a057['message']:''));}});await _0x20f743[_0x14e6cc(0x18e)](_0x4e8db5);}[a90_0x12dde3(0xe6)](){const _0x5aba4e=a90_0x12dde3,_0x375c5c={'gAGex':function(_0x3e3746,_0x2d5fba){return _0x3e3746(_0x2d5fba);},'nxUYh':_0x5aba4e(0x175)};_0x375c5c['gAGex'](require,_0x375c5c[_0x5aba4e(0x113)])();}[a90_0x12dde3(0x124)](){const _0x5494b8=a90_0x12dde3,_0x1fcebf={};_0x1fcebf[_0x5494b8(0xc7)]=_0x5494b8(0x168),_0x1fcebf['lLojI']='uncaughtException';const _0xf3d794=_0x1fcebf,_0x22796f=_0x387d3c=>{const _0x194245=_0x5494b8;logger[_0x194245(0xcc)](_0x387d3c[_0x194245(0xdb)]),logger[_0x194245(0xb3)](util[_0x194245(0x188)](_0x387d3c)),this['unhandledErrors'][_0x194245(0x171)](util['format']('%j',_0x387d3c)),PerformanceTester[_0x194245(0x195)](_0x387d3c);};process['on'](_0xf3d794[_0x5494b8(0xc7)],_0x22796f),process['on'](_0xf3d794[_0x5494b8(0x15b)],_0x22796f);}async[a90_0x12dde3(0x130)](_0x18041f){const _0xefd4b1=a90_0x12dde3,_0x2c560c={};_0x2c560c[_0xefd4b1(0xec)]=_0xefd4b1(0xb0),_0x2c560c[_0xefd4b1(0xcb)]=function(_0x15df24,_0x1779ad){return _0x15df24+_0x1779ad;},_0x2c560c[_0xefd4b1(0xff)]=_0xefd4b1(0x135),_0x2c560c[_0xefd4b1(0x19b)]=_0xefd4b1(0x17e),_0x2c560c[_0xefd4b1(0xe9)]=function(_0x250832,_0x15c42c){return _0x250832+_0x15c42c;};const _0x265644=_0x2c560c,_0x490393=_0x265644[_0xefd4b1(0xec)][_0xefd4b1(0x17d)]('|');let _0xe28719=0x0;while(!![]){switch(_0x490393[_0xe28719++]){case'0':if(this[_0x265644[_0xefd4b1(0xcb)](_0x265644['aCdbX'],_0x18041f)])return;continue;case'1':await BrowserstackCLI[_0xefd4b1(0xd6)]()[_0xefd4b1(0x166)]();continue;case'2':this[_0xefd4b1(0x15e)]=_0x18041f;continue;case'3':logger[_0xefd4b1(0xde)](_0x265644[_0xefd4b1(0xcb)](_0x265644['TJOsn'],_0x18041f));continue;case'4':await TestHubHandler[_0xefd4b1(0x166)](_0x18041f);continue;case'5':this[_0x265644[_0xefd4b1(0xe9)](_0x265644[_0xefd4b1(0xff)],_0x18041f)]=!![];continue;}break;}}[a90_0x12dde3(0x139)](){const _0x5ef813={'sOptH':function(_0x5943f9,_0xf7bdef){return _0x5943f9===_0xf7bdef;},'MesJl':'Calling\x20Build\x20Stop\x20from\x20ExitHandler','KkGTU':function(_0x477bcc,_0x434581){return _0x477bcc>_0x434581;},'kgfXl':function(_0x4a84c1,_0x576f32){return _0x4a84c1>_0x576f32;},'YSxwZ':function(_0xb25a3f,_0x39619c){return _0xb25a3f(_0x39619c);},'IxxhU':function(_0x5bdd08){return _0x5bdd08();},'QfPgt':'events.json'};let _0x5df8e3=0x0;return async()=>{const _0x1167f2=a90_0x9b86;_0x5df8e3++;if(_0x5ef813[_0x1167f2(0x101)](_0x5df8e3,0x1)){helper[_0x1167f2(0x178)](this[_0x1167f2(0x110)])&&await this[_0x1167f2(0x134)]();try{logger[_0x1167f2(0xb3)](_0x5ef813[_0x1167f2(0x125)]),await TestHubHandler['stop'](_0x5df8e3),await BrowserstackCLI[_0x1167f2(0xd6)]()[_0x1167f2(0x166)]('1');}catch(_0x3bf809){logger[_0x1167f2(0xb3)](_0x1167f2(0x129)+util[_0x1167f2(0x188)](_0x3bf809));}PerformanceTester[_0x1167f2(0x143)](PerformanceEvents[_0x1167f2(0x16a)]);if(PerformanceTester['isEnabled']()){const {measures:_0x2b472d,errors:_0x2ed79a}=await PerformanceTester[_0x1167f2(0xc8)](),_0x2793c4={};if(_0x2b472d&&_0x5ef813[_0x1167f2(0x167)](_0x2b472d[_0x1167f2(0xfb)],0x0)||_0x2ed79a&&_0x5ef813[_0x1167f2(0x161)](_0x2ed79a[_0x1167f2(0xfb)],0x0)){const _0x128963={};_0x128963['measures']=_0x2b472d,_0x128963[_0x1167f2(0x174)]=_0x2ed79a,Object[_0x1167f2(0x112)](_0x2793c4,_0x128963);}try{const _0x3ec623=await helper[_0x1167f2(0xe1)](_0x2793c4,this[_0x1167f2(0x100)]);logger[_0x1167f2(0xb3)]('Data\x20sent\x20successfully\x20to\x20'+_0x5ef813[_0x1167f2(0x13b)](getEdsInstrumentationAPIUrl,'')+_0x1167f2(0xcf)+_0x3ec623[_0x1167f2(0xe8)]);}catch(_0x5d9e36){logger['debug'](_0x1167f2(0x176)+_0x5ef813[_0x1167f2(0x13b)](getEdsInstrumentationAPIUrl,'')+_0x1167f2(0xfc)+util[_0x1167f2(0x188)](_0x5d9e36));}try{fs[_0x1167f2(0x11c)](path['join'](_0x5ef813[_0x1167f2(0xbc)](getLogDir),_0x5ef813[_0x1167f2(0xfe)]),JSON['stringify'](_0x2793c4));}catch(_0x4672){logger['debug'](_0x1167f2(0x111)+_0x4672);}}}logger&&logger[_0x1167f2(0x16d)](),fileLogger&&fileLogger['close']();};}}exports['default']=BrowserStackSetup;function a90_0x5756(){const _0x46dae5=['nxUYh','NWFoB','MHIxS','ijYip','SIGBREAK','cliConfig','setEnvCaps','WZwjF','toString','writeFileSync','AI_INIT_FAILURE','userName','AUTOLOGCAPTURE_NOTIFICATION','?caps=','WXfoK','stopLocalBinary','./utilities','handleExceptions','MesJl','SIGQUIT','anqzl','setUpHubUrl','Error\x20in\x20sending\x20testhub\x20stop:\x20','hubUrl','./helper','userName\x20or\x20accessKey\x20is\x20not\x20defined','HYDzU','forceLocal','pKFKQ','intExitHandler','stopPercy','TCG_AUTH_TIMEOUT','aiHeal:tcgAuth','stopBrowserstackLocal','handled','../bin/utils/constants','SIGTERM','percy','exitHandler','Could\x20not\x20start\x20percy,\x20check\x20percy\x20logs\x20for\x20info.','YSxwZ','getCentralUser','getTurboScaleGridDetails','QAMVL','version','allocateHub','../hubAllocationMethods','fireFunnelTestEvent','end','No\x20config\x20provided.','turboScale','MllOJ','proxyUrl','1432286CwihUS','SIGHUP','vgyYi','includes','FGieB','util','toLowerCase','envConfig','status','ats-repeater','cChwC','frHQD','Authentication\x20Failed.\x20Disabling\x20Healing\x20for\x20this\x20session.','nMAEN','hBgxu','Few\x20SDK\x20features\x20were\x20not\x20activated\x20as\x20platforms\x20object\x20was\x20not\x20defined','Local\x20binary\x20not\x20started\x20as\x20skipBinaryInitialisation\x20is\x20enabled','getConfigPath','Healing\x20is\x20not\x20enabled\x20for\x20your\x20group,\x20please\x20contact\x20the\x20admin','lLojI','sanitizeCaps','central_scanner','killSignal','isRunning','setLogLevel','kgfXl','join','Error\x20occured\x20while\x20stopping\x20local\x20binary','getProxyConfigForTcg','KdKqA','stop','KkGTU','unhandledRejection','4.5.0','SDK_CLEANUP','AtvmV','setupBrowserstackLocal','close','hnOBi','custom-repeater','getUserName','push','normalizeTestReportingEnvVars','SDK\x20run\x20started\x20with\x20id:\x20','exceptions','./setKeepAlive','Failed\x20to\x20send\x20data\x20to\x20','pkoGm','checkStopLocalBinaryOnExit','OpkHm','true','isBrowserstackInfra','MWWVq','split','Shutdown\x20triggered\x20by\x20','Local\x20binary\x20stopped','bFFHf','sdkRunId','getHubUrl','hJsQs','localOptions','isTurboScaleSession','platforms','tCqVD','format','ftyRr','requireSeleniumWebdriverCheck','CFdtc','rQSMX','PvcoW','dHrBG','mLvlc','pQsSZ','HGxKd','env','measureWrapper','generateLocalIdentifier','captureError','3433684FzVLGG','vkSoJ','false','isTrue','platform','TJOsn','./percy/utils','skipSessionName','playwright','Percy\x20started\x20successfully','browserstackLocal','setupTcgConfigFile','localIdentifier','UPGRADE_REQUIRED','gcoWY','getPackageVersion','parallelsPerPlatform','2678226iUvsCj','458184BQAems','winstonLogger','0|5|3|2|4|1','xJvgW','setBrowserstackInfraFromConfig','debug','leRHf','TCG_URL','warn','BrowserstackHealing.init','unhandledErrors','BrowserstackHealing.init\x20method\x20timed\x20out','init','HUB\x20URL\x20SET\x20TO\x20TurboScale\x20HUB\x20-\x20','IxxhU','WAtFz','integrations','isUndefined','FRAMEWORK','riEMs','isAuthenticated','getAccessKey','setCLICaps','GGVrj','BUnAr','TgUeC','finalize','nQcze','SDKTestAttempted','pKVVU','error','eHAUc','isNotUndefined','\x20with\x20response\x20','12281336QfRflD','accessKey','isHealingEnabled','TCG_DOWN','Error\x20in\x20Fire\x20SDKTestAttempted.\x20Stacktrace:\x20','turboScaleUrl','getInstance','Error\x20occured\x20while\x20stopping\x20percy','1241014kFgsxb','Local\x20binary\x20started\x20successfully','parallelsPerPlatform\x20was\x20ignored\x20as\x20platforms\x20object\x20was\x20not\x20defined','message','ctIIA','skipBinaryInitialisation','info','YqbyB','customRepeaters','sendToEDS','21|8|9|22|2|7|4|17|11|16|18|19|20|12|10|3|15|13|0|14|6|5|1','fxQFS','BROWSERSTACK_PERCY','startLocalBinary','setupKeepAlive','readConfig','statusCode','PkPrg','AI_INIT_SUCCESSFUL','./logger','hjOmx','proxyConfig','preInitialize','getLocalIdentifier','AI_PROXY_FAILURE','../ai-sdk-node/bundle','SIGABRT','./performance/constants','setHandlePWError','setCredentialsFromYmlConfig','turboScaleOptions','5qMjplr','cancel','startMonitoring','errorMessage','length','\x20with\x20error\x20','xfrBZ','QfPgt','aCdbX','config','sOptH','./timeoutPromise','useW3C','2925216ubbpvN','setProxySettings','BROWSERSTACK_TURBOSCALE','OzvOH','testContextOptions','initialize','iZgju','TasHT','tPkld','HLJQH','skipSessionStatus','browserStackLocalOptions','framework','Error\x20in\x20writing\x20events\x20to\x20file\x20','assign'];a90_0x5756=function(){return _0x46dae5;};return a90_0x5756();}