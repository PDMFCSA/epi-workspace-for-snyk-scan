#!/usr/bin/env node
'use strict';function a27_0x15ef(_0x5e7ab9,_0x3f1741){const _0xb6151f=a27_0xb615();return a27_0x15ef=function(_0x15ef69,_0x229991){_0x15ef69=_0x15ef69-0x144;let _0x264f5a=_0xb6151f[_0x15ef69];return _0x264f5a;},a27_0x15ef(_0x5e7ab9,_0x3f1741);}const a27_0x561d4a=a27_0x15ef;(function(_0x2a6ff0,_0x1c202c){const _0x4c8676=a27_0x15ef,_0x4d743f=_0x2a6ff0();while(!![]){try{const _0x3b73a9=-parseInt(_0x4c8676(0x151))/0x1*(-parseInt(_0x4c8676(0x17c))/0x2)+-parseInt(_0x4c8676(0x14a))/0x3+parseInt(_0x4c8676(0x178))/0x4*(-parseInt(_0x4c8676(0x149))/0x5)+parseInt(_0x4c8676(0x150))/0x6*(-parseInt(_0x4c8676(0x15d))/0x7)+parseInt(_0x4c8676(0x180))/0x8+-parseInt(_0x4c8676(0x186))/0x9*(-parseInt(_0x4c8676(0x16d))/0xa)+parseInt(_0x4c8676(0x15a))/0xb*(parseInt(_0x4c8676(0x185))/0xc);if(_0x3b73a9===_0x1c202c)break;else _0x4d743f['push'](_0x4d743f['shift']());}catch(_0x5ba419){_0x4d743f['push'](_0x4d743f['shift']());}}}(a27_0xb615,0x36815));const {spawn}=require('child_process'),path=require(a27_0x561d4a(0x16b)),helper=require(a27_0x561d4a(0x158)),CLIUtils=require(a27_0x561d4a(0x166)),{getLoadConfigPath,sleep}=require(a27_0x561d4a(0x146)),logger=require(a27_0x561d4a(0x153))[a27_0x561d4a(0x14f)];function a27_0xb615(){const _0x126ee3=['Authentication\x20incomplete.\x20Please\x20add\x20your\x20userName\x20and\x20accessKey\x20to\x20either\x20the\x20browserstack.yml\x20file\x20or\x20as\x20environment\x20variables,\x20then\x20try\x20running\x20the\x20command\x20again.','debug','Failed\x20to\x20download\x20or\x20locate\x20CLI\x20binary','1883688kWvIlP','2149533zWpjBw','CLI\x20binary\x20not\x20found,\x20downloading\x20latest\x20version','nXKtz','./loadUtils','message','SIGQUIT','815myVWKZ','824859yMfArd','inherit','\x20load\x20','fsJVH','slice','winstonLogger','6redbDm','60139gSgTUi','uwRhZ','../../helpers/logger','stack','BROWSERSTACK_USER','SIGTERM','SRYzs','../../helpers/helper','gZLYW','11ZHHoef','BROWSERSTACK_ACCESS_KEY','oWUpA','837326XpoevL','SIGINT','MHdZt','Ndvmq','close','userName','Error\x20loading\x20configuration:\x20','Spawning:\x20','YhIzC','../v2/cliUtils','FluAa','killed','vlWxb','exports','path','Error\x20Details:\x20','10gynvTh','env','join','exit','argv','Error\x20details:\x20','\x20exited\x20with\x20code\x20','load','kill','error','CLI\x20binary\x20found,\x20Checking\x20for\x20CLI\x20updates','4308PTVGYv','accessKey','Failed\x20initiating\x20load\x20test:\x20','BROWSERSTACK_USERNAME','12hufbNg','UaPhI','stringify','BROWSERSTACK_ACCESSKEY','293840RCULQq','Waiting\x20for\x20child\x20process\x20to\x20exit...'];a27_0xb615=function(){return _0x126ee3;};return a27_0xb615();}async function executeLoadTest(_0x4de24a){const _0x3071bd=a27_0x561d4a,_0x398de4={'SRYzs':function(_0x185af4,_0xec9c39){return _0x185af4(_0xec9c39);},'oVOIZ':_0x3071bd(0x161),'AKrlp':_0x3071bd(0x181),'Gqllb':'Loading\x20configuration\x20using\x20environment\x20variables\x20if\x20available.','YhIzC':function(_0xe88603){return _0xe88603();},'MHdZt':_0x3071bd(0x182),'XEGpa':'Failed\x20to\x20determine\x20CLI\x20directory','FluAa':function(_0x525b4e){return _0x525b4e();},'oWUpA':_0x3071bd(0x144),'dpVFg':_0x3071bd(0x177),'nXKtz':_0x3071bd(0x184),'uwRhZ':function(_0x1a0624,_0xe18b35,_0x2f2478,_0x2b6a59){return _0x1a0624(_0xe18b35,_0x2f2478,_0x2b6a59);},'PCscx':_0x3071bd(0x174),'gaVyu':_0x3071bd(0x14b),'Ndvmq':_0x3071bd(0x15e),'fsJVH':_0x3071bd(0x156),'vIgEk':_0x3071bd(0x148),'vlWxb':'SIGHUP','gZLYW':function(_0x512692){return _0x512692();}};try{const _0x35e56b=process[_0x3071bd(0x171)][_0x3071bd(0x14e)](0x2),_0x2d471e=_0x35e56b['slice'](0x1);logger['debug']('Executing\x20load\x20test\x20with\x20arguments:\x20'+_0x2d471e);let _0x2f680d={};try{logger[_0x3071bd(0x183)](_0x398de4['Gqllb']);const _0x1db440={};_0x1db440[_0x3071bd(0x162)]=process[_0x3071bd(0x16e)][_0x3071bd(0x17b)]||process[_0x3071bd(0x16e)][_0x3071bd(0x155)],_0x1db440[_0x3071bd(0x179)]=process[_0x3071bd(0x16e)][_0x3071bd(0x15b)]||process[_0x3071bd(0x16e)][_0x3071bd(0x17f)],_0x2f680d=_0x1db440;if(!_0x2f680d[_0x3071bd(0x162)]||!_0x2f680d[_0x3071bd(0x179)]){const _0x5979db=_0x398de4[_0x3071bd(0x157)](getLoadConfigPath,_0x4de24a[_0x3071bd(0x171)]);logger[_0x3071bd(0x183)]('Configuration\x20path:\x20'+_0x5979db),_0x5979db&&(_0x2f680d=helper['readConfig'](_0x5979db));}}catch(_0x54be33){logger[_0x3071bd(0x176)](_0x3071bd(0x163)+_0x54be33[_0x3071bd(0x147)]),logger[_0x3071bd(0x183)](_0x3071bd(0x172)+(_0x54be33[_0x3071bd(0x154)]||JSON[_0x3071bd(0x17e)](_0x54be33))),await _0x398de4['YhIzC'](sleep),process[_0x3071bd(0x170)](0x1);}(!_0x2f680d['userName']||!_0x2f680d[_0x3071bd(0x179)])&&(logger[_0x3071bd(0x176)](_0x398de4[_0x3071bd(0x15f)]),await _0x398de4[_0x3071bd(0x165)](sleep),process[_0x3071bd(0x170)](0x1));const _0x345684=CLIUtils['getCliDir']();!_0x345684&&(logger[_0x3071bd(0x176)](_0x398de4['XEGpa']),await _0x398de4[_0x3071bd(0x167)](sleep),process[_0x3071bd(0x170)](0x1));let _0x5bb902=CLIUtils['getExistingCliPath'](_0x345684);try{!_0x5bb902?(logger['debug'](_0x398de4[_0x3071bd(0x15c)]),_0x5bb902=await CLIUtils['checkAndUpdateCli']('',_0x345684,_0x2f680d)):(logger['debug'](_0x398de4['dpVFg']),_0x5bb902=await CLIUtils['checkAndUpdateCli'](_0x5bb902,_0x345684,_0x2f680d));}catch(_0x3583ef){logger['error'](_0x398de4[_0x3071bd(0x15f)]),logger[_0x3071bd(0x183)](_0x3071bd(0x16c)+(_0x3583ef[_0x3071bd(0x154)]||JSON[_0x3071bd(0x17e)](_0x3583ef))),await _0x398de4[_0x3071bd(0x165)](sleep),process[_0x3071bd(0x170)](0x1);}!_0x5bb902&&(logger['error'](_0x398de4[_0x3071bd(0x15f)]),logger['debug'](_0x398de4[_0x3071bd(0x145)]),await _0x398de4[_0x3071bd(0x165)](sleep),process[_0x3071bd(0x170)](0x1));logger[_0x3071bd(0x183)](_0x3071bd(0x164)+_0x5bb902+_0x3071bd(0x14c)+_0x2d471e[_0x3071bd(0x16f)]('\x20'));const _0x11526f=_0x398de4[_0x3071bd(0x152)](spawn,_0x5bb902,[_0x398de4['PCscx'],..._0x2d471e],{'stdio':_0x398de4['gaVyu']});let _0x54a18c=![];const _0x5141d6=new Promise(_0x3b2eda=>{_0x11526f['on'](_0x398de4['oVOIZ'],_0xf3c7ab=>{const _0x17a0cb=a27_0x15ef;logger[_0x17a0cb(0x183)](_0x5bb902+_0x17a0cb(0x173)+_0xf3c7ab),_0x398de4[_0x17a0cb(0x157)](_0x3b2eda,_0xf3c7ab);});});[_0x398de4[_0x3071bd(0x160)],_0x398de4[_0x3071bd(0x14d)],_0x398de4['vIgEk'],_0x398de4[_0x3071bd(0x169)]]['forEach'](_0x2c2a7b=>{const _0x365139=_0x3071bd,_0x42cf9d={};_0x42cf9d[_0x365139(0x17d)]=_0x398de4['AKrlp'];const _0x20d245=_0x42cf9d;process['on'](_0x2c2a7b,()=>{const _0x56ed86=_0x365139;if(_0x54a18c)return;_0x54a18c=!![],logger[_0x56ed86(0x183)]('Received\x20'+_0x2c2a7b+',\x20forwarding\x20to\x20child\x20process...'),_0x11526f&&!_0x11526f[_0x56ed86(0x168)]&&(_0x11526f[_0x56ed86(0x175)](_0x2c2a7b),logger[_0x56ed86(0x183)](_0x20d245[_0x56ed86(0x17d)]));});});const _0xe591bc=await _0x5141d6;await _0x398de4['YhIzC'](sleep),process[_0x3071bd(0x170)](_0xe591bc);}catch(_0x573388){logger[_0x3071bd(0x176)](_0x3071bd(0x17a)+_0x573388[_0x3071bd(0x147)]),logger[_0x3071bd(0x183)](_0x3071bd(0x172)+(_0x573388[_0x3071bd(0x154)]||JSON[_0x3071bd(0x17e)](_0x573388))),await _0x398de4[_0x3071bd(0x159)](sleep),process[_0x3071bd(0x170)](0x1);}}module[a27_0x561d4a(0x16a)]=executeLoadTest;