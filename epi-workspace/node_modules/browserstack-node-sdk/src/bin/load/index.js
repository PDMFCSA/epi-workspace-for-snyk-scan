#!/usr/bin/env node
'use strict';function a27_0x2818(){const _0x19013c=['Configuration\x20path:\x20','env','debug','winstonLogger','gBPdT','560cWGjjd','slice','CLI\x20binary\x20not\x20found,\x20downloading\x20latest\x20version','exit',',\x20forwarding\x20to\x20child\x20process...','accessKey','hghvf','getExistingCliPath','Error\x20details:\x20','Failed\x20to\x20download\x20or\x20locate\x20CLI\x20binary','getCliDir','avCbL','Error\x20loading\x20configuration:\x20','78zzHrHt','error','vaHQB','exports','BROWSERSTACK_USER','BDHzy','inherit','checkAndUpdateCli','SIGHUP','KDXYu','userName','readConfig','1zZBEgw','zHyPS','5931lESZOu','8YuRmIb','101930WLPKnt','path','Spawning:\x20','tDwqU','BROWSERSTACK_USERNAME','close','message','Waiting\x20for\x20child\x20process\x20to\x20exit...','Received\x20','stack','cMeFq','join','killed','8eZIpeQ','Authentication\x20incomplete.\x20Please\x20add\x20your\x20userName\x20and\x20accessKey\x20to\x20either\x20the\x20browserstack.yml\x20file\x20or\x20as\x20environment\x20variables,\x20then\x20try\x20running\x20the\x20command\x20again.','load','2243494BQrRtM','RUVPM','Failed\x20initiating\x20load\x20test:\x20','98306IscugD','ezpfJ','264723tWvWTK','94087PetCcT','DigzT','Error\x20Details:\x20','tWayO','Zzunt','argv','Loading\x20configuration\x20using\x20environment\x20variables\x20if\x20available.','1236480IOlerh','stringify','Failed\x20to\x20determine\x20CLI\x20directory','hoyJJ','WHxKN'];a27_0x2818=function(){return _0x19013c;};return a27_0x2818();}function a27_0x37e9(_0x41e737,_0xc71f75){const _0x28183e=a27_0x2818();return a27_0x37e9=function(_0x37e905,_0x5db3e5){_0x37e905=_0x37e905-0x17a;let _0x517000=_0x28183e[_0x37e905];return _0x517000;},a27_0x37e9(_0x41e737,_0xc71f75);}const a27_0x14e3d9=a27_0x37e9;(function(_0x54b2de,_0x264a8e){const _0x442b8c=a27_0x37e9,_0x2767e9=_0x54b2de();while(!![]){try{const _0x43b0de=parseInt(_0x442b8c(0x18b))/0x1*(parseInt(_0x442b8c(0x1a2))/0x2)+parseInt(_0x442b8c(0x1a4))/0x3*(parseInt(_0x442b8c(0x19c))/0x4)+-parseInt(_0x442b8c(0x18f))/0x5*(-parseInt(_0x442b8c(0x17f))/0x6)+-parseInt(_0x442b8c(0x1a5))/0x7*(parseInt(_0x442b8c(0x18e))/0x8)+-parseInt(_0x442b8c(0x18d))/0x9*(parseInt(_0x442b8c(0x1b6))/0xa)+-parseInt(_0x442b8c(0x19f))/0xb+-parseInt(_0x442b8c(0x1ac))/0xc;if(_0x43b0de===_0x264a8e)break;else _0x2767e9['push'](_0x2767e9['shift']());}catch(_0x1fcbb4){_0x2767e9['push'](_0x2767e9['shift']());}}}(a27_0x2818,0x208c2));const {spawn}=require('child_process'),path=require(a27_0x14e3d9(0x190)),helper=require('../../helpers/helper'),CLIUtils=require('../v2/cliUtils'),{getLoadConfigPath,sleep}=require('./loadUtils'),logger=require('../../helpers/logger')[a27_0x14e3d9(0x1b4)];async function executeLoadTest(_0x3b4668){const _0x471c3e=a27_0x14e3d9,_0x488935={'KDXYu':function(_0x420f6a,_0x483586){return _0x420f6a(_0x483586);},'WHxKN':_0x471c3e(0x194),'gBPdT':_0x471c3e(0x196),'hoyJJ':_0x471c3e(0x1ab),'avCbL':function(_0x24d189,_0x559d80){return _0x24d189(_0x559d80);},'zHyPS':function(_0x2044c4){return _0x2044c4();},'vaHQB':_0x471c3e(0x19d),'uuOoe':_0x471c3e(0x1ae),'hghvf':function(_0x536aff){return _0x536aff();},'ezpfJ':_0x471c3e(0x1b8),'OyySp':'CLI\x20binary\x20found,\x20Checking\x20for\x20CLI\x20updates','QlqYg':function(_0x99d759){return _0x99d759();},'lljQR':_0x471c3e(0x17b),'DigzT':function(_0x44c370,_0x62998d,_0x51928d,_0x4f74a2){return _0x44c370(_0x62998d,_0x51928d,_0x4f74a2);},'cMeFq':_0x471c3e(0x19e),'BDHzy':_0x471c3e(0x185),'tWayO':'SIGINT','XBKmw':'SIGTERM','Zzunt':'SIGQUIT','RUVPM':_0x471c3e(0x187),'eXgoL':function(_0x2c0be1){return _0x2c0be1();}};try{const _0x162025=process[_0x471c3e(0x1aa)][_0x471c3e(0x1b7)](0x2),_0x585ff2=_0x162025[_0x471c3e(0x1b7)](0x1);logger[_0x471c3e(0x1b3)]('Executing\x20load\x20test\x20with\x20arguments:\x20'+_0x585ff2);let _0x1f1305={};try{logger[_0x471c3e(0x1b3)](_0x488935[_0x471c3e(0x1af)]);const _0x194578={};_0x194578['userName']=process[_0x471c3e(0x1b2)][_0x471c3e(0x193)]||process[_0x471c3e(0x1b2)][_0x471c3e(0x183)],_0x194578[_0x471c3e(0x1bb)]=process[_0x471c3e(0x1b2)]['BROWSERSTACK_ACCESS_KEY']||process[_0x471c3e(0x1b2)]['BROWSERSTACK_ACCESSKEY'],_0x1f1305=_0x194578;if(!_0x1f1305['userName']||!_0x1f1305[_0x471c3e(0x1bb)]){const _0x1d2a4a=_0x488935[_0x471c3e(0x17d)](getLoadConfigPath,_0x3b4668[_0x471c3e(0x1aa)]);logger[_0x471c3e(0x1b3)](_0x471c3e(0x1b1)+_0x1d2a4a),_0x1d2a4a&&(_0x1f1305=helper[_0x471c3e(0x18a)](_0x1d2a4a));}}catch(_0x4f0ae8){logger['error'](_0x471c3e(0x17e)+_0x4f0ae8[_0x471c3e(0x195)]),logger[_0x471c3e(0x1b3)](_0x471c3e(0x17a)+(_0x4f0ae8[_0x471c3e(0x198)]||JSON[_0x471c3e(0x1ad)](_0x4f0ae8))),await _0x488935[_0x471c3e(0x18c)](sleep),process['exit'](0x1);}(!_0x1f1305[_0x471c3e(0x189)]||!_0x1f1305['accessKey'])&&(logger[_0x471c3e(0x180)](_0x488935['vaHQB']),await _0x488935[_0x471c3e(0x18c)](sleep),process[_0x471c3e(0x1b9)](0x1));const _0x5ab8fa=CLIUtils[_0x471c3e(0x17c)]();!_0x5ab8fa&&(logger['error'](_0x488935['uuOoe']),await _0x488935['hghvf'](sleep),process['exit'](0x1));let _0x537555=CLIUtils[_0x471c3e(0x1bd)](_0x5ab8fa);try{!_0x537555?(logger['debug'](_0x488935[_0x471c3e(0x1a3)]),_0x537555=await CLIUtils['checkAndUpdateCli']('',_0x5ab8fa,_0x1f1305)):(logger[_0x471c3e(0x1b3)](_0x488935['OyySp']),_0x537555=await CLIUtils[_0x471c3e(0x186)](_0x537555,_0x5ab8fa,_0x1f1305));}catch(_0x38f21d){logger[_0x471c3e(0x180)](_0x488935[_0x471c3e(0x181)]),logger[_0x471c3e(0x1b3)](_0x471c3e(0x1a7)+(_0x38f21d[_0x471c3e(0x198)]||JSON[_0x471c3e(0x1ad)](_0x38f21d))),await _0x488935['QlqYg'](sleep),process[_0x471c3e(0x1b9)](0x1);}!_0x537555&&(logger[_0x471c3e(0x180)](_0x488935['vaHQB']),logger['debug'](_0x488935['lljQR']),await _0x488935[_0x471c3e(0x1bc)](sleep),process['exit'](0x1));logger['debug'](_0x471c3e(0x191)+_0x537555+'\x20load\x20'+_0x585ff2[_0x471c3e(0x19a)]('\x20'));const _0x4d8f1e=_0x488935[_0x471c3e(0x1a6)](spawn,_0x537555,[_0x488935[_0x471c3e(0x199)],..._0x585ff2],{'stdio':_0x488935[_0x471c3e(0x184)]});let _0x1f4de5=![];const _0x39705a=new Promise(_0xeb45e1=>{const _0x3b5fa9=_0x471c3e,_0x5e423b={'yBrHN':function(_0x590426,_0x3c0157){const _0x297e3a=a27_0x37e9;return _0x488935[_0x297e3a(0x188)](_0x590426,_0x3c0157);}};_0x4d8f1e['on'](_0x488935[_0x3b5fa9(0x1b0)],_0x1afbea=>{const _0x4479b5=_0x3b5fa9;logger[_0x4479b5(0x1b3)](_0x537555+'\x20exited\x20with\x20code\x20'+_0x1afbea),_0x5e423b['yBrHN'](_0xeb45e1,_0x1afbea);});});[_0x488935[_0x471c3e(0x1a8)],_0x488935['XBKmw'],_0x488935[_0x471c3e(0x1a9)],_0x488935[_0x471c3e(0x1a0)]]['forEach'](_0x47db96=>{const _0x1f976e=_0x471c3e,_0x2194c7={};_0x2194c7[_0x1f976e(0x192)]=_0x488935[_0x1f976e(0x1b5)];const _0x152d70=_0x2194c7;process['on'](_0x47db96,()=>{const _0x47eb94=_0x1f976e;if(_0x1f4de5)return;_0x1f4de5=!![],logger['debug'](_0x47eb94(0x197)+_0x47db96+_0x47eb94(0x1ba)),_0x4d8f1e&&!_0x4d8f1e[_0x47eb94(0x19b)]&&(_0x4d8f1e['kill'](_0x47db96),logger[_0x47eb94(0x1b3)](_0x152d70[_0x47eb94(0x192)]));});});const _0x238459=await _0x39705a;await _0x488935['zHyPS'](sleep),process[_0x471c3e(0x1b9)](_0x238459);}catch(_0x4f0f0c){logger[_0x471c3e(0x180)](_0x471c3e(0x1a1)+_0x4f0f0c[_0x471c3e(0x195)]),logger[_0x471c3e(0x1b3)]('Error\x20details:\x20'+(_0x4f0f0c[_0x471c3e(0x198)]||JSON[_0x471c3e(0x1ad)](_0x4f0f0c))),await _0x488935['eXgoL'](sleep),process[_0x471c3e(0x1b9)](0x1);}}module[a27_0x14e3d9(0x182)]=executeLoadTest;