#!/usr/bin/env node
'use strict';function a27_0x5a61(_0x2638d5,_0x26ea1f){const _0x1bb02c=a27_0x1bb0();return a27_0x5a61=function(_0x5a6166,_0x12a44d){_0x5a6166=_0x5a6166-0x1c7;let _0x40aeb0=_0x1bb02c[_0x5a6166];return _0x40aeb0;},a27_0x5a61(_0x2638d5,_0x26ea1f);}const a27_0x434a45=a27_0x5a61;(function(_0x347a7b,_0x560fe4){const _0x377132=a27_0x5a61,_0x26188e=_0x347a7b();while(!![]){try{const _0x48950c=-parseInt(_0x377132(0x1cb))/0x1*(parseInt(_0x377132(0x1ce))/0x2)+parseInt(_0x377132(0x1e8))/0x3+parseInt(_0x377132(0x1e6))/0x4+-parseInt(_0x377132(0x1eb))/0x5+-parseInt(_0x377132(0x1cd))/0x6*(-parseInt(_0x377132(0x1c7))/0x7)+-parseInt(_0x377132(0x1fa))/0x8*(-parseInt(_0x377132(0x1ed))/0x9)+-parseInt(_0x377132(0x202))/0xa;if(_0x48950c===_0x560fe4)break;else _0x26188e['push'](_0x26188e['shift']());}catch(_0x198e99){_0x26188e['push'](_0x26188e['shift']());}}}(a27_0x1bb0,0x30131));function a27_0x1bb0(){const _0x920ff5=['AIvbB','VjTIB','path','winstonLogger','lIoBT','argv','664008obivds','IwBXz','664035SgaoNF','SEdWf','../../helpers/helper','667120MZzaYO','SIGTERM','943623LcQrwc','load','jhYmB','Failed\x20initiating\x20load\x20test:\x20','exit','Error\x20loading\x20configuration:\x20','stringify','error','join','BROWSERSTACK_ACCESS_KEY','slice','XgVhj','\x20load\x20','8OmHdMt','inherit','BROWSERSTACK_USERNAME','yhHsp','CLI\x20binary\x20not\x20found,\x20downloading\x20latest\x20version','hEcmg','nTZng','Failed\x20to\x20download\x20or\x20locate\x20CLI\x20binary','2423890eLwwro',',\x20forwarding\x20to\x20child\x20process...','./loadUtils','accessKey','TVDZi','Spawning:\x20','BROWSERSTACK_ACCESSKEY','IOnXO','CLI\x20binary\x20found,\x20Checking\x20for\x20CLI\x20updates','68691zbvXPK','Waiting\x20for\x20child\x20process\x20to\x20exit...','hXhfS','getCliDir','15152RZEGmL','SIGHUP','216usSNpp','36Ijztaa','kill','exports','forEach','agbzF','readConfig','checkAndUpdateCli','env','stack','Error\x20details:\x20','close','Authentication\x20incomplete.\x20Please\x20add\x20your\x20userName\x20and\x20accessKey\x20to\x20either\x20the\x20browserstack.yml\x20file\x20or\x20as\x20environment\x20variables,\x20then\x20try\x20running\x20the\x20command\x20again.','lbVQw','ObbOZ','CgFYI','RkSom','HRhjF','debug'];a27_0x1bb0=function(){return _0x920ff5;};return a27_0x1bb0();}const {spawn}=require('child_process'),path=require(a27_0x434a45(0x1e2)),helper=require(a27_0x434a45(0x1ea)),CLIUtils=require('../v2/cliUtils'),{getLoadConfigPath,sleep}=require(a27_0x434a45(0x204)),logger=require('../../helpers/logger')[a27_0x434a45(0x1e3)];async function executeLoadTest(_0x2b96fb){const _0x281e22=a27_0x434a45,_0x13684a={'TVDZi':function(_0x1b0106,_0x2af290){return _0x1b0106(_0x2af290);},'nLDZF':_0x281e22(0x1d8),'HRhjF':_0x281e22(0x1c8),'lbVQw':'Loading\x20configuration\x20using\x20environment\x20variables\x20if\x20available.','hEcmg':function(_0x5467d8,_0x1640ee){return _0x5467d8(_0x1640ee);},'yhHsp':function(_0x2ff491){return _0x2ff491();},'nTZng':_0x281e22(0x1d9),'ObbOZ':function(_0x41d12b){return _0x41d12b();},'IOnXO':'Failed\x20to\x20determine\x20CLI\x20directory','RkSom':_0x281e22(0x1fe),'CgFYI':_0x281e22(0x20a),'SocgH':function(_0x5628df){return _0x5628df();},'XgVhj':_0x281e22(0x201),'lIoBT':function(_0x40ca92){return _0x40ca92();},'hXhfS':function(_0x1c24a4,_0x29155d,_0x2d2451,_0x375ed9){return _0x1c24a4(_0x29155d,_0x2d2451,_0x375ed9);},'agbzF':_0x281e22(0x1ee),'VjTIB':_0x281e22(0x1fb),'AIvbB':'SIGINT','sCiMV':_0x281e22(0x1ec),'SEdWf':'SIGQUIT','lrfxy':_0x281e22(0x1cc),'jhYmB':function(_0x3d8943){return _0x3d8943();}};try{const _0x4b27a4=process[_0x281e22(0x1e5)]['slice'](0x2),_0xfd8744=_0x4b27a4[_0x281e22(0x1f7)](0x1);logger[_0x281e22(0x1df)]('Executing\x20load\x20test\x20with\x20arguments:\x20'+_0xfd8744);let _0x3ee627={};try{logger[_0x281e22(0x1df)](_0x13684a[_0x281e22(0x1da)]);const _0x3a5458={};_0x3a5458['userName']=process['env'][_0x281e22(0x1fc)]||process[_0x281e22(0x1d5)]['BROWSERSTACK_USER'],_0x3a5458[_0x281e22(0x205)]=process[_0x281e22(0x1d5)][_0x281e22(0x1f6)]||process[_0x281e22(0x1d5)][_0x281e22(0x208)],_0x3ee627=_0x3a5458;if(!_0x3ee627['userName']||!_0x3ee627[_0x281e22(0x205)]){const _0x49561a=_0x13684a[_0x281e22(0x1ff)](getLoadConfigPath,_0x2b96fb[_0x281e22(0x1e5)]);logger[_0x281e22(0x1df)]('Configuration\x20path:\x20'+_0x49561a),_0x49561a&&(_0x3ee627=helper[_0x281e22(0x1d3)](_0x49561a));}}catch(_0x3db7c0){logger[_0x281e22(0x1f4)](_0x281e22(0x1f2)+_0x3db7c0['message']),logger[_0x281e22(0x1df)](_0x281e22(0x1d7)+(_0x3db7c0[_0x281e22(0x1d6)]||JSON[_0x281e22(0x1f3)](_0x3db7c0))),await _0x13684a[_0x281e22(0x1fd)](sleep),process[_0x281e22(0x1f1)](0x1);}(!_0x3ee627['userName']||!_0x3ee627['accessKey'])&&(logger['error'](_0x13684a[_0x281e22(0x200)]),await _0x13684a[_0x281e22(0x1db)](sleep),process[_0x281e22(0x1f1)](0x1));const _0xf81334=CLIUtils[_0x281e22(0x1ca)]();!_0xf81334&&(logger[_0x281e22(0x1f4)](_0x13684a[_0x281e22(0x209)]),await _0x13684a[_0x281e22(0x1db)](sleep),process['exit'](0x1));let _0x26a9d1=CLIUtils['getExistingCliPath'](_0xf81334);try{!_0x26a9d1?(logger[_0x281e22(0x1df)](_0x13684a[_0x281e22(0x1dd)]),_0x26a9d1=await CLIUtils[_0x281e22(0x1d4)]('',_0xf81334,_0x3ee627)):(logger[_0x281e22(0x1df)](_0x13684a[_0x281e22(0x1dc)]),_0x26a9d1=await CLIUtils[_0x281e22(0x1d4)](_0x26a9d1,_0xf81334,_0x3ee627));}catch(_0x1f1323){logger[_0x281e22(0x1f4)](_0x13684a[_0x281e22(0x200)]),logger['debug']('Error\x20Details:\x20'+(_0x1f1323[_0x281e22(0x1d6)]||JSON['stringify'](_0x1f1323))),await _0x13684a['SocgH'](sleep),process[_0x281e22(0x1f1)](0x1);}!_0x26a9d1&&(logger[_0x281e22(0x1f4)](_0x13684a[_0x281e22(0x200)]),logger[_0x281e22(0x1df)](_0x13684a[_0x281e22(0x1f8)]),await _0x13684a[_0x281e22(0x1e4)](sleep),process[_0x281e22(0x1f1)](0x1));logger[_0x281e22(0x1df)](_0x281e22(0x207)+_0x26a9d1+_0x281e22(0x1f9)+_0xfd8744[_0x281e22(0x1f5)]('\x20'));const _0x5b4f95=_0x13684a[_0x281e22(0x1c9)](spawn,_0x26a9d1,[_0x13684a[_0x281e22(0x1d2)],..._0xfd8744],{'stdio':_0x13684a[_0x281e22(0x1e1)]});let _0x5e3cf3=![];const _0x309b29=new Promise(_0xf603ae=>{const _0x5654ca={'tOYSr':function(_0x348213,_0x33cda5){const _0x16cdbb=a27_0x5a61;return _0x13684a[_0x16cdbb(0x206)](_0x348213,_0x33cda5);}};_0x5b4f95['on'](_0x13684a['nLDZF'],_0x5f463f=>{const _0x35e23f=a27_0x5a61;logger[_0x35e23f(0x1df)](_0x26a9d1+'\x20exited\x20with\x20code\x20'+_0x5f463f),_0x5654ca['tOYSr'](_0xf603ae,_0x5f463f);});});[_0x13684a[_0x281e22(0x1e0)],_0x13684a['sCiMV'],_0x13684a[_0x281e22(0x1e9)],_0x13684a['lrfxy']][_0x281e22(0x1d1)](_0x182335=>{const _0x3b29eb=_0x281e22,_0x4cd525={};_0x4cd525['IwBXz']=_0x13684a[_0x3b29eb(0x1de)];const _0x368c89=_0x4cd525;process['on'](_0x182335,()=>{const _0x51a9a4=_0x3b29eb;if(_0x5e3cf3)return;_0x5e3cf3=!![],logger[_0x51a9a4(0x1df)]('Received\x20'+_0x182335+_0x51a9a4(0x203)),_0x5b4f95&&!_0x5b4f95['killed']&&(_0x5b4f95[_0x51a9a4(0x1cf)](_0x182335),logger[_0x51a9a4(0x1df)](_0x368c89[_0x51a9a4(0x1e7)]));});});const _0x121ca6=await _0x309b29;await _0x13684a[_0x281e22(0x1ef)](sleep),process[_0x281e22(0x1f1)](_0x121ca6);}catch(_0x543d36){logger[_0x281e22(0x1f4)](_0x281e22(0x1f0)+_0x543d36['message']),logger[_0x281e22(0x1df)](_0x281e22(0x1d7)+(_0x543d36[_0x281e22(0x1d6)]||JSON['stringify'](_0x543d36))),await _0x13684a[_0x281e22(0x1db)](sleep),process[_0x281e22(0x1f1)](0x1);}}module[a27_0x434a45(0x1d0)]=executeLoadTest;