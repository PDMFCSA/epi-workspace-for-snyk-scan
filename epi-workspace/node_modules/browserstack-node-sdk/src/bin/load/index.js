#!/usr/bin/env node
'use strict';function a28_0x5ad2(_0x2d7d4b,_0x155727){const _0x58eeda=a28_0x58ee();return a28_0x5ad2=function(_0x5ad22e,_0x583ef8){_0x5ad22e=_0x5ad22e-0xc8;let _0x28066c=_0x58eeda[_0x5ad22e];return _0x28066c;},a28_0x5ad2(_0x2d7d4b,_0x155727);}const a28_0xbc5afe=a28_0x5ad2;(function(_0x3c6c13,_0x5c5b71){const _0x36ea5b=a28_0x5ad2,_0x34544b=_0x3c6c13();while(!![]){try{const _0x1cd4d8=-parseInt(_0x36ea5b(0xe4))/0x1*(parseInt(_0x36ea5b(0xec))/0x2)+-parseInt(_0x36ea5b(0xd4))/0x3+-parseInt(_0x36ea5b(0xcd))/0x4*(parseInt(_0x36ea5b(0xd0))/0x5)+-parseInt(_0x36ea5b(0xca))/0x6+-parseInt(_0x36ea5b(0xd7))/0x7*(parseInt(_0x36ea5b(0xfe))/0x8)+parseInt(_0x36ea5b(0xfa))/0x9+parseInt(_0x36ea5b(0xdc))/0xa;if(_0x1cd4d8===_0x5c5b71)break;else _0x34544b['push'](_0x34544b['shift']());}catch(_0x523eee){_0x34544b['push'](_0x34544b['shift']());}}}(a28_0x58ee,0x4e5cd));function a28_0x58ee(){const _0x12d719=['stack','MWylJ','../../helpers/logger','Failed\x20to\x20download\x20or\x20locate\x20CLI\x20binary','2776746cdhJki','\x20exited\x20with\x20code\x20','message','4SQGXUv','readConfig','Failed\x20to\x20determine\x20CLI\x20directory','642845QiaZac','PjBKV','debug','vihwX','668655LLMkKi','mIjZF','slice','1904iEqeNo','IQpmo','accessKey','stringify','exit','15726480QFqIPp','argv','XJxvn','IwXgi','htgzI','checkAndUpdateCli','load','DfcVI','372661TNyaij','owebx','Error\x20details:\x20','inherit','Failed\x20initiating\x20load\x20test:\x20','TdXCX','close','BROWSERSTACK_ACCESSKEY','2yXuGbX',',\x20forwarding\x20to\x20child\x20process...','Error\x20loading\x20configuration:\x20','CLI\x20binary\x20found,\x20Checking\x20for\x20CLI\x20updates','getExistingCliPath','../../helpers/helper','userName','Loading\x20configuration\x20using\x20environment\x20variables\x20if\x20available.','Waiting\x20for\x20child\x20process\x20to\x20exit...','CLI\x20binary\x20not\x20found,\x20downloading\x20latest\x20version','SIGTERM','Configuration\x20path:\x20','../v2/cliUtils','winstonLogger','362007JfPoqp','fDVJe','axSZu','vMPlo','3088ioaQWd','SIGINT','Authentication\x20incomplete.\x20Please\x20add\x20your\x20userName\x20and\x20accessKey\x20to\x20either\x20the\x20browserstack.yml\x20file\x20or\x20as\x20environment\x20variables,\x20then\x20try\x20running\x20the\x20command\x20again.','env','Received\x20','join','SIGQUIT','BROWSERSTACK_USERNAME','BROWSERSTACK_ACCESS_KEY','Executing\x20load\x20test\x20with\x20arguments:\x20','error'];a28_0x58ee=function(){return _0x12d719;};return a28_0x58ee();}const {spawn}=require('child_process'),path=require('path'),helper=require(a28_0xbc5afe(0xf1)),CLIUtils=require(a28_0xbc5afe(0xf8)),{getLoadConfigPath,sleep}=require('./loadUtils'),logger=require(a28_0xbc5afe(0xc8))[a28_0xbc5afe(0xf9)];async function executeLoadTest(_0x320694){const _0xf53f7f=a28_0xbc5afe,_0x1499a0={'fDVJe':function(_0x3a6aca,_0x547675){return _0x3a6aca(_0x547675);},'IwXgi':_0xf53f7f(0xea),'rZYlE':_0xf53f7f(0xf4),'htgzI':_0xf53f7f(0xf3),'IQpmo':function(_0x16a454,_0x2645b3){return _0x16a454(_0x2645b3);},'vihwX':function(_0x582f68){return _0x582f68();},'MWylJ':_0xf53f7f(0x100),'mIjZF':function(_0x214607){return _0x214607();},'MBeSQ':_0xf53f7f(0xcf),'bCSbf':_0xf53f7f(0xf5),'owebx':_0xf53f7f(0xef),'DfcVI':_0xf53f7f(0xc9),'XJxvn':function(_0x4a98b4){return _0x4a98b4();},'CcWvy':function(_0x1cfa4e,_0x4e0aeb,_0x35aae2,_0x45f193){return _0x1cfa4e(_0x4e0aeb,_0x35aae2,_0x45f193);},'axSZu':_0xf53f7f(0xe2),'zojzY':_0xf53f7f(0xe7),'psBWy':_0xf53f7f(0xff),'PjBKV':_0xf53f7f(0xf6),'vMPlo':_0xf53f7f(0x104),'TdXCX':'SIGHUP','REiSc':function(_0x40e39e){return _0x40e39e();}};try{const _0x386b40=process[_0xf53f7f(0xdd)][_0xf53f7f(0xd6)](0x2),_0x301f41=_0x386b40[_0xf53f7f(0xd6)](0x1);logger[_0xf53f7f(0xd2)](_0xf53f7f(0x107)+_0x301f41);let _0x1ec24e={};try{logger[_0xf53f7f(0xd2)](_0x1499a0[_0xf53f7f(0xe0)]);const _0x13f687={};_0x13f687[_0xf53f7f(0xf2)]=process[_0xf53f7f(0x101)][_0xf53f7f(0x105)]||process[_0xf53f7f(0x101)]['BROWSERSTACK_USER'],_0x13f687['accessKey']=process[_0xf53f7f(0x101)][_0xf53f7f(0x106)]||process[_0xf53f7f(0x101)][_0xf53f7f(0xeb)],_0x1ec24e=_0x13f687;if(!_0x1ec24e['userName']||!_0x1ec24e[_0xf53f7f(0xd9)]){const _0x4ff6fd=_0x1499a0[_0xf53f7f(0xd8)](getLoadConfigPath,_0x320694[_0xf53f7f(0xdd)]);logger[_0xf53f7f(0xd2)](_0xf53f7f(0xf7)+_0x4ff6fd),_0x4ff6fd&&(_0x1ec24e=helper[_0xf53f7f(0xce)](_0x4ff6fd));}}catch(_0x4bf90f){logger['error'](_0xf53f7f(0xee)+_0x4bf90f[_0xf53f7f(0xcc)]),logger[_0xf53f7f(0xd2)](_0xf53f7f(0xe6)+(_0x4bf90f['stack']||JSON[_0xf53f7f(0xda)](_0x4bf90f))),await _0x1499a0['vihwX'](sleep),process[_0xf53f7f(0xdb)](0x1);}(!_0x1ec24e['userName']||!_0x1ec24e[_0xf53f7f(0xd9)])&&(logger['error'](_0x1499a0[_0xf53f7f(0x10a)]),await _0x1499a0[_0xf53f7f(0xd5)](sleep),process[_0xf53f7f(0xdb)](0x1));const _0x43a318=CLIUtils['getCliDir']();!_0x43a318&&(logger['error'](_0x1499a0['MBeSQ']),await _0x1499a0[_0xf53f7f(0xd3)](sleep),process['exit'](0x1));let _0xafd0a3=CLIUtils[_0xf53f7f(0xf0)](_0x43a318);try{!_0xafd0a3?(logger[_0xf53f7f(0xd2)](_0x1499a0['bCSbf']),_0xafd0a3=await CLIUtils[_0xf53f7f(0xe1)]('',_0x43a318,_0x1ec24e)):(logger['debug'](_0x1499a0[_0xf53f7f(0xe5)]),_0xafd0a3=await CLIUtils[_0xf53f7f(0xe1)](_0xafd0a3,_0x43a318,_0x1ec24e));}catch(_0x835eb6){logger[_0xf53f7f(0x108)](_0x1499a0[_0xf53f7f(0x10a)]),logger[_0xf53f7f(0xd2)]('Error\x20Details:\x20'+(_0x835eb6[_0xf53f7f(0x109)]||JSON[_0xf53f7f(0xda)](_0x835eb6))),await _0x1499a0['mIjZF'](sleep),process[_0xf53f7f(0xdb)](0x1);}!_0xafd0a3&&(logger['error'](_0x1499a0[_0xf53f7f(0x10a)]),logger[_0xf53f7f(0xd2)](_0x1499a0[_0xf53f7f(0xe3)]),await _0x1499a0[_0xf53f7f(0xde)](sleep),process[_0xf53f7f(0xdb)](0x1));logger[_0xf53f7f(0xd2)]('Spawning:\x20'+_0xafd0a3+'\x20load\x20'+_0x301f41[_0xf53f7f(0x103)]('\x20'));const _0x35652f=_0x1499a0['CcWvy'](spawn,_0xafd0a3,[_0x1499a0[_0xf53f7f(0xfc)],..._0x301f41],{'stdio':_0x1499a0['zojzY']});let _0x259013=![];const _0x555f80=new Promise(_0x25219e=>{const _0x149c98=_0xf53f7f,_0x2258a4={'sdQHE':function(_0x53caec,_0x379824){const _0x1600bb=a28_0x5ad2;return _0x1499a0[_0x1600bb(0xfb)](_0x53caec,_0x379824);}};_0x35652f['on'](_0x1499a0[_0x149c98(0xdf)],_0x168861=>{const _0x3ef344=_0x149c98;logger[_0x3ef344(0xd2)](_0xafd0a3+_0x3ef344(0xcb)+_0x168861),_0x2258a4['sdQHE'](_0x25219e,_0x168861);});});[_0x1499a0['psBWy'],_0x1499a0[_0xf53f7f(0xd1)],_0x1499a0[_0xf53f7f(0xfd)],_0x1499a0[_0xf53f7f(0xe9)]]['forEach'](_0x18eef7=>{process['on'](_0x18eef7,()=>{const _0x2b7f00=a28_0x5ad2;if(_0x259013)return;_0x259013=!![],logger[_0x2b7f00(0xd2)](_0x2b7f00(0x102)+_0x18eef7+_0x2b7f00(0xed)),_0x35652f&&!_0x35652f['killed']&&(_0x35652f['kill'](_0x18eef7),logger['debug'](_0x1499a0['rZYlE']));});});const _0x248952=await _0x555f80;await _0x1499a0['REiSc'](sleep),process[_0xf53f7f(0xdb)](_0x248952);}catch(_0xba5455){logger['error'](_0xf53f7f(0xe8)+_0xba5455['message']),logger[_0xf53f7f(0xd2)](_0xf53f7f(0xe6)+(_0xba5455[_0xf53f7f(0x109)]||JSON[_0xf53f7f(0xda)](_0xba5455))),await _0x1499a0['mIjZF'](sleep),process[_0xf53f7f(0xdb)](0x1);}}module['exports']=executeLoadTest;