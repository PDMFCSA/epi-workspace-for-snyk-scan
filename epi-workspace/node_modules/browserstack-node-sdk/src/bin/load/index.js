#!/usr/bin/env node
'use strict';const a27_0x5ea453=a27_0x7a96;(function(_0x9bfdee,_0x269460){const _0x403f1a=a27_0x7a96,_0xc5b3eb=_0x9bfdee();while(!![]){try{const _0x4db932=-parseInt(_0x403f1a(0x18f))/0x1*(-parseInt(_0x403f1a(0x1a7))/0x2)+-parseInt(_0x403f1a(0x194))/0x3*(-parseInt(_0x403f1a(0x1ba))/0x4)+parseInt(_0x403f1a(0x1a5))/0x5+-parseInt(_0x403f1a(0x18a))/0x6+parseInt(_0x403f1a(0x1ac))/0x7*(-parseInt(_0x403f1a(0x1ab))/0x8)+-parseInt(_0x403f1a(0x187))/0x9+parseInt(_0x403f1a(0x1b5))/0xa*(parseInt(_0x403f1a(0x186))/0xb);if(_0x4db932===_0x269460)break;else _0xc5b3eb['push'](_0xc5b3eb['shift']());}catch(_0x25d43d){_0xc5b3eb['push'](_0xc5b3eb['shift']());}}}(a27_0x3d5e,0x65cb3));const {spawn}=require('child_process'),path=require(a27_0x5ea453(0x190)),helper=require(a27_0x5ea453(0x19f)),CLIUtils=require(a27_0x5ea453(0x1bf)),{getLoadConfigPath,sleep}=require('./loadUtils'),logger=require(a27_0x5ea453(0x196))[a27_0x5ea453(0x189)];function a27_0x7a96(_0x18d09e,_0x4cf4f0){const _0x3d5e0b=a27_0x3d5e();return a27_0x7a96=function(_0x7a96c3,_0x1b1a5d){_0x7a96c3=_0x7a96c3-0x17c;let _0x575638=_0x3d5e0b[_0x7a96c3];return _0x575638;},a27_0x7a96(_0x18d09e,_0x4cf4f0);}function a27_0x3d5e(){const _0x59a4ba=['2204720XzzckG','qKYdd','2RhBZtU','Error\x20details:\x20','checkAndUpdateCli','Configuration\x20path:\x20','296dyaLdw','26047qWpkBQ','accessKey','stack','\x20exited\x20with\x20code\x20','message',',\x20forwarding\x20to\x20child\x20process...','BROWSERSTACK_ACCESSKEY','pJwxc','myDMa','209390WFHMBL','Bpaln','SIGTERM','userName','close','8DlzAUV','load','kill','CXpnO','SIGQUIT','../v2/cliUtils','UFbUL','Spawning:\x20','CLI\x20binary\x20not\x20found,\x20downloading\x20latest\x20version','Loading\x20configuration\x20using\x20environment\x20variables\x20if\x20available.','slice','gLeUK','Error\x20Details:\x20','WMeIX','\x20load\x20','forEach','RYWEG','Error\x20loading\x20configuration:\x20','CLI\x20binary\x20found,\x20Checking\x20for\x20CLI\x20updates','132aFjmUt','4147434dpNCDG','AjtOY','winstonLogger','2593362BFiiXm','exit','ZmeNe','getCliDir','Failed\x20to\x20determine\x20CLI\x20directory','511873qdWgZS','path','killed','BROWSERSTACK_USERNAME','inherit','365388cCQTOg','BROWSERSTACK_ACCESS_KEY','../../helpers/logger','error','BROWSERSTACK_USER','YBqGC','argv','stringify','SIGHUP','LPJbk','ipWeh','../../helpers/helper','BikyG','PgScW','env','Failed\x20initiating\x20load\x20test:\x20','debug'];a27_0x3d5e=function(){return _0x59a4ba;};return a27_0x3d5e();}async function executeLoadTest(_0x407a58){const _0x8bcf88=a27_0x5ea453,_0x17ffb8={'KGcHw':function(_0x55c840,_0x155e11){return _0x55c840(_0x155e11);},'WMeIX':_0x8bcf88(0x1b9),'CXpnO':'Waiting\x20for\x20child\x20process\x20to\x20exit...','qKYdd':_0x8bcf88(0x17c),'pJwxc':function(_0x51dc4c){return _0x51dc4c();},'myDMa':'Authentication\x20incomplete.\x20Please\x20add\x20your\x20userName\x20and\x20accessKey\x20to\x20either\x20the\x20browserstack.yml\x20file\x20or\x20as\x20environment\x20variables,\x20then\x20try\x20running\x20the\x20command\x20again.','RYWEG':_0x8bcf88(0x18e),'PgScW':function(_0x3eee98){return _0x3eee98();},'gLeUK':_0x8bcf88(0x1c2),'YBqGC':_0x8bcf88(0x185),'ipWeh':function(_0x34c520){return _0x34c520();},'LPJbk':'Failed\x20to\x20download\x20or\x20locate\x20CLI\x20binary','JMXtm':function(_0x824c86){return _0x824c86();},'ZQDmt':function(_0x434b18,_0x3f6c6c,_0x39135b,_0x57e9f2){return _0x434b18(_0x3f6c6c,_0x39135b,_0x57e9f2);},'xqCuW':_0x8bcf88(0x1bb),'ZmeNe':_0x8bcf88(0x193),'BikyG':'SIGINT','AjtOY':_0x8bcf88(0x1b7),'UFbUL':_0x8bcf88(0x1be),'Bpaln':_0x8bcf88(0x19c)};try{const _0x46f7b7=process[_0x8bcf88(0x19a)][_0x8bcf88(0x17d)](0x2),_0x2b8d6f=_0x46f7b7[_0x8bcf88(0x17d)](0x1);logger['debug']('Executing\x20load\x20test\x20with\x20arguments:\x20'+_0x2b8d6f);let _0xb2dbcc={};try{logger[_0x8bcf88(0x1a4)](_0x17ffb8[_0x8bcf88(0x1a6)]);const _0x1772f1={};_0x1772f1['userName']=process['env'][_0x8bcf88(0x192)]||process[_0x8bcf88(0x1a2)][_0x8bcf88(0x198)],_0x1772f1[_0x8bcf88(0x1ad)]=process[_0x8bcf88(0x1a2)][_0x8bcf88(0x195)]||process['env'][_0x8bcf88(0x1b2)],_0xb2dbcc=_0x1772f1;if(!_0xb2dbcc['userName']||!_0xb2dbcc[_0x8bcf88(0x1ad)]){const _0x34b95a=_0x17ffb8['KGcHw'](getLoadConfigPath,_0x407a58[_0x8bcf88(0x19a)]);logger[_0x8bcf88(0x1a4)](_0x8bcf88(0x1aa)+_0x34b95a),_0x34b95a&&(_0xb2dbcc=helper['readConfig'](_0x34b95a));}}catch(_0x17d52b){logger[_0x8bcf88(0x197)](_0x8bcf88(0x184)+_0x17d52b[_0x8bcf88(0x1b0)]),logger[_0x8bcf88(0x1a4)](_0x8bcf88(0x1a8)+(_0x17d52b[_0x8bcf88(0x1ae)]||JSON[_0x8bcf88(0x19b)](_0x17d52b))),await _0x17ffb8[_0x8bcf88(0x1b3)](sleep),process[_0x8bcf88(0x18b)](0x1);}(!_0xb2dbcc[_0x8bcf88(0x1b8)]||!_0xb2dbcc[_0x8bcf88(0x1ad)])&&(logger[_0x8bcf88(0x197)](_0x17ffb8[_0x8bcf88(0x1b4)]),await _0x17ffb8[_0x8bcf88(0x1b3)](sleep),process[_0x8bcf88(0x18b)](0x1));const _0x4e3ac6=CLIUtils[_0x8bcf88(0x18d)]();!_0x4e3ac6&&(logger[_0x8bcf88(0x197)](_0x17ffb8[_0x8bcf88(0x183)]),await _0x17ffb8[_0x8bcf88(0x1a1)](sleep),process[_0x8bcf88(0x18b)](0x1));let _0x62c357=CLIUtils['getExistingCliPath'](_0x4e3ac6);try{!_0x62c357?(logger[_0x8bcf88(0x1a4)](_0x17ffb8[_0x8bcf88(0x17e)]),_0x62c357=await CLIUtils['checkAndUpdateCli']('',_0x4e3ac6,_0xb2dbcc)):(logger[_0x8bcf88(0x1a4)](_0x17ffb8[_0x8bcf88(0x199)]),_0x62c357=await CLIUtils[_0x8bcf88(0x1a9)](_0x62c357,_0x4e3ac6,_0xb2dbcc));}catch(_0x46e0c7){logger[_0x8bcf88(0x197)](_0x17ffb8[_0x8bcf88(0x1b4)]),logger['debug'](_0x8bcf88(0x17f)+(_0x46e0c7[_0x8bcf88(0x1ae)]||JSON[_0x8bcf88(0x19b)](_0x46e0c7))),await _0x17ffb8[_0x8bcf88(0x19e)](sleep),process[_0x8bcf88(0x18b)](0x1);}!_0x62c357&&(logger[_0x8bcf88(0x197)](_0x17ffb8[_0x8bcf88(0x1b4)]),logger['debug'](_0x17ffb8[_0x8bcf88(0x19d)]),await _0x17ffb8['JMXtm'](sleep),process[_0x8bcf88(0x18b)](0x1));logger[_0x8bcf88(0x1a4)](_0x8bcf88(0x1c1)+_0x62c357+_0x8bcf88(0x181)+_0x2b8d6f['join']('\x20'));const _0x3e858d=_0x17ffb8['ZQDmt'](spawn,_0x62c357,[_0x17ffb8['xqCuW'],..._0x2b8d6f],{'stdio':_0x17ffb8[_0x8bcf88(0x18c)]});let _0x117f0d=![];const _0x372128=new Promise(_0x34a979=>{const _0x3821eb=_0x8bcf88;_0x3e858d['on'](_0x17ffb8[_0x3821eb(0x180)],_0x58bbef=>{const _0x5ba221=_0x3821eb;logger[_0x5ba221(0x1a4)](_0x62c357+_0x5ba221(0x1af)+_0x58bbef),_0x17ffb8['KGcHw'](_0x34a979,_0x58bbef);});});[_0x17ffb8[_0x8bcf88(0x1a0)],_0x17ffb8[_0x8bcf88(0x188)],_0x17ffb8[_0x8bcf88(0x1c0)],_0x17ffb8[_0x8bcf88(0x1b6)]][_0x8bcf88(0x182)](_0x3bdf76=>{process['on'](_0x3bdf76,()=>{const _0x2fa8ac=a27_0x7a96;if(_0x117f0d)return;_0x117f0d=!![],logger[_0x2fa8ac(0x1a4)]('Received\x20'+_0x3bdf76+_0x2fa8ac(0x1b1)),_0x3e858d&&!_0x3e858d[_0x2fa8ac(0x191)]&&(_0x3e858d[_0x2fa8ac(0x1bc)](_0x3bdf76),logger[_0x2fa8ac(0x1a4)](_0x17ffb8[_0x2fa8ac(0x1bd)]));});});const _0x5622d3=await _0x372128;await _0x17ffb8['ipWeh'](sleep),process[_0x8bcf88(0x18b)](_0x5622d3);}catch(_0x50b482){logger[_0x8bcf88(0x197)](_0x8bcf88(0x1a3)+_0x50b482[_0x8bcf88(0x1b0)]),logger[_0x8bcf88(0x1a4)](_0x8bcf88(0x1a8)+(_0x50b482[_0x8bcf88(0x1ae)]||JSON[_0x8bcf88(0x19b)](_0x50b482))),await _0x17ffb8['ipWeh'](sleep),process[_0x8bcf88(0x18b)](0x1);}}module['exports']=executeLoadTest;