#!/usr/bin/env node
'use strict';function a28_0x40d2(_0xfc4c01,_0x3d49ef){const _0x15e558=a28_0x15e5();return a28_0x40d2=function(_0x40d2a9,_0x3563e4){_0x40d2a9=_0x40d2a9-0xff;let _0x51de5b=_0x15e558[_0x40d2a9];return _0x51de5b;},a28_0x40d2(_0xfc4c01,_0x3d49ef);}const a28_0x29fdb2=a28_0x40d2;(function(_0x189aea,_0x568bf1){const _0x41811f=a28_0x40d2,_0x293f16=_0x189aea();while(!![]){try{const _0x460339=-parseInt(_0x41811f(0x104))/0x1+parseInt(_0x41811f(0x13d))/0x2*(parseInt(_0x41811f(0x11d))/0x3)+-parseInt(_0x41811f(0x117))/0x4*(-parseInt(_0x41811f(0x130))/0x5)+-parseInt(_0x41811f(0x13f))/0x6*(parseInt(_0x41811f(0x135))/0x7)+-parseInt(_0x41811f(0x111))/0x8+-parseInt(_0x41811f(0x107))/0x9+parseInt(_0x41811f(0x137))/0xa;if(_0x460339===_0x568bf1)break;else _0x293f16['push'](_0x293f16['shift']());}catch(_0x11168f){_0x293f16['push'](_0x293f16['shift']());}}}(a28_0x15e5,0x61f15));const {spawn}=require('child_process'),path=require('path'),helper=require(a28_0x29fdb2(0x124)),CLIUtils=require(a28_0x29fdb2(0x116)),{getLoadConfigPath,sleep}=require('./loadUtils'),logger=require(a28_0x29fdb2(0x11e))[a28_0x29fdb2(0x132)];function a28_0x15e5(){const _0x9819ad=['491222yOrMAx','\x20exited\x20with\x20code\x20','exit','3363705PoPgBc','BROWSERSTACK_ACCESS_KEY','readConfig','stack','Hpped','join','HvuuC','Failed\x20to\x20determine\x20CLI\x20directory','BROWSERSTACK_USER','ffucZ','869448WSOlCt','env','nzkVA','CLI\x20binary\x20found,\x20Checking\x20for\x20CLI\x20updates','slice','../v2/cliUtils','1562732BzwMyC','CQWFj','Error\x20Details:\x20','error','message','BROWSERSTACK_ACCESSKEY','12PWPvYb','../../helpers/logger','getExistingCliPath','SIGTERM','Error\x20details:\x20','Configuration\x20path:\x20','accessKey','../../helpers/helper','forEach','userName','JAGXO','Executing\x20load\x20test\x20with\x20arguments:\x20','debug','LqIID','argv','Failed\x20initiating\x20load\x20test:\x20','stringify','WiKJD','HQweN','10cUcZMS','SIGQUIT','winstonLogger','Authentication\x20incomplete.\x20Please\x20add\x20your\x20userName\x20and\x20accessKey\x20to\x20either\x20the\x20browserstack.yml\x20file\x20or\x20as\x20environment\x20variables,\x20then\x20try\x20running\x20the\x20command\x20again.','SIGHUP','4081TrLKda','Spawning:\x20','7104090wmQRCG','\x20load\x20','load','exports','MarbM','QCWkX','182302HEuirv','oYWRI','4956aiCGaQ','sNBbi','killed','Received\x20','BOlFH','Waiting\x20for\x20child\x20process\x20to\x20exit...','inherit'];a28_0x15e5=function(){return _0x9819ad;};return a28_0x15e5();}async function executeLoadTest(_0x150491){const _0x23ad45=a28_0x29fdb2,_0xae9b61={'LqIID':function(_0x18469a,_0x4b4496){return _0x18469a(_0x4b4496);},'dPZSu':'close','BOlFH':_0x23ad45(0x102),'ffucZ':'Loading\x20configuration\x20using\x20environment\x20variables\x20if\x20available.','QCWkX':function(_0x2d08c4,_0x38df29){return _0x2d08c4(_0x38df29);},'MarbM':function(_0x41ad28){return _0x41ad28();},'oYWRI':_0x23ad45(0x133),'HHKbT':function(_0x564a24){return _0x564a24();},'CQWFj':_0x23ad45(0x10e),'HQweN':function(_0x217605){return _0x217605();},'rFVhN':'CLI\x20binary\x20not\x20found,\x20downloading\x20latest\x20version','Nkqxw':_0x23ad45(0x114),'HvuuC':'Failed\x20to\x20download\x20or\x20locate\x20CLI\x20binary','sNBbi':function(_0xe63252){return _0xe63252();},'MbBme':function(_0x451302,_0x102361,_0x358eca,_0x3bf87b){return _0x451302(_0x102361,_0x358eca,_0x3bf87b);},'uyydt':_0x23ad45(0x139),'umZPW':_0x23ad45(0x103),'nzkVA':'SIGINT','rNUKl':_0x23ad45(0x120),'JAGXO':_0x23ad45(0x131),'Hpped':_0x23ad45(0x134)};try{const _0x1b24ee=process[_0x23ad45(0x12b)][_0x23ad45(0x115)](0x2),_0x5c6c58=_0x1b24ee[_0x23ad45(0x115)](0x1);logger[_0x23ad45(0x129)](_0x23ad45(0x128)+_0x5c6c58);let _0x21560c={};try{logger[_0x23ad45(0x129)](_0xae9b61[_0x23ad45(0x110)]);const _0x3c24f7={};_0x3c24f7[_0x23ad45(0x126)]=process[_0x23ad45(0x112)]['BROWSERSTACK_USERNAME']||process[_0x23ad45(0x112)][_0x23ad45(0x10f)],_0x3c24f7[_0x23ad45(0x123)]=process[_0x23ad45(0x112)][_0x23ad45(0x108)]||process['env'][_0x23ad45(0x11c)],_0x21560c=_0x3c24f7;if(!_0x21560c['userName']||!_0x21560c['accessKey']){const _0x29c2ca=_0xae9b61[_0x23ad45(0x13c)](getLoadConfigPath,_0x150491[_0x23ad45(0x12b)]);logger[_0x23ad45(0x129)](_0x23ad45(0x122)+_0x29c2ca),_0x29c2ca&&(_0x21560c=helper[_0x23ad45(0x109)](_0x29c2ca));}}catch(_0x33619b){logger['error']('Error\x20loading\x20configuration:\x20'+_0x33619b['message']),logger[_0x23ad45(0x129)]('Error\x20details:\x20'+(_0x33619b[_0x23ad45(0x10a)]||JSON[_0x23ad45(0x12d)](_0x33619b))),await _0xae9b61[_0x23ad45(0x13b)](sleep),process[_0x23ad45(0x106)](0x1);}(!_0x21560c[_0x23ad45(0x126)]||!_0x21560c['accessKey'])&&(logger[_0x23ad45(0x11a)](_0xae9b61['oYWRI']),await _0xae9b61['HHKbT'](sleep),process[_0x23ad45(0x106)](0x1));const _0x1f00bb=CLIUtils['getCliDir']();!_0x1f00bb&&(logger[_0x23ad45(0x11a)](_0xae9b61[_0x23ad45(0x118)]),await _0xae9b61[_0x23ad45(0x12f)](sleep),process[_0x23ad45(0x106)](0x1));let _0x77062a=CLIUtils[_0x23ad45(0x11f)](_0x1f00bb);try{!_0x77062a?(logger[_0x23ad45(0x129)](_0xae9b61['rFVhN']),_0x77062a=await CLIUtils['checkAndUpdateCli']('',_0x1f00bb,_0x21560c)):(logger['debug'](_0xae9b61['Nkqxw']),_0x77062a=await CLIUtils['checkAndUpdateCli'](_0x77062a,_0x1f00bb,_0x21560c));}catch(_0x13bd43){logger[_0x23ad45(0x11a)](_0xae9b61['oYWRI']),logger[_0x23ad45(0x129)](_0x23ad45(0x119)+(_0x13bd43[_0x23ad45(0x10a)]||JSON[_0x23ad45(0x12d)](_0x13bd43))),await _0xae9b61['HQweN'](sleep),process[_0x23ad45(0x106)](0x1);}!_0x77062a&&(logger['error'](_0xae9b61[_0x23ad45(0x13e)]),logger[_0x23ad45(0x129)](_0xae9b61[_0x23ad45(0x10d)]),await _0xae9b61[_0x23ad45(0x140)](sleep),process['exit'](0x1));logger['debug'](_0x23ad45(0x136)+_0x77062a+_0x23ad45(0x138)+_0x5c6c58[_0x23ad45(0x10c)]('\x20'));const _0x193513=_0xae9b61['MbBme'](spawn,_0x77062a,[_0xae9b61['uyydt'],..._0x5c6c58],{'stdio':_0xae9b61['umZPW']});let _0xaf7cc2=![];const _0x4a7cdb=new Promise(_0x1651ea=>{const _0x3e0e7d={'WiKJD':function(_0x7a2c59,_0x17d34a){const _0x15b76e=a28_0x40d2;return _0xae9b61[_0x15b76e(0x12a)](_0x7a2c59,_0x17d34a);}};_0x193513['on'](_0xae9b61['dPZSu'],_0x4685d1=>{const _0x53a421=a28_0x40d2;logger[_0x53a421(0x129)](_0x77062a+_0x53a421(0x105)+_0x4685d1),_0x3e0e7d[_0x53a421(0x12e)](_0x1651ea,_0x4685d1);});});[_0xae9b61[_0x23ad45(0x113)],_0xae9b61['rNUKl'],_0xae9b61[_0x23ad45(0x127)],_0xae9b61[_0x23ad45(0x10b)]][_0x23ad45(0x125)](_0x1222ec=>{process['on'](_0x1222ec,()=>{const _0x51561b=a28_0x40d2;if(_0xaf7cc2)return;_0xaf7cc2=!![],logger[_0x51561b(0x129)](_0x51561b(0x100)+_0x1222ec+',\x20forwarding\x20to\x20child\x20process...'),_0x193513&&!_0x193513[_0x51561b(0xff)]&&(_0x193513['kill'](_0x1222ec),logger[_0x51561b(0x129)](_0xae9b61[_0x51561b(0x101)]));});});const _0x5b0de4=await _0x4a7cdb;await _0xae9b61['MarbM'](sleep),process[_0x23ad45(0x106)](_0x5b0de4);}catch(_0x53d8c0){logger[_0x23ad45(0x11a)](_0x23ad45(0x12c)+_0x53d8c0[_0x23ad45(0x11b)]),logger[_0x23ad45(0x129)](_0x23ad45(0x121)+(_0x53d8c0['stack']||JSON[_0x23ad45(0x12d)](_0x53d8c0))),await _0xae9b61[_0x23ad45(0x12f)](sleep),process[_0x23ad45(0x106)](0x1);}}module[a28_0x29fdb2(0x13a)]=executeLoadTest;