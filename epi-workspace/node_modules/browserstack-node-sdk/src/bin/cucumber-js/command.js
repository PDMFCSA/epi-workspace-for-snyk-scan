#!/usr/bin/env node
'use strict';const a5_0x2eb826=a5_0x3601;function a5_0x3601(_0x2d07e0,_0x10ad34){const _0x27b1a6=a5_0x27b1();return a5_0x3601=function(_0x3601c5,_0x4e12d4){_0x3601c5=_0x3601c5-0xe7;let _0x4f579b=_0x27b1a6[_0x3601c5];return _0x4f579b;},a5_0x3601(_0x2d07e0,_0x10ad34);}(function(_0x1f6691,_0x5ed620){const _0x2cd966=a5_0x3601,_0x4e5a75=_0x1f6691();while(!![]){try{const _0x111e66=-parseInt(_0x2cd966(0x150))/0x1*(-parseInt(_0x2cd966(0x138))/0x2)+-parseInt(_0x2cd966(0x123))/0x3*(parseInt(_0x2cd966(0x156))/0x4)+parseInt(_0x2cd966(0x159))/0x5*(-parseInt(_0x2cd966(0x132))/0x6)+-parseInt(_0x2cd966(0xe9))/0x7*(-parseInt(_0x2cd966(0x10b))/0x8)+-parseInt(_0x2cd966(0xfc))/0x9+-parseInt(_0x2cd966(0x14a))/0xa*(parseInt(_0x2cd966(0x11d))/0xb)+parseInt(_0x2cd966(0x143))/0xc*(parseInt(_0x2cd966(0x155))/0xd);if(_0x111e66===_0x5ed620)break;else _0x4e5a75['push'](_0x4e5a75['shift']());}catch(_0x5e85c1){_0x4e5a75['push'](_0x4e5a75['shift']());}}}(a5_0x27b1,0x58a3a));const fs=require('fs'),path=require(a5_0x2eb826(0x148)),util=require(a5_0x2eb826(0x139)),logger=require(a5_0x2eb826(0x126))[a5_0x2eb826(0x154)],{default:BrowserStackSetup}=require(a5_0x2eb826(0xf0)),helper=require(a5_0x2eb826(0x12d)),utilities=require(a5_0x2eb826(0xf9)),constants=require('../utils/constants'),{parallelCucumberRun}=require(a5_0x2eb826(0xf5)),TestHubHandler=require(a5_0x2eb826(0x147)),testOpsHelper=require('../../helpers/test-observability/utils'),chalk=require(a5_0x2eb826(0xf3)),PerformanceTester=require('../../helpers/performance/performance-tester'),PerformanceEvents=require('../../helpers/performance/constants')[a5_0x2eb826(0x114)];function printCucumberStats(_0x5eb078){const _0x2bf17f=a5_0x2eb826,_0x13e4f3={};_0x13e4f3[_0x2bf17f(0x10a)]=function(_0x3c1678,_0x47a02c){return _0x3c1678>_0x47a02c;},_0x13e4f3['AtnpJ']=function(_0x142ed4,_0x1306ad){return _0x142ed4-_0x1306ad;},_0x13e4f3[_0x2bf17f(0x144)]=function(_0x37c47c,_0x336c70){return _0x37c47c>_0x336c70;},_0x13e4f3[_0x2bf17f(0xfd)]=function(_0x1f8945,_0x56d391){return _0x1f8945>_0x56d391;},_0x13e4f3[_0x2bf17f(0x120)]=function(_0x342eb2,_0x7e5a3c){return _0x342eb2>_0x7e5a3c;},_0x13e4f3[_0x2bf17f(0x112)]=function(_0x4df5a7,_0x5574b0){return _0x4df5a7+_0x5574b0;},_0x13e4f3[_0x2bf17f(0x15c)]=function(_0x11da2c,_0x553f06){return _0x11da2c+_0x553f06;},_0x13e4f3['wukgR']=function(_0x360078,_0x19a517){return _0x360078+_0x19a517;},_0x13e4f3[_0x2bf17f(0x129)]=function(_0x512383,_0x119e68){return _0x512383+_0x119e68;},_0x13e4f3[_0x2bf17f(0xec)]=function(_0x360600,_0x5cc01a){return _0x360600+_0x5cc01a;},_0x13e4f3['lHdaz']=function(_0x33927a,_0x27820d){return _0x33927a===_0x27820d;},_0x13e4f3[_0x2bf17f(0xf4)]='****\x20RESULTS\x20****';const _0x4951a1=_0x13e4f3;let _0x4c44f5=0x0;if(_0x4951a1['lHdaz'](_0x5eb078[_0x2bf17f(0xf2)],0x0))return _0x4c44f5;return console[_0x2bf17f(0x14b)](chalk[_0x2bf17f(0xfe)]['bgWhite'](_0x4951a1[_0x2bf17f(0xf4)])),_0x5eb078[_0x2bf17f(0x13d)](_0x429e8b=>{const _0x4fcf2c=_0x2bf17f,_0x359090=_0x429e8b[0x0],_0x3c8ea9=_0x429e8b[0x1];helper[_0x4fcf2c(0x121)]()&&console[_0x4fcf2c(0x14b)]('\x0a'+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0xed)](''+helper[_0x4fcf2c(0x135)](_0x359090)));const _0x8c4ed5=_0x3c8ea9['scenarios'],_0x415ce5=_0x3c8ea9[_0x4fcf2c(0x117)],_0x1a0b21=_0x3c8ea9['scenariosFailed'],_0x23a007=_0x3c8ea9[_0x4fcf2c(0x13b)],_0x3e92da=_0x3c8ea9[_0x4fcf2c(0x12b)],_0xef14d=_0x3c8ea9[_0x4fcf2c(0x12a)],_0x2ac3b2=_0x3c8ea9[_0x4fcf2c(0x111)],_0x24b425=_0x3c8ea9[_0x4fcf2c(0x151)],_0x55e66e=_0x3c8ea9[_0x4fcf2c(0x145)],_0x22a600=_0x3c8ea9[_0x4fcf2c(0x141)],_0x2cae0f=_0x3c8ea9['processSuccess'];let _0x544c23=_0x8c4ed5+'\x20scenarios';const _0x1049f4=_0x4951a1[_0x4fcf2c(0x10a)](_0x4951a1[_0x4fcf2c(0x110)](_0x8c4ed5,_0x1a0b21),0x0)?_0x4951a1[_0x4fcf2c(0x110)](_0x8c4ed5,_0x1a0b21):0x0;if(_0x4951a1[_0x4fcf2c(0x10a)](_0x1a0b21,0x0)&&_0x4951a1['aBsJt'](_0x1049f4,0x0))_0x544c23+='\x20('+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0x140)](_0x1a0b21+_0x4fcf2c(0x12f))+',\x20'+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0x113)](_0x1049f4+_0x4fcf2c(0x13c))+')';else(_0x4951a1[_0x4fcf2c(0x10a)](_0x1a0b21,0x0)||_0x4951a1[_0x4fcf2c(0x10a)](_0x1049f4,0x0))&&(_0x544c23+=_0x4951a1[_0x4fcf2c(0x10a)](_0x1a0b21,0x0)?'\x20('+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0x140)](_0x1a0b21+_0x4fcf2c(0x12f))+')':'\x20('+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0x113)](_0x1049f4+_0x4fcf2c(0x13c))+')');const _0x39fe75=_0x415ce5+_0x4fcf2c(0x133),_0x10f632=[];_0x4951a1[_0x4fcf2c(0x144)](_0x22a600,0x0)&&_0x10f632['push'](''+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0x140)](_0x22a600+_0x4fcf2c(0x119)));_0x4951a1[_0x4fcf2c(0x10a)](_0x23a007,0x0)&&_0x10f632[_0x4fcf2c(0x101)](''+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0x140)](_0x23a007+_0x4fcf2c(0x12f)));_0x4951a1[_0x4fcf2c(0xfd)](_0x3e92da,0x0)&&_0x10f632[_0x4fcf2c(0x101)](''+chalk['bold'][_0x4fcf2c(0x113)](_0x3e92da+_0x4fcf2c(0x13c)));_0x4951a1[_0x4fcf2c(0x120)](_0x2ac3b2,0x0)&&_0x10f632[_0x4fcf2c(0x101)](''+chalk['bold']['yellow'](_0x2ac3b2+_0x4fcf2c(0x11b)));_0x4951a1[_0x4fcf2c(0x10a)](_0xef14d,0x0)&&_0x10f632[_0x4fcf2c(0x101)](''+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0x115)](_0xef14d+_0x4fcf2c(0x13a)));_0x4951a1[_0x4fcf2c(0x120)](_0x24b425,0x0)&&_0x10f632[_0x4fcf2c(0x101)](''+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0xed)](_0x24b425+'\x20undefined'));_0x4951a1[_0x4fcf2c(0x10a)](_0x55e66e,0x0)&&_0x10f632[_0x4fcf2c(0x101)](''+chalk[_0x4fcf2c(0xfe)][_0x4fcf2c(0xed)](_0x55e66e+'\x20skipped'));const _0x440650=_0x4951a1[_0x4fcf2c(0x112)](_0x4951a1[_0x4fcf2c(0x112)](_0x4951a1[_0x4fcf2c(0x15c)](_0x39fe75,'('),_0x10f632['join'](',\x20')),')');console[_0x4fcf2c(0x14b)](_0x4951a1[_0x4fcf2c(0x149)](_0x4951a1['WqwmO'](_0x4951a1[_0x4fcf2c(0xec)](_0x4951a1[_0x4fcf2c(0x112)]('\x0a',_0x544c23),'\x0a'),_0x440650),'\x0a')),_0x4951a1[_0x4fcf2c(0x11c)](_0x2cae0f,![])&&(_0x4c44f5=0x1);}),_0x4c44f5;}async function run(_0x49a04d,_0x40df56,_0x3dbd0b){const _0x3c2057=a5_0x2eb826,_0x539307={'ZdKba':function(_0x5515e0,_0x4aaca8){return _0x5515e0(_0x4aaca8);},'bzqJw':function(_0x1441ef,_0x562ec2){return _0x1441ef>_0x562ec2;},'aKHkY':_0x3c2057(0x152),'VKsHz':'Removing\x20tmp\x20directory\x20created\x20for\x20reports','fAjAu':_0x3c2057(0x13f),'nuPLz':_0x3c2057(0x14c),'byasi':_0x3c2057(0x118),'tVmsq':function(_0x5d8aea,_0x557cf0){return _0x5d8aea-_0x557cf0;},'RjDxH':function(_0x5d59cc,_0x4d7421){return _0x5d59cc>=_0x4d7421;},'yfUvO':function(_0x36c350,_0x9b8025){return _0x36c350!=_0x9b8025;},'wbdvs':_0x3c2057(0xef),'IycIv':function(_0x170cf9,_0x5c02cb,_0x511b91,_0x4c93e8,_0x20584c,_0x2491b2){return _0x170cf9(_0x5c02cb,_0x511b91,_0x4c93e8,_0x20584c,_0x2491b2);}};await _0x3dbd0b[_0x3c2057(0x158)](_0x49a04d),helper[_0x3c2057(0xe7)](_0x3dbd0b[_0x3c2057(0x153)],_0x49a04d);!helper[_0x3c2057(0x121)]()&&await _0x3dbd0b['setupTCGAuth']();await helper[_0x3c2057(0xfb)](_0x3dbd0b[_0x3c2057(0xe8)]);const _0x5a71d7=helper[_0x3c2057(0x12c)](_0x3dbd0b[_0x3c2057(0xe8)]);!helper[_0x3c2057(0xf6)](_0x3dbd0b[_0x3c2057(0xe8)][_0x3c2057(0x134)])&&(process[_0x3c2057(0x10d)][_0x3c2057(0x146)]=JSON[_0x3c2057(0x157)](_0x3dbd0b[_0x3c2057(0xe8)][_0x3c2057(0x134)]));const _0x5a430e=await TestHubHandler[_0x3c2057(0x103)](constants[_0x3c2057(0xf8)][_0x3c2057(0x12e)],_0x3dbd0b);let _0x574216=[];if(!helper[_0x3c2057(0x121)]()){const _0x549c54={};_0x549c54[_0x3c2057(0x124)]=[],_0x574216=helper[_0x3c2057(0x11e)](Object['assign']({},_0x3dbd0b['config'],_0x549c54),_0x5a71d7,constants[_0x3c2057(0xf8)][_0x3c2057(0x12e)]);}else _0x574216=helper[_0x3c2057(0x11e)](_0x3dbd0b[_0x3c2057(0xe8)],_0x5a71d7,constants[_0x3c2057(0xf8)]['CUCUMBER']);if(!_0x3dbd0b[_0x3c2057(0xe8)])return;const _0x4ef2a2=_0x3dbd0b['config']['parallelsPerPlatform']||helper[_0x3c2057(0xfa)](_0x49a04d,_0x40df56,_0x3dbd0b['config'],constants[_0x3c2057(0xf8)][_0x3c2057(0x12e)])||0x1,_0x464f0e={'server':helper['getHubUrl'](_0x3dbd0b[_0x3c2057(0xe8)]),'proxySettings':_0x3dbd0b[_0x3c2057(0xe8)]['proxySettings'],'maxWorkers':_0x4ef2a2,'browserStackLogLevel':_0x3dbd0b[_0x3c2057(0xe8)]['logLevel'],'skipSessionName':_0x3dbd0b['config'][_0x3c2057(0x125)][_0x3c2057(0x10c)],'skipSessionStatus':_0x3dbd0b['config']['testContextOptions'][_0x3c2057(0x13e)],'turboScaleUrl':_0x3dbd0b['config']['turboScaleUrl']},_0x4129d9=process[_0x3c2057(0x128)],[_0x147b6a,_0x58aa0a]=helper['parseFormatters'](_0x4129d9),_0x3eeabf=path['join'](process['cwd'](),_0x539307[_0x3c2057(0xeb)]);if(_0x539307['bzqJw'](_0x58aa0a['length'],0x0)){helper[_0x3c2057(0xee)](_0x3eeabf);for(let _0x177789=_0x539307[_0x3c2057(0x104)](_0x147b6a[_0x3c2057(0xf2)],0x1);_0x539307[_0x3c2057(0x10f)](_0x177789,0x0);_0x177789--){_0x4129d9['splice'](_0x147b6a[_0x177789],0x2);}}_0x539307['yfUvO'](_0x3dbd0b['config'][_0x3c2057(0x15a)],null)?process[_0x3c2057(0x10d)][_0x3c2057(0x136)]=_0x3dbd0b[_0x3c2057(0xe8)]['testObservability']:process[_0x3c2057(0x10d)]['BROWSERSTACK_TEST_OBSERVABILITY_YML']=_0x539307[_0x3c2057(0x105)];PerformanceTester[_0x3c2057(0x116)](PerformanceEvents['SDK_SETUP']);let _0x1e2c5b;_0x539307[_0x3c2057(0x11f)](parallelCucumberRun,_0x574216,_0x464f0e,_0x3dbd0b['config'],_0x4129d9,_0x58aa0a)['then'](async _0x8c73f5=>{const _0x37aee4=_0x3c2057;PerformanceTester[_0x37aee4(0x108)](PerformanceEvents[_0x37aee4(0x130)]),_0x1e2c5b=_0x8c73f5;const _0x14dc56=_0x539307[_0x37aee4(0x10e)](printCucumberStats,_0x8c73f5);process[_0x37aee4(0x109)]=_0x14dc56,_0x539307[_0x37aee4(0xf1)](_0x58aa0a['length'],0x0)&&(logger['debug'](_0x539307['aKHkY']),helper[_0x37aee4(0x131)](_0x3eeabf,_0x58aa0a),logger[_0x37aee4(0x14d)](_0x539307[_0x37aee4(0x137)]),helper[_0x37aee4(0xf7)](_0x3eeabf));})[_0x3c2057(0x14e)](async()=>{const _0x169fa8=_0x3c2057;PerformanceTester[_0x169fa8(0x108)](PerformanceEvents['SDK_CLEANUP']),_0x3dbd0b[_0x169fa8(0x102)]=helper[_0x169fa8(0xff)](_0x1e2c5b,_0x539307[_0x169fa8(0xea)]),testOpsHelper[_0x169fa8(0x127)]();try{await TestHubHandler[_0x169fa8(0x142)]();}catch(_0x30cc8b){logger[_0x169fa8(0x14d)](_0x169fa8(0x14f)+util[_0x169fa8(0x122)](_0x30cc8b));}try{const {browserstackFolderPath:_0x23ddd9,tcgConfigPath:_0x49c118}=helper[_0x169fa8(0x100)]();fs[_0x169fa8(0x107)](_0x49c118),fs[_0x169fa8(0x106)](_0x23ddd9);}catch(_0x5b56e0){logger[_0x169fa8(0x14d)](_0x539307[_0x169fa8(0x11a)],_0x5b56e0);}await utilities[_0x169fa8(0x15b)](_0x3dbd0b);});}module['exports']=run;function a5_0x27b1(){const _0x2fdb46=['true','../../helpers/BrowserStackSetup','bzqJw','length','chalk','fXOnI','../test-runner','isUndefined','removeDir','FRAMEWORKS','../../helpers/utilities','getUserWorkerCount','handleApp','2611116pqoZjQ','MiESn','bold','getErrorMessageFromResults','getTCGConfigFilePaths','push','errorMessage','launchBuild','tVmsq','wbdvs','rmdirSync','unlinkSync','start','exitCode','aBsJt','2368zYoLKc','skipSessionName','env','ZdKba','RjDxH','AtnpJ','stepsPending','YItWA','green','EVENTS','cyan','end','steps','tmp','\x20ambiguous','nuPLz','\x20pending','lHdaz','4573349jAsSdp','prepareCapabilities','IycIv','TiiAQ','isBrowserstackInfra','format','3gcFRTn','platforms','testContextOptions','../../helpers/logger','printBuildLink','argv','WqwmO','stepsSkipped','stepsPassed','useW3C','../../helpers/helper','CUCUMBER','\x20failed','SDK_CLEANUP','mergeOutputFiles','6NqbvwR','\x20steps','accessibilityOptions','getPlatformName','BROWSERSTACK_TEST_OBSERVABILITY_YML','VKsHz','37140vOkCLR','util','\x20skipped','stepsFailed','\x20passed','forEach','skipSessionStatus','cucumber','red','stepsAmbiguous','stop','12cFwNlK','MGhGX','stepsUnknown','BROWSERSTACK_TEST_ACCESSIBILITY_CONFIGURATION_YML','../../helpers/testhub/testhubHandler','path','wukgR','10EYJmkz','log','error\x20removing\x20tcg\x20config\x20file','debug','finally','Exception\x20in\x20stop\x20build\x20request\x20to\x20testhub\x20:\x20','13FZoeKH','stepsUndefined','Generating\x20consolidated\x20report...','framework','winstonLogger','25710932CbCCXM','2661236PtebQQ','stringify','initialize','2710220FBijQE','testObservability','finalExecution','jghDh','setUserConfigPath','config','1351rEltEK','fAjAu','byasi','tTWbw','yellow','createDir'];a5_0x27b1=function(){return _0x2fdb46;};return a5_0x27b1();}