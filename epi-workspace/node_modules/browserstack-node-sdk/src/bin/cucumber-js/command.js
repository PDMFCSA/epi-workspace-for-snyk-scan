#!/usr/bin/env node
'use strict';const a5_0x1b6367=a5_0x32c5;(function(_0x1e3cd5,_0x2a2c91){const _0x29052a=a5_0x32c5,_0xaad7e1=_0x1e3cd5();while(!![]){try{const _0xa7bed2=-parseInt(_0x29052a(0x12f))/0x1+parseInt(_0x29052a(0x190))/0x2+parseInt(_0x29052a(0x15c))/0x3*(-parseInt(_0x29052a(0x132))/0x4)+parseInt(_0x29052a(0x185))/0x5*(parseInt(_0x29052a(0x138))/0x6)+-parseInt(_0x29052a(0x197))/0x7+-parseInt(_0x29052a(0x145))/0x8*(-parseInt(_0x29052a(0x147))/0x9)+parseInt(_0x29052a(0x160))/0xa;if(_0xa7bed2===_0x2a2c91)break;else _0xaad7e1['push'](_0xaad7e1['shift']());}catch(_0x236ef9){_0xaad7e1['push'](_0xaad7e1['shift']());}}}(a5_0x2ba4,0xf29fa));function a5_0x32c5(_0x1f1c40,_0x4a1e55){const _0x2ba420=a5_0x2ba4();return a5_0x32c5=function(_0x32c5c4,_0x55de26){_0x32c5c4=_0x32c5c4-0x118;let _0x4da7c2=_0x2ba420[_0x32c5c4];return _0x4da7c2;},a5_0x32c5(_0x1f1c40,_0x4a1e55);}const fs=require('fs'),path=require(a5_0x1b6367(0x188)),util=require(a5_0x1b6367(0x18c)),logger=require(a5_0x1b6367(0x179))['winstonLogger'],{default:BrowserStackSetup}=require('../../helpers/BrowserStackSetup'),helper=require(a5_0x1b6367(0x19c)),utilities=require('../../helpers/utilities'),constants=require('../utils/constants'),{parallelCucumberRun}=require('../test-runner'),TestHubHandler=require(a5_0x1b6367(0x195)),testOpsHelper=require(a5_0x1b6367(0x178)),chalk=require(a5_0x1b6367(0x166)),PerformanceTester=require(a5_0x1b6367(0x15d)),PerformanceEvents=require(a5_0x1b6367(0x18a))['EVENTS'],BrowserstackCLI=require(a5_0x1b6367(0x183)),CLIUtils=require(a5_0x1b6367(0x144)),TestInfo=require('../v2/TestInfo');function printCucumberStats(_0x24adf8){const _0x3eaa51=a5_0x1b6367,_0x56d792={};_0x56d792['qbFRf']=function(_0x5abc02,_0x641097){return _0x5abc02>_0x641097;},_0x56d792[_0x3eaa51(0x173)]=function(_0x40e987,_0x5c5721){return _0x40e987-_0x5c5721;},_0x56d792[_0x3eaa51(0x142)]=function(_0x1b6e1b,_0x130d47){return _0x1b6e1b-_0x130d47;},_0x56d792[_0x3eaa51(0x140)]=function(_0x4a9cc2,_0x4334cd){return _0x4a9cc2>_0x4334cd;},_0x56d792[_0x3eaa51(0x16d)]=function(_0x4bd0ef,_0xaffa54){return _0x4bd0ef>_0xaffa54;},_0x56d792[_0x3eaa51(0x16b)]=function(_0x1e9f0a,_0x174b68){return _0x1e9f0a>_0x174b68;},_0x56d792[_0x3eaa51(0x169)]=function(_0x2fd9de,_0x1493ec){return _0x2fd9de>_0x1493ec;},_0x56d792['rCVEA']=function(_0x348beb,_0x5e3ba8){return _0x348beb>_0x5e3ba8;},_0x56d792[_0x3eaa51(0x11d)]=function(_0x3f5eef,_0x1d487b){return _0x3f5eef>_0x1d487b;},_0x56d792['ZSfwu']=function(_0x325889,_0x410504){return _0x325889>_0x410504;},_0x56d792[_0x3eaa51(0x150)]=function(_0x4cc14f,_0x4baa5e){return _0x4cc14f>_0x4baa5e;},_0x56d792['HHSsk']=function(_0x4e6431,_0x268614){return _0x4e6431+_0x268614;},_0x56d792[_0x3eaa51(0x137)]=function(_0x57c56d,_0x33aabb){return _0x57c56d+_0x33aabb;},_0x56d792['FvuDt']=function(_0x51ef7d,_0xebd5fe){return _0x51ef7d+_0xebd5fe;},_0x56d792[_0x3eaa51(0x12e)]=function(_0x2b348f,_0x5a75c2){return _0x2b348f+_0x5a75c2;},_0x56d792[_0x3eaa51(0x11b)]=function(_0x303e97,_0x2c2ebc){return _0x303e97===_0x2c2ebc;},_0x56d792['tUNNY']=function(_0x4be756,_0x2fcbbe){return _0x4be756===_0x2fcbbe;},_0x56d792[_0x3eaa51(0x172)]=_0x3eaa51(0x13a);const _0x15c33a=_0x56d792;let _0x5c8bf6=0x0;if(_0x15c33a[_0x3eaa51(0x19a)](_0x24adf8[_0x3eaa51(0x13d)],0x0))return _0x5c8bf6;return console[_0x3eaa51(0x194)](chalk[_0x3eaa51(0x14d)][_0x3eaa51(0x119)](_0x15c33a['Itdqo'])),_0x24adf8[_0x3eaa51(0x149)](_0x1c7c03=>{const _0x480882=_0x3eaa51,_0xf858cc=_0x1c7c03[0x0],_0x47d5b3=_0x1c7c03[0x1];helper[_0x480882(0x19b)]()&&console[_0x480882(0x194)]('\x0a'+chalk[_0x480882(0x14d)]['yellow'](''+helper[_0x480882(0x199)](_0xf858cc)));const _0x4854c8=_0x47d5b3[_0x480882(0x182)],_0x183517=_0x47d5b3[_0x480882(0x146)],_0x255c43=_0x47d5b3['scenariosFailed'],_0x478033=_0x47d5b3['stepsFailed'],_0x42e507=_0x47d5b3[_0x480882(0x175)],_0x1df616=_0x47d5b3[_0x480882(0x17d)],_0x3e17f9=_0x47d5b3[_0x480882(0x126)],_0x802e89=_0x47d5b3[_0x480882(0x13c)],_0x2f4c45=_0x47d5b3[_0x480882(0x189)],_0x802f1d=_0x47d5b3[_0x480882(0x19d)],_0x445376=_0x47d5b3['processSuccess'];let _0x2384b2=_0x4854c8+_0x480882(0x17a);const _0x24cf94=_0x15c33a['qbFRf'](_0x15c33a[_0x480882(0x173)](_0x4854c8,_0x255c43),0x0)?_0x15c33a[_0x480882(0x142)](_0x4854c8,_0x255c43):0x0;if(_0x15c33a[_0x480882(0x140)](_0x255c43,0x0)&&_0x15c33a['PbIuk'](_0x24cf94,0x0))_0x2384b2+='\x20('+chalk[_0x480882(0x14d)][_0x480882(0x118)](_0x255c43+_0x480882(0x164))+',\x20'+chalk[_0x480882(0x14d)][_0x480882(0x192)](_0x24cf94+_0x480882(0x186))+')';else(_0x15c33a[_0x480882(0x16b)](_0x255c43,0x0)||_0x15c33a['weLSW'](_0x24cf94,0x0))&&(_0x2384b2+=_0x15c33a[_0x480882(0x16b)](_0x255c43,0x0)?'\x20('+chalk[_0x480882(0x14d)][_0x480882(0x118)](_0x255c43+_0x480882(0x164))+')':'\x20('+chalk['bold'][_0x480882(0x192)](_0x24cf94+_0x480882(0x186))+')');const _0x24232c=_0x183517+'\x20steps',_0xf2b736=[];_0x15c33a['rCVEA'](_0x802f1d,0x0)&&_0xf2b736[_0x480882(0x143)](''+chalk['bold']['red'](_0x802f1d+_0x480882(0x14c)));_0x15c33a['AMJAV'](_0x478033,0x0)&&_0xf2b736[_0x480882(0x143)](''+chalk['bold']['red'](_0x478033+_0x480882(0x164)));_0x15c33a['ZSfwu'](_0x42e507,0x0)&&_0xf2b736['push'](''+chalk['bold']['green'](_0x42e507+'\x20passed'));_0x15c33a['bXLnt'](_0x3e17f9,0x0)&&_0xf2b736[_0x480882(0x143)](''+chalk['bold'][_0x480882(0x167)](_0x3e17f9+_0x480882(0x161)));_0x15c33a['rCVEA'](_0x1df616,0x0)&&_0xf2b736['push'](''+chalk[_0x480882(0x14d)][_0x480882(0x130)](_0x1df616+_0x480882(0x133)));_0x15c33a[_0x480882(0x169)](_0x802e89,0x0)&&_0xf2b736[_0x480882(0x143)](''+chalk['bold']['yellow'](_0x802e89+_0x480882(0x128)));_0x15c33a[_0x480882(0x11d)](_0x2f4c45,0x0)&&_0xf2b736[_0x480882(0x143)](''+chalk['bold'][_0x480882(0x167)](_0x2f4c45+_0x480882(0x133)));const _0x87e58e=_0x15c33a['HHSsk'](_0x15c33a[_0x480882(0x137)](_0x15c33a[_0x480882(0x137)](_0x24232c,'('),_0xf2b736['join'](',\x20')),')');console[_0x480882(0x194)](_0x15c33a[_0x480882(0x156)](_0x15c33a[_0x480882(0x137)](_0x15c33a[_0x480882(0x12e)](_0x15c33a[_0x480882(0x135)]('\x0a',_0x2384b2),'\x0a'),_0x87e58e),'\x0a')),_0x15c33a[_0x480882(0x11b)](_0x445376,![])&&(_0x5c8bf6=0x1);}),_0x5c8bf6;}function a5_0x2ba4(){const _0x366592=['yellow','ZtRUE','weLSW','tFirT','NEUMa','createDir','PbIuk','rmdirSync','framework','qyvAq','FRAMEWORKS','Itdqo','ctNZg','getInstance','stepsPassed','argv','assign','../../helpers/test-observability/utils','../../helpers/logger','\x20scenarios','BROWSERSTACK_TEST_ACCESSIBILITY_CONFIGURATION_YML','accessibilityOptions','stepsSkipped','binSessionId','finalExecution','splice','QmfNF','scenarios','../v2/browserstackCLI','exports','33815zCMwPd','\x20passed','SDK_CLEANUP','path','stepsUnknown','../../helpers/performance/constants','start','util','skipSessionStatus','printBuildLink','env','3820514JNcECr','Generating\x20consolidated\x20report...','green','RSpca','log','../../helpers/testhub/testhubHandler','XYduw','6296276cZqvTL','finally','getPlatformName','tUNNY','isBrowserstackInfra','../../helpers/helper','stepsAmbiguous','red','bgWhite','svNMu','fLyjI','prepareCapabilities','AMJAV','setFrameworkDetail','getPackageVersion','xdfEy','true','testContextOptions','unlinkSync','parallelsPerPlatform','getErrorMessageFromResults','stepsPending','errorMessage','\x20undefined','config','@playwright/test','parseFormatters','handleApp','setupTCGAuth','qIncg','1618667sdXJUu','cyan','debug','87064YPQawk','\x20skipped','stop','HHSsk','removeDir','DQAvt','210mrPawn','error\x20removing\x20tcg\x20config\x20file','****\x20RESULTS\x20****','end','stepsUndefined','length','getUserWorkerCount','BROWSERSTACK_TEST_OBSERVABILITY_YML','uOfGk','tmp','gWsye','push','../v2/cliUtils','8bXOrhK','steps','4082229lbTDiP','\x20for\x20cucumber-js\x20flow','forEach','then','format','\x20ambiguous','bold','bootstrap','isUndefined','bXLnt','SDK_SETUP','Exception\x20in\x20stop\x20build\x20request\x20to\x20testhub\x20:\x20','qovon','getHubUrl','platforms','FvuDt','initialize','proxySettings','Detected\x20Playwright\x20version\x20','join','Dadhg','228UAlDGv','../../helpers/performance/performance-tester','logLevel','CUCUMBER','25655940aHsfuk','\x20pending','useW3C','Removing\x20tmp\x20directory\x20created\x20for\x20reports','\x20failed','4|1|3|0|2','chalk'];a5_0x2ba4=function(){return _0x366592;};return a5_0x2ba4();}async function run(_0x3239c3,_0x541712,_0x40ff88){const _0x2c421c=a5_0x1b6367,_0x464ea5={'JcUwq':function(_0x9a4c58,_0x1e1af8){return _0x9a4c58(_0x1e1af8);},'qovon':function(_0x9aca71,_0x4401e0){return _0x9aca71>_0x4401e0;},'tFirT':_0x2c421c(0x191),'fuify':_0x2c421c(0x163),'RSpca':'cucumber','QmfNF':_0x2c421c(0x139),'YSujA':_0x2c421c(0x12a),'YOYEj':_0x2c421c(0x165),'ZtRUE':_0x2c421c(0x141),'Dadhg':function(_0x38b8eb,_0x1a99d6){return _0x38b8eb>_0x1a99d6;},'xdfEy':function(_0x1d4350,_0x42cbe4){return _0x1d4350-_0x42cbe4;},'svNMu':function(_0x1730e0,_0x473259){return _0x1730e0>=_0x473259;},'XYduw':function(_0x55c82e,_0x2b6fcb){return _0x55c82e!=_0x2b6fcb;},'CDoyy':_0x2c421c(0x121),'qyvAq':function(_0x5c52a7,_0x2e7300,_0x464514,_0xc63b79,_0x8363bf,_0x43693f){return _0x5c52a7(_0x2e7300,_0x464514,_0xc63b79,_0x8363bf,_0x43693f);}},_0x5401a9=helper[_0x2c421c(0x11f)](_0x464ea5['YSujA']);let _0x1b64ac=constants['FRAMEWORKS']['CUCUMBER'];global['__isPlaywrightInstalled']=!!_0x5401a9,await _0x40ff88[_0x2c421c(0x157)](_0x3239c3);if(_0x5401a9){const _0x317757=_0x464ea5['YOYEj']['split']('|');let _0xceb67d=0x0;while(!![]){switch(_0x317757[_0xceb67d++]){case'0':BrowserstackCLI[_0x2c421c(0x174)]()['setBrowserstackConfig'](_0x40ff88['config'],_0x40ff88['cliConfig']);continue;case'1':logger[_0x2c421c(0x131)](_0x2c421c(0x159)+_0x5401a9+_0x2c421c(0x148));continue;case'2':await BrowserstackCLI[_0x2c421c(0x174)]()[_0x2c421c(0x14e)]();continue;case'3':CLIUtils[_0x2c421c(0x11e)](constants[_0x2c421c(0x171)]['CUCUMBER'],_0x1b64ac);continue;case'4':_0x1b64ac=constants[_0x2c421c(0x171)]['PLAYWRIGHT'];continue;}break;}}BrowserstackCLI[_0x2c421c(0x174)]()[_0x2c421c(0x17e)]&&(process[_0x2c421c(0x18f)]['BROWSERSTACK_CLI_BIN_SESSION_ID']=BrowserstackCLI['getInstance']()[_0x2c421c(0x17e)]);helper['setUserConfigPath'](_0x40ff88[_0x2c421c(0x16f)],_0x3239c3);!helper[_0x2c421c(0x19b)]()&&await _0x40ff88[_0x2c421c(0x12d)]();await helper[_0x2c421c(0x12c)](_0x40ff88['config']);const _0x5cf7b6=helper[_0x2c421c(0x162)](_0x40ff88['config']);!helper[_0x2c421c(0x14f)](_0x40ff88[_0x2c421c(0x129)][_0x2c421c(0x17c)])&&(process[_0x2c421c(0x18f)][_0x2c421c(0x17b)]=JSON['stringify'](_0x40ff88['config'][_0x2c421c(0x17c)]));if(!BrowserstackCLI[_0x2c421c(0x174)]()['isRunning']()){const _0x21c9f9=await TestHubHandler['launchBuild'](constants[_0x2c421c(0x171)][_0x2c421c(0x15f)],_0x40ff88);}let _0x59190c=[];if(!helper[_0x2c421c(0x19b)]()){const _0x45671a={};_0x45671a[_0x2c421c(0x155)]=[],_0x59190c=helper[_0x2c421c(0x11c)](Object[_0x2c421c(0x177)]({},_0x40ff88[_0x2c421c(0x129)],_0x45671a),_0x5cf7b6,constants['FRAMEWORKS'][_0x2c421c(0x15f)]);}else _0x59190c=helper[_0x2c421c(0x11c)](_0x40ff88[_0x2c421c(0x129)],_0x5cf7b6,constants[_0x2c421c(0x171)]['CUCUMBER']);if(!_0x40ff88[_0x2c421c(0x129)])return;const _0x31726c=_0x40ff88[_0x2c421c(0x129)][_0x2c421c(0x124)]||helper[_0x2c421c(0x13e)](_0x3239c3,_0x541712,_0x40ff88[_0x2c421c(0x129)],constants['FRAMEWORKS'][_0x2c421c(0x15f)])||0x1,_0xdc806={'server':helper[_0x2c421c(0x154)](_0x40ff88[_0x2c421c(0x129)]),'proxySettings':_0x40ff88[_0x2c421c(0x129)][_0x2c421c(0x158)],'maxWorkers':_0x31726c,'browserStackLogLevel':_0x40ff88[_0x2c421c(0x129)][_0x2c421c(0x15e)],'skipSessionName':_0x40ff88[_0x2c421c(0x129)][_0x2c421c(0x122)]['skipSessionName'],'skipSessionStatus':_0x40ff88['config'][_0x2c421c(0x122)][_0x2c421c(0x18d)],'turboScaleUrl':_0x40ff88[_0x2c421c(0x129)]['turboScaleUrl']},_0x20eaf7=process[_0x2c421c(0x176)],[_0x48fd03,_0x3c734c]=helper[_0x2c421c(0x12b)](_0x20eaf7),_0x22295b=path[_0x2c421c(0x15a)](process['cwd'](),_0x464ea5[_0x2c421c(0x168)]);if(_0x464ea5[_0x2c421c(0x15b)](_0x3c734c[_0x2c421c(0x13d)],0x0)){helper[_0x2c421c(0x16c)](_0x22295b);for(let _0x202e1a=_0x464ea5[_0x2c421c(0x120)](_0x48fd03['length'],0x1);_0x464ea5[_0x2c421c(0x11a)](_0x202e1a,0x0);_0x202e1a--){_0x20eaf7[_0x2c421c(0x180)](_0x48fd03[_0x202e1a],0x2);}}_0x464ea5[_0x2c421c(0x196)](_0x40ff88[_0x2c421c(0x129)]['testObservability'],null)?process[_0x2c421c(0x18f)][_0x2c421c(0x13f)]=_0x40ff88['config']['testObservability']:process[_0x2c421c(0x18f)]['BROWSERSTACK_TEST_OBSERVABILITY_YML']=_0x464ea5['CDoyy'];PerformanceTester[_0x2c421c(0x13b)](PerformanceEvents[_0x2c421c(0x151)]);let _0x1245b9;_0x464ea5[_0x2c421c(0x170)](parallelCucumberRun,_0x59190c,_0xdc806,_0x40ff88[_0x2c421c(0x129)],_0x20eaf7,_0x3c734c)[_0x2c421c(0x14a)](async _0x2b8b77=>{const _0x22cc7a=_0x2c421c;PerformanceTester[_0x22cc7a(0x18b)](PerformanceEvents[_0x22cc7a(0x187)]),_0x1245b9=_0x2b8b77;const _0x3019b8=_0x464ea5['JcUwq'](printCucumberStats,_0x2b8b77);process['exitCode']=_0x3019b8,_0x464ea5[_0x22cc7a(0x153)](_0x3c734c[_0x22cc7a(0x13d)],0x0)&&(logger['debug'](_0x464ea5[_0x22cc7a(0x16a)]),helper['mergeOutputFiles'](_0x22295b,_0x3c734c),logger[_0x22cc7a(0x131)](_0x464ea5['fuify']),helper[_0x22cc7a(0x136)](_0x22295b));})[_0x2c421c(0x198)](async()=>{const _0x3ded0c=_0x2c421c;PerformanceTester[_0x3ded0c(0x18b)](PerformanceEvents[_0x3ded0c(0x187)]),_0x40ff88[_0x3ded0c(0x127)]=helper[_0x3ded0c(0x125)](_0x1245b9,_0x464ea5[_0x3ded0c(0x193)]),testOpsHelper[_0x3ded0c(0x18e)]();try{await TestHubHandler['stop'](),await BrowserstackCLI[_0x3ded0c(0x174)]()[_0x3ded0c(0x134)]();}catch(_0x5384bf){logger['debug'](_0x3ded0c(0x152)+util[_0x3ded0c(0x14b)](_0x5384bf));}try{const {browserstackFolderPath:_0x5cb147,tcgConfigPath:_0x5e1dcc}=helper['getTCGConfigFilePaths']();fs[_0x3ded0c(0x123)](_0x5e1dcc),fs[_0x3ded0c(0x16e)](_0x5cb147);}catch(_0x43a32a){logger[_0x3ded0c(0x131)](_0x464ea5[_0x3ded0c(0x181)],_0x43a32a);}await utilities[_0x3ded0c(0x17f)](_0x40ff88);});}module[a5_0x1b6367(0x184)]=run;