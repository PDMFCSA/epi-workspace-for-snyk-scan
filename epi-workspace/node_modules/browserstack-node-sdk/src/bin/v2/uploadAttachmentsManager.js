const a89_0x230463=a89_0x281a;(function(_0x5314b0,_0x3f74fa){const _0x53b533=a89_0x281a,_0x279eeb=_0x5314b0();while(!![]){try{const _0x53e31c=parseInt(_0x53b533(0xd2))/0x1+parseInt(_0x53b533(0xee))/0x2*(-parseInt(_0x53b533(0x12c))/0x3)+parseInt(_0x53b533(0xe7))/0x4+parseInt(_0x53b533(0x11c))/0x5+-parseInt(_0x53b533(0xed))/0x6+-parseInt(_0x53b533(0x136))/0x7+-parseInt(_0x53b533(0x134))/0x8;if(_0x53e31c===_0x3f74fa)break;else _0x279eeb['push'](_0x279eeb['shift']());}catch(_0xe7b1f9){_0x279eeb['push'](_0x279eeb['shift']());}}}(a89_0x4ade,0x5d810));const os=require('os'),fs=require('fs'),path=require(a89_0x230463(0xfa)),util=require(a89_0x230463(0x12e)),BrowserstackCLI=require('./browserstackCLI'),https=require('https'),http=require('http'),AutomationFramework=require(a89_0x230463(0xca)),PlaywrightDriverModule=require(a89_0x230463(0xd0)),TestInfo=require('./TestInfo'),TestFrameworkConstants=require('./framework/constants/testFrameworkConstants'),{createClassLogger}=require('../../helpers/classLogger.js');function a89_0x281a(_0x5f4462,_0x2c9664){const _0x4ade00=a89_0x4ade();return a89_0x281a=function(_0x281aaa,_0x1f85a7){_0x281aaa=_0x281aaa-0xb9;let _0xf4b6a9=_0x4ade00[_0x281aaa];return _0xf4b6a9;},a89_0x281a(_0x5f4462,_0x2c9664);}class uploadAttachmentsManager{static [a89_0x230463(0x138)]=createClassLogger('uploadAttachmentsManager');static[a89_0x230463(0x100)](_0x589b47,_0x413ede=![]){const _0x1b6faa=a89_0x230463,_0x3fa18f={};_0x3fa18f['vuLkA']=function(_0x2367f5,_0x5982a7){return _0x2367f5/_0x5982a7;},_0x3fa18f[_0x1b6faa(0x11d)]=function(_0x268459,_0x33d227){return _0x268459*_0x33d227;},_0x3fa18f[_0x1b6faa(0xdb)]=function(_0x194fe8,_0x49383f){return _0x194fe8>_0x49383f;},_0x3fa18f[_0x1b6faa(0xf3)]=_0x1b6faa(0x118),_0x3fa18f['dvgOc']='File\x20downloaded\x20to:\x20%s',_0x3fa18f['qUphe']=function(_0x3b43b4,_0x153375){return _0x3b43b4===_0x153375;},_0x3fa18f[_0x1b6faa(0x110)]='finish',_0x3fa18f['SXUTL']=_0x1b6faa(0xdf),_0x3fa18f[_0x1b6faa(0xd7)]=_0x1b6faa(0x11e),_0x3fa18f[_0x1b6faa(0xc5)]=_0x1b6faa(0x113),_0x3fa18f[_0x1b6faa(0xbe)]='.browserstack',_0x3fa18f[_0x1b6faa(0x126)]=_0x1b6faa(0xff),_0x3fa18f[_0x1b6faa(0xfe)]=_0x1b6faa(0xf1),_0x3fa18f[_0x1b6faa(0x10a)]=_0x1b6faa(0xec),_0x3fa18f[_0x1b6faa(0x13a)]='Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.',_0x3fa18f[_0x1b6faa(0xc3)]=_0x1b6faa(0xf8),_0x3fa18f[_0x1b6faa(0xe2)]='http://',_0x3fa18f[_0x1b6faa(0x129)]=_0x1b6faa(0x11b),_0x3fa18f[_0x1b6faa(0x10c)]='Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s',_0x3fa18f[_0x1b6faa(0xc4)]=function(_0x5dd40b,_0x1ca4cd){return _0x5dd40b/_0x1ca4cd;},_0x3fa18f[_0x1b6faa(0xf5)]=function(_0x425b14,_0x1491e5){return _0x425b14*_0x1491e5;},_0x3fa18f[_0x1b6faa(0xf4)]=_0x1b6faa(0x128);const _0x3965d6=_0x3fa18f;this['logger'][_0x1b6faa(0x101)](util['format'](_0x3965d6[_0x1b6faa(0xc5)],_0x589b47));const _0x399155=os[_0x1b6faa(0x139)](),_0x3558c2=path[_0x1b6faa(0x111)](_0x399155,_0x3965d6[_0x1b6faa(0xbe)]);!fs[_0x1b6faa(0xd9)](_0x3558c2)&&(this[_0x1b6faa(0x138)][_0x1b6faa(0x101)](util[_0x1b6faa(0xf9)](_0x3965d6[_0x1b6faa(0x126)],_0x3558c2)),fs['mkdirSync'](_0x3558c2),this[_0x1b6faa(0x138)][_0x1b6faa(0x101)](util['format'](_0x3965d6[_0x1b6faa(0xfe)],_0x3558c2)));const _0xe4b402=BrowserstackCLI['getInstance']()[_0x1b6faa(0xcb)]['TestHubModule']?.[_0x1b6faa(0x132)]?.['toObject']()?.[_0x1b6faa(0x10b)],_0x4f672a=path[_0x1b6faa(0x111)](_0x3558c2,_0xe4b402);!fs[_0x1b6faa(0xd9)](_0x4f672a)&&(fs[_0x1b6faa(0xe5)](_0x4f672a),this[_0x1b6faa(0x138)]['debug'](util['format'](_0x3965d6[_0x1b6faa(0x10a)],_0x4f672a)));if(_0x3965d6['qUphe'](_0x589b47[_0x1b6faa(0xc6)](),'')){this['logger'][_0x1b6faa(0x101)](util[_0x1b6faa(0xf9)](_0x3965d6[_0x1b6faa(0x13a)]));return;}if(_0x589b47[_0x1b6faa(0x119)](_0x3965d6['fweoa'])||_0x589b47['startsWith'](_0x3965d6[_0x1b6faa(0xe2)])){const _0x452e64=_0x589b47[_0x1b6faa(0x119)](_0x3965d6[_0x1b6faa(0xc3)])?https:http,_0x5d1901=path[_0x1b6faa(0xcc)](_0x589b47),_0x321a7e=path[_0x1b6faa(0x111)](_0x4f672a,_0x5d1901),_0x1f0ca4=fs[_0x1b6faa(0xbd)](_0x321a7e);_0x452e64[_0x1b6faa(0x109)](_0x589b47,_0x470e0a=>{const _0x5e5526=_0x1b6faa;if(_0x3965d6[_0x5e5526(0xba)](_0x470e0a['statusCode'],0xc8))_0x470e0a[_0x5e5526(0x112)](_0x1f0ca4),_0x1f0ca4['on'](_0x3965d6[_0x5e5526(0x110)],()=>{const _0x596835=_0x5e5526;_0x1f0ca4[_0x596835(0xd4)]();const _0x2a1531=fs[_0x596835(0xbc)](_0x321a7e),_0x4e1794=_0x3965d6[_0x596835(0x10d)](_0x2a1531[_0x596835(0xc0)],_0x3965d6[_0x596835(0x11d)](0x400,0x400));if(_0x3965d6[_0x596835(0xdb)](_0x4e1794,0x64)){this[_0x596835(0x138)][_0x596835(0x101)](util[_0x596835(0xf9)](_0x3965d6[_0x596835(0xf3)],_0x4e1794[_0x596835(0x12f)](0x2))),fs['unlinkSync'](_0x321a7e);return;}this['logger'][_0x596835(0x101)](util['format'](_0x3965d6[_0x596835(0xdd)],_0x321a7e)),uploadAttachmentsManager[_0x596835(0xeb)](_0x321a7e,_0x413ede);});else{this[_0x5e5526(0x138)]['debug'](util[_0x5e5526(0xf9)](_0x3965d6[_0x5e5526(0x127)],_0x470e0a[_0x5e5526(0xcd)])),_0x1f0ca4[_0x5e5526(0xd4)](),fs[_0x5e5526(0x104)](_0x321a7e);return;}})['on'](_0x3965d6[_0x1b6faa(0x129)],_0x4c2a5f=>{const _0x20a8a5=_0x1b6faa;this['logger'][_0x20a8a5(0x101)](util[_0x20a8a5(0xf9)](_0x3965d6[_0x20a8a5(0xd7)],_0x4c2a5f['message'])),_0x1f0ca4['close'](),fs[_0x20a8a5(0x104)](_0x321a7e);return;});}else{if(!fs['existsSync'](_0x589b47)){this[_0x1b6faa(0x138)][_0x1b6faa(0x101)](util['format'](_0x3965d6[_0x1b6faa(0x10c)],_0x589b47));return;}const _0x2dcfcb=fs['statSync'](_0x589b47),_0xf5c7a0=_0x3965d6[_0x1b6faa(0xc4)](_0x2dcfcb['size'],_0x3965d6['OBnCK'](0x400,0x400));if(_0x3965d6[_0x1b6faa(0xdb)](_0xf5c7a0,0x64)){this[_0x1b6faa(0x138)]['debug'](util['format'](_0x3965d6[_0x1b6faa(0xf4)],_0xf5c7a0[_0x1b6faa(0x12f)](0x2)));return;}const _0x297337=path[_0x1b6faa(0xcc)](_0x589b47),_0x2d96ec=path['join'](_0x4f672a,_0x297337);fs[_0x1b6faa(0xde)](_0x589b47,_0x2d96ec),uploadAttachmentsManager[_0x1b6faa(0xeb)](_0x2d96ec,_0x413ede);}}static['trackFile'](_0x5213ec,_0x59353a){const _0x25a42a=a89_0x230463,_0x548190={'HXpTO':function(_0x26f613,_0x1a6969){return _0x26f613(_0x1a6969);},'ClPKp':'./browserstackCLI','yqrwE':function(_0x3367df,_0x9c210c){return _0x3367df(_0x9c210c);},'vhqtB':'./cliUtils','hmljg':function(_0x2f596d,_0x4d4786){return _0x2f596d===_0x4d4786;},'BnBEL':_0x25a42a(0xef),'uqkIt':'trackFile:\x20No\x20testId\x20available,\x20cannot\x20track\x20attachment','DJuSS':_0x25a42a(0x12a),'lbeZi':_0x25a42a(0xd8),'ZkicZ':_0x25a42a(0xc1),'mCNsi':function(_0x2f537c,_0x165caa){return _0x2f537c(_0x165caa);},'mTNRA':_0x25a42a(0xb9),'fqFYG':function(_0x31e6fd,_0x4e6261){return _0x31e6fd(_0x4e6261);},'dxycy':_0x25a42a(0x108),'KgIhc':'trackFile:\x20Instance\x20not\x20available,\x20cannot\x20track\x20attachment','yOqvm':_0x25a42a(0x133),'xwlgE':'Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload'};try{let _0x1bc543;const _0x7b2318=global['__workerDetails']?.[_0x25a42a(0xf2)]?.[_0x25a42a(0xd1)],_0x5aed64=_0x548190[_0x25a42a(0xfb)](require,_0x548190[_0x25a42a(0x10f)]),_0x1d40d0=_0x548190[_0x25a42a(0x102)](require,_0x548190[_0x25a42a(0x122)]),_0x49d626=_0x5aed64['getInstance']()['isRunning']()&&_0x548190[_0x25a42a(0xe3)](_0x1d40d0[_0x25a42a(0x115)]()?.[_0x25a42a(0xc2)]?.[_0x25a42a(0xe4)](),_0x548190[_0x25a42a(0x124)]);if(_0x49d626){_0x1bc543=global[_0x25a42a(0xfc)];if(!_0x1bc543){const _0x52f7c6=AutomationFramework[_0x25a42a(0xc8)]();_0x1bc543=AutomationFramework[_0x25a42a(0x106)](_0x52f7c6,PlaywrightDriverModule[_0x25a42a(0xe0)],'');}this['logger'][_0x25a42a(0x101)](_0x25a42a(0x125)+_0x1bc543);}else{if(!_0x7b2318){const _0x4dc603=AutomationFramework[_0x25a42a(0xc8)]();_0x1bc543=AutomationFramework[_0x25a42a(0x106)](_0x4dc603,PlaywrightDriverModule[_0x25a42a(0xe0)],'');}else _0x1bc543=TestInfo[_0x25a42a(0x11a)](_0x7b2318,_0x7b2318['retry']);this[_0x25a42a(0x138)][_0x25a42a(0x101)](_0x25a42a(0xd3)+_0x1bc543);}if(!_0x1bc543){this[_0x25a42a(0x138)]['debug'](_0x548190[_0x25a42a(0x107)]);return;}const _0x196c21={[TestFrameworkConstants[_0x25a42a(0xe9)]]:fs['statSync'](_0x5213ec)[_0x25a42a(0xc0)],[TestFrameworkConstants['KEY_FILE_NAME']]:path['basename'](_0x5213ec),[TestFrameworkConstants[_0x25a42a(0x135)]]:_0x5213ec,[TestFrameworkConstants[_0x25a42a(0xd6)]]:_0x59353a?_0x548190[_0x25a42a(0x123)]:_0x548190[_0x25a42a(0xd5)]};if(_0x49d626){const _0x1699c6=_0x5aed64[_0x25a42a(0xf0)]()[_0x25a42a(0x12b)]();if(!_0x1699c6){this[_0x25a42a(0x138)][_0x25a42a(0x101)](_0x548190[_0x25a42a(0x114)]);return;}const _0x3f3604=_0x548190[_0x25a42a(0xc9)](require,_0x548190[_0x25a42a(0x10e)]),_0x40e3a3=_0x548190[_0x25a42a(0xce)](require,_0x548190[_0x25a42a(0xea)]),_0x4b0dcd=_0x1699c6[_0x25a42a(0x103)](_0x3f3604[_0x25a42a(0x137)],_0x40e3a3[_0x25a42a(0xdc)]);if(!_0x4b0dcd){this[_0x25a42a(0x138)]['debug'](_0x548190[_0x25a42a(0xda)]);return;}const _0x351c8f=_0x4b0dcd['getAllData']()[_0x25a42a(0x109)](_0x1bc543)||{},_0x35bc5d=_0x351c8f[TestFrameworkConstants[_0x25a42a(0x117)]]||{},_0x45dfaf={..._0x35bc5d};_0x45dfaf[_0x5213ec]=_0x196c21;const _0x5e3db5=_0x45dfaf,_0x441933={[TestFrameworkConstants[_0x25a42a(0x117)]]:_0x5e3db5},_0x551322={};_0x551322[_0x1bc543]=_0x441933,_0x4b0dcd[_0x25a42a(0xf6)](_0x551322),this['logger'][_0x25a42a(0x101)](_0x25a42a(0xc7)+_0x1bc543+',\x20filepath:\x20'+_0x5213ec);}else{const _0x44d5b2=TestInfo['getTestDetails'](_0x1bc543),_0x42214b=_0x44d5b2[TestFrameworkConstants[_0x25a42a(0x117)]]||{};_0x42214b[_0x5213ec]=_0x196c21,_0x44d5b2[TestFrameworkConstants['KEY_TEST_ATTACHMENTS']]=_0x42214b,TestInfo[_0x25a42a(0xbb)](_0x1bc543,_0x44d5b2),this[_0x25a42a(0x138)][_0x25a42a(0x101)](_0x25a42a(0xbf)+_0x1bc543+_0x25a42a(0xe6)+_0x5213ec);}this[_0x25a42a(0x138)][_0x25a42a(0x101)](util[_0x25a42a(0xf9)](_0x548190[_0x25a42a(0x131)],_0x5213ec));}catch(_0xfd227b){this[_0x25a42a(0x138)]['debug'](util[_0x25a42a(0xf9)](_0x548190[_0x25a42a(0xcf)],_0xfd227b[_0x25a42a(0xf7)]));}}static[a89_0x230463(0x11f)](){const _0x34a867=a89_0x230463,_0x14561a={};_0x14561a['DrzGn']=_0x34a867(0x121),_0x14561a['fUwcC']=_0x34a867(0x130),_0x14561a[_0x34a867(0x12d)]='Cleared\x20attachment\x20folder';const _0x4772cb=_0x14561a,_0x427e9e=os[_0x34a867(0x139)](),_0x6a172=path[_0x34a867(0x111)](_0x427e9e,_0x4772cb['DrzGn']);if(!fs[_0x34a867(0xd9)](_0x6a172))return;const _0x1953fb=BrowserstackCLI['getInstance']()[_0x34a867(0xcb)][_0x34a867(0x116)]?.[_0x34a867(0x132)]?.[_0x34a867(0x120)]()?.[_0x34a867(0x10b)],_0x14b391=_0x1953fb?path[_0x34a867(0x111)](_0x6a172,_0x1953fb):null;if(!_0x14b391||!fs[_0x34a867(0xd9)](_0x14b391)){this[_0x34a867(0x138)][_0x34a867(0x101)](util[_0x34a867(0xf9)](_0x4772cb[_0x34a867(0xfd)],_0x1953fb));return;}const _0x50f809={};_0x50f809['recursive']=!![],_0x50f809[_0x34a867(0xe8)]=!![],fs[_0x34a867(0x105)](_0x14b391,_0x50f809),this['logger'][_0x34a867(0x101)](util['format'](_0x4772cb[_0x34a867(0x12d)]));}}function a89_0x4ade(){const _0x58db9a=['lbeZi','KEY_FILE_LEVEL','xAkcL','TestLevel','existsSync','KgIhc','eXgLl','POST','dvgOc','copyFileSync','Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload','KEY_TEST_ID','exports','CuLDR','hmljg','toLowerCase','mkdirSync',',\x20filepath:\x20','2976920edGjhW','force','KEY_FILE_SIZE','dxycy','trackFile','Created\x20folder:\x20%s','871818hzvyrB','2IyGVbD','jest','getInstance','Created\x20.browserstack\x20folder\x20at:\x20%s','currentTest','ydQqr','Vqrhr','OBnCK','addMultipleEntries','message','https://','format','path','HXpTO','__jestCurrentTestIdentifier','fUwcC','EXoOY','.browserstack\x20folder\x20not\x20found\x20at:\x20%s','uploadAttachments','debug','yqrwE','resolveInstance','unlinkSync','rmSync','getState','uqkIt','./state/hookState','get','uDtxk','buildHashedId','cStND','vuLkA','mTNRA','ClPKp','LVkqW','join','pipe','Attachment\x20recevied\x20for\x20path:\x20%s','ZkicZ','getTestFrameworkDetail','TestHubModule','KEY_TEST_ATTACHMENTS','Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.','startsWith','getTestIdentifierFromTestInfo','error','3819075kmGsmL','meINa','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','clearAttachments','toObject','.browserstack','vhqtB','DJuSS','BnBEL','trackFile:\x20Jest+Playwright\x20-\x20testId\x20(testIdentifier):\x20','eRbql','SXUTL','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','gwCsJ','BuildLevel','getTestFramework','284478Cszkex','rBdle','util','toFixed','No\x20attachment\x20folder\x20found\x20for\x20testhubID:\x20%s','yOqvm','testhubConfig','Attachment\x20file\x20tracked\x20for\x20upload:\x20%s','2666136OOCjUg','KEY_FILE_PATH','5264861DFzlfP','TEST','logger','homedir','ndXLn','./state/testFrameworkState','qUphe','setTestDetails','statSync','createWriteStream','qivFD','trackFile:\x20Stored\x20attachment\x20in\x20TestInfo\x20file\x20for\x20testId:\x20','size','trackFile:\x20TestFramework\x20not\x20available,\x20cannot\x20track\x20attachment','name','fweoa','ARQGF','UEfSv','trim','trackFile:\x20Stored\x20attachment\x20in\x20instance\x20memory\x20for\x20testId:\x20','getTrackedInstance','mCNsi','./framework/automationFramework','modules','basename','statusCode','fqFYG','xwlgE','./modules/playwrightDriverModule','testInfo','200466izbTNI','trackFile:\x20Cucumber+Playwright\x20-\x20testId:\x20','close'];a89_0x4ade=function(){return _0x58db9a;};return a89_0x4ade();}module[a89_0x230463(0xe1)]=uploadAttachmentsManager;