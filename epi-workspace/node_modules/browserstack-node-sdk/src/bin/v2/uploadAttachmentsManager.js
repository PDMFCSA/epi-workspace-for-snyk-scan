const a80_0x15f6de=a80_0x4144;function a80_0x4645(){const _0x425b50=['error','2812356SWCFki','close','LyjFV','statSync','eTiLo','KEY_FILE_PATH','XUqFJ','YPGXu','TestHubModule','4598481HJUkNZ','XmPrD','getTrackedInstance','./framework/constants/testFrameworkConstants','96IMCZHA','KEY_TEST_ID','JvOxN','uploadAttachmentsManager','recursive','basename','jpRnP','GEQdD','util','pmakb','KEY_TEST_ATTACHMENTS','existsSync','Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.','zcibj','Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s','size','testhubConfig','Cleared\x20attachment\x20folder','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','8IbwLpc','XpANl','KEY_FILE_LEVEL','gobsx','Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload','uploadAttachments','File\x20downloaded\x20to:\x20%s','message','.browserstack\x20folder\x20not\x20found\x20at:\x20%s','homedir','pipe','Attachment\x20file\x20tracked\x20for\x20upload:\x20%s','./modules/playwrightDriverModule','1452504sASDEY','mkdirSync','copyFileSync','MHJzY','Created\x20folder:\x20%s','clearAttachments','37306800TSaWiX','1533419BAHxuq','get','173690EAEgUx','toObject','oRChZ','statusCode','logger','getInstance','http://','trackFile','debug','zIZIN','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','siNVg','trim','getState','modules','BuildLevel','IaKBo','aAlKW','../../helpers/classLogger.js','format','Created\x20.browserstack\x20folder\x20at:\x20%s','ezUYw','createWriteStream','fcqQu','iZapq','./framework/automationFramework','getTestDetails','eGRtv','toFixed','path','join','.browserstack','startsWith','6331146zknkRi','PZIjB','rbUio','buildHashedId','rfpes','TVwts','unlinkSync','7oIRYXP'];a80_0x4645=function(){return _0x425b50;};return a80_0x4645();}function a80_0x4144(_0x1f6f42,_0x45f6ee){const _0x464544=a80_0x4645();return a80_0x4144=function(_0x41441e,_0x30fe35){_0x41441e=_0x41441e-0x10a;let _0x4c0cf9=_0x464544[_0x41441e];return _0x4c0cf9;},a80_0x4144(_0x1f6f42,_0x45f6ee);}(function(_0x3aef23,_0x43392d){const _0x3e8a15=a80_0x4144,_0x90458f=_0x3aef23();while(!![]){try{const _0x3294d1=parseInt(_0x3e8a15(0x138))/0x1+-parseInt(_0x3e8a15(0x131))/0x2+-parseInt(_0x3e8a15(0x10d))/0x3+parseInt(_0x3e8a15(0x111))/0x4*(-parseInt(_0x3e8a15(0x13a))/0x5)+-parseInt(_0x3e8a15(0x15b))/0x6*(parseInt(_0x3e8a15(0x162))/0x7)+parseInt(_0x3e8a15(0x124))/0x8*(-parseInt(_0x3e8a15(0x164))/0x9)+parseInt(_0x3e8a15(0x137))/0xa;if(_0x3294d1===_0x43392d)break;else _0x90458f['push'](_0x90458f['shift']());}catch(_0x4b5286){_0x90458f['push'](_0x90458f['shift']());}}}(a80_0x4645,0xc4331));const os=require('os'),fs=require('fs'),path=require(a80_0x15f6de(0x157)),util=require(a80_0x15f6de(0x119)),BrowserstackCLI=require('./browserstackCLI'),https=require('https'),http=require('http'),AutomationFramework=require(a80_0x15f6de(0x153)),PlaywrightDriverModule=require(a80_0x15f6de(0x130)),TestInfo=require('./TestInfo'),TestFrameworkConstants=require(a80_0x15f6de(0x110)),{createClassLogger}=require(a80_0x15f6de(0x14c));class uploadAttachmentsManager{static ['logger']=createClassLogger(a80_0x15f6de(0x114));static[a80_0x15f6de(0x129)](_0x52977b,_0x33e0ea=![]){const _0x596a19=a80_0x15f6de,_0x3f5c12={};_0x3f5c12[_0x596a19(0x134)]=function(_0x47dde6,_0x46966e){return _0x47dde6/_0x46966e;},_0x3f5c12[_0x596a19(0x166)]=function(_0x164754,_0x356abb){return _0x164754*_0x356abb;},_0x3f5c12[_0x596a19(0x151)]=function(_0xda53d8,_0xaad8a8){return _0xda53d8>_0xaad8a8;},_0x3f5c12[_0x596a19(0x15f)]='Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.',_0x3f5c12[_0x596a19(0x127)]=_0x596a19(0x12a),_0x3f5c12['aAlKW']=function(_0x359bab,_0x1e9a01){return _0x359bab===_0x1e9a01;},_0x3f5c12['JvOxN']='finish',_0x3f5c12['FmpFe']='Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload',_0x3f5c12[_0x596a19(0x11e)]=_0x596a19(0x144),_0x3f5c12[_0x596a19(0x168)]='Attachment\x20recevied\x20for\x20path:\x20%s',_0x3f5c12[_0x596a19(0x155)]=_0x596a19(0x159),_0x3f5c12[_0x596a19(0x10e)]=_0x596a19(0x12c),_0x3f5c12[_0x596a19(0x125)]=_0x596a19(0x14e),_0x3f5c12[_0x596a19(0x14a)]=_0x596a19(0x135),_0x3f5c12[_0x596a19(0x152)]=_0x596a19(0x11d),_0x3f5c12[_0x596a19(0x10b)]='https://',_0x3f5c12[_0x596a19(0x11a)]=_0x596a19(0x140),_0x3f5c12[_0x596a19(0x160)]=_0x596a19(0x163),_0x3f5c12[_0x596a19(0x143)]=_0x596a19(0x11f),_0x3f5c12[_0x596a19(0x117)]=function(_0xf61aa0,_0x52716a){return _0xf61aa0>_0x52716a;},_0x3f5c12[_0x596a19(0x145)]=_0x596a19(0x123);const _0x42b6c6=_0x3f5c12;this[_0x596a19(0x13e)][_0x596a19(0x142)](util[_0x596a19(0x14d)](_0x42b6c6[_0x596a19(0x168)],_0x52977b));const _0x10e9ee=os[_0x596a19(0x12d)](),_0x915085=path['join'](_0x10e9ee,_0x42b6c6[_0x596a19(0x155)]);!fs['existsSync'](_0x915085)&&(this['logger'][_0x596a19(0x142)](util['format'](_0x42b6c6['XmPrD'],_0x915085)),fs['mkdirSync'](_0x915085),this[_0x596a19(0x13e)][_0x596a19(0x142)](util['format'](_0x42b6c6['XpANl'],_0x915085)));const _0x518ea4=BrowserstackCLI[_0x596a19(0x13f)]()[_0x596a19(0x148)][_0x596a19(0x10c)]?.['testhubConfig']?.[_0x596a19(0x13b)]()?.[_0x596a19(0x15e)],_0x11e76f=path[_0x596a19(0x158)](_0x915085,_0x518ea4);!fs[_0x596a19(0x11c)](_0x11e76f)&&(fs[_0x596a19(0x132)](_0x11e76f),this[_0x596a19(0x13e)]['debug'](util[_0x596a19(0x14d)](_0x42b6c6[_0x596a19(0x14a)],_0x11e76f)));if(_0x42b6c6[_0x596a19(0x14b)](_0x52977b[_0x596a19(0x146)](),'')){this[_0x596a19(0x13e)][_0x596a19(0x142)](util['format'](_0x42b6c6[_0x596a19(0x152)]));return;}if(_0x52977b[_0x596a19(0x15a)](_0x42b6c6[_0x596a19(0x10b)])||_0x52977b[_0x596a19(0x15a)](_0x42b6c6[_0x596a19(0x11a)])){const _0x44be04=_0x52977b[_0x596a19(0x15a)](_0x42b6c6['YPGXu'])?https:http,_0x596977=path[_0x596a19(0x116)](_0x52977b),_0x23ab6b=path[_0x596a19(0x158)](_0x11e76f,_0x596977),_0x552da7=fs[_0x596a19(0x150)](_0x23ab6b);_0x44be04[_0x596a19(0x139)](_0x52977b,_0x4d6f27=>{const _0x536060=_0x596a19;if(_0x42b6c6[_0x536060(0x14b)](_0x4d6f27['statusCode'],0xc8))_0x4d6f27[_0x536060(0x12e)](_0x552da7),_0x552da7['on'](_0x42b6c6[_0x536060(0x113)],()=>{const _0x9d87c=_0x536060;_0x552da7[_0x9d87c(0x165)]();const _0x17234f=fs[_0x9d87c(0x167)](_0x23ab6b),_0x19d685=_0x42b6c6['MHJzY'](_0x17234f['size'],_0x42b6c6[_0x9d87c(0x166)](0x400,0x400));if(_0x42b6c6[_0x9d87c(0x151)](_0x19d685,0x64)){this[_0x9d87c(0x13e)][_0x9d87c(0x142)](util[_0x9d87c(0x14d)](_0x42b6c6[_0x9d87c(0x15f)],_0x19d685[_0x9d87c(0x156)](0x2))),fs[_0x9d87c(0x161)](_0x23ab6b);return;}this[_0x9d87c(0x13e)][_0x9d87c(0x142)](util[_0x9d87c(0x14d)](_0x42b6c6['gobsx'],_0x23ab6b)),uploadAttachmentsManager['trackFile'](_0x23ab6b,_0x33e0ea);});else{this[_0x536060(0x13e)][_0x536060(0x142)](util[_0x536060(0x14d)](_0x42b6c6['FmpFe'],_0x4d6f27[_0x536060(0x13d)])),_0x552da7[_0x536060(0x165)](),fs['unlinkSync'](_0x23ab6b);return;}})['on'](_0x42b6c6[_0x596a19(0x160)],_0x1726e2=>{const _0x490d93=_0x596a19;this[_0x490d93(0x13e)][_0x490d93(0x142)](util[_0x490d93(0x14d)](_0x42b6c6[_0x490d93(0x11e)],_0x1726e2[_0x490d93(0x12b)])),_0x552da7[_0x490d93(0x165)](),fs['unlinkSync'](_0x23ab6b);return;});}else{if(!fs[_0x596a19(0x11c)](_0x52977b)){this['logger']['debug'](util['format'](_0x42b6c6['zIZIN'],_0x52977b));return;}const _0x56f781=fs[_0x596a19(0x167)](_0x52977b),_0x5e9fa1=_0x42b6c6[_0x596a19(0x134)](_0x56f781['size'],_0x42b6c6['LyjFV'](0x400,0x400));if(_0x42b6c6['jpRnP'](_0x5e9fa1,0x64)){this['logger']['debug'](util['format'](_0x42b6c6[_0x596a19(0x145)],_0x5e9fa1[_0x596a19(0x156)](0x2)));return;}const _0x44d9b1=path[_0x596a19(0x116)](_0x52977b),_0x4a107b=path['join'](_0x11e76f,_0x44d9b1);fs[_0x596a19(0x133)](_0x52977b,_0x4a107b),uploadAttachmentsManager[_0x596a19(0x141)](_0x4a107b,_0x33e0ea);}}static[a80_0x15f6de(0x141)](_0x57d6ee,_0x400a7a){const _0x1d1dd4=a80_0x15f6de,_0x4563bf={};_0x4563bf[_0x1d1dd4(0x15c)]=_0x1d1dd4(0x149),_0x4563bf[_0x1d1dd4(0x10a)]='TestLevel',_0x4563bf[_0x1d1dd4(0x14f)]=_0x1d1dd4(0x12f),_0x4563bf[_0x1d1dd4(0x15d)]=_0x1d1dd4(0x128);const _0x552701=_0x4563bf;try{const _0x526646=AutomationFramework[_0x1d1dd4(0x10f)](),_0x405c8a=AutomationFramework[_0x1d1dd4(0x147)](_0x526646,PlaywrightDriverModule[_0x1d1dd4(0x112)],''),_0x2a155c=TestInfo[_0x1d1dd4(0x154)](_0x405c8a),_0x325699=_0x2a155c[TestFrameworkConstants[_0x1d1dd4(0x11b)]]||{};_0x325699[_0x57d6ee]={[TestFrameworkConstants['KEY_FILE_SIZE']]:fs['statSync'](_0x57d6ee)[_0x1d1dd4(0x120)],[TestFrameworkConstants['KEY_FILE_NAME']]:path['basename'](_0x57d6ee),[TestFrameworkConstants[_0x1d1dd4(0x169)]]:_0x57d6ee,[TestFrameworkConstants[_0x1d1dd4(0x126)]]:_0x400a7a?_0x552701[_0x1d1dd4(0x15c)]:_0x552701[_0x1d1dd4(0x10a)]},_0x2a155c[TestFrameworkConstants[_0x1d1dd4(0x11b)]]=_0x325699,TestInfo['setTestDetails'](_0x405c8a,_0x2a155c),this['logger'][_0x1d1dd4(0x142)](util[_0x1d1dd4(0x14d)](_0x552701[_0x1d1dd4(0x14f)],_0x57d6ee));}catch(_0x5e1cd5){this['logger'][_0x1d1dd4(0x142)](util[_0x1d1dd4(0x14d)](_0x552701[_0x1d1dd4(0x15d)],_0x5e1cd5['message']));}}static[a80_0x15f6de(0x136)](){const _0x1f685b=a80_0x15f6de,_0x5a7c73={};_0x5a7c73[_0x1f685b(0x118)]='.browserstack',_0x5a7c73[_0x1f685b(0x13c)]=_0x1f685b(0x122);const _0x518f7e=_0x5a7c73,_0x4e14bd=os['homedir'](),_0x37de78=path[_0x1f685b(0x158)](_0x4e14bd,_0x518f7e[_0x1f685b(0x118)]);if(!fs[_0x1f685b(0x11c)](_0x37de78))return;const _0x308e14=BrowserstackCLI[_0x1f685b(0x13f)]()[_0x1f685b(0x148)][_0x1f685b(0x10c)]?.[_0x1f685b(0x121)]?.[_0x1f685b(0x13b)]()?.['buildHashedId'],_0x459015=path[_0x1f685b(0x158)](_0x37de78,_0x308e14);if(!fs[_0x1f685b(0x11c)](_0x459015))return;const _0x146a55={};_0x146a55[_0x1f685b(0x115)]=!![],_0x146a55['force']=!![],fs['rmSync'](_0x459015,_0x146a55),this[_0x1f685b(0x13e)][_0x1f685b(0x142)](util['format'](_0x518f7e['oRChZ']));}}module['exports']=uploadAttachmentsManager;