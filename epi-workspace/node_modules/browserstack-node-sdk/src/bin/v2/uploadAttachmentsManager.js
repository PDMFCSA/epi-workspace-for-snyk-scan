const a87_0x2af632=a87_0x5790;(function(_0x5cab3c,_0x5803b7){const _0x3d3f23=a87_0x5790,_0x113625=_0x5cab3c();while(!![]){try{const _0x598e64=-parseInt(_0x3d3f23(0x7f))/0x1+parseInt(_0x3d3f23(0xe2))/0x2+-parseInt(_0x3d3f23(0x9b))/0x3*(parseInt(_0x3d3f23(0xdc))/0x4)+parseInt(_0x3d3f23(0xb6))/0x5+parseInt(_0x3d3f23(0xae))/0x6+parseInt(_0x3d3f23(0xa3))/0x7+-parseInt(_0x3d3f23(0x8f))/0x8*(parseInt(_0x3d3f23(0xe3))/0x9);if(_0x598e64===_0x5803b7)break;else _0x113625['push'](_0x113625['shift']());}catch(_0x417e87){_0x113625['push'](_0x113625['shift']());}}}(a87_0x1104,0x3a8ff));const os=require('os'),fs=require('fs'),path=require('path'),util=require(a87_0x2af632(0x7c)),BrowserstackCLI=require(a87_0x2af632(0xbe)),https=require('https'),http=require(a87_0x2af632(0xd1)),AutomationFramework=require(a87_0x2af632(0x9d)),PlaywrightDriverModule=require(a87_0x2af632(0xe4)),TestInfo=require(a87_0x2af632(0xc9)),TestFrameworkConstants=require(a87_0x2af632(0x8c)),{createClassLogger}=require(a87_0x2af632(0xd3));function a87_0x5790(_0x316a8c,_0x28cde6){const _0x1104c1=a87_0x1104();return a87_0x5790=function(_0x579045,_0x1c1746){_0x579045=_0x579045-0x79;let _0x7a4646=_0x1104c1[_0x579045];return _0x7a4646;},a87_0x5790(_0x316a8c,_0x28cde6);}function a87_0x1104(){const _0x287620=['toObject','erNrv','KEY_FILE_LEVEL','KEY_FILE_PATH','Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.','gSQJv','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','./browserstackCLI','basename','LVosi','rmSync','Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s','CLmnQ','xhiyz','size','buildHashedId','gCQjp','uploadAttachmentsManager','./TestInfo','finish','getState','startsWith','rfGIh','close','getTrackedInstance','Attachment\x20recevied\x20for\x20path:\x20%s','http','Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.','../../helpers/classLogger.js','getTestIdentifierFromTestInfo','http://','TestHubModule','.browserstack\x20folder\x20not\x20found\x20at:\x20%s','Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload','KEY_TEST_ID','existsSync','ILhaI','1007044KbkXnv','statSync','get','DnpaX','uploadAttachments','clearAttachments','162670ULZqQS','32715xvMAJV','./modules/playwrightDriverModule','trackFile','QUwEI','recursive','util','No\x20attachment\x20folder\x20found\x20for\x20testhubID:\x20%s','MiEVA','168180bTDjPz','pipe','message','toFixed','format','Jcnqs','CKlPM','BuildLevel','Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload','MhYoV','TestLevel','nilDk','BDqcV','./framework/constants/testFrameworkConstants','KEY_TEST_ATTACHMENTS','currentTest','120npLFTT','statusCode','setTestDetails','error','oXacq','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','join','PHmmZ','IybuY','MzfVz','Cleared\x20attachment\x20folder','hTzpB','3xFQvcY','force','./framework/automationFramework','gqJCx','KEY_FILE_SIZE','unlinkSync','File\x20downloaded\x20to:\x20%s','PRDoH','3260138qTWuOQ','logger','sUPEl','SREpu','qHPrs','testInfo','yYRCD','createWriteStream','gtutG','__workerDetails','Created\x20.browserstack\x20folder\x20at:\x20%s','442254vreSww','.browserstack','testhubConfig','HURlv','AZxmn','getInstance','debug','retry','467795NbSNnq'];a87_0x1104=function(){return _0x287620;};return a87_0x1104();}class uploadAttachmentsManager{static [a87_0x2af632(0xa4)]=createClassLogger(a87_0x2af632(0xc8));static[a87_0x2af632(0xe0)](_0x473f77,_0x33c6e2=![]){const _0xd62fee=a87_0x2af632,_0x65163c={};_0x65163c[_0xd62fee(0xa5)]=function(_0x5476e2,_0x248ff6){return _0x5476e2/_0x248ff6;},_0x65163c[_0xd62fee(0x9a)]=function(_0x4dbf68,_0x482a25){return _0x4dbf68*_0x482a25;},_0x65163c['erNrv']=function(_0x17e565,_0x1a9d54){return _0x17e565>_0x1a9d54;},_0x65163c['gtutG']=_0xd62fee(0xd2),_0x65163c[_0xd62fee(0xbc)]=_0xd62fee(0xa1),_0x65163c[_0xd62fee(0x84)]=function(_0x1954cc,_0x5979aa){return _0x1954cc===_0x5979aa;},_0x65163c[_0xd62fee(0x96)]=_0xd62fee(0xca),_0x65163c['MhYoV']=_0xd62fee(0xd8),_0x65163c['yYRCD']=_0xd62fee(0xbd),_0x65163c[_0xd62fee(0x8a)]=_0xd62fee(0xd0),_0x65163c[_0xd62fee(0xc7)]=_0xd62fee(0xaf),_0x65163c[_0xd62fee(0xa2)]=_0xd62fee(0xd7),_0x65163c[_0xd62fee(0xb2)]=_0xd62fee(0xad),_0x65163c['oXacq']='Created\x20folder:\x20%s',_0x65163c[_0xd62fee(0xc4)]=function(_0xe1ef1b,_0xab4a5e){return _0xe1ef1b===_0xab4a5e;},_0x65163c[_0xd62fee(0xc0)]=_0xd62fee(0xbb),_0x65163c[_0xd62fee(0x9e)]='https://',_0x65163c[_0xd62fee(0x7e)]=_0xd62fee(0xd5),_0x65163c['qHPrs']=_0xd62fee(0x92),_0x65163c['DnpaX']=_0xd62fee(0xc2),_0x65163c['ILhaI']=function(_0x219d9a,_0x482d70){return _0x219d9a/_0x482d70;},_0x65163c['QUwEI']=function(_0x1f8397,_0x5c7b07){return _0x1f8397>_0x5c7b07;},_0x65163c['SUthh']=_0xd62fee(0x94);const _0x7b8e61=_0x65163c;this[_0xd62fee(0xa4)][_0xd62fee(0xb4)](util['format'](_0x7b8e61['nilDk'],_0x473f77));const _0x51e35f=os['homedir'](),_0x3ac309=path[_0xd62fee(0x95)](_0x51e35f,_0x7b8e61[_0xd62fee(0xc7)]);!fs['existsSync'](_0x3ac309)&&(this[_0xd62fee(0xa4)][_0xd62fee(0xb4)](util[_0xd62fee(0x83)](_0x7b8e61[_0xd62fee(0xa2)],_0x3ac309)),fs['mkdirSync'](_0x3ac309),this[_0xd62fee(0xa4)][_0xd62fee(0xb4)](util['format'](_0x7b8e61[_0xd62fee(0xb2)],_0x3ac309)));const _0x279f1e=BrowserstackCLI[_0xd62fee(0xb3)]()['modules'][_0xd62fee(0xd6)]?.['testhubConfig']?.[_0xd62fee(0xb7)]()?.[_0xd62fee(0xc6)],_0x2eb9f9=path[_0xd62fee(0x95)](_0x3ac309,_0x279f1e);!fs[_0xd62fee(0xda)](_0x2eb9f9)&&(fs['mkdirSync'](_0x2eb9f9),this[_0xd62fee(0xa4)][_0xd62fee(0xb4)](util[_0xd62fee(0x83)](_0x7b8e61[_0xd62fee(0x93)],_0x2eb9f9)));if(_0x7b8e61['xhiyz'](_0x473f77['trim'](),'')){this[_0xd62fee(0xa4)][_0xd62fee(0xb4)](util[_0xd62fee(0x83)](_0x7b8e61[_0xd62fee(0xc0)]));return;}if(_0x473f77[_0xd62fee(0xcc)](_0x7b8e61[_0xd62fee(0x9e)])||_0x473f77[_0xd62fee(0xcc)](_0x7b8e61[_0xd62fee(0x7e)])){const _0x24eb03=_0x473f77[_0xd62fee(0xcc)](_0x7b8e61[_0xd62fee(0x9e)])?https:http,_0x5f0677=path['basename'](_0x473f77),_0x3fec13=path[_0xd62fee(0x95)](_0x2eb9f9,_0x5f0677),_0x338ecf=fs[_0xd62fee(0xaa)](_0x3fec13);_0x24eb03[_0xd62fee(0xde)](_0x473f77,_0xcddb1c=>{const _0x43a931=_0xd62fee,_0xf859f8={'MzfVz':function(_0x47deb1,_0x232954){const _0x432595=a87_0x5790;return _0x7b8e61[_0x432595(0xa5)](_0x47deb1,_0x232954);},'IybuY':function(_0x16a989,_0x5dde20){return _0x7b8e61['hTzpB'](_0x16a989,_0x5dde20);},'GqxEN':function(_0x4f30e1,_0x312f03){const _0x2f7184=a87_0x5790;return _0x7b8e61[_0x2f7184(0xb8)](_0x4f30e1,_0x312f03);},'HURlv':_0x7b8e61[_0x43a931(0xab)],'croId':_0x7b8e61[_0x43a931(0xbc)]};if(_0x7b8e61['Jcnqs'](_0xcddb1c[_0x43a931(0x90)],0xc8))_0xcddb1c[_0x43a931(0x80)](_0x338ecf),_0x338ecf['on'](_0x7b8e61[_0x43a931(0x96)],()=>{const _0x17b607=_0x43a931;_0x338ecf[_0x17b607(0xce)]();const _0xdc3548=fs[_0x17b607(0xdd)](_0x3fec13),_0x788087=_0xf859f8[_0x17b607(0x98)](_0xdc3548['size'],_0xf859f8[_0x17b607(0x97)](0x400,0x400));if(_0xf859f8['GqxEN'](_0x788087,0x64)){this[_0x17b607(0xa4)]['debug'](util[_0x17b607(0x83)](_0xf859f8[_0x17b607(0xb1)],_0x788087[_0x17b607(0x82)](0x2))),fs[_0x17b607(0xa0)](_0x3fec13);return;}this[_0x17b607(0xa4)][_0x17b607(0xb4)](util[_0x17b607(0x83)](_0xf859f8['croId'],_0x3fec13)),uploadAttachmentsManager[_0x17b607(0x79)](_0x3fec13,_0x33c6e2);});else{this[_0x43a931(0xa4)][_0x43a931(0xb4)](util[_0x43a931(0x83)](_0x7b8e61[_0x43a931(0x88)],_0xcddb1c[_0x43a931(0x90)])),_0x338ecf[_0x43a931(0xce)](),fs[_0x43a931(0xa0)](_0x3fec13);return;}})['on'](_0x7b8e61[_0xd62fee(0xa7)],_0x14cdc0=>{const _0x3f2e9c=_0xd62fee;this[_0x3f2e9c(0xa4)][_0x3f2e9c(0xb4)](util['format'](_0x7b8e61[_0x3f2e9c(0xa9)],_0x14cdc0[_0x3f2e9c(0x81)])),_0x338ecf[_0x3f2e9c(0xce)](),fs[_0x3f2e9c(0xa0)](_0x3fec13);return;});}else{if(!fs[_0xd62fee(0xda)](_0x473f77)){this[_0xd62fee(0xa4)][_0xd62fee(0xb4)](util[_0xd62fee(0x83)](_0x7b8e61[_0xd62fee(0xdf)],_0x473f77));return;}const _0x29bafb=fs[_0xd62fee(0xdd)](_0x473f77),_0x278150=_0x7b8e61[_0xd62fee(0xdb)](_0x29bafb[_0xd62fee(0xc5)],_0x7b8e61[_0xd62fee(0x9a)](0x400,0x400));if(_0x7b8e61[_0xd62fee(0x7a)](_0x278150,0x64)){this['logger'][_0xd62fee(0xb4)](util[_0xd62fee(0x83)](_0x7b8e61['SUthh'],_0x278150['toFixed'](0x2)));return;}const _0x4e6479=path[_0xd62fee(0xbf)](_0x473f77),_0xb9c18=path[_0xd62fee(0x95)](_0x2eb9f9,_0x4e6479);fs['copyFileSync'](_0x473f77,_0xb9c18),uploadAttachmentsManager[_0xd62fee(0x79)](_0xb9c18,_0x33c6e2);}}static['trackFile'](_0x47062c,_0x5065c5){const _0x33991b=a87_0x2af632,_0x2d9a0b={};_0x2d9a0b[_0x33991b(0xcd)]=_0x33991b(0x86),_0x2d9a0b[_0x33991b(0x85)]=_0x33991b(0x89),_0x2d9a0b['BDqcV']='Attachment\x20file\x20tracked\x20for\x20upload:\x20%s',_0x2d9a0b[_0x33991b(0xa6)]=_0x33991b(0x87);const _0x54091e=_0x2d9a0b;try{let _0x535f86;const _0x78885b=global[_0x33991b(0xac)]?.[_0x33991b(0x8e)]?.[_0x33991b(0xa8)];if(!_0x78885b){const _0x1839bd=AutomationFramework[_0x33991b(0xcf)]();_0x535f86=AutomationFramework[_0x33991b(0xcb)](_0x1839bd,PlaywrightDriverModule[_0x33991b(0xd9)],'');}else _0x535f86=TestInfo[_0x33991b(0xd4)](_0x78885b,_0x78885b[_0x33991b(0xb5)]);const _0x23c845=TestInfo['getTestDetails'](_0x535f86),_0x369fba=_0x23c845[TestFrameworkConstants[_0x33991b(0x8d)]]||{};_0x369fba[_0x47062c]={[TestFrameworkConstants[_0x33991b(0x9f)]]:fs['statSync'](_0x47062c)[_0x33991b(0xc5)],[TestFrameworkConstants['KEY_FILE_NAME']]:path[_0x33991b(0xbf)](_0x47062c),[TestFrameworkConstants[_0x33991b(0xba)]]:_0x47062c,[TestFrameworkConstants[_0x33991b(0xb9)]]:_0x5065c5?_0x54091e[_0x33991b(0xcd)]:_0x54091e[_0x33991b(0x85)]},_0x23c845[TestFrameworkConstants['KEY_TEST_ATTACHMENTS']]=_0x369fba,TestInfo[_0x33991b(0x91)](_0x535f86,_0x23c845),this[_0x33991b(0xa4)]['debug'](util[_0x33991b(0x83)](_0x54091e[_0x33991b(0x8b)],_0x47062c));}catch(_0x4f3280){this[_0x33991b(0xa4)][_0x33991b(0xb4)](util[_0x33991b(0x83)](_0x54091e[_0x33991b(0xa6)],_0x4f3280[_0x33991b(0x81)]));}}static[a87_0x2af632(0xe1)](){const _0x259756=a87_0x2af632,_0x43699a={};_0x43699a['lJtot']=_0x259756(0xaf),_0x43699a[_0x259756(0xc3)]=_0x259756(0x7d),_0x43699a['FByRu']=_0x259756(0x99);const _0xb2aa4d=_0x43699a,_0x5a4083=os['homedir'](),_0x4b425a=path[_0x259756(0x95)](_0x5a4083,_0xb2aa4d['lJtot']);if(!fs[_0x259756(0xda)](_0x4b425a))return;const _0x20a7c3=BrowserstackCLI[_0x259756(0xb3)]()['modules'][_0x259756(0xd6)]?.[_0x259756(0xb0)]?.[_0x259756(0xb7)]()?.[_0x259756(0xc6)],_0x42704c=_0x20a7c3?path[_0x259756(0x95)](_0x4b425a,_0x20a7c3):null;if(!_0x42704c||!fs[_0x259756(0xda)](_0x42704c)){this[_0x259756(0xa4)][_0x259756(0xb4)](util[_0x259756(0x83)](_0xb2aa4d[_0x259756(0xc3)],_0x20a7c3));return;}const _0x5f2614={};_0x5f2614[_0x259756(0x7b)]=!![],_0x5f2614[_0x259756(0x9c)]=!![],fs[_0x259756(0xc1)](_0x42704c,_0x5f2614),this[_0x259756(0xa4)][_0x259756(0xb4)](util[_0x259756(0x83)](_0xb2aa4d['FByRu']));}}module['exports']=uploadAttachmentsManager;