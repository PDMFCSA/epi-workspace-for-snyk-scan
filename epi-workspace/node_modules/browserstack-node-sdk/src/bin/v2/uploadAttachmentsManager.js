const a89_0x112683=a89_0x6350;(function(_0x269155,_0x508ced){const _0x548ff5=a89_0x6350,_0x3871f8=_0x269155();while(!![]){try{const _0x498edb=-parseInt(_0x548ff5(0x1bb))/0x1+parseInt(_0x548ff5(0x17f))/0x2*(-parseInt(_0x548ff5(0x1e1))/0x3)+parseInt(_0x548ff5(0x192))/0x4*(parseInt(_0x548ff5(0x194))/0x5)+parseInt(_0x548ff5(0x1e7))/0x6+parseInt(_0x548ff5(0x1ca))/0x7+parseInt(_0x548ff5(0x18b))/0x8*(parseInt(_0x548ff5(0x1e0))/0x9)+-parseInt(_0x548ff5(0x1c4))/0xa;if(_0x498edb===_0x508ced)break;else _0x3871f8['push'](_0x3871f8['shift']());}catch(_0x369671){_0x3871f8['push'](_0x3871f8['shift']());}}}(a89_0x43a3,0x3545e));function a89_0x6350(_0x16d510,_0x1ccab2){const _0x43a3fb=a89_0x43a3();return a89_0x6350=function(_0x63508d,_0x2488bf){_0x63508d=_0x63508d-0x178;let _0x143334=_0x43a3fb[_0x63508d];return _0x143334;},a89_0x6350(_0x16d510,_0x1ccab2);}const os=require('os'),fs=require('fs'),path=require('path'),util=require(a89_0x112683(0x1b7)),BrowserstackCLI=require(a89_0x112683(0x1a1)),https=require(a89_0x112683(0x19b)),http=require(a89_0x112683(0x1c1)),AutomationFramework=require(a89_0x112683(0x1af)),PlaywrightDriverModule=require('./modules/playwrightDriverModule'),TestInfo=require(a89_0x112683(0x17a)),TestFrameworkConstants=require(a89_0x112683(0x19a)),{createClassLogger}=require('../../helpers/classLogger.js');class uploadAttachmentsManager{static [a89_0x112683(0x1f1)]=createClassLogger(a89_0x112683(0x1f0));static['uploadAttachments'](_0x355eff,_0x502688=![]){const _0x4bb503=a89_0x112683,_0x172edd={};_0x172edd[_0x4bb503(0x1aa)]=function(_0x323b77,_0x2e649c){return _0x323b77/_0x2e649c;},_0x172edd[_0x4bb503(0x1a2)]=function(_0x1f4795,_0x1abf04){return _0x1f4795*_0x1abf04;},_0x172edd[_0x4bb503(0x193)]=function(_0x150d6e,_0x321896){return _0x150d6e>_0x321896;},_0x172edd['efOsx']='Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.',_0x172edd[_0x4bb503(0x182)]=_0x4bb503(0x1d5),_0x172edd['jvwAw']=function(_0x397294,_0x5c9970){return _0x397294===_0x5c9970;},_0x172edd[_0x4bb503(0x1f5)]='finish',_0x172edd[_0x4bb503(0x1c9)]=_0x4bb503(0x1f9),_0x172edd[_0x4bb503(0x1a0)]=_0x4bb503(0x1c8),_0x172edd['HjqMy']=_0x4bb503(0x1e2),_0x172edd[_0x4bb503(0x1b9)]='.browserstack',_0x172edd[_0x4bb503(0x180)]=_0x4bb503(0x1a4),_0x172edd[_0x4bb503(0x1a3)]=_0x4bb503(0x1f2),_0x172edd['kUvAT']=_0x4bb503(0x184),_0x172edd['Qrbxa']=function(_0x172d43,_0x57d18a){return _0x172d43===_0x57d18a;},_0x172edd[_0x4bb503(0x190)]=_0x4bb503(0x1c2),_0x172edd[_0x4bb503(0x1eb)]=_0x4bb503(0x1df),_0x172edd[_0x4bb503(0x1f3)]=_0x4bb503(0x1e5),_0x172edd[_0x4bb503(0x19e)]=_0x4bb503(0x1f6),_0x172edd[_0x4bb503(0x1cb)]=_0x4bb503(0x199),_0x172edd[_0x4bb503(0x1ef)]=function(_0xb916b0,_0x34d16a){return _0xb916b0*_0x34d16a;},_0x172edd[_0x4bb503(0x195)]=_0x4bb503(0x1a6);const _0x56c885=_0x172edd;this['logger'][_0x4bb503(0x18d)](util[_0x4bb503(0x1c3)](_0x56c885[_0x4bb503(0x1b0)],_0x355eff));const _0xac6a32=os['homedir'](),_0xce4356=path[_0x4bb503(0x1d2)](_0xac6a32,_0x56c885[_0x4bb503(0x1b9)]);!fs[_0x4bb503(0x1fb)](_0xce4356)&&(this['logger'][_0x4bb503(0x18d)](util[_0x4bb503(0x1c3)](_0x56c885[_0x4bb503(0x180)],_0xce4356)),fs['mkdirSync'](_0xce4356),this[_0x4bb503(0x1f1)][_0x4bb503(0x18d)](util[_0x4bb503(0x1c3)](_0x56c885['oMWxB'],_0xce4356)));const _0x3bfdd9=BrowserstackCLI[_0x4bb503(0x178)]()[_0x4bb503(0x17b)][_0x4bb503(0x17d)]?.[_0x4bb503(0x181)]?.['toObject']()?.[_0x4bb503(0x17e)],_0x40743f=path['join'](_0xce4356,_0x3bfdd9);!fs[_0x4bb503(0x1fb)](_0x40743f)&&(fs[_0x4bb503(0x1d1)](_0x40743f),this[_0x4bb503(0x1f1)][_0x4bb503(0x18d)](util[_0x4bb503(0x1c3)](_0x56c885[_0x4bb503(0x1e4)],_0x40743f)));if(_0x56c885[_0x4bb503(0x1ea)](_0x355eff[_0x4bb503(0x1c7)](),'')){this[_0x4bb503(0x1f1)][_0x4bb503(0x18d)](util[_0x4bb503(0x1c3)](_0x56c885[_0x4bb503(0x190)]));return;}if(_0x355eff[_0x4bb503(0x191)](_0x56c885['EpCyg'])||_0x355eff[_0x4bb503(0x191)](_0x56c885[_0x4bb503(0x1f3)])){const _0x1d5a2f=_0x355eff[_0x4bb503(0x191)](_0x56c885[_0x4bb503(0x1eb)])?https:http,_0x2fd883=path[_0x4bb503(0x198)](_0x355eff),_0x5f1cb8=path[_0x4bb503(0x1d2)](_0x40743f,_0x2fd883),_0x24a4f4=fs[_0x4bb503(0x1ce)](_0x5f1cb8);_0x1d5a2f['get'](_0x355eff,_0x5573b0=>{const _0x2d64aa=_0x4bb503;if(_0x56c885[_0x2d64aa(0x1cc)](_0x5573b0['statusCode'],0xc8))_0x5573b0[_0x2d64aa(0x1f8)](_0x24a4f4),_0x24a4f4['on'](_0x56c885[_0x2d64aa(0x1f5)],()=>{const _0x499917=_0x2d64aa;_0x24a4f4['close']();const _0x4affab=fs[_0x499917(0x1f7)](_0x5f1cb8),_0x31a0fb=_0x56c885['ZiwYv'](_0x4affab[_0x499917(0x187)],_0x56c885[_0x499917(0x1a2)](0x400,0x400));if(_0x56c885[_0x499917(0x193)](_0x31a0fb,0x64)){this[_0x499917(0x1f1)][_0x499917(0x18d)](util[_0x499917(0x1c3)](_0x56c885[_0x499917(0x1ac)],_0x31a0fb[_0x499917(0x1dc)](0x2))),fs[_0x499917(0x197)](_0x5f1cb8);return;}this[_0x499917(0x1f1)][_0x499917(0x18d)](util[_0x499917(0x1c3)](_0x56c885[_0x499917(0x182)],_0x5f1cb8)),uploadAttachmentsManager['trackFile'](_0x5f1cb8,_0x502688);});else{this['logger'][_0x2d64aa(0x18d)](util[_0x2d64aa(0x1c3)](_0x56c885[_0x2d64aa(0x1c9)],_0x5573b0['statusCode'])),_0x24a4f4[_0x2d64aa(0x1b3)](),fs[_0x2d64aa(0x197)](_0x5f1cb8);return;}})['on'](_0x56c885[_0x4bb503(0x19e)],_0x5999eb=>{const _0x4bca7d=_0x4bb503;this[_0x4bca7d(0x1f1)][_0x4bca7d(0x18d)](util[_0x4bca7d(0x1c3)](_0x56c885[_0x4bca7d(0x1a0)],_0x5999eb['message'])),_0x24a4f4[_0x4bca7d(0x1b3)](),fs[_0x4bca7d(0x197)](_0x5f1cb8);return;});}else{if(!fs[_0x4bb503(0x1fb)](_0x355eff)){this[_0x4bb503(0x1f1)]['debug'](util[_0x4bb503(0x1c3)](_0x56c885[_0x4bb503(0x1cb)],_0x355eff));return;}const _0x15c92e=fs[_0x4bb503(0x1f7)](_0x355eff),_0x18f4b1=_0x56c885['ZiwYv'](_0x15c92e[_0x4bb503(0x187)],_0x56c885['YUpCs'](0x400,0x400));if(_0x56c885[_0x4bb503(0x193)](_0x18f4b1,0x64)){this[_0x4bb503(0x1f1)][_0x4bb503(0x18d)](util[_0x4bb503(0x1c3)](_0x56c885[_0x4bb503(0x195)],_0x18f4b1[_0x4bb503(0x1dc)](0x2)));return;}const _0x3a0e0c=path[_0x4bb503(0x198)](_0x355eff),_0x3ad84a=path[_0x4bb503(0x1d2)](_0x40743f,_0x3a0e0c);fs[_0x4bb503(0x1d0)](_0x355eff,_0x3ad84a),uploadAttachmentsManager['trackFile'](_0x3ad84a,_0x502688);}}static['trackFile'](_0x38f95a,_0x326d77){const _0x39d7ff=a89_0x112683,_0x363dfc={'zkUDt':function(_0x7efe05,_0x442ffa){return _0x7efe05(_0x442ffa);},'fpDpA':_0x39d7ff(0x1a1),'lwAyp':function(_0x10186a,_0x36ce5e){return _0x10186a(_0x36ce5e);},'SvmoP':_0x39d7ff(0x1a7),'qiHEE':function(_0x1d619b,_0x221424){return _0x1d619b===_0x221424;},'CCAdC':_0x39d7ff(0x1b5),'bljxt':_0x39d7ff(0x1e3),'LGnUY':'BuildLevel','DGATX':_0x39d7ff(0x183),'ckgfD':_0x39d7ff(0x19d),'SnqRc':_0x39d7ff(0x1b4),'tuMAj':_0x39d7ff(0x1d7),'bfcbU':'trackFile:\x20Instance\x20not\x20available,\x20cannot\x20track\x20attachment','gTYPJ':'Attachment\x20file\x20tracked\x20for\x20upload:\x20%s','zyzby':_0x39d7ff(0x19c)};try{let _0x156e9b;const _0x9bd3=global[_0x39d7ff(0x1a9)]?.[_0x39d7ff(0x189)]?.['testInfo'],_0x3659cf=_0x363dfc[_0x39d7ff(0x1c6)](require,_0x363dfc['fpDpA']),_0x1a07b0=_0x363dfc['lwAyp'](require,_0x363dfc[_0x39d7ff(0x188)]),_0x2ced2d=_0x3659cf[_0x39d7ff(0x178)]()[_0x39d7ff(0x1d3)]()&&_0x363dfc[_0x39d7ff(0x1ed)](_0x1a07b0[_0x39d7ff(0x1fa)]()?.['name']?.[_0x39d7ff(0x1dd)](),_0x363dfc[_0x39d7ff(0x18f)]);if(_0x2ced2d){_0x156e9b=global[_0x39d7ff(0x19f)];if(!_0x156e9b){const _0x582a0b=AutomationFramework[_0x39d7ff(0x1f4)]();_0x156e9b=AutomationFramework[_0x39d7ff(0x1a8)](_0x582a0b,PlaywrightDriverModule['KEY_TEST_ID'],'');}this[_0x39d7ff(0x1f1)]['debug']('trackFile:\x20Jest+Playwright\x20-\x20testId\x20(testIdentifier):\x20'+_0x156e9b);}else{if(!_0x9bd3){const _0x1f501a=AutomationFramework[_0x39d7ff(0x1f4)]();_0x156e9b=AutomationFramework[_0x39d7ff(0x1a8)](_0x1f501a,PlaywrightDriverModule[_0x39d7ff(0x1ab)],'');}else _0x156e9b=TestInfo[_0x39d7ff(0x1e9)](_0x9bd3,_0x9bd3[_0x39d7ff(0x1b2)]);this['logger']['debug']('trackFile:\x20Cucumber+Playwright\x20-\x20testId:\x20'+_0x156e9b);}if(!_0x156e9b){this[_0x39d7ff(0x1f1)]['debug'](_0x363dfc[_0x39d7ff(0x179)]);return;}const _0x3d4e38={[TestFrameworkConstants[_0x39d7ff(0x1b8)]]:fs[_0x39d7ff(0x1f7)](_0x38f95a)['size'],[TestFrameworkConstants['KEY_FILE_NAME']]:path[_0x39d7ff(0x198)](_0x38f95a),[TestFrameworkConstants[_0x39d7ff(0x1cf)]]:_0x38f95a,[TestFrameworkConstants[_0x39d7ff(0x1b6)]]:_0x326d77?_0x363dfc[_0x39d7ff(0x1e8)]:_0x363dfc['DGATX']};if(_0x2ced2d){const _0x141515=_0x3659cf[_0x39d7ff(0x178)]()[_0x39d7ff(0x1d8)]();if(!_0x141515){this[_0x39d7ff(0x1f1)][_0x39d7ff(0x18d)](_0x363dfc[_0x39d7ff(0x18c)]);return;}const _0xc8016f=_0x363dfc[_0x39d7ff(0x18e)](require,_0x363dfc['SnqRc']),_0x2eb31b=_0x363dfc[_0x39d7ff(0x1c6)](require,_0x363dfc['tuMAj']),_0x141c20=_0x141515['resolveInstance'](_0xc8016f[_0x39d7ff(0x17c)],_0x2eb31b[_0x39d7ff(0x1ad)]);if(!_0x141c20){this[_0x39d7ff(0x1f1)][_0x39d7ff(0x18d)](_0x363dfc[_0x39d7ff(0x1ee)]);return;}const _0x1958f1=_0x141c20[_0x39d7ff(0x1e6)]()[_0x39d7ff(0x1bd)](_0x156e9b)||{},_0x1dc49e=_0x1958f1[TestFrameworkConstants[_0x39d7ff(0x1a5)]]||{},_0x5c3f19={..._0x1dc49e};_0x5c3f19[_0x38f95a]=_0x3d4e38;const _0x1e19e8=_0x5c3f19,_0x5b5e2e={[TestFrameworkConstants[_0x39d7ff(0x1a5)]]:_0x1e19e8},_0xdca77c={};_0xdca77c[_0x156e9b]=_0x5b5e2e,_0x141c20[_0x39d7ff(0x1ec)](_0xdca77c),this[_0x39d7ff(0x1f1)]['debug'](_0x39d7ff(0x1d6)+_0x156e9b+',\x20filepath:\x20'+_0x38f95a);}else{const _0x270895=TestInfo[_0x39d7ff(0x1cd)](_0x156e9b),_0x107b69=_0x270895[TestFrameworkConstants['KEY_TEST_ATTACHMENTS']]||{};_0x107b69[_0x38f95a]=_0x3d4e38,_0x270895[TestFrameworkConstants[_0x39d7ff(0x1a5)]]=_0x107b69,TestInfo[_0x39d7ff(0x1d4)](_0x156e9b,_0x270895),this['logger']['debug'](_0x39d7ff(0x186)+_0x156e9b+',\x20filepath:\x20'+_0x38f95a);}this[_0x39d7ff(0x1f1)][_0x39d7ff(0x18d)](util[_0x39d7ff(0x1c3)](_0x363dfc[_0x39d7ff(0x1db)],_0x38f95a));}catch(_0x3e2316){this[_0x39d7ff(0x1f1)][_0x39d7ff(0x18d)](util[_0x39d7ff(0x1c3)](_0x363dfc[_0x39d7ff(0x196)],_0x3e2316[_0x39d7ff(0x1be)]));}}static[a89_0x112683(0x1c0)](){const _0x34f938=a89_0x112683,_0x17c568={};_0x17c568[_0x34f938(0x1de)]='.browserstack',_0x17c568['HMsbC']=_0x34f938(0x1d9),_0x17c568[_0x34f938(0x185)]=_0x34f938(0x1bc);const _0x29c5e6=_0x17c568,_0x275ca9=os[_0x34f938(0x18a)](),_0x1a1276=path[_0x34f938(0x1d2)](_0x275ca9,_0x29c5e6[_0x34f938(0x1de)]);if(!fs[_0x34f938(0x1fb)](_0x1a1276))return;const _0x3a94ab=BrowserstackCLI['getInstance']()[_0x34f938(0x17b)]['TestHubModule']?.[_0x34f938(0x181)]?.[_0x34f938(0x1ba)]()?.[_0x34f938(0x17e)],_0x3e09d7=_0x3a94ab?path[_0x34f938(0x1d2)](_0x1a1276,_0x3a94ab):null;if(!_0x3e09d7||!fs[_0x34f938(0x1fb)](_0x3e09d7)){this[_0x34f938(0x1f1)][_0x34f938(0x18d)](util['format'](_0x29c5e6[_0x34f938(0x1ae)],_0x3a94ab));return;}const _0x3dabb6={};_0x3dabb6[_0x34f938(0x1b1)]=!![],_0x3dabb6[_0x34f938(0x1bf)]=!![],fs[_0x34f938(0x1da)](_0x3e09d7,_0x3dabb6),this['logger'][_0x34f938(0x18d)](util[_0x34f938(0x1c3)](_0x29c5e6['nVcEW']));}}function a89_0x43a3(){const _0x4f44a4=['message','force','clearAttachments','http','Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.','format','2605420FyeakY','exports','zkUDt','trim','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','lMstm','1376564SdbQzA','JloWj','jvwAw','getTestDetails','createWriteStream','KEY_FILE_PATH','copyFileSync','mkdirSync','join','isRunning','setTestDetails','File\x20downloaded\x20to:\x20%s','trackFile:\x20Stored\x20attachment\x20in\x20instance\x20memory\x20for\x20testId:\x20','./state/hookState','getTestFramework','No\x20attachment\x20folder\x20found\x20for\x20testhubID:\x20%s','rmSync','gTYPJ','toFixed','toLowerCase','BWRwm','https://','252tVBYDz','98409cfPYUU','Attachment\x20recevied\x20for\x20path:\x20%s','trackFile:\x20No\x20testId\x20available,\x20cannot\x20track\x20attachment','kUvAT','http://','getAllData','622578evmqvG','LGnUY','getTestIdentifierFromTestInfo','Qrbxa','EpCyg','addMultipleEntries','qiHEE','bfcbU','YUpCs','uploadAttachmentsManager','logger','Created\x20.browserstack\x20folder\x20at:\x20%s','isxDH','getTrackedInstance','CKGtc','error','statSync','pipe','Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload','getTestFrameworkDetail','existsSync','getInstance','bljxt','./TestInfo','modules','TEST','TestHubModule','buildHashedId','8ifFZsr','rGVzi','testhubConfig','JqKTQ','TestLevel','Created\x20folder:\x20%s','nVcEW','trackFile:\x20Stored\x20attachment\x20in\x20TestInfo\x20file\x20for\x20testId:\x20','size','SvmoP','currentTest','homedir','58112mELrtE','ckgfD','debug','lwAyp','CCAdC','sSNOH','startsWith','196utzORk','kQAIw','30945zDGYGt','dEsfz','zyzby','unlinkSync','basename','Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s','./framework/constants/testFrameworkConstants','https','Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload','trackFile:\x20TestFramework\x20not\x20available,\x20cannot\x20track\x20attachment','sdUYa','__jestCurrentTestIdentifier','eIJDb','./browserstackCLI','NpXwE','oMWxB','.browserstack\x20folder\x20not\x20found\x20at:\x20%s','KEY_TEST_ATTACHMENTS','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','./cliUtils','getState','__workerDetails','ZiwYv','KEY_TEST_ID','efOsx','POST','HMsbC','./framework/automationFramework','HjqMy','recursive','retry','close','./state/testFrameworkState','jest','KEY_FILE_LEVEL','util','KEY_FILE_SIZE','yhuZs','toObject','197108NdamoV','Cleared\x20attachment\x20folder','get'];a89_0x43a3=function(){return _0x4f44a4;};return a89_0x43a3();}module[a89_0x112683(0x1c5)]=uploadAttachmentsManager;