const a82_0x59e78f=a82_0xe1db;(function(_0x313d1e,_0x3c46d4){const _0x448a44=a82_0xe1db,_0x4fe09e=_0x313d1e();while(!![]){try{const _0xbdc006=parseInt(_0x448a44(0x189))/0x1*(parseInt(_0x448a44(0x14b))/0x2)+-parseInt(_0x448a44(0x130))/0x3+-parseInt(_0x448a44(0x12d))/0x4+-parseInt(_0x448a44(0x15a))/0x5+parseInt(_0x448a44(0x163))/0x6+parseInt(_0x448a44(0x15b))/0x7+-parseInt(_0x448a44(0x176))/0x8*(-parseInt(_0x448a44(0x156))/0x9);if(_0xbdc006===_0x3c46d4)break;else _0x4fe09e['push'](_0x4fe09e['shift']());}catch(_0x4362ca){_0x4fe09e['push'](_0x4fe09e['shift']());}}}(a82_0x2946,0x55f66));function a82_0xe1db(_0xa1ae70,_0xf39f6b){const _0x2946a1=a82_0x2946();return a82_0xe1db=function(_0xe1db54,_0x5547d7){_0xe1db54=_0xe1db54-0x12d;let _0x465078=_0x2946a1[_0xe1db54];return _0x465078;},a82_0xe1db(_0xa1ae70,_0xf39f6b);}const os=require('os'),fs=require('fs'),path=require(a82_0x59e78f(0x159)),util=require(a82_0x59e78f(0x138)),BrowserstackCLI=require(a82_0x59e78f(0x145)),https=require(a82_0x59e78f(0x168)),http=require('http'),AutomationFramework=require(a82_0x59e78f(0x152)),PlaywrightDriverModule=require(a82_0x59e78f(0x16e)),TestInfo=require('./TestInfo'),TestFrameworkConstants=require(a82_0x59e78f(0x15d)),{createClassLogger}=require('../../helpers/classLogger.js');function a82_0x2946(){const _0x543237=['getState','vKHeY','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','copyFileSync','bauJE','GNEow','Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.','getInstance','AeZKm','clearAttachments','KEY_TEST_ATTACHMENTS','1MbecXp','GMyEc','basename','No\x20attachment\x20folder\x20found\x20for\x20testhubID:\x20%s','toFixed','Blltt','ZaMRJ','2422236KiSxrQ','http://','.browserstack\x20folder\x20not\x20found\x20at:\x20%s','1526049xGFZfr','SbhAu','size','DkpsS','uzQIY','Created\x20.browserstack\x20folder\x20at:\x20%s','dEKqv','jobvf','util','KEY_FILE_NAME','uploadAttachmentsManager','debug','kWkZk','.browserstack','rmSync','close','get','KEY_FILE_PATH','Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload','modules','Attachment\x20file\x20tracked\x20for\x20upload:\x20%s','./browserstackCLI','logger','trackFile','HyAdF','finish','KEY_FILE_LEVEL','249092JTcHTc','join','existsSync','uploadAttachments','getTrackedInstance','DoXQE','aFuIj','./framework/automationFramework','testhubConfig','roQKE','format','124947ukzMEL','SjZGc','KEY_FILE_SIZE','path','1665790PpKkwO','1002225mPcveS','WKhKj','./framework/constants/testFrameworkConstants','statusCode','getTestDetails','wqqIM','TestLevel','mkdirSync','1610568wOfEZl','vSgdI','File\x20downloaded\x20to:\x20%s','SJMuV','YWrNa','https','unlinkSync','Zufid','setTestDetails','YOjLE','homedir','./modules/playwrightDriverModule','QHhZM','statSync','force','pipe','TestHubModule','kdOKq','toObject','728UnFezc','KNJyS','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','createWriteStream','QAJXH','https://','BuildLevel','cGbMN'];a82_0x2946=function(){return _0x543237;};return a82_0x2946();}class uploadAttachmentsManager{static [a82_0x59e78f(0x146)]=createClassLogger(a82_0x59e78f(0x13a));static[a82_0x59e78f(0x14e)](_0x3db796,_0x5c3ab1=![]){const _0x381b06=a82_0x59e78f,_0x9cde03={};_0x9cde03[_0x381b06(0x136)]=function(_0x2e03ee,_0x1fd986){return _0x2e03ee/_0x1fd986;},_0x9cde03['cGbMN']=function(_0x490d29,_0x3d5e70){return _0x490d29*_0x3d5e70;},_0x9cde03[_0x381b06(0x18a)]=function(_0x2c3fcd,_0x284b7d){return _0x2c3fcd>_0x284b7d;},_0x9cde03[_0x381b06(0x151)]=_0x381b06(0x184),_0x9cde03[_0x381b06(0x177)]=_0x381b06(0x165),_0x9cde03[_0x381b06(0x17f)]=function(_0x11467a,_0x4eb7cd){return _0x11467a===_0x4eb7cd;},_0x9cde03[_0x381b06(0x167)]=_0x381b06(0x149),_0x9cde03[_0x381b06(0x160)]=_0x381b06(0x142),_0x9cde03[_0x381b06(0x183)]=_0x381b06(0x180),_0x9cde03[_0x381b06(0x16c)]='Attachment\x20recevied\x20for\x20path:\x20%s',_0x9cde03[_0x381b06(0x134)]=_0x381b06(0x13d),_0x9cde03[_0x381b06(0x186)]=_0x381b06(0x12f),_0x9cde03[_0x381b06(0x166)]=_0x381b06(0x135),_0x9cde03[_0x381b06(0x182)]='Created\x20folder:\x20%s',_0x9cde03[_0x381b06(0x17a)]=function(_0x4f6838,_0x54ddeb){return _0x4f6838===_0x54ddeb;},_0x9cde03[_0x381b06(0x157)]='Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.',_0x9cde03[_0x381b06(0x150)]=_0x381b06(0x17b),_0x9cde03[_0x381b06(0x18f)]=_0x381b06(0x12e),_0x9cde03[_0x381b06(0x18e)]='error',_0x9cde03['vSgdI']='Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s',_0x9cde03[_0x381b06(0x131)]=function(_0x557512,_0x39162c){return _0x557512>_0x39162c;},_0x9cde03[_0x381b06(0x154)]=_0x381b06(0x178);const _0x570404=_0x9cde03;this[_0x381b06(0x146)]['debug'](util[_0x381b06(0x155)](_0x570404[_0x381b06(0x16c)],_0x3db796));const _0x164683=os['homedir'](),_0x10965a=path[_0x381b06(0x14c)](_0x164683,_0x570404[_0x381b06(0x134)]);!fs['existsSync'](_0x10965a)&&(this[_0x381b06(0x146)][_0x381b06(0x13b)](util[_0x381b06(0x155)](_0x570404[_0x381b06(0x186)],_0x10965a)),fs[_0x381b06(0x162)](_0x10965a),this[_0x381b06(0x146)][_0x381b06(0x13b)](util['format'](_0x570404[_0x381b06(0x166)],_0x10965a)));const _0x2ef748=BrowserstackCLI[_0x381b06(0x185)]()['modules'][_0x381b06(0x173)]?.[_0x381b06(0x153)]?.['toObject']()?.['buildHashedId'],_0xb3d9f3=path[_0x381b06(0x14c)](_0x10965a,_0x2ef748);!fs['existsSync'](_0xb3d9f3)&&(fs[_0x381b06(0x162)](_0xb3d9f3),this['logger'][_0x381b06(0x13b)](util[_0x381b06(0x155)](_0x570404[_0x381b06(0x182)],_0xb3d9f3)));if(_0x570404[_0x381b06(0x17a)](_0x3db796['trim'](),'')){this[_0x381b06(0x146)][_0x381b06(0x13b)](util[_0x381b06(0x155)](_0x570404[_0x381b06(0x157)]));return;}if(_0x3db796['startsWith'](_0x570404[_0x381b06(0x150)])||_0x3db796['startsWith'](_0x570404[_0x381b06(0x18f)])){const _0xa0084=_0x3db796['startsWith'](_0x570404[_0x381b06(0x150)])?https:http,_0x3774f2=path[_0x381b06(0x18b)](_0x3db796),_0x2e7b87=path[_0x381b06(0x14c)](_0xb3d9f3,_0x3774f2),_0xaf346f=fs[_0x381b06(0x179)](_0x2e7b87);_0xa0084[_0x381b06(0x140)](_0x3db796,_0x5b2f1a=>{const _0x2be3ab=_0x381b06,_0x4e88fc={'Zufid':function(_0x4fed33,_0x1adc2a){const _0x5f541a=a82_0xe1db;return _0x570404[_0x5f541a(0x136)](_0x4fed33,_0x1adc2a);},'KPkkQ':function(_0x427b39,_0x45a862){const _0x27d28b=a82_0xe1db;return _0x570404[_0x27d28b(0x17d)](_0x427b39,_0x45a862);},'WKhKj':function(_0x4f5ef8,_0xc7c73f){const _0x461b4d=a82_0xe1db;return _0x570404[_0x461b4d(0x18a)](_0x4f5ef8,_0xc7c73f);},'EBUsE':_0x570404['aFuIj'],'oEEBz':_0x570404[_0x2be3ab(0x177)]};if(_0x570404[_0x2be3ab(0x17f)](_0x5b2f1a[_0x2be3ab(0x15e)],0xc8))_0x5b2f1a[_0x2be3ab(0x172)](_0xaf346f),_0xaf346f['on'](_0x570404[_0x2be3ab(0x167)],()=>{const _0x5086b3=_0x2be3ab;_0xaf346f[_0x5086b3(0x13f)]();const _0x178c56=fs['statSync'](_0x2e7b87),_0x5d6241=_0x4e88fc[_0x5086b3(0x16a)](_0x178c56['size'],_0x4e88fc['KPkkQ'](0x400,0x400));if(_0x4e88fc[_0x5086b3(0x15c)](_0x5d6241,0x64)){this[_0x5086b3(0x146)][_0x5086b3(0x13b)](util['format'](_0x4e88fc['EBUsE'],_0x5d6241['toFixed'](0x2))),fs[_0x5086b3(0x169)](_0x2e7b87);return;}this[_0x5086b3(0x146)][_0x5086b3(0x13b)](util[_0x5086b3(0x155)](_0x4e88fc['oEEBz'],_0x2e7b87)),uploadAttachmentsManager[_0x5086b3(0x147)](_0x2e7b87,_0x5c3ab1);});else{this[_0x2be3ab(0x146)]['debug'](util[_0x2be3ab(0x155)](_0x570404[_0x2be3ab(0x160)],_0x5b2f1a[_0x2be3ab(0x15e)])),_0xaf346f['close'](),fs[_0x2be3ab(0x169)](_0x2e7b87);return;}})['on'](_0x570404['Blltt'],_0x3b5299=>{const _0x226fe7=_0x381b06;this[_0x226fe7(0x146)]['debug'](util[_0x226fe7(0x155)](_0x570404[_0x226fe7(0x183)],_0x3b5299['message'])),_0xaf346f[_0x226fe7(0x13f)](),fs[_0x226fe7(0x169)](_0x2e7b87);return;});}else{if(!fs['existsSync'](_0x3db796)){this[_0x381b06(0x146)][_0x381b06(0x13b)](util['format'](_0x570404[_0x381b06(0x164)],_0x3db796));return;}const _0x1596c2=fs[_0x381b06(0x170)](_0x3db796),_0x12df95=_0x570404[_0x381b06(0x136)](_0x1596c2[_0x381b06(0x132)],_0x570404[_0x381b06(0x17d)](0x400,0x400));if(_0x570404[_0x381b06(0x131)](_0x12df95,0x64)){this['logger'][_0x381b06(0x13b)](util[_0x381b06(0x155)](_0x570404[_0x381b06(0x154)],_0x12df95[_0x381b06(0x18d)](0x2)));return;}const _0x2cd142=path[_0x381b06(0x18b)](_0x3db796),_0xb1056c=path[_0x381b06(0x14c)](_0xb3d9f3,_0x2cd142);fs[_0x381b06(0x181)](_0x3db796,_0xb1056c),uploadAttachmentsManager['trackFile'](_0xb1056c,_0x5c3ab1);}}static[a82_0x59e78f(0x147)](_0x17272c,_0x1296ef){const _0x47f4fa=a82_0x59e78f,_0x446806={};_0x446806[_0x47f4fa(0x148)]=_0x47f4fa(0x17c),_0x446806[_0x47f4fa(0x137)]=_0x47f4fa(0x161),_0x446806[_0x47f4fa(0x174)]=_0x47f4fa(0x144),_0x446806[_0x47f4fa(0x133)]='Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload';const _0x254d04=_0x446806;try{const _0x3ffe2f=AutomationFramework[_0x47f4fa(0x14f)](),_0x295dea=AutomationFramework[_0x47f4fa(0x17e)](_0x3ffe2f,PlaywrightDriverModule['KEY_TEST_ID'],''),_0x1edc9f=TestInfo[_0x47f4fa(0x15f)](_0x295dea),_0x2f47de=_0x1edc9f[TestFrameworkConstants[_0x47f4fa(0x188)]]||{};_0x2f47de[_0x17272c]={[TestFrameworkConstants[_0x47f4fa(0x158)]]:fs[_0x47f4fa(0x170)](_0x17272c)[_0x47f4fa(0x132)],[TestFrameworkConstants[_0x47f4fa(0x139)]]:path[_0x47f4fa(0x18b)](_0x17272c),[TestFrameworkConstants[_0x47f4fa(0x141)]]:_0x17272c,[TestFrameworkConstants[_0x47f4fa(0x14a)]]:_0x1296ef?_0x254d04[_0x47f4fa(0x148)]:_0x254d04[_0x47f4fa(0x137)]},_0x1edc9f[TestFrameworkConstants[_0x47f4fa(0x188)]]=_0x2f47de,TestInfo[_0x47f4fa(0x16b)](_0x295dea,_0x1edc9f),this[_0x47f4fa(0x146)][_0x47f4fa(0x13b)](util['format'](_0x254d04[_0x47f4fa(0x174)],_0x17272c));}catch(_0x9893d0){this[_0x47f4fa(0x146)][_0x47f4fa(0x13b)](util['format'](_0x254d04[_0x47f4fa(0x133)],_0x9893d0['message']));}}static[a82_0x59e78f(0x187)](){const _0x1d2127=a82_0x59e78f,_0x56d9fc={};_0x56d9fc['BuazX']=_0x1d2127(0x13d),_0x56d9fc[_0x1d2127(0x16f)]=_0x1d2127(0x18c),_0x56d9fc[_0x1d2127(0x13c)]='Cleared\x20attachment\x20folder';const _0x2b5003=_0x56d9fc,_0x4cc7e0=os[_0x1d2127(0x16d)](),_0x132b54=path[_0x1d2127(0x14c)](_0x4cc7e0,_0x2b5003['BuazX']);if(!fs[_0x1d2127(0x14d)](_0x132b54))return;const _0x39e99d=BrowserstackCLI[_0x1d2127(0x185)]()[_0x1d2127(0x143)]['TestHubModule']?.[_0x1d2127(0x153)]?.[_0x1d2127(0x175)]()?.['buildHashedId'],_0x231ccb=_0x39e99d?path[_0x1d2127(0x14c)](_0x132b54,_0x39e99d):null;if(!_0x231ccb||!fs['existsSync'](_0x231ccb)){this[_0x1d2127(0x146)][_0x1d2127(0x13b)](util[_0x1d2127(0x155)](_0x2b5003[_0x1d2127(0x16f)],_0x39e99d));return;}const _0x2d5c33={};_0x2d5c33['recursive']=!![],_0x2d5c33[_0x1d2127(0x171)]=!![],fs[_0x1d2127(0x13e)](_0x231ccb,_0x2d5c33),this[_0x1d2127(0x146)]['debug'](util['format'](_0x2b5003[_0x1d2127(0x13c)]));}}module['exports']=uploadAttachmentsManager;