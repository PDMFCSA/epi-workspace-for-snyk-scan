const a78_0x42f855=a78_0x4d8b;(function(_0x20759d,_0x2c83d2){const _0xf6f7a3=a78_0x4d8b,_0x55544f=_0x20759d();while(!![]){try{const _0x2dafdc=parseInt(_0xf6f7a3(0x99))/0x1+-parseInt(_0xf6f7a3(0xcd))/0x2+-parseInt(_0xf6f7a3(0xa3))/0x3+parseInt(_0xf6f7a3(0x90))/0x4*(-parseInt(_0xf6f7a3(0xb8))/0x5)+-parseInt(_0xf6f7a3(0xb0))/0x6+-parseInt(_0xf6f7a3(0x93))/0x7*(parseInt(_0xf6f7a3(0xa4))/0x8)+parseInt(_0xf6f7a3(0x84))/0x9;if(_0x2dafdc===_0x2c83d2)break;else _0x55544f['push'](_0x55544f['shift']());}catch(_0xfa5636){_0x55544f['push'](_0x55544f['shift']());}}}(a78_0x5cc3,0x6b1a3));function a78_0x4d8b(_0x45191a,_0x1bc349){const _0x5cc393=a78_0x5cc3();return a78_0x4d8b=function(_0x4d8b13,_0x51bb74){_0x4d8b13=_0x4d8b13-0x78;let _0x5a117d=_0x5cc393[_0x4d8b13];return _0x5a117d;},a78_0x4d8b(_0x45191a,_0x1bc349);}function a78_0x5cc3(){const _0x397bba=['http','BuildLevel','zHDwR','BMRgm','501096UnvnlJ','mkdirSync','unlinkSync','toFixed','Attachment\x20recevied\x20for\x20path:\x20%s','KEY_FILE_PATH','KEY_TEST_ATTACHMENTS','startsWith','setTestDetails','buildHashedId','statSync','uploadAttachmentsManager','KEY_FILE_NAME','gAqRq','ByWKZ','getTestDetails','https','http://','iHSIR','testhubConfig','getTrackedInstance','size','../../helpers/classLogger.js','wxEFD','GQAQd','close','vQqNw','IytvP','srkHX','12708873KWFOLE','statusCode','logger','pipe','RrheF','File\x20downloaded\x20to:\x20%s','error','rmSync','getState','path','./framework/constants/testFrameworkConstants','vbzBA','4nFjjlK','format','message','35qBLQCz','debug','modules','Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.','SGpdQ','basename','557223HEngHM','get','Cleared\x20attachment\x20folder','HiXBF','./TestInfo','TestLevel','eYZoI','Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload','TestHubModule','Created\x20.browserstack\x20folder\x20at:\x20%s','1315383fLNSzJ','677104GWuSAI','NtgFc','getInstance','util','DdsjG','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','copyFileSync','homedir','RMcNR','OcDGq','join','BZHcX','1513134GcQuzE','IGPil','Attachment\x20file\x20tracked\x20for\x20upload:\x20%s','toObject','existsSync','.browserstack\x20folder\x20not\x20found\x20at:\x20%s','megdL','Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload','831205OtVVvV','finish','clearAttachments','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','eqWCc','.browserstack','rZDkw','Mseod','Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s','KEY_FILE_LEVEL','rUXtg','NRTEJ','VsJVo','GWBmT','vBwjm','./modules/playwrightDriverModule','KZCJv'];a78_0x5cc3=function(){return _0x397bba;};return a78_0x5cc3();}const os=require('os'),fs=require('fs'),path=require(a78_0x42f855(0x8d)),util=require(a78_0x42f855(0xa7)),BrowserstackCLI=require('./browserstackCLI'),https=require(a78_0x42f855(0xdd)),http=require(a78_0x42f855(0xc9)),AutomationFramework=require('./framework/automationFramework'),PlaywrightDriverModule=require(a78_0x42f855(0xc7)),TestInfo=require(a78_0x42f855(0x9d)),TestFrameworkConstants=require(a78_0x42f855(0x8e)),{createClassLogger}=require(a78_0x42f855(0x7d));class uploadAttachmentsManager{static [a78_0x42f855(0x86)]=createClassLogger(a78_0x42f855(0xd8));static['uploadAttachments'](_0x51375f,_0x333341=![]){const _0x405399=a78_0x42f855,_0x5e86a7={};_0x5e86a7[_0x405399(0xdb)]=function(_0x29784c,_0x4c56cb){return _0x29784c/_0x4c56cb;},_0x5e86a7[_0x405399(0x88)]=function(_0x32eea5,_0x1ee010){return _0x32eea5*_0x1ee010;},_0x5e86a7[_0x405399(0xbf)]=function(_0x260a42,_0x21c489){return _0x260a42>_0x21c489;},_0x5e86a7['iHSIR']=_0x405399(0x96),_0x5e86a7['OcDGq']=_0x405399(0x89),_0x5e86a7[_0x405399(0xb1)]=function(_0x4c5be6,_0x284cd6){return _0x4c5be6===_0x284cd6;},_0x5e86a7[_0x405399(0xaf)]=_0x405399(0xb9),_0x5e86a7[_0x405399(0xbc)]=_0x405399(0xb7),_0x5e86a7[_0x405399(0xac)]=_0x405399(0xa9),_0x5e86a7[_0x405399(0xb6)]=_0x405399(0xd1),_0x5e86a7[_0x405399(0x83)]=_0x405399(0xbd),_0x5e86a7[_0x405399(0xcc)]=_0x405399(0xb5),_0x5e86a7[_0x405399(0x82)]=_0x405399(0xa2),_0x5e86a7['GWBmT']='Created\x20folder:\x20%s',_0x5e86a7[_0x405399(0x9c)]='Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.',_0x5e86a7[_0x405399(0x7f)]='https://',_0x5e86a7['zHDwR']=_0x405399(0x78),_0x5e86a7[_0x405399(0x7e)]=_0x405399(0x8a),_0x5e86a7[_0x405399(0xc4)]=_0x405399(0xc0),_0x5e86a7[_0x405399(0xbe)]=function(_0x22ab29,_0x11451a){return _0x22ab29*_0x11451a;},_0x5e86a7[_0x405399(0xc2)]=function(_0x3276ce,_0x42249e){return _0x3276ce>_0x42249e;},_0x5e86a7[_0x405399(0xc8)]=_0x405399(0xbb);const _0x174a61=_0x5e86a7;this['logger'][_0x405399(0x94)](util[_0x405399(0x91)](_0x174a61[_0x405399(0xb6)],_0x51375f));const _0x10678d=os[_0x405399(0xab)](),_0x13cee5=path[_0x405399(0xae)](_0x10678d,_0x174a61[_0x405399(0x83)]);!fs[_0x405399(0xb4)](_0x13cee5)&&(this[_0x405399(0x86)]['debug'](util['format'](_0x174a61['BMRgm'],_0x13cee5)),fs[_0x405399(0xce)](_0x13cee5),this[_0x405399(0x86)][_0x405399(0x94)](util['format'](_0x174a61[_0x405399(0x82)],_0x13cee5)));const _0x1a8810=BrowserstackCLI[_0x405399(0xa6)]()[_0x405399(0x95)]['TestHubModule']?.['testhubConfig']?.[_0x405399(0xb3)]()?.[_0x405399(0xd6)],_0x4a1189=path[_0x405399(0xae)](_0x13cee5,_0x1a8810);!fs[_0x405399(0xb4)](_0x4a1189)&&(fs[_0x405399(0xce)](_0x4a1189),this['logger'][_0x405399(0x94)](util[_0x405399(0x91)](_0x174a61[_0x405399(0xc5)],_0x4a1189)));if(_0x174a61['IGPil'](_0x51375f['trim'](),'')){this[_0x405399(0x86)][_0x405399(0x94)](util[_0x405399(0x91)](_0x174a61[_0x405399(0x9c)]));return;}if(_0x51375f['startsWith'](_0x174a61[_0x405399(0x7f)])||_0x51375f[_0x405399(0xd4)](_0x174a61[_0x405399(0xcb)])){const _0x3267ea=_0x51375f['startsWith'](_0x174a61[_0x405399(0x7f)])?https:http,_0x5c7cf9=path['basename'](_0x51375f),_0x21a36f=path[_0x405399(0xae)](_0x4a1189,_0x5c7cf9),_0x50071e=fs['createWriteStream'](_0x21a36f);_0x3267ea[_0x405399(0x9a)](_0x51375f,_0x27cac3=>{const _0x3909e6=_0x405399,_0x2668aa={'NtgFc':function(_0x415d3d,_0x526d00){const _0x555eb5=a78_0x4d8b;return _0x174a61[_0x555eb5(0xdb)](_0x415d3d,_0x526d00);},'vbzBA':function(_0x344c40,_0x57f62e){return _0x174a61['RrheF'](_0x344c40,_0x57f62e);},'ulSGK':function(_0x2583ed,_0x198647){const _0x431002=a78_0x4d8b;return _0x174a61[_0x431002(0xbf)](_0x2583ed,_0x198647);},'SGpdQ':_0x174a61[_0x3909e6(0x79)],'gAqRq':_0x174a61[_0x3909e6(0xad)]};if(_0x174a61[_0x3909e6(0xb1)](_0x27cac3[_0x3909e6(0x85)],0xc8))_0x27cac3[_0x3909e6(0x87)](_0x50071e),_0x50071e['on'](_0x174a61['BZHcX'],()=>{const _0x5afdd6=_0x3909e6;_0x50071e['close']();const _0x3ce50=fs[_0x5afdd6(0xd7)](_0x21a36f),_0x3abe3f=_0x2668aa[_0x5afdd6(0xa5)](_0x3ce50['size'],_0x2668aa[_0x5afdd6(0x8f)](0x400,0x400));if(_0x2668aa['ulSGK'](_0x3abe3f,0x64)){this[_0x5afdd6(0x86)][_0x5afdd6(0x94)](util[_0x5afdd6(0x91)](_0x2668aa[_0x5afdd6(0x97)],_0x3abe3f['toFixed'](0x2))),fs[_0x5afdd6(0xcf)](_0x21a36f);return;}this[_0x5afdd6(0x86)][_0x5afdd6(0x94)](util[_0x5afdd6(0x91)](_0x2668aa[_0x5afdd6(0xda)],_0x21a36f)),uploadAttachmentsManager['trackFile'](_0x21a36f,_0x333341);});else{this[_0x3909e6(0x86)]['debug'](util['format'](_0x174a61['eqWCc'],_0x27cac3['statusCode'])),_0x50071e[_0x3909e6(0x80)](),fs[_0x3909e6(0xcf)](_0x21a36f);return;}})['on'](_0x174a61[_0x405399(0x7e)],_0x29a40b=>{const _0x270497=_0x405399;this[_0x270497(0x86)]['debug'](util[_0x270497(0x91)](_0x174a61['RMcNR'],_0x29a40b[_0x270497(0x92)])),_0x50071e['close'](),fs[_0x270497(0xcf)](_0x21a36f);return;});}else{if(!fs['existsSync'](_0x51375f)){this['logger'][_0x405399(0x94)](util[_0x405399(0x91)](_0x174a61['VsJVo'],_0x51375f));return;}const _0x27d6e9=fs[_0x405399(0xd7)](_0x51375f),_0x4eb1d7=_0x174a61[_0x405399(0xdb)](_0x27d6e9[_0x405399(0x7c)],_0x174a61['rZDkw'](0x400,0x400));if(_0x174a61[_0x405399(0xc2)](_0x4eb1d7,0x64)){this[_0x405399(0x86)]['debug'](util[_0x405399(0x91)](_0x174a61['KZCJv'],_0x4eb1d7[_0x405399(0xd0)](0x2)));return;}const _0x1c038b=path['basename'](_0x51375f),_0x3d1ae7=path[_0x405399(0xae)](_0x4a1189,_0x1c038b);fs[_0x405399(0xaa)](_0x51375f,_0x3d1ae7),uploadAttachmentsManager['trackFile'](_0x3d1ae7,_0x333341);}}static['trackFile'](_0x34fcc9,_0xce0869){const _0x2642e1=a78_0x42f855,_0x2e4294={};_0x2e4294[_0x2642e1(0xa8)]=_0x2642e1(0xca),_0x2e4294['vBwjm']=_0x2642e1(0x9e),_0x2e4294['Nzpcj']=_0x2642e1(0xb2),_0x2e4294[_0x2642e1(0xc3)]=_0x2642e1(0xa0);const _0x6e2c70=_0x2e4294;try{const _0x15dbdc=AutomationFramework[_0x2642e1(0x7b)](),_0x19fd65=AutomationFramework[_0x2642e1(0x8c)](_0x15dbdc,PlaywrightDriverModule['KEY_TEST_ID'],''),_0x41f6cc=TestInfo[_0x2642e1(0xdc)](_0x19fd65),_0x34f70b=_0x41f6cc[TestFrameworkConstants[_0x2642e1(0xd3)]]||{};_0x34f70b[_0x34fcc9]={[TestFrameworkConstants['KEY_FILE_SIZE']]:fs[_0x2642e1(0xd7)](_0x34fcc9)[_0x2642e1(0x7c)],[TestFrameworkConstants[_0x2642e1(0xd9)]]:path[_0x2642e1(0x98)](_0x34fcc9),[TestFrameworkConstants[_0x2642e1(0xd2)]]:_0x34fcc9,[TestFrameworkConstants[_0x2642e1(0xc1)]]:_0xce0869?_0x6e2c70['DdsjG']:_0x6e2c70[_0x2642e1(0xc6)]},_0x41f6cc[TestFrameworkConstants[_0x2642e1(0xd3)]]=_0x34f70b,TestInfo[_0x2642e1(0xd5)](_0x19fd65,_0x41f6cc),this[_0x2642e1(0x86)]['debug'](util['format'](_0x6e2c70['Nzpcj'],_0x34fcc9));}catch(_0x574786){this[_0x2642e1(0x86)]['debug'](util['format'](_0x6e2c70[_0x2642e1(0xc3)],_0x574786['message']));}}static[a78_0x42f855(0xba)](){const _0x487d34=a78_0x42f855,_0x1e54d6={};_0x1e54d6[_0x487d34(0x9f)]='.browserstack',_0x1e54d6[_0x487d34(0x81)]=_0x487d34(0x9b);const _0x48b0e9=_0x1e54d6,_0x18bf4b=os['homedir'](),_0x375a33=path['join'](_0x18bf4b,_0x48b0e9[_0x487d34(0x9f)]);if(!fs[_0x487d34(0xb4)](_0x375a33))return;const _0x2496ce=BrowserstackCLI[_0x487d34(0xa6)]()['modules'][_0x487d34(0xa1)]?.[_0x487d34(0x7a)]?.['toObject']()?.[_0x487d34(0xd6)],_0x522321=path['join'](_0x375a33,_0x2496ce);if(!fs['existsSync'](_0x522321))return;const _0x146a4c={};_0x146a4c['recursive']=!![],_0x146a4c['force']=!![],fs[_0x487d34(0x8b)](_0x522321,_0x146a4c),this[_0x487d34(0x86)]['debug'](util[_0x487d34(0x91)](_0x48b0e9[_0x487d34(0x81)]));}}module['exports']=uploadAttachmentsManager;