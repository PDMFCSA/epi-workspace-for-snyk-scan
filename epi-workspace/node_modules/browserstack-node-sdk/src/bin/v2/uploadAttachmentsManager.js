const a77_0x584aad=a77_0x20f1;function a77_0x20f1(_0x141f9d,_0x585a2b){const _0x23c6c6=a77_0x23c6();return a77_0x20f1=function(_0x20f173,_0x3319b5){_0x20f173=_0x20f173-0x1be;let _0x1a61ab=_0x23c6c6[_0x20f173];return _0x1a61ab;},a77_0x20f1(_0x141f9d,_0x585a2b);}(function(_0xe2b0d5,_0x5012e0){const _0x3fce8a=a77_0x20f1,_0x284c34=_0xe2b0d5();while(!![]){try{const _0x3835b3=-parseInt(_0x3fce8a(0x1f2))/0x1+-parseInt(_0x3fce8a(0x1dd))/0x2+parseInt(_0x3fce8a(0x21f))/0x3*(-parseInt(_0x3fce8a(0x1d4))/0x4)+-parseInt(_0x3fce8a(0x1f9))/0x5*(parseInt(_0x3fce8a(0x206))/0x6)+-parseInt(_0x3fce8a(0x1d0))/0x7+parseInt(_0x3fce8a(0x1fc))/0x8+-parseInt(_0x3fce8a(0x21d))/0x9*(-parseInt(_0x3fce8a(0x1ee))/0xa);if(_0x3835b3===_0x5012e0)break;else _0x284c34['push'](_0x284c34['shift']());}catch(_0x342e4f){_0x284c34['push'](_0x284c34['shift']());}}}(a77_0x23c6,0xbcbfa));function a77_0x23c6(){const _0x382f98=['./browserstackCLI','uYfzJ','format','RpZzz','QOPEI','Attachment\x20recevied\x20for\x20path:\x20%s','http','path','pvBQX','./modules/playwrightDriverModule','30kckHCy','toObject','Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload','homedir','1146651vdtDAi','ofWJD','https://','KEY_FILE_LEVEL','XTJvp','wLHDM','uploadAttachments','6948265fGWcHP','http://','get','12271816LacYyA','oBCgC','iADkI','kDXdG','QiXDH','QAbAx','Created\x20.browserstack\x20folder\x20at:\x20%s','statusCode','qvShA','existsSync','6ZTlrcO','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','FLxxl','Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.','CLqAx','DHdBT','KEY_TEST_ATTACHMENTS','trackFile','buildHashedId','TestHubModule','startsWith','getState','toFixed','modules','statSync','wtkNf','Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','clearAttachments','mkdirSync','VhRRM','Eghyl','copyFileSync','12857517EHgJVk','exports','1929QfjfUT','brEwJ','egQdF','size','Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.','error','finish','VgArB','Cleared\x20attachment\x20folder','BuildLevel','RXjKF','basename','MRAQW','TestLevel','Created\x20folder:\x20%s','lqpwy','debug','neSgw','unlinkSync','10758104bSmWSW','https','pipe','eNRrF','5008DalYjV','fHhnw','testhubConfig','getInstance','rmSync','close','Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload','logger','recursive','336980RDYAIc','Attachment\x20file\x20tracked\x20for\x20upload:\x20%s','force','wJyxz','join','.browserstack','aBWRC'];a77_0x23c6=function(){return _0x382f98;};return a77_0x23c6();}const os=require('os'),fs=require('fs'),path=require(a77_0x584aad(0x1eb)),util=require('util'),BrowserstackCLI=require(a77_0x584aad(0x1e4)),https=require(a77_0x584aad(0x1d1)),http=require(a77_0x584aad(0x1ea)),AutomationFramework=require('./framework/automationFramework'),PlaywrightDriverModule=require(a77_0x584aad(0x1ed)),TestInfo=require('./TestInfo'),TestFrameworkConstants=require('./framework/constants/testFrameworkConstants'),{createClassLogger}=require('../../helpers/classLogger.js');class uploadAttachmentsManager{static [a77_0x584aad(0x1db)]=createClassLogger('uploadAttachmentsManager');static[a77_0x584aad(0x1f8)](_0x5ad7b2,_0x1354d7=![]){const _0x49a3a9=a77_0x584aad,_0x4caeda={};_0x4caeda[_0x49a3a9(0x200)]=function(_0x3b584b,_0x5641a3){return _0x3b584b/_0x5641a3;},_0x4caeda[_0x49a3a9(0x1ff)]=function(_0x4c3159,_0xe46c87){return _0x4c3159*_0xe46c87;},_0x4caeda[_0x49a3a9(0x1fe)]=function(_0x27397b,_0x584367){return _0x27397b>_0x584367;},_0x4caeda[_0x49a3a9(0x1e3)]=_0x49a3a9(0x209),_0x4caeda[_0x49a3a9(0x1c9)]='File\x20downloaded\x20to:\x20%s',_0x4caeda[_0x49a3a9(0x208)]=function(_0x5e85fa,_0x1dd4d4){return _0x5e85fa===_0x1dd4d4;},_0x4caeda['fHhnw']=_0x49a3a9(0x1c3),_0x4caeda[_0x49a3a9(0x204)]=_0x49a3a9(0x1f0),_0x4caeda[_0x49a3a9(0x1c7)]=_0x49a3a9(0x207),_0x4caeda[_0x49a3a9(0x201)]=_0x49a3a9(0x1e9),_0x4caeda[_0x49a3a9(0x1e0)]=_0x49a3a9(0x1e2),_0x4caeda[_0x49a3a9(0x21b)]='.browserstack\x20folder\x20not\x20found\x20at:\x20%s',_0x4caeda[_0x49a3a9(0x1f7)]=_0x49a3a9(0x202),_0x4caeda[_0x49a3a9(0x20a)]=_0x49a3a9(0x1cb),_0x4caeda['aRVDZ']=function(_0x729913,_0x2b4bc3){return _0x729913===_0x2b4bc3;},_0x4caeda[_0x49a3a9(0x1fd)]=_0x49a3a9(0x1c1),_0x4caeda[_0x49a3a9(0x1e7)]=_0x49a3a9(0x1f4),_0x4caeda[_0x49a3a9(0x1f6)]=_0x49a3a9(0x1fa),_0x4caeda[_0x49a3a9(0x1bf)]=_0x49a3a9(0x1c2),_0x4caeda[_0x49a3a9(0x1e8)]=_0x49a3a9(0x216),_0x4caeda[_0x49a3a9(0x1ec)]=function(_0x29c1a6,_0x4b4adc){return _0x29c1a6>_0x4b4adc;},_0x4caeda[_0x49a3a9(0x1d3)]=_0x49a3a9(0x217);const _0x1ec7f6=_0x4caeda;this[_0x49a3a9(0x1db)][_0x49a3a9(0x1cd)](util[_0x49a3a9(0x1e6)](_0x1ec7f6[_0x49a3a9(0x201)],_0x5ad7b2));const _0x2d35f2=os[_0x49a3a9(0x1f1)](),_0x45f12d=path['join'](_0x2d35f2,_0x1ec7f6[_0x49a3a9(0x1e0)]);!fs[_0x49a3a9(0x205)](_0x45f12d)&&(this[_0x49a3a9(0x1db)]['debug'](util['format'](_0x1ec7f6[_0x49a3a9(0x21b)],_0x45f12d)),fs[_0x49a3a9(0x219)](_0x45f12d),this['logger'][_0x49a3a9(0x1cd)](util[_0x49a3a9(0x1e6)](_0x1ec7f6[_0x49a3a9(0x1f7)],_0x45f12d)));const _0x4b3af7=BrowserstackCLI[_0x49a3a9(0x1d7)]()[_0x49a3a9(0x213)][_0x49a3a9(0x20f)]?.[_0x49a3a9(0x1d6)]?.[_0x49a3a9(0x1ef)]()?.[_0x49a3a9(0x20e)],_0x1406bb=path[_0x49a3a9(0x1e1)](_0x45f12d,_0x4b3af7);!fs[_0x49a3a9(0x205)](_0x1406bb)&&(fs[_0x49a3a9(0x219)](_0x1406bb),this[_0x49a3a9(0x1db)][_0x49a3a9(0x1cd)](util['format'](_0x1ec7f6[_0x49a3a9(0x20a)],_0x1406bb)));if(_0x1ec7f6['aRVDZ'](_0x5ad7b2['trim'](),'')){this[_0x49a3a9(0x1db)][_0x49a3a9(0x1cd)](util[_0x49a3a9(0x1e6)](_0x1ec7f6[_0x49a3a9(0x1fd)]));return;}if(_0x5ad7b2[_0x49a3a9(0x210)](_0x1ec7f6['RpZzz'])||_0x5ad7b2[_0x49a3a9(0x210)](_0x1ec7f6['XTJvp'])){const _0x49fb4d=_0x5ad7b2[_0x49a3a9(0x210)](_0x1ec7f6['RpZzz'])?https:http,_0x6c20a4=path[_0x49a3a9(0x1c8)](_0x5ad7b2),_0x1a870c=path['join'](_0x1406bb,_0x6c20a4),_0x4069ad=fs['createWriteStream'](_0x1a870c);_0x49fb4d[_0x49a3a9(0x1fb)](_0x5ad7b2,_0xb06186=>{const _0x2711cc=_0x49a3a9,_0x5df438={'OjJJl':function(_0x24bb2c,_0x2fe71a){const _0x180e2f=a77_0x20f1;return _0x1ec7f6[_0x180e2f(0x200)](_0x24bb2c,_0x2fe71a);},'lqpwy':function(_0x215c6d,_0x292da1){return _0x1ec7f6['kDXdG'](_0x215c6d,_0x292da1);},'nTSyE':function(_0x23335f,_0x5c208c){return _0x1ec7f6['iADkI'](_0x23335f,_0x5c208c);},'neSgw':_0x1ec7f6[_0x2711cc(0x1e3)],'uYfzJ':_0x1ec7f6[_0x2711cc(0x1c9)]};if(_0x1ec7f6['FLxxl'](_0xb06186[_0x2711cc(0x203)],0xc8))_0xb06186[_0x2711cc(0x1d2)](_0x4069ad),_0x4069ad['on'](_0x1ec7f6[_0x2711cc(0x1d5)],()=>{const _0x2252ea=_0x2711cc;_0x4069ad[_0x2252ea(0x1d9)]();const _0x85f745=fs[_0x2252ea(0x214)](_0x1a870c),_0x56b75f=_0x5df438['OjJJl'](_0x85f745[_0x2252ea(0x1c0)],_0x5df438[_0x2252ea(0x1cc)](0x400,0x400));if(_0x5df438['nTSyE'](_0x56b75f,0x64)){this['logger']['debug'](util[_0x2252ea(0x1e6)](_0x5df438[_0x2252ea(0x1ce)],_0x56b75f[_0x2252ea(0x212)](0x2))),fs[_0x2252ea(0x1cf)](_0x1a870c);return;}this[_0x2252ea(0x1db)][_0x2252ea(0x1cd)](util[_0x2252ea(0x1e6)](_0x5df438[_0x2252ea(0x1e5)],_0x1a870c)),uploadAttachmentsManager[_0x2252ea(0x20d)](_0x1a870c,_0x1354d7);});else{this['logger']['debug'](util[_0x2711cc(0x1e6)](_0x1ec7f6['qvShA'],_0xb06186['statusCode'])),_0x4069ad[_0x2711cc(0x1d9)](),fs[_0x2711cc(0x1cf)](_0x1a870c);return;}})['on'](_0x1ec7f6[_0x49a3a9(0x1bf)],_0x6bf410=>{const _0x266bf7=_0x49a3a9;this['logger'][_0x266bf7(0x1cd)](util[_0x266bf7(0x1e6)](_0x1ec7f6[_0x266bf7(0x1c7)],_0x6bf410['message'])),_0x4069ad[_0x266bf7(0x1d9)](),fs[_0x266bf7(0x1cf)](_0x1a870c);return;});}else{if(!fs[_0x49a3a9(0x205)](_0x5ad7b2)){this[_0x49a3a9(0x1db)]['debug'](util[_0x49a3a9(0x1e6)](_0x1ec7f6[_0x49a3a9(0x1e8)],_0x5ad7b2));return;}const _0x476cdb=fs[_0x49a3a9(0x214)](_0x5ad7b2),_0xd75714=_0x1ec7f6['QiXDH'](_0x476cdb[_0x49a3a9(0x1c0)],_0x1ec7f6['kDXdG'](0x400,0x400));if(_0x1ec7f6[_0x49a3a9(0x1ec)](_0xd75714,0x64)){this[_0x49a3a9(0x1db)][_0x49a3a9(0x1cd)](util[_0x49a3a9(0x1e6)](_0x1ec7f6[_0x49a3a9(0x1d3)],_0xd75714[_0x49a3a9(0x212)](0x2)));return;}const _0x17faf3=path[_0x49a3a9(0x1c8)](_0x5ad7b2),_0x11fda3=path[_0x49a3a9(0x1e1)](_0x1406bb,_0x17faf3);fs[_0x49a3a9(0x21c)](_0x5ad7b2,_0x11fda3),uploadAttachmentsManager['trackFile'](_0x11fda3,_0x1354d7);}}static[a77_0x584aad(0x20d)](_0x4c7063,_0x24a71e){const _0x2eb795=a77_0x584aad,_0x326ea7={};_0x326ea7[_0x2eb795(0x20b)]=_0x2eb795(0x1c6),_0x326ea7[_0x2eb795(0x1f3)]=_0x2eb795(0x1ca),_0x326ea7[_0x2eb795(0x1be)]=_0x2eb795(0x1de),_0x326ea7[_0x2eb795(0x215)]=_0x2eb795(0x1da);const _0x29f37b=_0x326ea7;try{const _0x2feba3=AutomationFramework['getTrackedInstance'](),_0x3f021f=AutomationFramework[_0x2eb795(0x211)](_0x2feba3,PlaywrightDriverModule['KEY_TEST_ID'],''),_0x15ef6b=TestInfo['getTestDetails'](_0x3f021f),_0x49e281=_0x15ef6b[TestFrameworkConstants[_0x2eb795(0x20c)]]||{};_0x49e281[_0x4c7063]={[TestFrameworkConstants['KEY_FILE_SIZE']]:fs[_0x2eb795(0x214)](_0x4c7063)['size'],[TestFrameworkConstants['KEY_FILE_NAME']]:path[_0x2eb795(0x1c8)](_0x4c7063),[TestFrameworkConstants['KEY_FILE_PATH']]:_0x4c7063,[TestFrameworkConstants[_0x2eb795(0x1f5)]]:_0x24a71e?_0x29f37b[_0x2eb795(0x20b)]:_0x29f37b[_0x2eb795(0x1f3)]},_0x15ef6b[TestFrameworkConstants[_0x2eb795(0x20c)]]=_0x49e281,TestInfo['setTestDetails'](_0x3f021f,_0x15ef6b),this[_0x2eb795(0x1db)][_0x2eb795(0x1cd)](util[_0x2eb795(0x1e6)](_0x29f37b[_0x2eb795(0x1be)],_0x4c7063));}catch(_0x5bcffb){this[_0x2eb795(0x1db)][_0x2eb795(0x1cd)](util['format'](_0x29f37b[_0x2eb795(0x215)],_0x5bcffb['message']));}}static[a77_0x584aad(0x218)](){const _0xfe78c3=a77_0x584aad,_0x5f5bc0={};_0x5f5bc0[_0xfe78c3(0x1c4)]='.browserstack',_0x5f5bc0[_0xfe78c3(0x21a)]=_0xfe78c3(0x1c5);const _0x1af112=_0x5f5bc0,_0x50a0bb=os[_0xfe78c3(0x1f1)](),_0x5c457e=path[_0xfe78c3(0x1e1)](_0x50a0bb,_0x1af112[_0xfe78c3(0x1c4)]);if(!fs[_0xfe78c3(0x205)](_0x5c457e))return;const _0x1fb1fc=BrowserstackCLI[_0xfe78c3(0x1d7)]()[_0xfe78c3(0x213)][_0xfe78c3(0x20f)]?.[_0xfe78c3(0x1d6)]?.[_0xfe78c3(0x1ef)]()?.[_0xfe78c3(0x20e)],_0x40aa59=path[_0xfe78c3(0x1e1)](_0x5c457e,_0x1fb1fc);if(!fs[_0xfe78c3(0x205)](_0x40aa59))return;const _0x5e25d5={};_0x5e25d5[_0xfe78c3(0x1dc)]=!![],_0x5e25d5[_0xfe78c3(0x1df)]=!![],fs[_0xfe78c3(0x1d8)](_0x40aa59,_0x5e25d5),this['logger'][_0xfe78c3(0x1cd)](util[_0xfe78c3(0x1e6)](_0x1af112['VhRRM']));}}module[a77_0x584aad(0x21e)]=uploadAttachmentsManager;