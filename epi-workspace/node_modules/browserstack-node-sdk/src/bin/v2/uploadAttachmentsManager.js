const a85_0x5da283=a85_0x2a3f;(function(_0x395d4d,_0x2e7a7a){const _0x4899b2=a85_0x2a3f,_0x36e31=_0x395d4d();while(!![]){try{const _0x4724a0=-parseInt(_0x4899b2(0x134))/0x1*(parseInt(_0x4899b2(0x138))/0x2)+-parseInt(_0x4899b2(0x171))/0x3+-parseInt(_0x4899b2(0x153))/0x4+parseInt(_0x4899b2(0x14e))/0x5*(parseInt(_0x4899b2(0x18f))/0x6)+parseInt(_0x4899b2(0x133))/0x7*(-parseInt(_0x4899b2(0x198))/0x8)+parseInt(_0x4899b2(0x175))/0x9*(-parseInt(_0x4899b2(0x162))/0xa)+parseInt(_0x4899b2(0x14b))/0xb;if(_0x4724a0===_0x2e7a7a)break;else _0x36e31['push'](_0x36e31['shift']());}catch(_0x1771ef){_0x36e31['push'](_0x36e31['shift']());}}}(a85_0x23c3,0x8ee3d));function a85_0x2a3f(_0xe73742,_0x2dd916){const _0x23c35f=a85_0x23c3();return a85_0x2a3f=function(_0x2a3f86,_0x17c326){_0x2a3f86=_0x2a3f86-0x132;let _0xab3b17=_0x23c35f[_0x2a3f86];return _0xab3b17;},a85_0x2a3f(_0xe73742,_0x2dd916);}function a85_0x23c3(){const _0x5c9876=['unlinkSync','ndmja','statusCode','message','pipe','statSync','modules','hFRVw','.browserstack','__workerDetails','rmSync','trim','copyFileSync','basename','currentTest','LeIOu','27688287vGRiAc','uploadAttachmentsManager','debug','25EhIJSr','size','MTkhJ','CuikJ','recursive','2943128LkhDLH','./framework/constants/testFrameworkConstants','Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload','tUFha','join','TestHubModule','hnbKt','clUZi','NOABN','inOcm','path','getTrackedInstance','finish','Created\x20folder:\x20%s','AzHcc','849190Daierf','setTestDetails','./browserstackCLI','File\x20downloaded\x20to:\x20%s','startsWith','KEY_FILE_NAME','No\x20attachment\x20folder\x20found\x20for\x20testhubID:\x20%s','testhubConfig','UTckv','YrqzB','WZmgd','toObject','toFixed','trackFile','katJG','3068760vdBpax','naVmp','BYfNH','KBtYd','9mhbtpM','format','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','Attachment\x20recevied\x20for\x20path:\x20%s','uaYMe','wPIZD','KEY_FILE_PATH','https://','zDWRk','KEY_FILE_LEVEL','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','lotCb','BuildLevel','uploadAttachments','close','KEY_TEST_ATTACHMENTS','./modules/playwrightDriverModule','Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.','RPjJq','JYAaG','ghjEV','error','buildHashedId','bmTjw','http://','logger','1176906yocAmG','http','./framework/automationFramework','retry','homedir','ibgCt','getTestIdentifierFromTestInfo','getInstance','fnoMy','1989528gTUzkX','./TestInfo','testInfo','VYHto','TestLevel','qHfqt','RjqJN','jfkZs','28JKkqlD','14842osvnPG','wGbvv','mkdirSync','Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.','10eAXmhB','existsSync','getState'];a85_0x23c3=function(){return _0x5c9876;};return a85_0x23c3();}const os=require('os'),fs=require('fs'),path=require(a85_0x5da283(0x15d)),util=require('util'),BrowserstackCLI=require(a85_0x5da283(0x164)),https=require('https'),http=require(a85_0x5da283(0x190)),AutomationFramework=require(a85_0x5da283(0x191)),PlaywrightDriverModule=require(a85_0x5da283(0x185)),TestInfo=require(a85_0x5da283(0x199)),TestFrameworkConstants=require(a85_0x5da283(0x154)),{createClassLogger}=require('../../helpers/classLogger.js');class uploadAttachmentsManager{static [a85_0x5da283(0x18e)]=createClassLogger(a85_0x5da283(0x14c));static[a85_0x5da283(0x182)](_0x340780,_0x499efa=![]){const _0x31f740=a85_0x5da283,_0x2595dc={};_0x2595dc[_0x31f740(0x135)]=function(_0x3fd35a,_0x28d515){return _0x3fd35a/_0x28d515;},_0x2595dc[_0x31f740(0x15a)]=function(_0x45e8a1,_0x2d6476){return _0x45e8a1*_0x2d6476;},_0x2595dc[_0x31f740(0x159)]=function(_0x27669a,_0x34dc32){return _0x27669a>_0x34dc32;},_0x2595dc[_0x31f740(0x17d)]=_0x31f740(0x186),_0x2595dc[_0x31f740(0x172)]=_0x31f740(0x165),_0x2595dc[_0x31f740(0x19e)]=function(_0x32d6cc,_0x9c7651){return _0x32d6cc===_0x9c7651;},_0x2595dc['BYfNH']=_0x31f740(0x15f),_0x2595dc[_0x31f740(0x14a)]=_0x31f740(0x155),_0x2595dc[_0x31f740(0x17a)]=_0x31f740(0x17f),_0x2595dc[_0x31f740(0x151)]=_0x31f740(0x178),_0x2595dc[_0x31f740(0x197)]='.browserstack',_0x2595dc[_0x31f740(0x187)]='.browserstack\x20folder\x20not\x20found\x20at:\x20%s',_0x2595dc[_0x31f740(0x194)]='Created\x20.browserstack\x20folder\x20at:\x20%s',_0x2595dc['JYAaG']=_0x31f740(0x160),_0x2595dc[_0x31f740(0x174)]=function(_0x58afd6,_0x2e5993){return _0x58afd6===_0x2e5993;},_0x2595dc['qHfqt']=_0x31f740(0x137),_0x2595dc['YrqzB']=_0x31f740(0x17c),_0x2595dc[_0x31f740(0x15b)]=_0x31f740(0x18d),_0x2595dc[_0x31f740(0x16a)]=_0x31f740(0x18a),_0x2595dc[_0x31f740(0x18c)]='Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s',_0x2595dc[_0x31f740(0x142)]=function(_0x3a6c5a,_0x374da0){return _0x3a6c5a>_0x374da0;},_0x2595dc[_0x31f740(0x180)]=_0x31f740(0x177);const _0x551cd7=_0x2595dc;this['logger'][_0x31f740(0x14d)](util[_0x31f740(0x176)](_0x551cd7[_0x31f740(0x151)],_0x340780));const _0x3c205c=os[_0x31f740(0x193)](),_0x45874a=path[_0x31f740(0x157)](_0x3c205c,_0x551cd7[_0x31f740(0x197)]);!fs[_0x31f740(0x139)](_0x45874a)&&(this['logger'][_0x31f740(0x14d)](util['format'](_0x551cd7[_0x31f740(0x187)],_0x45874a)),fs[_0x31f740(0x136)](_0x45874a),this[_0x31f740(0x18e)][_0x31f740(0x14d)](util[_0x31f740(0x176)](_0x551cd7[_0x31f740(0x194)],_0x45874a)));const _0x36fe2c=BrowserstackCLI['getInstance']()['modules'][_0x31f740(0x158)]?.[_0x31f740(0x169)]?.[_0x31f740(0x16d)]()?.[_0x31f740(0x18b)],_0x4adc2f=path[_0x31f740(0x157)](_0x45874a,_0x36fe2c);!fs[_0x31f740(0x139)](_0x4adc2f)&&(fs[_0x31f740(0x136)](_0x4adc2f),this['logger'][_0x31f740(0x14d)](util[_0x31f740(0x176)](_0x551cd7[_0x31f740(0x188)],_0x4adc2f)));if(_0x551cd7[_0x31f740(0x174)](_0x340780[_0x31f740(0x146)](),'')){this[_0x31f740(0x18e)][_0x31f740(0x14d)](util[_0x31f740(0x176)](_0x551cd7[_0x31f740(0x19d)]));return;}if(_0x340780[_0x31f740(0x166)](_0x551cd7[_0x31f740(0x16b)])||_0x340780['startsWith'](_0x551cd7[_0x31f740(0x15b)])){const _0x3ccf48=_0x340780['startsWith'](_0x551cd7['YrqzB'])?https:http,_0x9645e8=path['basename'](_0x340780),_0x3775f4=path[_0x31f740(0x157)](_0x4adc2f,_0x9645e8),_0x2042d9=fs['createWriteStream'](_0x3775f4);_0x3ccf48['get'](_0x340780,_0x1698b5=>{const _0x53653d=_0x31f740,_0x561a57={'hRnPG':function(_0x46f87d,_0x21cba2){const _0x3982b6=a85_0x2a3f;return _0x551cd7[_0x3982b6(0x135)](_0x46f87d,_0x21cba2);},'tUFha':function(_0x30b6f8,_0xf5e93f){return _0x551cd7['clUZi'](_0x30b6f8,_0xf5e93f);},'ghjEV':function(_0x322ff2,_0x2f45b){const _0x487cb0=a85_0x2a3f;return _0x551cd7[_0x487cb0(0x159)](_0x322ff2,_0x2f45b);},'WZmgd':_0x551cd7[_0x53653d(0x17d)],'katJG':_0x551cd7[_0x53653d(0x172)]};if(_0x551cd7[_0x53653d(0x19e)](_0x1698b5[_0x53653d(0x13d)],0xc8))_0x1698b5[_0x53653d(0x13f)](_0x2042d9),_0x2042d9['on'](_0x551cd7[_0x53653d(0x173)],()=>{const _0x1db1ec=_0x53653d;_0x2042d9[_0x1db1ec(0x183)]();const _0x2e74a4=fs[_0x1db1ec(0x140)](_0x3775f4),_0x53b693=_0x561a57['hRnPG'](_0x2e74a4[_0x1db1ec(0x14f)],_0x561a57[_0x1db1ec(0x156)](0x400,0x400));if(_0x561a57[_0x1db1ec(0x189)](_0x53b693,0x64)){this['logger']['debug'](util[_0x1db1ec(0x176)](_0x561a57[_0x1db1ec(0x16c)],_0x53b693[_0x1db1ec(0x16e)](0x2))),fs['unlinkSync'](_0x3775f4);return;}this['logger'][_0x1db1ec(0x14d)](util[_0x1db1ec(0x176)](_0x561a57[_0x1db1ec(0x170)],_0x3775f4)),uploadAttachmentsManager['trackFile'](_0x3775f4,_0x499efa);});else{this['logger'][_0x53653d(0x14d)](util[_0x53653d(0x176)](_0x551cd7[_0x53653d(0x14a)],_0x1698b5[_0x53653d(0x13d)])),_0x2042d9[_0x53653d(0x183)](),fs[_0x53653d(0x13b)](_0x3775f4);return;}})['on'](_0x551cd7['UTckv'],_0x1a2f5d=>{const _0x333746=_0x31f740;this[_0x333746(0x18e)][_0x333746(0x14d)](util[_0x333746(0x176)](_0x551cd7[_0x333746(0x17a)],_0x1a2f5d[_0x333746(0x13e)])),_0x2042d9[_0x333746(0x183)](),fs[_0x333746(0x13b)](_0x3775f4);return;});}else{if(!fs[_0x31f740(0x139)](_0x340780)){this[_0x31f740(0x18e)]['debug'](util['format'](_0x551cd7[_0x31f740(0x18c)],_0x340780));return;}const _0x996173=fs['statSync'](_0x340780),_0xad176a=_0x551cd7[_0x31f740(0x135)](_0x996173[_0x31f740(0x14f)],_0x551cd7[_0x31f740(0x15a)](0x400,0x400));if(_0x551cd7['hFRVw'](_0xad176a,0x64)){this[_0x31f740(0x18e)][_0x31f740(0x14d)](util[_0x31f740(0x176)](_0x551cd7['lotCb'],_0xad176a[_0x31f740(0x16e)](0x2)));return;}const _0x46bc76=path[_0x31f740(0x148)](_0x340780),_0x2cc7b5=path['join'](_0x4adc2f,_0x46bc76);fs[_0x31f740(0x147)](_0x340780,_0x2cc7b5),uploadAttachmentsManager[_0x31f740(0x16f)](_0x2cc7b5,_0x499efa);}}static['trackFile'](_0x589745,_0x504ce7){const _0x44a626=a85_0x5da283,_0x26307a={};_0x26307a[_0x44a626(0x132)]=_0x44a626(0x181),_0x26307a[_0x44a626(0x13c)]=_0x44a626(0x19c),_0x26307a[_0x44a626(0x19b)]='Attachment\x20file\x20tracked\x20for\x20upload:\x20%s',_0x26307a['AzHcc']='Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload';const _0xc35b48=_0x26307a;try{let _0x137fa8;const _0x15c998=global[_0x44a626(0x144)]?.[_0x44a626(0x149)]?.[_0x44a626(0x19a)];if(!_0x15c998){const _0x31de97=AutomationFramework[_0x44a626(0x15e)]();_0x137fa8=AutomationFramework[_0x44a626(0x13a)](_0x31de97,PlaywrightDriverModule['KEY_TEST_ID'],'');}else _0x137fa8=TestInfo[_0x44a626(0x195)](_0x15c998,_0x15c998[_0x44a626(0x192)]);const _0x575f6e=TestInfo['getTestDetails'](_0x137fa8),_0x3a1a05=_0x575f6e[TestFrameworkConstants[_0x44a626(0x184)]]||{};_0x3a1a05[_0x589745]={[TestFrameworkConstants['KEY_FILE_SIZE']]:fs['statSync'](_0x589745)['size'],[TestFrameworkConstants[_0x44a626(0x167)]]:path['basename'](_0x589745),[TestFrameworkConstants[_0x44a626(0x17b)]]:_0x589745,[TestFrameworkConstants[_0x44a626(0x17e)]]:_0x504ce7?_0xc35b48[_0x44a626(0x132)]:_0xc35b48[_0x44a626(0x13c)]},_0x575f6e[TestFrameworkConstants[_0x44a626(0x184)]]=_0x3a1a05,TestInfo[_0x44a626(0x163)](_0x137fa8,_0x575f6e),this[_0x44a626(0x18e)][_0x44a626(0x14d)](util[_0x44a626(0x176)](_0xc35b48[_0x44a626(0x19b)],_0x589745));}catch(_0xe255bd){this[_0x44a626(0x18e)][_0x44a626(0x14d)](util[_0x44a626(0x176)](_0xc35b48[_0x44a626(0x161)],_0xe255bd[_0x44a626(0x13e)]));}}static['clearAttachments'](){const _0x16ab34=a85_0x5da283,_0x2310f0={};_0x2310f0[_0x16ab34(0x179)]=_0x16ab34(0x143),_0x2310f0[_0x16ab34(0x15c)]=_0x16ab34(0x168),_0x2310f0[_0x16ab34(0x150)]='Cleared\x20attachment\x20folder';const _0x963dd2=_0x2310f0,_0x723494=os[_0x16ab34(0x193)](),_0x303228=path[_0x16ab34(0x157)](_0x723494,_0x963dd2['uaYMe']);if(!fs[_0x16ab34(0x139)](_0x303228))return;const _0x3a9c30=BrowserstackCLI[_0x16ab34(0x196)]()[_0x16ab34(0x141)][_0x16ab34(0x158)]?.[_0x16ab34(0x169)]?.['toObject']()?.['buildHashedId'],_0x2bbcf2=_0x3a9c30?path[_0x16ab34(0x157)](_0x303228,_0x3a9c30):null;if(!_0x2bbcf2||!fs[_0x16ab34(0x139)](_0x2bbcf2)){this['logger'][_0x16ab34(0x14d)](util[_0x16ab34(0x176)](_0x963dd2['inOcm'],_0x3a9c30));return;}const _0x5dd1d5={};_0x5dd1d5[_0x16ab34(0x152)]=!![],_0x5dd1d5['force']=!![],fs[_0x16ab34(0x145)](_0x2bbcf2,_0x5dd1d5),this[_0x16ab34(0x18e)][_0x16ab34(0x14d)](util[_0x16ab34(0x176)](_0x963dd2[_0x16ab34(0x150)]));}}module['exports']=uploadAttachmentsManager;