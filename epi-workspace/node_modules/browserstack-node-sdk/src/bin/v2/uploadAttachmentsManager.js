const a87_0x443eb2=a87_0x581a;(function(_0xba1320,_0x262393){const _0x6e6509=a87_0x581a,_0x20a5cf=_0xba1320();while(!![]){try{const _0x22c52e=-parseInt(_0x6e6509(0x15c))/0x1+-parseInt(_0x6e6509(0x118))/0x2+-parseInt(_0x6e6509(0x15a))/0x3*(-parseInt(_0x6e6509(0x11b))/0x4)+-parseInt(_0x6e6509(0x134))/0x5*(-parseInt(_0x6e6509(0x149))/0x6)+parseInt(_0x6e6509(0x116))/0x7+parseInt(_0x6e6509(0x147))/0x8+-parseInt(_0x6e6509(0x154))/0x9*(parseInt(_0x6e6509(0x12c))/0xa);if(_0x22c52e===_0x262393)break;else _0x20a5cf['push'](_0x20a5cf['shift']());}catch(_0xfad7f5){_0x20a5cf['push'](_0x20a5cf['shift']());}}}(a87_0x172e,0x589eb));function a87_0x581a(_0x2ed13c,_0x250d26){const _0x172e76=a87_0x172e();return a87_0x581a=function(_0x581ab8,_0x463702){_0x581ab8=_0x581ab8-0xfe;let _0x5e1033=_0x172e76[_0x581ab8];return _0x5e1033;},a87_0x581a(_0x2ed13c,_0x250d26);}const os=require('os'),fs=require('fs'),path=require(a87_0x443eb2(0x137)),util=require(a87_0x443eb2(0x159)),BrowserstackCLI=require(a87_0x443eb2(0x114)),https=require(a87_0x443eb2(0x13e)),http=require(a87_0x443eb2(0x10e)),AutomationFramework=require('./framework/automationFramework'),PlaywrightDriverModule=require(a87_0x443eb2(0x163)),TestInfo=require(a87_0x443eb2(0xff)),TestFrameworkConstants=require('./framework/constants/testFrameworkConstants'),{createClassLogger}=require(a87_0x443eb2(0x10f));class uploadAttachmentsManager{static [a87_0x443eb2(0x11a)]=createClassLogger('uploadAttachmentsManager');static[a87_0x443eb2(0x152)](_0x1ebdff,_0x1ee122=![]){const _0x197ea5=a87_0x443eb2,_0x4832d5={};_0x4832d5['aRiWV']=function(_0x185b32,_0x479305){return _0x185b32/_0x479305;},_0x4832d5[_0x197ea5(0x13a)]=function(_0x9184e6,_0x3b2cbb){return _0x9184e6*_0x3b2cbb;},_0x4832d5[_0x197ea5(0x164)]=function(_0x251d36,_0x1bf31e){return _0x251d36>_0x1bf31e;},_0x4832d5[_0x197ea5(0x117)]='Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.',_0x4832d5[_0x197ea5(0x158)]=_0x197ea5(0x138),_0x4832d5['hCNQu']=function(_0x2ff5de,_0x387a48){return _0x2ff5de===_0x387a48;},_0x4832d5[_0x197ea5(0x141)]=_0x197ea5(0x15f),_0x4832d5[_0x197ea5(0x145)]=_0x197ea5(0x15e),_0x4832d5[_0x197ea5(0x14d)]=_0x197ea5(0x12b),_0x4832d5[_0x197ea5(0x11c)]=_0x197ea5(0x166),_0x4832d5[_0x197ea5(0x13f)]=_0x197ea5(0x14e),_0x4832d5[_0x197ea5(0x162)]=_0x197ea5(0x139),_0x4832d5[_0x197ea5(0x14c)]=_0x197ea5(0x124),_0x4832d5[_0x197ea5(0x133)]=_0x197ea5(0x132),_0x4832d5[_0x197ea5(0x11d)]=function(_0x3e0261,_0x25db0a){return _0x3e0261===_0x25db0a;},_0x4832d5[_0x197ea5(0x156)]=_0x197ea5(0x103),_0x4832d5[_0x197ea5(0x129)]=_0x197ea5(0x12f),_0x4832d5[_0x197ea5(0x125)]='http://',_0x4832d5[_0x197ea5(0x165)]='error',_0x4832d5[_0x197ea5(0x160)]=_0x197ea5(0x10b),_0x4832d5[_0x197ea5(0xfe)]=_0x197ea5(0x144);const _0x2174c5=_0x4832d5;this[_0x197ea5(0x11a)][_0x197ea5(0x127)](util[_0x197ea5(0x13b)](_0x2174c5['yTKJv'],_0x1ebdff));const _0x5e39f6=os['homedir'](),_0x2a9492=path[_0x197ea5(0x135)](_0x5e39f6,_0x2174c5[_0x197ea5(0x13f)]);!fs[_0x197ea5(0x112)](_0x2a9492)&&(this[_0x197ea5(0x11a)][_0x197ea5(0x127)](util[_0x197ea5(0x13b)](_0x2174c5[_0x197ea5(0x162)],_0x2a9492)),fs['mkdirSync'](_0x2a9492),this[_0x197ea5(0x11a)]['debug'](util[_0x197ea5(0x13b)](_0x2174c5['ftyuc'],_0x2a9492)));const _0x42d138=BrowserstackCLI['getInstance']()['modules'][_0x197ea5(0x167)]?.['testhubConfig']?.[_0x197ea5(0x110)]()?.[_0x197ea5(0x108)],_0x102632=path[_0x197ea5(0x135)](_0x2a9492,_0x42d138);!fs[_0x197ea5(0x112)](_0x102632)&&(fs[_0x197ea5(0x128)](_0x102632),this[_0x197ea5(0x11a)][_0x197ea5(0x127)](util[_0x197ea5(0x13b)](_0x2174c5[_0x197ea5(0x133)],_0x102632)));if(_0x2174c5[_0x197ea5(0x11d)](_0x1ebdff[_0x197ea5(0x150)](),'')){this[_0x197ea5(0x11a)][_0x197ea5(0x127)](util['format'](_0x2174c5['BUDzR']));return;}if(_0x1ebdff['startsWith'](_0x2174c5[_0x197ea5(0x129)])||_0x1ebdff[_0x197ea5(0x122)](_0x2174c5[_0x197ea5(0x125)])){const _0x54e260=_0x1ebdff[_0x197ea5(0x122)](_0x2174c5[_0x197ea5(0x129)])?https:http,_0x261e77=path[_0x197ea5(0x120)](_0x1ebdff),_0x292247=path[_0x197ea5(0x135)](_0x102632,_0x261e77),_0x32bfb3=fs[_0x197ea5(0x100)](_0x292247);_0x54e260['get'](_0x1ebdff,_0x2deafd=>{const _0x2846ae=_0x197ea5,_0xbbc1c3={'cxNkI':function(_0x5443dc,_0x2484e9){const _0x13ff24=a87_0x581a;return _0x2174c5[_0x13ff24(0x15d)](_0x5443dc,_0x2484e9);},'ONrfZ':function(_0x1c1d90,_0x4e4d6b){const _0x4ebc3e=a87_0x581a;return _0x2174c5[_0x4ebc3e(0x13a)](_0x1c1d90,_0x4e4d6b);},'gwvda':function(_0x5c8d7d,_0xbf6f6e){const _0x55eee1=a87_0x581a;return _0x2174c5[_0x55eee1(0x164)](_0x5c8d7d,_0xbf6f6e);},'DLIDk':_0x2174c5[_0x2846ae(0x117)],'fSEFU':_0x2174c5['uCBfJ']};if(_0x2174c5[_0x2846ae(0x111)](_0x2deafd[_0x2846ae(0x11e)],0xc8))_0x2deafd[_0x2846ae(0x11f)](_0x32bfb3),_0x32bfb3['on'](_0x2174c5['UozzN'],()=>{const _0x43e21d=_0x2846ae;_0x32bfb3[_0x43e21d(0x105)]();const _0x5c3b19=fs[_0x43e21d(0x121)](_0x292247),_0x32f1d4=_0xbbc1c3[_0x43e21d(0x126)](_0x5c3b19['size'],_0xbbc1c3['ONrfZ'](0x400,0x400));if(_0xbbc1c3[_0x43e21d(0x142)](_0x32f1d4,0x64)){this[_0x43e21d(0x11a)][_0x43e21d(0x127)](util[_0x43e21d(0x13b)](_0xbbc1c3[_0x43e21d(0x131)],_0x32f1d4[_0x43e21d(0x13d)](0x2))),fs[_0x43e21d(0x130)](_0x292247);return;}this[_0x43e21d(0x11a)][_0x43e21d(0x127)](util[_0x43e21d(0x13b)](_0xbbc1c3[_0x43e21d(0x14f)],_0x292247)),uploadAttachmentsManager[_0x43e21d(0x15b)](_0x292247,_0x1ee122);});else{this[_0x2846ae(0x11a)][_0x2846ae(0x127)](util['format'](_0x2174c5[_0x2846ae(0x145)],_0x2deafd[_0x2846ae(0x11e)])),_0x32bfb3['close'](),fs[_0x2846ae(0x130)](_0x292247);return;}})['on'](_0x2174c5['doWAj'],_0xa894d=>{const _0x294d47=_0x197ea5;this[_0x294d47(0x11a)][_0x294d47(0x127)](util[_0x294d47(0x13b)](_0x2174c5['uWpcb'],_0xa894d[_0x294d47(0x12e)])),_0x32bfb3[_0x294d47(0x105)](),fs[_0x294d47(0x130)](_0x292247);return;});}else{if(!fs[_0x197ea5(0x112)](_0x1ebdff)){this[_0x197ea5(0x11a)][_0x197ea5(0x127)](util[_0x197ea5(0x13b)](_0x2174c5[_0x197ea5(0x160)],_0x1ebdff));return;}const _0x37a511=fs[_0x197ea5(0x121)](_0x1ebdff),_0x5e5039=_0x2174c5[_0x197ea5(0x15d)](_0x37a511[_0x197ea5(0x161)],_0x2174c5[_0x197ea5(0x13a)](0x400,0x400));if(_0x2174c5['kGzyL'](_0x5e5039,0x64)){this[_0x197ea5(0x11a)][_0x197ea5(0x127)](util[_0x197ea5(0x13b)](_0x2174c5[_0x197ea5(0xfe)],_0x5e5039[_0x197ea5(0x13d)](0x2)));return;}const _0x2b6619=path[_0x197ea5(0x120)](_0x1ebdff),_0x2bc5a4=path[_0x197ea5(0x135)](_0x102632,_0x2b6619);fs[_0x197ea5(0x155)](_0x1ebdff,_0x2bc5a4),uploadAttachmentsManager[_0x197ea5(0x15b)](_0x2bc5a4,_0x1ee122);}}static['trackFile'](_0x1abbe3,_0x2ec913){const _0x1ed07b=a87_0x443eb2,_0xb84dc5={};_0xb84dc5[_0x1ed07b(0x101)]=_0x1ed07b(0x136),_0xb84dc5['PQoyO']=_0x1ed07b(0x151),_0xb84dc5[_0x1ed07b(0x115)]='Attachment\x20file\x20tracked\x20for\x20upload:\x20%s',_0xb84dc5['YHnsI']=_0x1ed07b(0x113);const _0x17202a=_0xb84dc5;try{let _0x2f28f6;const _0x2206e7=global['__workerDetails']?.[_0x1ed07b(0x153)]?.['testInfo'];if(!_0x2206e7){const _0xa9f8fe=AutomationFramework[_0x1ed07b(0x148)]();_0x2f28f6=AutomationFramework['getState'](_0xa9f8fe,PlaywrightDriverModule[_0x1ed07b(0x104)],'');}else _0x2f28f6=TestInfo[_0x1ed07b(0x14b)](_0x2206e7,_0x2206e7[_0x1ed07b(0x109)]);const _0x17b985=TestInfo[_0x1ed07b(0x12a)](_0x2f28f6),_0x428216=_0x17b985[TestFrameworkConstants[_0x1ed07b(0x157)]]||{};_0x428216[_0x1abbe3]={[TestFrameworkConstants[_0x1ed07b(0x10d)]]:fs['statSync'](_0x1abbe3)[_0x1ed07b(0x161)],[TestFrameworkConstants[_0x1ed07b(0x123)]]:path['basename'](_0x1abbe3),[TestFrameworkConstants[_0x1ed07b(0x146)]]:_0x1abbe3,[TestFrameworkConstants['KEY_FILE_LEVEL']]:_0x2ec913?_0x17202a[_0x1ed07b(0x101)]:_0x17202a[_0x1ed07b(0x140)]},_0x17b985[TestFrameworkConstants[_0x1ed07b(0x157)]]=_0x428216,TestInfo[_0x1ed07b(0x102)](_0x2f28f6,_0x17b985),this[_0x1ed07b(0x11a)][_0x1ed07b(0x127)](util[_0x1ed07b(0x13b)](_0x17202a[_0x1ed07b(0x115)],_0x1abbe3));}catch(_0x3c3b9a){this[_0x1ed07b(0x11a)]['debug'](util[_0x1ed07b(0x13b)](_0x17202a['YHnsI'],_0x3c3b9a[_0x1ed07b(0x12e)]));}}static['clearAttachments'](){const _0x16cf31=a87_0x443eb2,_0x5ea35b={};_0x5ea35b[_0x16cf31(0x143)]='.browserstack',_0x5ea35b['niNKy']=_0x16cf31(0x119),_0x5ea35b[_0x16cf31(0x106)]='Cleared\x20attachment\x20folder';const _0x504ad9=_0x5ea35b,_0x230e5d=os[_0x16cf31(0x12d)](),_0x5a78cd=path[_0x16cf31(0x135)](_0x230e5d,_0x504ad9[_0x16cf31(0x143)]);if(!fs[_0x16cf31(0x112)](_0x5a78cd))return;const _0x47ee02=BrowserstackCLI['getInstance']()[_0x16cf31(0x10c)][_0x16cf31(0x167)]?.[_0x16cf31(0x107)]?.[_0x16cf31(0x110)]()?.['buildHashedId'],_0x26dad2=_0x47ee02?path[_0x16cf31(0x135)](_0x5a78cd,_0x47ee02):null;if(!_0x26dad2||!fs[_0x16cf31(0x112)](_0x26dad2)){this['logger'][_0x16cf31(0x127)](util[_0x16cf31(0x13b)](_0x504ad9[_0x16cf31(0x14a)],_0x47ee02));return;}const _0x435677={};_0x435677['recursive']=!![],_0x435677[_0x16cf31(0x13c)]=!![],fs[_0x16cf31(0x10a)](_0x26dad2,_0x435677),this[_0x16cf31(0x11a)][_0x16cf31(0x127)](util[_0x16cf31(0x13b)](_0x504ad9[_0x16cf31(0x106)]));}}function a87_0x172e(){const _0x7632e1=['unlinkSync','DLIDk','Created\x20folder:\x20%s','QEVfT','3312215aKycnp','join','BuildLevel','path','File\x20downloaded\x20to:\x20%s','.browserstack\x20folder\x20not\x20found\x20at:\x20%s','rtBGB','format','force','toFixed','https','ihFLs','PQoyO','UozzN','gwvda','Stqzm','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','CQWsa','KEY_FILE_PATH','1559320NgYMUJ','getTrackedInstance','6mLqdgV','niNKy','getTestIdentifierFromTestInfo','ftyuc','uWpcb','.browserstack','fSEFU','trim','TestLevel','uploadAttachments','currentTest','1242036VDoGZp','copyFileSync','BUDzR','KEY_TEST_ATTACHMENTS','uCBfJ','util','3obpxxJ','trackFile','323973zKdpQI','aRiWV','Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload','finish','GZSxA','size','SurdI','./modules/playwrightDriverModule','kGzyL','doWAj','Attachment\x20recevied\x20for\x20path:\x20%s','TestHubModule','ngjCy','./TestInfo','createWriteStream','Xiqzl','setTestDetails','Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.','KEY_TEST_ID','close','yeaoT','testhubConfig','buildHashedId','retry','rmSync','Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s','modules','KEY_FILE_SIZE','http','../../helpers/classLogger.js','toObject','hCNQu','existsSync','Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload','./browserstackCLI','pbgQZ','3110695NQRnqL','aPyqU','1311416rgKnGO','No\x20attachment\x20folder\x20found\x20for\x20testhubID:\x20%s','logger','715716cFadqv','yTKJv','DoWdH','statusCode','pipe','basename','statSync','startsWith','KEY_FILE_NAME','Created\x20.browserstack\x20folder\x20at:\x20%s','TNIDT','cxNkI','debug','mkdirSync','mhQcJ','getTestDetails','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','10FONxYz','homedir','message','https://'];a87_0x172e=function(){return _0x7632e1;};return a87_0x172e();}module['exports']=uploadAttachmentsManager;