const a88_0x4417f1=a88_0x1792;(function(_0x286d24,_0x18c731){const _0x33a24b=a88_0x1792,_0x243af6=_0x286d24();while(!![]){try{const _0x58c1f9=parseInt(_0x33a24b(0x9d))/0x1*(parseInt(_0x33a24b(0x6d))/0x2)+-parseInt(_0x33a24b(0x7b))/0x3*(-parseInt(_0x33a24b(0x7f))/0x4)+parseInt(_0x33a24b(0xe4))/0x5+parseInt(_0x33a24b(0xa2))/0x6+parseInt(_0x33a24b(0x84))/0x7*(parseInt(_0x33a24b(0xa9))/0x8)+-parseInt(_0x33a24b(0xae))/0x9*(parseInt(_0x33a24b(0xda))/0xa)+-parseInt(_0x33a24b(0xe9))/0xb*(parseInt(_0x33a24b(0x78))/0xc);if(_0x58c1f9===_0x18c731)break;else _0x243af6['push'](_0x243af6['shift']());}catch(_0xf3cb66){_0x243af6['push'](_0x243af6['shift']());}}}(a88_0x3ed9,0x48e08));const os=require('os'),fs=require('fs'),path=require(a88_0x4417f1(0x71)),util=require(a88_0x4417f1(0x88)),BrowserstackCLI=require(a88_0x4417f1(0xa3)),https=require('https'),http=require(a88_0x4417f1(0xd1)),AutomationFramework=require(a88_0x4417f1(0xce)),PlaywrightDriverModule=require('./modules/playwrightDriverModule'),TestInfo=require(a88_0x4417f1(0xb5)),TestFrameworkConstants=require(a88_0x4417f1(0xdd)),{createClassLogger}=require(a88_0x4417f1(0xd8));function a88_0x1792(_0x464f74,_0xea966d){const _0x3ed9e4=a88_0x3ed9();return a88_0x1792=function(_0x179221,_0x438549){_0x179221=_0x179221-0x6b;let _0x509f14=_0x3ed9e4[_0x179221];return _0x509f14;},a88_0x1792(_0x464f74,_0xea966d);}class uploadAttachmentsManager{static ['logger']=createClassLogger(a88_0x4417f1(0x8b));static[a88_0x4417f1(0xe3)](_0x5846ea,_0x2c71fa=![]){const _0x8a5c30=a88_0x4417f1,_0x3075ca={};_0x3075ca['kCdSn']=function(_0x1d2a26,_0xee7fef){return _0x1d2a26/_0xee7fef;},_0x3075ca[_0x8a5c30(0xa6)]=function(_0x1faf58,_0x1d642a){return _0x1faf58*_0x1d642a;},_0x3075ca[_0x8a5c30(0xbf)]=function(_0x5b86d0,_0x59e356){return _0x5b86d0>_0x59e356;},_0x3075ca[_0x8a5c30(0xe6)]=_0x8a5c30(0xd3),_0x3075ca[_0x8a5c30(0xd5)]=_0x8a5c30(0x6b),_0x3075ca[_0x8a5c30(0xc8)]=function(_0x46e47c,_0x5000b5){return _0x46e47c===_0x5000b5;},_0x3075ca['xvZba']=_0x8a5c30(0x85),_0x3075ca[_0x8a5c30(0xb8)]=_0x8a5c30(0xe1),_0x3075ca[_0x8a5c30(0xdc)]=_0x8a5c30(0xef),_0x3075ca['cOBYG']=_0x8a5c30(0x74),_0x3075ca['yilwW']=_0x8a5c30(0x9c),_0x3075ca[_0x8a5c30(0x8c)]=_0x8a5c30(0xc6),_0x3075ca[_0x8a5c30(0xb6)]='Created\x20.browserstack\x20folder\x20at:\x20%s',_0x3075ca[_0x8a5c30(0xd6)]=_0x8a5c30(0x9f),_0x3075ca[_0x8a5c30(0xd2)]=_0x8a5c30(0x93),_0x3075ca[_0x8a5c30(0x9b)]=_0x8a5c30(0x86),_0x3075ca[_0x8a5c30(0xb4)]=_0x8a5c30(0x6c),_0x3075ca[_0x8a5c30(0x9a)]='error',_0x3075ca[_0x8a5c30(0xd7)]=_0x8a5c30(0x89),_0x3075ca['sUYoH']=function(_0x30e1f5,_0x49f0d7){return _0x30e1f5*_0x49f0d7;},_0x3075ca[_0x8a5c30(0x83)]=function(_0x2440de,_0x528f16){return _0x2440de>_0x528f16;},_0x3075ca[_0x8a5c30(0x7e)]=_0x8a5c30(0x7a);const _0x3ef5b1=_0x3075ca;this[_0x8a5c30(0x9e)][_0x8a5c30(0xc5)](util[_0x8a5c30(0xad)](_0x3ef5b1[_0x8a5c30(0x91)],_0x5846ea));const _0x3cc716=os[_0x8a5c30(0x76)](),_0x2280aa=path[_0x8a5c30(0x79)](_0x3cc716,_0x3ef5b1[_0x8a5c30(0xe0)]);!fs[_0x8a5c30(0x90)](_0x2280aa)&&(this[_0x8a5c30(0x9e)][_0x8a5c30(0xc5)](util[_0x8a5c30(0xad)](_0x3ef5b1[_0x8a5c30(0x8c)],_0x2280aa)),fs[_0x8a5c30(0xf6)](_0x2280aa),this[_0x8a5c30(0x9e)][_0x8a5c30(0xc5)](util['format'](_0x3ef5b1[_0x8a5c30(0xb6)],_0x2280aa)));const _0x660803=BrowserstackCLI['getInstance']()['modules']['TestHubModule']?.[_0x8a5c30(0xe7)]?.[_0x8a5c30(0xc7)]()?.[_0x8a5c30(0xf0)],_0x3247a7=path[_0x8a5c30(0x79)](_0x2280aa,_0x660803);!fs['existsSync'](_0x3247a7)&&(fs[_0x8a5c30(0xf6)](_0x3247a7),this[_0x8a5c30(0x9e)]['debug'](util[_0x8a5c30(0xad)](_0x3ef5b1[_0x8a5c30(0xd6)],_0x3247a7)));if(_0x3ef5b1[_0x8a5c30(0xc8)](_0x5846ea[_0x8a5c30(0x7c)](),'')){this[_0x8a5c30(0x9e)][_0x8a5c30(0xc5)](util[_0x8a5c30(0xad)](_0x3ef5b1['RAVke']));return;}if(_0x5846ea[_0x8a5c30(0xec)](_0x3ef5b1['PpRdW'])||_0x5846ea[_0x8a5c30(0xec)](_0x3ef5b1['HcCzQ'])){const _0x2d09af=_0x5846ea[_0x8a5c30(0xec)](_0x3ef5b1['PpRdW'])?https:http,_0x1d6fc5=path[_0x8a5c30(0xa0)](_0x5846ea),_0x567413=path['join'](_0x3247a7,_0x1d6fc5),_0x2f4883=fs[_0x8a5c30(0xc1)](_0x567413);_0x2d09af['get'](_0x5846ea,_0x1898d1=>{const _0x341932=_0x8a5c30;if(_0x3ef5b1['aPsim'](_0x1898d1[_0x341932(0xbd)],0xc8))_0x1898d1[_0x341932(0xc2)](_0x2f4883),_0x2f4883['on'](_0x3ef5b1[_0x341932(0xc9)],()=>{const _0x3d1ac9=_0x341932;_0x2f4883[_0x3d1ac9(0xe5)]();const _0x3fdf22=fs[_0x3d1ac9(0xf1)](_0x567413),_0x2de303=_0x3ef5b1[_0x3d1ac9(0xcc)](_0x3fdf22[_0x3d1ac9(0xcd)],_0x3ef5b1['aPgBh'](0x400,0x400));if(_0x3ef5b1['LvsMZ'](_0x2de303,0x64)){this['logger'][_0x3d1ac9(0xc5)](util[_0x3d1ac9(0xad)](_0x3ef5b1[_0x3d1ac9(0xe6)],_0x2de303[_0x3d1ac9(0x7d)](0x2))),fs[_0x3d1ac9(0xb3)](_0x567413);return;}this[_0x3d1ac9(0x9e)][_0x3d1ac9(0xc5)](util[_0x3d1ac9(0xad)](_0x3ef5b1[_0x3d1ac9(0xd5)],_0x567413)),uploadAttachmentsManager['trackFile'](_0x567413,_0x2c71fa);});else{this[_0x341932(0x9e)]['debug'](util[_0x341932(0xad)](_0x3ef5b1[_0x341932(0xb8)],_0x1898d1['statusCode'])),_0x2f4883[_0x341932(0xe5)](),fs['unlinkSync'](_0x567413);return;}})['on'](_0x3ef5b1[_0x8a5c30(0x9a)],_0x2a7820=>{const _0x3e982e=_0x8a5c30;this['logger']['debug'](util[_0x3e982e(0xad)](_0x3ef5b1[_0x3e982e(0xdc)],_0x2a7820[_0x3e982e(0x75)])),_0x2f4883[_0x3e982e(0xe5)](),fs[_0x3e982e(0xb3)](_0x567413);return;});}else{if(!fs[_0x8a5c30(0x90)](_0x5846ea)){this[_0x8a5c30(0x9e)][_0x8a5c30(0xc5)](util[_0x8a5c30(0xad)](_0x3ef5b1['PUDGQ'],_0x5846ea));return;}const _0x5542fa=fs[_0x8a5c30(0xf1)](_0x5846ea),_0x467594=_0x3ef5b1[_0x8a5c30(0xcc)](_0x5542fa['size'],_0x3ef5b1[_0x8a5c30(0xd4)](0x400,0x400));if(_0x3ef5b1[_0x8a5c30(0x83)](_0x467594,0x64)){this['logger']['debug'](util[_0x8a5c30(0xad)](_0x3ef5b1[_0x8a5c30(0x7e)],_0x467594['toFixed'](0x2)));return;}const _0x2a6554=path[_0x8a5c30(0xa0)](_0x5846ea),_0x11dcc1=path[_0x8a5c30(0x79)](_0x3247a7,_0x2a6554);fs[_0x8a5c30(0x6f)](_0x5846ea,_0x11dcc1),uploadAttachmentsManager[_0x8a5c30(0xed)](_0x11dcc1,_0x2c71fa);}}static['trackFile'](_0x34ff30,_0x3cf322){const _0x39b66a=a88_0x4417f1,_0x4dffec={'sOIoV':function(_0x5bf5df,_0x20aa28){return _0x5bf5df(_0x20aa28);},'qKZyM':_0x39b66a(0xa3),'ZMAYS':function(_0x5c467f,_0x1d6384){return _0x5c467f(_0x1d6384);},'dIjav':_0x39b66a(0xb1),'NpUMv':function(_0x5cebda,_0x151170){return _0x5cebda===_0x151170;},'aLxhM':_0x39b66a(0x80),'LIMbF':_0x39b66a(0x97),'Mfypl':_0x39b66a(0x87),'abixm':_0x39b66a(0xaa),'LoVPV':_0x39b66a(0x81),'FjuGG':_0x39b66a(0xb2),'ZgivY':_0x39b66a(0xeb),'rlAMo':_0x39b66a(0xaf),'abPSA':_0x39b66a(0xe8),'ZvFTF':'Error\x20tracking\x20file:\x20%s,\x20skipping\x20upload'};try{let _0x357a63;const _0x23efd6=global[_0x39b66a(0x94)]?.[_0x39b66a(0xf5)]?.['testInfo'],_0x3dd150=_0x4dffec[_0x39b66a(0xcb)](require,_0x4dffec[_0x39b66a(0x95)]),_0x3b84e6=_0x4dffec['ZMAYS'](require,_0x4dffec[_0x39b66a(0xab)]),_0x57e612=_0x3dd150['getInstance']()[_0x39b66a(0x82)]()&&_0x4dffec[_0x39b66a(0xba)](_0x3b84e6[_0x39b66a(0xb0)]()?.[_0x39b66a(0x8d)]?.[_0x39b66a(0xc3)](),_0x4dffec[_0x39b66a(0x70)]);if(_0x57e612){_0x357a63=global[_0x39b66a(0x96)];if(!_0x357a63){const _0x24a65a=AutomationFramework[_0x39b66a(0xe2)]();_0x357a63=AutomationFramework[_0x39b66a(0x6e)](_0x24a65a,PlaywrightDriverModule['KEY_TEST_ID'],'');}this[_0x39b66a(0x9e)]['debug']('trackFile:\x20Jest+Playwright\x20-\x20testId\x20(testIdentifier):\x20'+_0x357a63);}else{if(!_0x23efd6){const _0x271731=AutomationFramework[_0x39b66a(0xe2)]();_0x357a63=AutomationFramework[_0x39b66a(0x6e)](_0x271731,PlaywrightDriverModule[_0x39b66a(0x77)],'');}else _0x357a63=TestInfo['getTestIdentifierFromTestInfo'](_0x23efd6,_0x23efd6['retry']);this[_0x39b66a(0x9e)][_0x39b66a(0xc5)](_0x39b66a(0xcf)+_0x357a63);}if(!_0x357a63){this['logger'][_0x39b66a(0xc5)](_0x4dffec[_0x39b66a(0xf4)]);return;}const _0x3ca99e={[TestFrameworkConstants['KEY_FILE_SIZE']]:fs[_0x39b66a(0xf1)](_0x34ff30)[_0x39b66a(0xcd)],[TestFrameworkConstants[_0x39b66a(0xa5)]]:path[_0x39b66a(0xa0)](_0x34ff30),[TestFrameworkConstants[_0x39b66a(0xdf)]]:_0x34ff30,[TestFrameworkConstants[_0x39b66a(0xde)]]:_0x3cf322?_0x4dffec[_0x39b66a(0xf2)]:_0x4dffec[_0x39b66a(0x92)]};if(_0x57e612){const _0x398b50=_0x3dd150[_0x39b66a(0x72)]()['getTestFramework']();if(!_0x398b50){this[_0x39b66a(0x9e)][_0x39b66a(0xc5)](_0x4dffec[_0x39b66a(0xa1)]);return;}const _0x3bc6ba=_0x4dffec[_0x39b66a(0x8a)](require,_0x4dffec[_0x39b66a(0x73)]),_0x457651=_0x4dffec['sOIoV'](require,_0x4dffec[_0x39b66a(0x8f)]),_0x2b50d1=_0x398b50['resolveInstance'](_0x3bc6ba[_0x39b66a(0xac)],_0x457651[_0x39b66a(0xbb)]);if(!_0x2b50d1){this[_0x39b66a(0x9e)][_0x39b66a(0xc5)](_0x4dffec[_0x39b66a(0xca)]);return;}const _0x4dacc7=_0x2b50d1[_0x39b66a(0x8e)]()[_0x39b66a(0xc0)](_0x357a63)||{},_0x1643c2=_0x4dacc7[TestFrameworkConstants[_0x39b66a(0xf3)]]||{},_0x1ee13d={..._0x1643c2};_0x1ee13d[_0x34ff30]=_0x3ca99e;const _0x565699=_0x1ee13d,_0x8f70ca={[TestFrameworkConstants[_0x39b66a(0xf3)]]:_0x565699},_0x51f42f={};_0x51f42f[_0x357a63]=_0x8f70ca,_0x2b50d1[_0x39b66a(0xd0)](_0x51f42f),this[_0x39b66a(0x9e)]['debug'](_0x39b66a(0xbc)+_0x357a63+_0x39b66a(0xee)+_0x34ff30);}else{const _0x3ec20d=TestInfo['getTestDetails'](_0x357a63),_0x3d847d=_0x3ec20d[TestFrameworkConstants[_0x39b66a(0xf3)]]||{};_0x3d847d[_0x34ff30]=_0x3ca99e,_0x3ec20d[TestFrameworkConstants[_0x39b66a(0xf3)]]=_0x3d847d,TestInfo[_0x39b66a(0xa7)](_0x357a63,_0x3ec20d),this[_0x39b66a(0x9e)]['debug'](_0x39b66a(0xb7)+_0x357a63+_0x39b66a(0xee)+_0x34ff30);}this[_0x39b66a(0x9e)]['debug'](util[_0x39b66a(0xad)](_0x4dffec[_0x39b66a(0xd9)],_0x34ff30));}catch(_0xd91cb5){this[_0x39b66a(0x9e)][_0x39b66a(0xc5)](util['format'](_0x4dffec[_0x39b66a(0xc4)],_0xd91cb5['message']));}}static['clearAttachments'](){const _0x3590d1=a88_0x4417f1,_0x22c0b7={};_0x22c0b7[_0x3590d1(0xdb)]='.browserstack',_0x22c0b7['grZAE']=_0x3590d1(0x98),_0x22c0b7['Alfrc']=_0x3590d1(0xf7);const _0x4f1681=_0x22c0b7,_0x381de0=os['homedir'](),_0x19909f=path[_0x3590d1(0x79)](_0x381de0,_0x4f1681[_0x3590d1(0xdb)]);if(!fs[_0x3590d1(0x90)](_0x19909f))return;const _0x31cf93=BrowserstackCLI[_0x3590d1(0x72)]()['modules'][_0x3590d1(0xa8)]?.[_0x3590d1(0xe7)]?.[_0x3590d1(0xc7)]()?.['buildHashedId'],_0x3bb605=_0x31cf93?path[_0x3590d1(0x79)](_0x19909f,_0x31cf93):null;if(!_0x3bb605||!fs[_0x3590d1(0x90)](_0x3bb605)){this['logger'][_0x3590d1(0xc5)](util[_0x3590d1(0xad)](_0x4f1681[_0x3590d1(0xbe)],_0x31cf93));return;}const _0x1c21bf={};_0x1c21bf[_0x3590d1(0xea)]=!![],_0x1c21bf[_0x3590d1(0xa4)]=!![],fs[_0x3590d1(0x99)](_0x3bb605,_0x1c21bf),this[_0x3590d1(0x9e)][_0x3590d1(0xc5)](util[_0x3590d1(0xad)](_0x4f1681[_0x3590d1(0xb9)]));}}function a88_0x3ed9(){const _0xfa6a9f=['yilwW','Failed\x20to\x20download\x20file.\x20Status\x20code:\x20%s,\x20skipping\x20upload','getTrackedInstance','uploadAttachments','1240185fIjEsQ','close','yYekl','testhubConfig','Attachment\x20file\x20tracked\x20for\x20upload:\x20%s','1430cgnTJX','recursive','./state/hookState','startsWith','trackFile',',\x20filepath:\x20','Error\x20downloading\x20file:\x20%s,\x20skipping\x20upload','buildHashedId','statSync','Mfypl','KEY_TEST_ATTACHMENTS','LIMbF','currentTest','mkdirSync','Cleared\x20attachment\x20folder','File\x20downloaded\x20to:\x20%s','http://','1178776PZPpQt','getState','copyFileSync','aLxhM','path','getInstance','FjuGG','Attachment\x20recevied\x20for\x20path:\x20%s','message','homedir','KEY_TEST_ID','107556lvSqvO','join','File\x20size\x20is\x20too\x20large\x20(%s\x20MB).\x20Skipping\x20upload.','311079pxdEih','trim','toFixed','ggNsQ','4rdrUaz','jest','trackFile:\x20TestFramework\x20not\x20available,\x20cannot\x20track\x20attachment','isRunning','EhPmy','21CqgGzd','finish','https://','BuildLevel','util','Attachment\x20file\x20does\x20not\x20exist\x20at:\x20%s','ZMAYS','uploadAttachmentsManager','bbNea','name','getAllData','ZgivY','existsSync','cOBYG','abixm','Attachment\x20file\x20path\x20is\x20empty,\x20skipping\x20upload.','__workerDetails','qKZyM','__jestCurrentTestIdentifier','trackFile:\x20No\x20testId\x20available,\x20cannot\x20track\x20attachment','No\x20attachment\x20folder\x20found\x20for\x20testhubID:\x20%s','rmSync','HgAfN','PpRdW','.browserstack','1gCcwGX','logger','Created\x20folder:\x20%s','basename','LoVPV','3416094iOehMX','./browserstackCLI','force','KEY_FILE_NAME','aPgBh','setTestDetails','TestHubModule','888912ZFpkRF','TestLevel','dIjav','TEST','format','27ictKMa','trackFile:\x20Instance\x20not\x20available,\x20cannot\x20track\x20attachment','getTestFrameworkDetail','./cliUtils','./state/testFrameworkState','unlinkSync','HcCzQ','./TestInfo','zuOmP','trackFile:\x20Stored\x20attachment\x20in\x20TestInfo\x20file\x20for\x20testId:\x20','nrWjN','Alfrc','NpUMv','POST','trackFile:\x20Stored\x20attachment\x20in\x20instance\x20memory\x20for\x20testId:\x20','statusCode','grZAE','LvsMZ','get','createWriteStream','pipe','toLowerCase','ZvFTF','debug','.browserstack\x20folder\x20not\x20found\x20at:\x20%s','toObject','aPsim','xvZba','rlAMo','sOIoV','kCdSn','size','./framework/automationFramework','trackFile:\x20Cucumber+Playwright\x20-\x20testId:\x20','addMultipleEntries','http','RAVke','Downloaded\x20file\x20is\x20too\x20large\x20(%s\x20MB).\x20Deleting\x20file\x20and\x20skipping\x20upload.','sUYoH','yGofh','FpzKP','PUDGQ','../../helpers/classLogger.js','abPSA','1267050biUmGU','Etcuk','fABxT','./framework/constants/testFrameworkConstants','KEY_FILE_LEVEL','KEY_FILE_PATH'];a88_0x3ed9=function(){return _0xfa6a9f;};return a88_0x3ed9();}module['exports']=uploadAttachmentsManager;