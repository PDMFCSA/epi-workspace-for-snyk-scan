const a85_0x5f138f=a85_0x4d41;(function(_0x3478cb,_0x36d1ae){const _0x4b575e=a85_0x4d41,_0x459ea4=_0x3478cb();while(!![]){try{const _0x15e4cf=parseInt(_0x4b575e(0xa7))/0x1+-parseInt(_0x4b575e(0x92))/0x2*(parseInt(_0x4b575e(0xb6))/0x3)+parseInt(_0x4b575e(0xce))/0x4*(-parseInt(_0x4b575e(0xa0))/0x5)+-parseInt(_0x4b575e(0xe1))/0x6*(parseInt(_0x4b575e(0x7d))/0x7)+parseInt(_0x4b575e(0x8e))/0x8+parseInt(_0x4b575e(0x82))/0x9+parseInt(_0x4b575e(0x85))/0xa;if(_0x15e4cf===_0x36d1ae)break;else _0x459ea4['push'](_0x459ea4['shift']());}catch(_0x5746fa){_0x459ea4['push'](_0x459ea4['shift']());}}}(a85_0x839b,0x4200c));function a85_0x4d41(_0x2a1821,_0x8bb206){const _0x839b61=a85_0x839b();return a85_0x4d41=function(_0x4d415a,_0x4e886c){_0x4d415a=_0x4d415a-0x7c;let _0x561073=_0x839b61[_0x4d415a];return _0x561073;},a85_0x4d41(_0x2a1821,_0x8bb206);}const util=require(a85_0x5f138f(0xa9)),BaseModule=require('./baseModule'),{createClassLogger}=require(a85_0x5f138f(0xd7)),AutomationFramework=require(a85_0x5f138f(0x9d)),AutomationFrameworkState=require('../state/automationFrameworkState.js'),HookState=require(a85_0x5f138f(0xbf)),TestFramework=require('../framework/testFramework.js'),TestFrameworkState=require(a85_0x5f138f(0xad)),PlaywrightDriverModule=require(a85_0x5f138f(0x80)),TestFrameworkConstants=require(a85_0x5f138f(0xc7)),GrpcClient=require(a85_0x5f138f(0x7e)),CLIUtils=require('../cliUtils.js'),TestInfo=require(a85_0x5f138f(0xb0)),testHubConstants=require(a85_0x5f138f(0xa8)),{FRAMEWORKS}=require('../../../helpers/test-observability/constants.js'),helper=require(a85_0x5f138f(0xdc)),LoadTestModule=require(a85_0x5f138f(0xde)),JestUtils=require(a85_0x5f138f(0x9c)),BrowserstackCLI=require('../browserstackCLI.js'),{getPlaywrightProvider}=require('../../../helpers/helper.js');class TestHubModule extends BaseModule{[a85_0x5f138f(0xb5)]=createClassLogger(a85_0x5f138f(0x9f));constructor(_0x2e505f,_0x4b2372=null){const _0x4ef9f4=a85_0x5f138f,_0x9b1af6={};_0x9b1af6[_0x4ef9f4(0xab)]=_0x4ef9f4(0xb2),_0x9b1af6['hYstd']=_0x4ef9f4(0x9f);const _0x42810f=_0x9b1af6,_0x2946aa=_0x42810f[_0x4ef9f4(0xab)][_0x4ef9f4(0xa4)]('|');let _0x2204b7=0x0;while(!![]){switch(_0x2946aa[_0x2204b7++]){case'0':this['jestUtils']=new JestUtils();continue;case'1':Object[_0x4ef9f4(0x7c)](TestFrameworkState)[_0x4ef9f4(0xba)](_0x57905e=>{const _0x411373=_0x4ef9f4;Object[_0x411373(0x7c)](HookState)[_0x411373(0xba)](_0xf23f3=>{const _0x3a9672=_0x411373;TestFramework['registerObserver'](_0x57905e,_0xf23f3,this[_0x3a9672(0x93)][_0x3a9672(0x98)](this));});});continue;case'2':process['env'][testHubConstants['ENV_VAR'][_0x4ef9f4(0xa3)]]=this[_0x4ef9f4(0xe2)][_0x4ef9f4(0x96)]();continue;case'3':super(_0x4b2372);continue;case'4':process['env'][testHubConstants[_0x4ef9f4(0xbb)][_0x4ef9f4(0x86)]]=this['testhubConfig'][_0x4ef9f4(0xc1)]();continue;case'5':BrowserstackCLI['O11yHashedID']=this[_0x4ef9f4(0xe2)][_0x4ef9f4(0x96)]();continue;case'6':this['testhubConfig']=_0x2e505f;continue;case'7':AutomationFramework[_0x4ef9f4(0x8a)](AutomationFrameworkState[_0x4ef9f4(0x8c)],HookState[_0x4ef9f4(0xcd)],this[_0x4ef9f4(0x99)][_0x4ef9f4(0x98)](this));continue;case'8':this[_0x4ef9f4(0xb9)]=_0x42810f[_0x4ef9f4(0xd5)];continue;}break;}}['getModuleName'](){const _0x4583a9=a85_0x5f138f;return TestHubModule[_0x4583a9(0xb8)];}[a85_0x5f138f(0x93)](_0x2771e6){const _0x5c4ed5=a85_0x5f138f,_0x24f838={};_0x24f838[_0x5c4ed5(0xa5)]=function(_0x3d5d13,_0x2c1ae6){return _0x3d5d13===_0x2c1ae6;};const _0x549a16=_0x24f838,_0x290c9d=_0x2771e6[_0x5c4ed5(0xbd)],_0x47fd3c=_0x290c9d[_0x5c4ed5(0x8b)]();(_0x549a16[_0x5c4ed5(0xa5)](_0x47fd3c,TestFrameworkState[_0x5c4ed5(0x9b)])||CLIUtils['matchHookRegex'](_0x47fd3c['toString']()[_0x5c4ed5(0xa4)]('.')[0x1]))&&this[_0x5c4ed5(0x91)](_0x2771e6);}async[a85_0x5f138f(0x91)](_0x48807d){const _0x1bfb16=a85_0x5f138f,_0x6b4865={};_0x6b4865[_0x1bfb16(0xca)]=function(_0x5d5023,_0x1f26aa){return _0x5d5023===_0x1f26aa;},_0x6b4865[_0x1bfb16(0xd8)]=_0x1bfb16(0xcf);const _0x52a429=_0x6b4865;try{const _0x15e13f=BrowserstackCLI[_0x1bfb16(0x84)]()['getTestFramework']()[_0x1bfb16(0xb4)](_0x48807d);if(!_0x15e13f||_0x52a429[_0x1bfb16(0xca)](Object['keys'](_0x15e13f)[_0x1bfb16(0xd2)],0x0)){this[_0x1bfb16(0xb5)][_0x1bfb16(0xc2)](_0x52a429[_0x1bfb16(0xd8)]);return;}const _0xc9367b=await GrpcClient['getInstance']()[_0x1bfb16(0x95)](_0x15e13f);this[_0x1bfb16(0xb5)]['debug'](_0x1bfb16(0xb1)+_0x15e13f[_0x1bfb16(0xc5)]+_0x1bfb16(0x83)+_0x15e13f['hookState']);}catch(_0x438b6c){this[_0x1bfb16(0xb5)]['error']('Error\x20in\x20sendTestFrameworkEvent:\x20'+util['format'](_0x438b6c));}}async['onPageCreate'](_0x5c0d33){const _0x44ad0d=a85_0x5f138f,_0x738c33={'kiKcQ':function(_0x5f57a7,_0x331767){return _0x5f57a7===_0x331767;},'WuxFp':'onPageCreate:\x20Skipping\x20CBT\x20session\x20event\x20-\x20no\x20testInfo\x20(page\x20created\x20outside\x20test\x20context)','ZNJOW':function(_0x575436,_0x2adc19){return _0x575436===_0x2adc19;},'bgIFD':function(_0x46acd9,_0x8ad9c2){return _0x46acd9===_0x8ad9c2;},'YjZSR':function(_0x35fef8,_0x52c058){return _0x35fef8(_0x52c058);},'AJIST':_0x44ad0d(0x87)};try{if(_0x5c0d33[_0x44ad0d(0xd3)]){const _0x24813c=this[_0x44ad0d(0xa6)](_0x5c0d33);this[_0x44ad0d(0xb5)][_0x44ad0d(0xc2)]('onPageCreate\x20Sending\x20CBT\x20for\x20testId:\x20'+_0x24813c);if(this[_0x44ad0d(0xa1)]&&_0x738c33[_0x44ad0d(0xc0)](this[_0x44ad0d(0xa1)][_0x44ad0d(0xb9)],FRAMEWORKS['JEST'])&&!_0x5c0d33[_0x44ad0d(0xdd)]){this['logger']['debug'](_0x738c33[_0x44ad0d(0x81)]);return;}let _0x7bf037,_0x47d939;if(this[_0x44ad0d(0xa1)]&&_0x738c33['ZNJOW'](this[_0x44ad0d(0xa1)][_0x44ad0d(0xb9)],FRAMEWORKS[_0x44ad0d(0x89)]))_0x7bf037=_0x24813c,_0x47d939=TestInfo[_0x44ad0d(0x97)](_0x7bf037);else this['testFrameworkData']&&_0x738c33[_0x44ad0d(0x88)](this['testFrameworkData'][_0x44ad0d(0xb9)],FRAMEWORKS[_0x44ad0d(0xc9)])?(_0x7bf037=this[_0x44ad0d(0x8f)][_0x44ad0d(0xc4)](_0x5c0d33[_0x44ad0d(0xdd)]),this[_0x44ad0d(0xb5)]['debug']('onPageCreate:\x20Recreated\x20Jest\x20testIdentifier:\x20'+_0x7bf037)):(_0x7bf037=TestInfo[_0x44ad0d(0xd4)](_0x5c0d33['testInfo'],_0x5c0d33['testInfo'][_0x44ad0d(0xd6)]),_0x47d939=TestInfo['getTestUUID'](_0x7bf037));const _0x3ebcae=TestInfo[_0x44ad0d(0xb7)](_0x7bf037),_0x44ce30=_0x5c0d33['instance'],_0x590717=AutomationFramework['getState'](_0x44ce30,PlaywrightDriverModule[_0x44ad0d(0xae)]),_0x32fd56=_0x3ebcae?.[TestFrameworkConstants[_0x44ad0d(0xbc)]]||this[_0x44ad0d(0xa1)]&&this[_0x44ad0d(0xa1)][_0x44ad0d(0xb9)],_0x385e93=_0x3ebcae?.[TestFrameworkConstants[_0x44ad0d(0xa2)]]||this['testFrameworkData']&&this[_0x44ad0d(0xa1)][_0x44ad0d(0xbe)],_0x51b974=TestFrameworkState['TEST']['toString']()[_0x44ad0d(0xa4)]('.')[0x1],_0x2ff32c=HookState[_0x44ad0d(0xcd)][_0x44ad0d(0xd9)]()[_0x44ad0d(0xa4)]('.')[0x1],_0x388b36=_0x44ce30[_0x44ad0d(0xda)](),_0x337bae=AutomationFramework[_0x44ad0d(0x90)](_0x44ce30,PlaywrightDriverModule['KEY_HUB_URL'],''),_0x1d0b5d={'provider':_0x738c33[_0x44ad0d(0xac)](getPlaywrightProvider,_0x337bae),'frameworkName':_0x44ce30[_0x44ad0d(0xc6)],'frameworkVersion':_0x44ce30[_0x44ad0d(0xd0)],'frameworkSessionId':LoadTestModule[_0x44ad0d(0xb3)]()?LoadTestModule['getLTSSessionId']():AutomationFramework[_0x44ad0d(0x90)](_0x44ce30,PlaywrightDriverModule[_0x44ad0d(0xdb)],''),'ref':_0x44ce30[_0x44ad0d(0xcc)](),'hubUrl':_0x337bae};let _0x3c2c35=AutomationFramework[_0x44ad0d(0x90)](_0x44ce30,PlaywrightDriverModule[_0x44ad0d(0x94)],{});_0x3c2c35=Buffer[_0x44ad0d(0xc3)](JSON[_0x44ad0d(0xaf)](_0x3c2c35))[_0x44ad0d(0xd9)](_0x738c33[_0x44ad0d(0xcb)]);const _0x3ebcb2={'hash':_0x388b36['getId'](),'threadId':_0x388b36[_0x44ad0d(0x7f)]()[_0x44ad0d(0xd9)](),'processId':_0x388b36['getProcessId']()['toString']()},_0x9268a2={};_0x9268a2[_0x44ad0d(0xe0)]=_0x7bf037;const _0x128476={};_0x128476[_0x44ad0d(0xc8)]=_0x47d939;const _0x5eb856={'platformIndex':_0x590717,'testFrameworkName':_0x32fd56,'testFrameworkVersion':_0x385e93,'testFrameworkState':_0x51b974,'testHookState':_0x2ff32c,...this['testFrameworkData']&&_0x738c33['kiKcQ'](this[_0x44ad0d(0xa1)][_0x44ad0d(0xb9)],FRAMEWORKS['JEST'])?_0x9268a2:_0x128476,'automationSession':_0x1d0b5d,'capabilities':_0x3c2c35,'executionContext':_0x3ebcb2};this[_0x44ad0d(0xb5)][_0x44ad0d(0xc2)]('onPageCreate\x20CBTSession\x20payload:\x20'+util[_0x44ad0d(0x8d)](_0x5eb856));const _0x549bd6=await GrpcClient[_0x44ad0d(0x84)]()['testSessionEvent'](_0x5eb856);this[_0x44ad0d(0xb5)]['debug'](_0x44ad0d(0xaa)+_0x24813c+(this[_0x44ad0d(0xa1)]&&_0x738c33[_0x44ad0d(0x88)](this[_0x44ad0d(0xa1)][_0x44ad0d(0xb9)],FRAMEWORKS['JEST'])?_0x44ad0d(0x9a)+_0x7bf037:''));}}catch(_0x2cc5ca){this[_0x44ad0d(0xb5)][_0x44ad0d(0xd1)](_0x44ad0d(0xdf)+util[_0x44ad0d(0x8d)](_0x2cc5ca));}}}function a85_0x839b(){const _0x1c6c1b=['testUuid','JEST','ernLO','AJIST','getRef','POST','1783288vprLRD','sendTestFrameworkEvent:\x20No\x20payload\x20created,\x20skipping\x20test\x20framework\x20event','frameworkVersion','error','length','page','getTestIdentifierFromTestInfo','hYstd','retry','../../../helpers/classLogger.js','YKQpg','toString','getContext','KEY_SESSION_ID','../../../helpers/helper.js','testInfo','./loadTestModule.js','Error\x20in\x20sending\x20CBTSession:\x20','test_identifier','18zprzzO','testhubConfig','values','911617EooKQg','../grpcClient.js','getThreadId','./playwrightDriverModule.js','WuxFp','2933307jRDITQ','\x20hookState:\x20','getInstance','7674930Dptmfb','BROWSERSTACK_TESTHUB_JWT','base64','bgIFD','CUCUMBER','registerObserver','getCurrentTestState','CREATE','format','122624ZLXsFJ','jestUtils','getState','sendTestFrameworkEvent','210838ZqVVIj','onAllTestEvents','KEY_CAPABILITIES','testFrameworkEvent','getBuildHashedId','getTestUUID','bind','onPageCreate',',\x20test_identifier:\x20','TEST','../utils/jest-utils.js','../framework/automationFramework.js','exports','TestHubModule','5MSvWWQ','testFrameworkData','KEY_TEST_FRAMEWORK_VERSION','BROWSERSTACK_TESTHUB_UUID','split','CyWBM','getTestId','103538hotXOP','../../../helpers/testhub/constants','util','onPageCreate\x20CBTSession\x20complete\x20for\x20testId:\x20','XyhwF','YjZSR','../state/testFrameworkState.js','KEY_PLATFORM_INDEX','stringify','../TestInfo.js','sendTestFrameworkEvent\x20complete\x20for\x20testState:\x20','3|8|6|0|7|1|4|2|5','isLTSSession','createTestFrameworkEventPayload','logger','3OnJoib','getTestDetails','MODULE_NAME','name','forEach','ENV_VAR','KEY_TEST_FRAMEWORK_NAME','instance','version','../state/hookState.js','kiKcQ','getJwt','debug','from','recreateIdentifierFromTestInfo','testFrameworkState','frameworkName','../framework/constants/testFrameworkConstants.js'];a85_0x839b=function(){return _0x1c6c1b;};return a85_0x839b();}TestHubModule[a85_0x5f138f(0xb8)]=a85_0x5f138f(0x9f),TestHubModule['KEY_TEST_DEFERRED']='test_deferred',module[a85_0x5f138f(0x9e)]=TestHubModule;