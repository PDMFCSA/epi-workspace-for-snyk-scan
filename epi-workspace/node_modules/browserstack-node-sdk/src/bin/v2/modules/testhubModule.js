const a76_0x34bb55=a76_0x4e5f;(function(_0xd04ad1,_0x59ee24){const _0x5415c2=a76_0x4e5f,_0x2fecd1=_0xd04ad1();while(!![]){try{const _0x2146f2=parseInt(_0x5415c2(0xff))/0x1*(-parseInt(_0x5415c2(0x10f))/0x2)+parseInt(_0x5415c2(0xea))/0x3+-parseInt(_0x5415c2(0xdd))/0x4+-parseInt(_0x5415c2(0xef))/0x5*(parseInt(_0x5415c2(0x106))/0x6)+-parseInt(_0x5415c2(0x110))/0x7+parseInt(_0x5415c2(0xf2))/0x8*(-parseInt(_0x5415c2(0xae))/0x9)+parseInt(_0x5415c2(0xd6))/0xa;if(_0x2146f2===_0x59ee24)break;else _0x2fecd1['push'](_0x2fecd1['shift']());}catch(_0x56b897){_0x2fecd1['push'](_0x2fecd1['shift']());}}}(a76_0x4365,0x2a605));function a76_0x4e5f(_0x5e2d09,_0x472807){const _0x4365ea=a76_0x4365();return a76_0x4e5f=function(_0x4e5ff1,_0x680c15){_0x4e5ff1=_0x4e5ff1-0xa4;let _0x857e79=_0x4365ea[_0x4e5ff1];return _0x857e79;},a76_0x4e5f(_0x5e2d09,_0x472807);}const util=require(a76_0x34bb55(0xbb)),BaseModule=require(a76_0x34bb55(0xb9)),{createClassLogger}=require(a76_0x34bb55(0xdc)),AutomationFramework=require(a76_0x34bb55(0xd8)),AutomationFrameworkState=require(a76_0x34bb55(0xf1)),HookState=require(a76_0x34bb55(0x10b)),TestFramework=require(a76_0x34bb55(0x105)),TestFrameworkState=require(a76_0x34bb55(0xd5)),PlaywrightDriverModule=require(a76_0x34bb55(0xc5)),TestFrameworkConstants=require(a76_0x34bb55(0xac)),GrpcClient=require(a76_0x34bb55(0xbe)),CLIUtils=require('../cliUtils.js'),TestInfo=require(a76_0x34bb55(0xf3)),testHubConstants=require('../../../helpers/testhub/constants'),BrowserstackCLI=require(a76_0x34bb55(0x112)),{getPlaywrightProvider}=require(a76_0x34bb55(0xe4));function a76_0x4365(){const _0x3f5ec7=['name','CREATE','getProcessId','startedAt','testInfo','base64','onPageCreate','getThreadId','test','BROWSERSTACK_TESTHUB_UUID','matchHookRegex','23ygtLjX','POST','KEY_TEST_FRAMEWORK_NAME','stringify','TestHubModule','KEY_TEST_STARTED_AT','../framework/testFramework.js','1487580LXGzlI','getBuildHashedId','getJwt','error','testFrameworkState','../state/hookState.js','testhubConfig','KEY_TEST_FRAMEWORK_VERSION','TEST','9426QOFZBN','2145689prwCts','sendTestFrameworkEvent\x20complete\x20for\x20testId:\x20','../browserstackCLI.js','bind','KEY_TEST_ENDED_AT','debug','\x20testState:\x20','instance','forEach','onPageCreate\x20CBTSession\x20complete\x20for\x20testId:\x20','getTestUUID','page','get','../framework/constants/testFrameworkConstants.js','eventJson','45GdCYUd','env','platformIndex','ENV_VAR','uuid','\x20hookState:\x20','getInstance','testId','hookState','logger','getCurrentTestState','./baseModule','workerInfo','util','Error\x20in\x20sendTestFrameworkEvent:\x20','getModuleName','../grpcClient.js','registerObserver','sendTestFrameworkEvent\x20testId:\x20','split','OslRj','frameworkVersion','testSessionEvent','./playwrightDriverModule.js','KEY_TEST_DEFERRED','capabilities','testFrameworkVersion','getId','getContext','VnIcv','testUuid','executionContext','exports','testFrameworkEvent','getTestDetails','frameworkName','getState','BROWSERSTACK_TESTHUB_JWT','KEY_SESSION_ID','../state/testFrameworkState.js','11196850AIXZSY','O11yHashedID','../framework/automationFramework.js','onPageCreate\x20CBTSession\x20payload:\x20','from','cxtYt','../../../helpers/classLogger.js','557360JhfGBg','KEY_PLATFORM_INDEX','format','toString','sendTestFrameworkEvent','automationSession','getCurrentHookState','../../../helpers/helper.js','testHookState','0|5|4|2|1|3|7|6','MODULE_NAME','UJNJm','getRef','218457kiXwCq','KEY_CAPABILITIES','__workerDetails','onAllTestEvents','values','5vsEZia','onPageCreate\x20Sending\x20CBT\x20for\x20testId:\x20','../state/automationFrameworkState.js','346776uUaZkc','../TestInfo.js'];a76_0x4365=function(){return _0x3f5ec7;};return a76_0x4365();}class TestHubModule extends BaseModule{[a76_0x34bb55(0xb7)]=createClassLogger('TestHubModule');constructor(_0x4ed92a){const _0x59fa0b=a76_0x34bb55,_0x204f63={};_0x204f63['jCqgI']=_0x59fa0b(0xe6),_0x204f63[_0x59fa0b(0xe8)]='TestHubModule';const _0x45d2df=_0x204f63,_0x5cbd3a=_0x45d2df['jCqgI'][_0x59fa0b(0xc1)]('|');let _0x3a6f87=0x0;while(!![]){switch(_0x5cbd3a[_0x3a6f87++]){case'0':super();continue;case'1':Object[_0x59fa0b(0xee)](TestFrameworkState)[_0x59fa0b(0xa7)](_0x274b87=>{const _0x3ebcbd=_0x59fa0b;Object[_0x3ebcbd(0xee)](HookState)[_0x3ebcbd(0xa7)](_0x378686=>{const _0xa7a040=_0x3ebcbd;TestFramework['registerObserver'](_0x274b87,_0x378686,this[_0xa7a040(0xed)][_0xa7a040(0x113)](this));});});continue;case'2':AutomationFramework[_0x59fa0b(0xbf)](AutomationFrameworkState[_0x59fa0b(0xf5)],HookState[_0x59fa0b(0x100)],this[_0x59fa0b(0xfa)][_0x59fa0b(0x113)](this));continue;case'3':process[_0x59fa0b(0xaf)][testHubConstants[_0x59fa0b(0xb1)][_0x59fa0b(0xd3)]]=this[_0x59fa0b(0x10c)][_0x59fa0b(0x108)]();continue;case'4':this[_0x59fa0b(0x10c)]=_0x4ed92a;continue;case'5':this[_0x59fa0b(0xf4)]=_0x45d2df[_0x59fa0b(0xe8)];continue;case'6':BrowserstackCLI[_0x59fa0b(0xd7)]=this[_0x59fa0b(0x10c)]['getBuildHashedId']();continue;case'7':process[_0x59fa0b(0xaf)][testHubConstants[_0x59fa0b(0xb1)][_0x59fa0b(0xfd)]]=this[_0x59fa0b(0x10c)][_0x59fa0b(0x107)]();continue;}break;}}[a76_0x34bb55(0xbd)](){const _0x5987ad=a76_0x34bb55;return TestHubModule[_0x5987ad(0xe7)];}[a76_0x34bb55(0xed)](_0x5cdcd6){const _0x5cd890=a76_0x34bb55,_0x5c5d7e={};_0x5c5d7e[_0x5cd890(0xc2)]=function(_0x4d864c,_0x4e0fc8){return _0x4d864c===_0x4e0fc8;};const _0x183276=_0x5c5d7e,_0x41ef2f=_0x5cdcd6[_0x5cd890(0xa6)],_0x40be11=_0x41ef2f[_0x5cd890(0xb8)]();(_0x183276[_0x5cd890(0xc2)](_0x40be11,TestFrameworkState[_0x5cd890(0x10e)])||CLIUtils[_0x5cd890(0xfe)](_0x40be11[_0x5cd890(0xe0)]()['split']('.')[0x1]))&&this[_0x5cd890(0xe1)](_0x5cdcd6);}async[a76_0x34bb55(0xe1)](_0x3760d0){const _0x39efa5=a76_0x34bb55,_0x1dec75={};_0x1dec75['iagZJ']=_0x39efa5(0xf9);const _0x2a359b=_0x1dec75;try{const _0x281454=_0x3760d0[_0x39efa5(0xfc)]['id'],_0x451b58=_0x3760d0['instance'],_0x4119b1=_0x451b58[_0x39efa5(0xca)](),_0x47f859=_0x451b58['getAllData']()[_0x39efa5(0xab)](_0x281454);this[_0x39efa5(0xb7)]['debug'](_0x39efa5(0xc0)+_0x281454);const {[TestFrameworkConstants['KEY_TEST_FRAMEWORK_NAME']]:_0x2e00bc='',[TestFrameworkConstants['KEY_TEST_FRAMEWORK_VERSION']]:_0x4e67de='',[TestFrameworkConstants[_0x39efa5(0x104)]]:_0x45e331='',[TestFrameworkConstants[_0x39efa5(0x114)]]:_0x19ef0f=''}=_0x47f859,_0x2c6279=_0x451b58[_0x39efa5(0xb8)]()[_0x39efa5(0xe0)]()[_0x39efa5(0xc1)]('.')[0x1],_0x4afb53=_0x451b58[_0x39efa5(0xe3)]()[_0x39efa5(0xe0)]()['split']('.')[0x1],_0x15e403=global?.[_0x39efa5(0xec)]?.[_0x39efa5(0xba)]?.['parallelIndex'];;const _0x395d95=_0x451b58['getRef'](),_0x53a25b=Buffer[_0x39efa5(0xda)](JSON[_0x39efa5(0x102)](_0x47f859))[_0x39efa5(0xe0)](_0x2a359b['iagZJ']),_0x34b727={'hash':_0x4119b1[_0x39efa5(0xc9)](),'threadId':_0x4119b1[_0x39efa5(0xfb)]()[_0x39efa5(0xe0)](),'processId':_0x4119b1['getProcessId']()[_0x39efa5(0xe0)]()},_0x4c9591={};_0x4c9591['platformIndex']=_0x15e403,_0x4c9591['testFrameworkName']=_0x2e00bc,_0x4c9591['testFrameworkVersion']=_0x4e67de,_0x4c9591[_0x39efa5(0x10a)]=_0x2c6279,_0x4c9591[_0x39efa5(0xb6)]=_0x4afb53,_0x4c9591[_0x39efa5(0xf7)]=_0x45e331,_0x4c9591['endedAt']=_0x19ef0f,_0x4c9591[_0x39efa5(0xb2)]=_0x395d95,_0x4c9591[_0x39efa5(0xad)]=_0x53a25b,_0x4c9591[_0x39efa5(0xcd)]=_0x34b727;const _0x4b6015=_0x4c9591,_0x286daf=await GrpcClient[_0x39efa5(0xb4)]()[_0x39efa5(0xcf)](_0x4b6015);this[_0x39efa5(0xb7)][_0x39efa5(0xa4)](_0x39efa5(0x111)+_0x281454+_0x39efa5(0xa5)+_0x2c6279+_0x39efa5(0xb3)+_0x4afb53);}catch(_0x2af17e){this['logger'][_0x39efa5(0x109)](_0x39efa5(0xbc)+util[_0x39efa5(0xdf)](_0x2af17e));}}async[a76_0x34bb55(0xfa)](_0x21644d){const _0x56a2af=a76_0x34bb55,_0x4d899c={'VnIcv':function(_0xfb1e,_0x4fee78){return _0xfb1e(_0x4fee78);},'cxtYt':'base64'};try{if(_0x21644d[_0x56a2af(0xaa)]){const _0x31455a=_0x21644d[_0x56a2af(0xf8)][_0x56a2af(0xb5)];this[_0x56a2af(0xb7)][_0x56a2af(0xa4)](_0x56a2af(0xf0)+_0x31455a);const _0x8cbb86=TestInfo[_0x56a2af(0xa9)](_0x31455a),_0x3eb55a=TestInfo[_0x56a2af(0xd0)](_0x31455a),_0x3024ad=_0x21644d[_0x56a2af(0xa6)],_0x2bdabe=AutomationFramework[_0x56a2af(0xd2)](_0x3024ad,PlaywrightDriverModule[_0x56a2af(0xde)]),_0x254788=_0x3eb55a[TestFrameworkConstants[_0x56a2af(0x101)]],_0x59ef5f=_0x3eb55a[TestFrameworkConstants[_0x56a2af(0x10d)]],_0x5011e8=TestFrameworkState[_0x56a2af(0x10e)]['toString']()[_0x56a2af(0xc1)]('.')[0x1],_0x326706=HookState['POST'][_0x56a2af(0xe0)]()[_0x56a2af(0xc1)]('.')[0x1],_0x4df222=_0x3024ad[_0x56a2af(0xca)](),_0xa9ebf3=AutomationFramework['getState'](_0x3024ad,PlaywrightDriverModule['KEY_HUB_URL'],''),_0x3302c4={'provider':_0x4d899c[_0x56a2af(0xcb)](getPlaywrightProvider,_0xa9ebf3),'frameworkName':_0x3024ad[_0x56a2af(0xd1)],'frameworkVersion':_0x3024ad[_0x56a2af(0xc3)],'frameworkSessionId':AutomationFramework[_0x56a2af(0xd2)](_0x3024ad,PlaywrightDriverModule[_0x56a2af(0xd4)],''),'ref':_0x3024ad[_0x56a2af(0xe9)](),'hubUrl':_0xa9ebf3};let _0xd1715=AutomationFramework[_0x56a2af(0xd2)](_0x3024ad,PlaywrightDriverModule[_0x56a2af(0xeb)],{});_0xd1715=Buffer['from'](JSON[_0x56a2af(0x102)](_0xd1715))[_0x56a2af(0xe0)](_0x4d899c[_0x56a2af(0xdb)]);const _0x39332d={'hash':_0x4df222[_0x56a2af(0xc9)](),'threadId':_0x4df222[_0x56a2af(0xfb)]()[_0x56a2af(0xe0)](),'processId':_0x4df222[_0x56a2af(0xf6)]()[_0x56a2af(0xe0)]()},_0x815278={};_0x815278[_0x56a2af(0xb0)]=_0x2bdabe,_0x815278['testFrameworkName']=_0x254788,_0x815278[_0x56a2af(0xc8)]=_0x59ef5f,_0x815278['testFrameworkState']=_0x5011e8,_0x815278[_0x56a2af(0xe5)]=_0x326706,_0x815278[_0x56a2af(0xcc)]=_0x8cbb86,_0x815278[_0x56a2af(0xe2)]=_0x3302c4,_0x815278[_0x56a2af(0xc7)]=_0xd1715,_0x815278[_0x56a2af(0xcd)]=_0x39332d;const _0x19b31c=_0x815278;this['logger']['debug'](_0x56a2af(0xd9)+util[_0x56a2af(0xdf)](_0x19b31c));const _0x159c3f=await GrpcClient[_0x56a2af(0xb4)]()[_0x56a2af(0xc4)](_0x19b31c);this[_0x56a2af(0xb7)][_0x56a2af(0xa4)](_0x56a2af(0xa8)+_0x31455a);}}catch(_0x629a50){this[_0x56a2af(0xb7)][_0x56a2af(0x109)]('Error\x20in\x20sending\x20CBTSession:\x20'+util[_0x56a2af(0xdf)](_0x629a50));}}}TestHubModule[a76_0x34bb55(0xe7)]=a76_0x34bb55(0x103),TestHubModule[a76_0x34bb55(0xc6)]='test_deferred',module[a76_0x34bb55(0xce)]=TestHubModule;