const a85_0x18f0aa=a85_0x1bdb;function a85_0x1bdb(_0x240d7f,_0x4b68a0){const _0x344975=a85_0x3449();return a85_0x1bdb=function(_0x1bdb8d,_0xc5310d){_0x1bdb8d=_0x1bdb8d-0x127;let _0x788b8f=_0x344975[_0x1bdb8d];return _0x788b8f;},a85_0x1bdb(_0x240d7f,_0x4b68a0);}(function(_0x15c64b,_0x577bf2){const _0x5655bc=a85_0x1bdb,_0x2ed397=_0x15c64b();while(!![]){try{const _0x3cb060=-parseInt(_0x5655bc(0x16a))/0x1+-parseInt(_0x5655bc(0x16e))/0x2*(parseInt(_0x5655bc(0x15c))/0x3)+-parseInt(_0x5655bc(0x13c))/0x4+-parseInt(_0x5655bc(0x18b))/0x5+parseInt(_0x5655bc(0x13e))/0x6*(-parseInt(_0x5655bc(0x136))/0x7)+parseInt(_0x5655bc(0x17c))/0x8+parseInt(_0x5655bc(0x183))/0x9*(parseInt(_0x5655bc(0x16d))/0xa);if(_0x3cb060===_0x577bf2)break;else _0x2ed397['push'](_0x2ed397['shift']());}catch(_0x40b760){_0x2ed397['push'](_0x2ed397['shift']());}}}(a85_0x3449,0x414c9));const util=require(a85_0x18f0aa(0x12c)),BaseModule=require(a85_0x18f0aa(0x138)),{createClassLogger}=require(a85_0x18f0aa(0x16c)),AutomationFramework=require('../framework/automationFramework.js'),AutomationFrameworkState=require(a85_0x18f0aa(0x14c)),HookState=require(a85_0x18f0aa(0x17e)),TestFramework=require('../framework/testFramework.js'),TestFrameworkState=require(a85_0x18f0aa(0x12b)),PlaywrightDriverModule=require(a85_0x18f0aa(0x14e)),TestFrameworkConstants=require(a85_0x18f0aa(0x140)),GrpcClient=require(a85_0x18f0aa(0x18a)),CLIUtils=require(a85_0x18f0aa(0x167)),TestInfo=require('../TestInfo.js'),testHubConstants=require('../../../helpers/testhub/constants'),{FRAMEWORKS}=require(a85_0x18f0aa(0x137)),helper=require('../../../helpers/helper.js'),LoadTestModule=require('./loadTestModule.js'),JestUtils=require(a85_0x18f0aa(0x186)),BrowserstackCLI=require(a85_0x18f0aa(0x172)),{getPlaywrightProvider,getProductForSession}=require(a85_0x18f0aa(0x17a));class TestHubModule extends BaseModule{[a85_0x18f0aa(0x187)]=createClassLogger(a85_0x18f0aa(0x132));constructor(_0x37bfec,_0xbc621d=null){const _0x464811=a85_0x18f0aa,_0x379bae={};_0x379bae[_0x464811(0x17d)]=_0x464811(0x164),_0x379bae[_0x464811(0x14d)]=_0x464811(0x132);const _0x34cc8e=_0x379bae,_0x46885d=_0x34cc8e['Ahjur'][_0x464811(0x175)]('|');let _0x4b9f82=0x0;while(!![]){switch(_0x46885d[_0x4b9f82++]){case'0':this[_0x464811(0x12d)]=new JestUtils();continue;case'1':this[_0x464811(0x150)]=_0x37bfec;continue;case'2':this[_0x464811(0x14a)]=_0x34cc8e[_0x464811(0x14d)];continue;case'3':AutomationFramework[_0x464811(0x156)](AutomationFrameworkState[_0x464811(0x177)],HookState['POST'],this[_0x464811(0x168)][_0x464811(0x15d)](this));continue;case'4':super(_0xbc621d);continue;case'5':Object[_0x464811(0x14b)](TestFrameworkState)[_0x464811(0x15f)](_0x320ef5=>{const _0x5455e0=_0x464811;Object[_0x5455e0(0x14b)](HookState)[_0x5455e0(0x15f)](_0x242c12=>{const _0xb73293=_0x5455e0;TestFramework[_0xb73293(0x156)](_0x320ef5,_0x242c12,this[_0xb73293(0x13b)]['bind'](this));});});continue;case'6':BrowserstackCLI[_0x464811(0x135)]=this[_0x464811(0x150)][_0x464811(0x159)]();continue;case'7':process['env'][testHubConstants[_0x464811(0x179)][_0x464811(0x146)]]=this[_0x464811(0x150)][_0x464811(0x127)]();continue;case'8':process['env'][testHubConstants[_0x464811(0x179)][_0x464811(0x144)]]=this['testhubConfig'][_0x464811(0x159)]();continue;}break;}}[a85_0x18f0aa(0x176)](){const _0x362f75=a85_0x18f0aa;return TestHubModule[_0x362f75(0x148)];}['onAllTestEvents'](_0x578cb7){const _0x46fe59=a85_0x18f0aa,_0x4aa162={};_0x4aa162[_0x46fe59(0x170)]=function(_0x3a2bd2,_0x238a24){return _0x3a2bd2===_0x238a24;};const _0x50da7f=_0x4aa162,_0x4dc11e=_0x578cb7[_0x46fe59(0x163)],_0x4b04e3=_0x4dc11e[_0x46fe59(0x18e)]();(_0x50da7f[_0x46fe59(0x170)](_0x4b04e3,TestFrameworkState[_0x46fe59(0x18f)])||CLIUtils[_0x46fe59(0x149)](_0x4b04e3[_0x46fe59(0x189)]()['split']('.')[0x1]))&&this[_0x46fe59(0x130)](_0x578cb7);}async['sendTestFrameworkEvent'](_0x45eb33){const _0x5895c1=a85_0x18f0aa,_0xb11b01={};_0xb11b01[_0x5895c1(0x14f)]=function(_0x1036da,_0x34d555){return _0x1036da===_0x34d555;},_0xb11b01[_0x5895c1(0x151)]=_0x5895c1(0x173);const _0x554663=_0xb11b01;try{const _0x317c07=BrowserstackCLI[_0x5895c1(0x166)]()[_0x5895c1(0x184)]()[_0x5895c1(0x158)](_0x45eb33);if(!_0x317c07||_0x554663[_0x5895c1(0x14f)](Object[_0x5895c1(0x141)](_0x317c07)[_0x5895c1(0x171)],0x0)){this[_0x5895c1(0x187)]['debug'](_0x554663[_0x5895c1(0x151)]);return;}const _0x1be4ea=await GrpcClient[_0x5895c1(0x166)]()['testFrameworkEvent'](_0x317c07);this[_0x5895c1(0x187)][_0x5895c1(0x161)](_0x5895c1(0x142)+_0x317c07[_0x5895c1(0x165)]+_0x5895c1(0x143)+_0x317c07[_0x5895c1(0x139)]);}catch(_0x52c9e1){this[_0x5895c1(0x187)][_0x5895c1(0x145)]('Error\x20in\x20sendTestFrameworkEvent:\x20'+util[_0x5895c1(0x147)](_0x52c9e1));}}async[a85_0x18f0aa(0x168)](_0x36de99){const _0x1dc462=a85_0x18f0aa,_0x5d655a={'dNOUb':function(_0x16756d,_0x250353){return _0x16756d===_0x250353;},'evOVd':'onPageCreate:\x20Skipping\x20CBT\x20session\x20event\x20-\x20no\x20testInfo\x20(page\x20created\x20outside\x20test\x20context)','Trker':function(_0x3a1227,_0xd4db94){return _0x3a1227(_0xd4db94);},'csKao':function(_0x4300c4){return _0x4300c4();},'Upeok':_0x1dc462(0x152),'MewEN':function(_0x5682c8,_0x47c556){return _0x5682c8===_0x47c556;}};try{if(_0x36de99[_0x1dc462(0x190)]){const _0x31284b=this['getTestId'](_0x36de99);this[_0x1dc462(0x187)][_0x1dc462(0x161)](_0x1dc462(0x169)+_0x31284b);if(this['testFrameworkData']&&_0x5d655a[_0x1dc462(0x15a)](this[_0x1dc462(0x12f)][_0x1dc462(0x14a)],FRAMEWORKS['JEST'])&&!_0x36de99[_0x1dc462(0x180)]){this[_0x1dc462(0x187)][_0x1dc462(0x161)](_0x5d655a[_0x1dc462(0x17f)]);return;}let _0x48be51,_0x5c14eb;if(this[_0x1dc462(0x12f)]&&_0x5d655a[_0x1dc462(0x15a)](this['testFrameworkData'][_0x1dc462(0x14a)],FRAMEWORKS['CUCUMBER']))_0x48be51=_0x31284b,_0x5c14eb=TestInfo['getTestUUID'](_0x48be51);else this[_0x1dc462(0x12f)]&&_0x5d655a['dNOUb'](this[_0x1dc462(0x12f)][_0x1dc462(0x14a)],FRAMEWORKS[_0x1dc462(0x160)])?(_0x48be51=this[_0x1dc462(0x12d)]['recreateIdentifierFromTestInfo'](_0x36de99[_0x1dc462(0x180)]),this[_0x1dc462(0x187)][_0x1dc462(0x161)](_0x1dc462(0x188)+_0x48be51)):(_0x48be51=TestInfo[_0x1dc462(0x16b)](_0x36de99[_0x1dc462(0x180)],_0x36de99[_0x1dc462(0x180)][_0x1dc462(0x157)]),_0x5c14eb=TestInfo[_0x1dc462(0x16f)](_0x48be51));const _0x42118e=TestInfo[_0x1dc462(0x12a)](_0x48be51),_0x53860a=_0x36de99['instance'],_0x2ac8d0=AutomationFramework[_0x1dc462(0x15b)](_0x53860a,PlaywrightDriverModule['KEY_PLATFORM_INDEX']),_0x56e3e8=_0x42118e?.[TestFrameworkConstants[_0x1dc462(0x154)]]||this[_0x1dc462(0x12f)]&&this[_0x1dc462(0x12f)]['name'],_0x100108=_0x42118e?.[TestFrameworkConstants[_0x1dc462(0x17b)]]||this[_0x1dc462(0x12f)]&&this[_0x1dc462(0x12f)][_0x1dc462(0x134)],_0x18d7c7=TestFrameworkState['TEST']['toString']()[_0x1dc462(0x175)]('.')[0x1],_0x1b1fae=HookState['POST']['toString']()['split']('.')[0x1],_0x434040=_0x53860a[_0x1dc462(0x13f)](),_0x20c9a6=AutomationFramework['getState'](_0x53860a,PlaywrightDriverModule['KEY_HUB_URL'],''),_0x14b6e0={'provider':_0x5d655a['Trker'](getPlaywrightProvider,_0x20c9a6),'frameworkName':_0x53860a[_0x1dc462(0x153)],'frameworkVersion':_0x53860a['frameworkVersion'],'frameworkSessionId':LoadTestModule['isLTSSession']()?LoadTestModule[_0x1dc462(0x133)]():AutomationFramework[_0x1dc462(0x15b)](_0x53860a,PlaywrightDriverModule['KEY_SESSION_ID'],''),'ref':_0x53860a[_0x1dc462(0x13d)](),'hubUrl':_0x20c9a6,'product':_0x5d655a['csKao'](getProductForSession)};let _0x3f7308=AutomationFramework[_0x1dc462(0x15b)](_0x53860a,PlaywrightDriverModule[_0x1dc462(0x18c)],{});_0x3f7308=Buffer[_0x1dc462(0x185)](JSON[_0x1dc462(0x155)](_0x3f7308))['toString'](_0x5d655a['Upeok']);const _0x1d6653={'hash':_0x434040[_0x1dc462(0x128)](),'threadId':_0x434040[_0x1dc462(0x182)]()['toString'](),'processId':_0x434040[_0x1dc462(0x129)]()[_0x1dc462(0x189)]()},_0x1ad2f5={};_0x1ad2f5[_0x1dc462(0x13a)]=_0x48be51;const _0x25d5b1={};_0x25d5b1[_0x1dc462(0x174)]=_0x5c14eb;const _0x65b1b3={'platformIndex':_0x2ac8d0,'testFrameworkName':_0x56e3e8,'testFrameworkVersion':_0x100108,'testFrameworkState':_0x18d7c7,'testHookState':_0x1b1fae,...this['testFrameworkData']&&_0x5d655a[_0x1dc462(0x15a)](this[_0x1dc462(0x12f)][_0x1dc462(0x14a)],FRAMEWORKS[_0x1dc462(0x160)])?_0x1ad2f5:_0x25d5b1,'automationSession':_0x14b6e0,'capabilities':_0x3f7308,'executionContext':_0x1d6653};this[_0x1dc462(0x187)][_0x1dc462(0x161)](_0x1dc462(0x18d)+util[_0x1dc462(0x147)](_0x65b1b3));const _0xe03e59=await GrpcClient['getInstance']()[_0x1dc462(0x181)](_0x65b1b3);this[_0x1dc462(0x187)][_0x1dc462(0x161)](_0x1dc462(0x178)+_0x31284b+(this['testFrameworkData']&&_0x5d655a['MewEN'](this[_0x1dc462(0x12f)][_0x1dc462(0x14a)],FRAMEWORKS['JEST'])?',\x20test_identifier:\x20'+_0x48be51:''));}}catch(_0x296e0f){this[_0x1dc462(0x187)][_0x1dc462(0x145)](_0x1dc462(0x162)+util[_0x1dc462(0x147)](_0x296e0f));}}}function a85_0x3449(){const _0x2861a2=['ENV_VAR','../../../helpers/helper.js','KEY_TEST_FRAMEWORK_VERSION','1087392Zweasl','Ahjur','../state/hookState.js','evOVd','testInfo','testSessionEvent','getThreadId','963XJrFbe','getTestFramework','from','../utils/jest-utils.js','logger','onPageCreate:\x20Recreated\x20Jest\x20testIdentifier:\x20','toString','../grpcClient.js','268185CPgWeW','KEY_CAPABILITIES','onPageCreate\x20CBTSession\x20payload:\x20','getCurrentTestState','TEST','page','getJwt','getId','getProcessId','getTestDetails','../state/testFrameworkState.js','util','jestUtils','KEY_TEST_DEFERRED','testFrameworkData','sendTestFrameworkEvent','test_deferred','TestHubModule','getLTSSessionId','version','O11yHashedID','28FjaXbA','../../../helpers/test-observability/constants.js','./baseModule','hookState','test_identifier','onAllTestEvents','783316NUIUGE','getRef','249654iVRjOe','getContext','../framework/constants/testFrameworkConstants.js','keys','sendTestFrameworkEvent\x20complete\x20for\x20testState:\x20','\x20hookState:\x20','BROWSERSTACK_TESTHUB_UUID','error','BROWSERSTACK_TESTHUB_JWT','format','MODULE_NAME','matchHookRegex','name','values','../state/automationFrameworkState.js','MlXOm','./playwrightDriverModule.js','pKNzl','testhubConfig','YNedm','base64','frameworkName','KEY_TEST_FRAMEWORK_NAME','stringify','registerObserver','retry','createTestFrameworkEventPayload','getBuildHashedId','dNOUb','getState','18nlDVkO','bind','exports','forEach','JEST','debug','Error\x20in\x20sending\x20CBTSession:\x20','instance','4|2|1|0|3|5|7|8|6','testFrameworkState','getInstance','../cliUtils.js','onPageCreate','onPageCreate\x20Sending\x20CBT\x20for\x20testId:\x20','21137GlTGlj','getTestIdentifierFromTestInfo','../../../helpers/classLogger.js','69580CHkHqs','58642pKHmNb','getTestUUID','LsjNV','length','../browserstackCLI.js','sendTestFrameworkEvent:\x20No\x20payload\x20created,\x20skipping\x20test\x20framework\x20event','testUuid','split','getModuleName','CREATE','onPageCreate\x20CBTSession\x20complete\x20for\x20testId:\x20'];a85_0x3449=function(){return _0x2861a2;};return a85_0x3449();}TestHubModule[a85_0x18f0aa(0x148)]=a85_0x18f0aa(0x132),TestHubModule[a85_0x18f0aa(0x12e)]=a85_0x18f0aa(0x131),module[a85_0x18f0aa(0x15e)]=TestHubModule;