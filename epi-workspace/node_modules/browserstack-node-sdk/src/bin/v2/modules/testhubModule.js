const a81_0x25023d=a81_0x43bd;(function(_0x5d7e36,_0x3fe45b){const _0x29c676=a81_0x43bd,_0x3dc3ad=_0x5d7e36();while(!![]){try{const _0x5e0ab7=-parseInt(_0x29c676(0x1bb))/0x1+-parseInt(_0x29c676(0x1b3))/0x2*(-parseInt(_0x29c676(0x1ca))/0x3)+-parseInt(_0x29c676(0x1d8))/0x4+-parseInt(_0x29c676(0x17c))/0x5*(parseInt(_0x29c676(0x1aa))/0x6)+-parseInt(_0x29c676(0x183))/0x7*(parseInt(_0x29c676(0x198))/0x8)+parseInt(_0x29c676(0x1b9))/0x9+parseInt(_0x29c676(0x186))/0xa;if(_0x5e0ab7===_0x3fe45b)break;else _0x3dc3ad['push'](_0x3dc3ad['shift']());}catch(_0xbb6b6d){_0x3dc3ad['push'](_0x3dc3ad['shift']());}}}(a81_0x2ad3,0x70743));function a81_0x43bd(_0x50ec23,_0x43db75){const _0x2ad389=a81_0x2ad3();return a81_0x43bd=function(_0x43bd21,_0x5b81e3){_0x43bd21=_0x43bd21-0x16f;let _0x564185=_0x2ad389[_0x43bd21];return _0x564185;},a81_0x43bd(_0x50ec23,_0x43db75);}const util=require('util'),BaseModule=require('./baseModule'),{createClassLogger}=require(a81_0x25023d(0x1ad)),AutomationFramework=require(a81_0x25023d(0x1d2)),AutomationFrameworkState=require('../state/automationFrameworkState.js'),HookState=require(a81_0x25023d(0x188)),TestFramework=require(a81_0x25023d(0x185)),TestFrameworkState=require(a81_0x25023d(0x187)),PlaywrightDriverModule=require(a81_0x25023d(0x17a)),TestFrameworkConstants=require(a81_0x25023d(0x1c8)),GrpcClient=require(a81_0x25023d(0x1d0)),CLIUtils=require(a81_0x25023d(0x1a7)),TestInfo=require(a81_0x25023d(0x1a6)),testHubConstants=require(a81_0x25023d(0x180)),{FRAMEWORKS}=require('../../../helpers/test-observability/constants.js'),BrowserstackCLI=require(a81_0x25023d(0x1ce)),{getPlaywrightProvider}=require(a81_0x25023d(0x18a));class TestHubModule extends BaseModule{[a81_0x25023d(0x182)]=createClassLogger('TestHubModule');constructor(_0x479aa0,_0x4da63e=null){const _0xfa9c80=a81_0x25023d,_0x4a0baf={};_0x4a0baf[_0xfa9c80(0x18b)]=_0xfa9c80(0x1cb),_0x4a0baf[_0xfa9c80(0x1a8)]=_0xfa9c80(0x1b2);const _0x52b252=_0x4a0baf,_0x3431a6=_0x52b252['qSqhT'][_0xfa9c80(0x1c4)]('|');let _0x302da5=0x0;while(!![]){switch(_0x3431a6[_0x302da5++]){case'0':AutomationFramework[_0xfa9c80(0x1a5)](AutomationFrameworkState['CREATE'],HookState[_0xfa9c80(0x1a3)],this[_0xfa9c80(0x1ba)]['bind'](this));continue;case'1':process[_0xfa9c80(0x1b6)][testHubConstants[_0xfa9c80(0x173)][_0xfa9c80(0x1d7)]]=this['testhubConfig'][_0xfa9c80(0x1b0)]();continue;case'2':super(_0x4da63e);continue;case'3':Object['values'](TestFrameworkState)['forEach'](_0x1c9a2f=>{const _0x452916=_0xfa9c80;Object[_0x452916(0x196)](HookState)[_0x452916(0x1cf)](_0x1d5faa=>{const _0x2ccfb6=_0x452916;TestFramework['registerObserver'](_0x1c9a2f,_0x1d5faa,this['onAllTestEvents'][_0x2ccfb6(0x1bf)](this));});});continue;case'4':this[_0xfa9c80(0x192)]=_0x52b252[_0xfa9c80(0x1a8)];continue;case'5':this[_0xfa9c80(0x197)]=_0x479aa0;continue;case'6':BrowserstackCLI[_0xfa9c80(0x18f)]=this[_0xfa9c80(0x197)][_0xfa9c80(0x1b0)]();continue;case'7':process[_0xfa9c80(0x1b6)][testHubConstants[_0xfa9c80(0x173)][_0xfa9c80(0x1b4)]]=this['testhubConfig'][_0xfa9c80(0x1d1)]();continue;}break;}}[a81_0x25023d(0x194)](){const _0x1905e4=a81_0x25023d;return TestHubModule[_0x1905e4(0x19a)];}[a81_0x25023d(0x17b)](_0x425ee7){const _0x5ef296=a81_0x25023d,_0x405582={};_0x405582[_0x5ef296(0x190)]=function(_0x216590,_0x379113){return _0x216590===_0x379113;};const _0xf765b0=_0x405582,_0x1e0a0d=_0x425ee7['instance'],_0x1773d7=_0x1e0a0d[_0x5ef296(0x1d4)]();(_0xf765b0[_0x5ef296(0x190)](_0x1773d7,TestFrameworkState[_0x5ef296(0x1be)])||CLIUtils[_0x5ef296(0x19b)](_0x1773d7[_0x5ef296(0x1af)]()['split']('.')[0x1]))&&this[_0x5ef296(0x19e)](_0x425ee7);}async[a81_0x25023d(0x19e)](_0x1e0bbe){const _0x238eba=a81_0x25023d,_0x6748a3={};_0x6748a3['zblFt']=function(_0x93b626,_0x46a9d2){return _0x93b626===_0x46a9d2;},_0x6748a3[_0x238eba(0x193)]=_0x238eba(0x1c7);const _0x5b85e1=_0x6748a3;try{const _0x2a5a75=BrowserstackCLI[_0x238eba(0x1c6)]()[_0x238eba(0x1bd)]()[_0x238eba(0x1a1)](_0x1e0bbe);if(!_0x2a5a75||_0x5b85e1['zblFt'](Object[_0x238eba(0x1ab)](_0x2a5a75)[_0x238eba(0x1ac)],0x0)){this[_0x238eba(0x182)][_0x238eba(0x181)](_0x5b85e1[_0x238eba(0x193)]);return;}const _0x20b279=await GrpcClient[_0x238eba(0x1c6)]()[_0x238eba(0x1c9)](_0x2a5a75);this['logger'][_0x238eba(0x181)](_0x238eba(0x18e)+_0x2a5a75[_0x238eba(0x1a0)]+_0x238eba(0x1b8)+_0x2a5a75[_0x238eba(0x199)]);}catch(_0x5abd0d){this[_0x238eba(0x182)][_0x238eba(0x171)](_0x238eba(0x19f)+util['format'](_0x5abd0d));}}async[a81_0x25023d(0x1ba)](_0x2aca84){const _0x25bb18=a81_0x25023d,_0x3ada56={'RWiDU':function(_0x1a347c,_0xd1d9e6){return _0x1a347c===_0xd1d9e6;},'AheYC':function(_0x10dfc0,_0x275c02){return _0x10dfc0(_0x275c02);},'jJRnQ':_0x25bb18(0x1ae)};try{if(_0x2aca84[_0x25bb18(0x191)]){const _0x5e0309=this[_0x25bb18(0x18c)](_0x2aca84);this[_0x25bb18(0x182)]['debug'](_0x25bb18(0x189)+_0x5e0309);let _0x24a94b;this[_0x25bb18(0x1d5)]&&_0x3ada56[_0x25bb18(0x1d3)](this['testFrameworkData']['name'],FRAMEWORKS[_0x25bb18(0x17d)])?_0x24a94b=_0x5e0309:_0x24a94b=TestInfo['getTestIdentifierFromTestInfo'](_0x2aca84[_0x25bb18(0x19c)],_0x2aca84['testInfo']['retry']);const _0xa2d499=TestInfo[_0x25bb18(0x1b7)](_0x24a94b),_0x1e5ccf=TestInfo[_0x25bb18(0x195)](_0x24a94b),_0x435588=_0x2aca84['instance'],_0x215197=AutomationFramework['getState'](_0x435588,PlaywrightDriverModule['KEY_PLATFORM_INDEX']),_0x2d71c6=_0x1e5ccf[TestFrameworkConstants[_0x25bb18(0x176)]]||this['testFrameworkData']&&this[_0x25bb18(0x1d5)]['name'],_0x8bf38f=_0x1e5ccf[TestFrameworkConstants[_0x25bb18(0x1a2)]]||this[_0x25bb18(0x1d5)]&&this[_0x25bb18(0x1d5)][_0x25bb18(0x1cd)],_0xd14522=TestFrameworkState[_0x25bb18(0x1be)]['toString']()[_0x25bb18(0x1c4)]('.')[0x1],_0x5d8b1e=HookState[_0x25bb18(0x1a3)]['toString']()[_0x25bb18(0x1c4)]('.')[0x1],_0x140ee0=_0x435588[_0x25bb18(0x170)](),_0xbc7269=AutomationFramework[_0x25bb18(0x1a4)](_0x435588,PlaywrightDriverModule[_0x25bb18(0x179)],''),_0x272253={'provider':_0x3ada56[_0x25bb18(0x177)](getPlaywrightProvider,_0xbc7269),'frameworkName':_0x435588[_0x25bb18(0x1cc)],'frameworkVersion':_0x435588[_0x25bb18(0x178)],'frameworkSessionId':AutomationFramework[_0x25bb18(0x1a4)](_0x435588,PlaywrightDriverModule['KEY_SESSION_ID'],''),'ref':_0x435588[_0x25bb18(0x18d)](),'hubUrl':_0xbc7269};let _0xaa3dfd=AutomationFramework[_0x25bb18(0x1a4)](_0x435588,PlaywrightDriverModule[_0x25bb18(0x1c0)],{});_0xaa3dfd=Buffer[_0x25bb18(0x1c2)](JSON['stringify'](_0xaa3dfd))[_0x25bb18(0x1af)](_0x3ada56[_0x25bb18(0x1a9)]);const _0x4bb798={'hash':_0x140ee0[_0x25bb18(0x172)](),'threadId':_0x140ee0[_0x25bb18(0x17f)]()[_0x25bb18(0x1af)](),'processId':_0x140ee0[_0x25bb18(0x1d6)]()['toString']()},_0x4fcb0d={};_0x4fcb0d[_0x25bb18(0x184)]=_0x215197,_0x4fcb0d[_0x25bb18(0x1b1)]=_0x2d71c6,_0x4fcb0d[_0x25bb18(0x1c3)]=_0x8bf38f,_0x4fcb0d[_0x25bb18(0x1a0)]=_0xd14522,_0x4fcb0d[_0x25bb18(0x1b5)]=_0x5d8b1e,_0x4fcb0d[_0x25bb18(0x17e)]=_0xa2d499,_0x4fcb0d['automationSession']=_0x272253,_0x4fcb0d['capabilities']=_0xaa3dfd,_0x4fcb0d['executionContext']=_0x4bb798;const _0x5c7b89=_0x4fcb0d;this[_0x25bb18(0x182)][_0x25bb18(0x181)](_0x25bb18(0x174)+util[_0x25bb18(0x1bc)](_0x5c7b89));const _0x53b3da=await GrpcClient['getInstance']()[_0x25bb18(0x175)](_0x5c7b89);this[_0x25bb18(0x182)][_0x25bb18(0x181)](_0x25bb18(0x19d)+_0x5e0309);}}catch(_0x205198){this[_0x25bb18(0x182)][_0x25bb18(0x171)](_0x25bb18(0x1c5)+util['format'](_0x205198));}}}function a81_0x2ad3(){const _0xb69454=['KEY_TEST_DEFERRED','from','testFrameworkVersion','split','Error\x20in\x20sending\x20CBTSession:\x20','getInstance','sendTestFrameworkEvent:\x20No\x20payload\x20created,\x20skipping\x20test\x20framework\x20event','../framework/constants/testFrameworkConstants.js','testFrameworkEvent','1906671Qjmrxn','2|4|5|0|3|7|1|6','frameworkName','version','../browserstackCLI.js','forEach','../grpcClient.js','getJwt','../framework/automationFramework.js','RWiDU','getCurrentTestState','testFrameworkData','getProcessId','BROWSERSTACK_TESTHUB_UUID','2484464RWWIwk','test_deferred','getContext','error','getId','ENV_VAR','onPageCreate\x20CBTSession\x20payload:\x20','testSessionEvent','KEY_TEST_FRAMEWORK_NAME','AheYC','frameworkVersion','KEY_HUB_URL','./playwrightDriverModule.js','onAllTestEvents','3241495zaGsXR','CUCUMBER','testUuid','getThreadId','../../../helpers/testhub/constants','debug','logger','175AkGwVH','platformIndex','../framework/testFramework.js','20362340XsEaQw','../state/testFrameworkState.js','../state/hookState.js','onPageCreate\x20Sending\x20CBT\x20for\x20testId:\x20','../../../helpers/helper.js','qSqhT','getTestId','getRef','sendTestFrameworkEvent\x20complete\x20for\x20testState:\x20','O11yHashedID','yMWru','page','name','qKWJz','getModuleName','getTestDetails','values','testhubConfig','228568JTfcKL','hookState','MODULE_NAME','matchHookRegex','testInfo','onPageCreate\x20CBTSession\x20complete\x20for\x20testId:\x20','sendTestFrameworkEvent','Error\x20in\x20sendTestFrameworkEvent:\x20','testFrameworkState','createTestFrameworkEventPayload','KEY_TEST_FRAMEWORK_VERSION','POST','getState','registerObserver','../TestInfo.js','../cliUtils.js','AxKCJ','jJRnQ','6XSZJLE','keys','length','../../../helpers/classLogger.js','base64','toString','getBuildHashedId','testFrameworkName','TestHubModule','2yzWKbQ','BROWSERSTACK_TESTHUB_JWT','testHookState','env','getTestUUID','\x20hookState:\x20','3789387otvhHw','onPageCreate','648533NoHkpI','format','getTestFramework','TEST','bind','KEY_CAPABILITIES'];a81_0x2ad3=function(){return _0xb69454;};return a81_0x2ad3();}TestHubModule[a81_0x25023d(0x19a)]=a81_0x25023d(0x1b2),TestHubModule[a81_0x25023d(0x1c1)]=a81_0x25023d(0x16f),module['exports']=TestHubModule;