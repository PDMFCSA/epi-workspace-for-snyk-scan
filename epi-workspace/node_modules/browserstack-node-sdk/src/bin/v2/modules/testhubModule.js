const a83_0x2a957e=a83_0x4f4b;(function(_0x22d2cc,_0x2cbbd4){const _0x10cfa1=a83_0x4f4b,_0xc6d5a3=_0x22d2cc();while(!![]){try{const _0x12cb73=-parseInt(_0x10cfa1(0x9a))/0x1+parseInt(_0x10cfa1(0xd6))/0x2*(-parseInt(_0x10cfa1(0xcb))/0x3)+parseInt(_0x10cfa1(0xdc))/0x4+-parseInt(_0x10cfa1(0xda))/0x5*(-parseInt(_0x10cfa1(0xd2))/0x6)+parseInt(_0x10cfa1(0xb9))/0x7+parseInt(_0x10cfa1(0xe3))/0x8*(-parseInt(_0x10cfa1(0xb7))/0x9)+parseInt(_0x10cfa1(0x96))/0xa;if(_0x12cb73===_0x2cbbd4)break;else _0xc6d5a3['push'](_0xc6d5a3['shift']());}catch(_0xd04aa2){_0xc6d5a3['push'](_0xc6d5a3['shift']());}}}(a83_0x5034,0x95e83));function a83_0x4f4b(_0x1120e6,_0x278065){const _0x50345c=a83_0x5034();return a83_0x4f4b=function(_0x4f4bf9,_0xa233f5){_0x4f4bf9=_0x4f4bf9-0x8c;let _0x115e9b=_0x50345c[_0x4f4bf9];return _0x115e9b;},a83_0x4f4b(_0x1120e6,_0x278065);}const util=require(a83_0x2a957e(0x9f)),BaseModule=require('./baseModule'),{createClassLogger}=require(a83_0x2a957e(0xae)),AutomationFramework=require(a83_0x2a957e(0xac)),AutomationFrameworkState=require(a83_0x2a957e(0xe4)),HookState=require(a83_0x2a957e(0xb8)),TestFramework=require(a83_0x2a957e(0xde)),TestFrameworkState=require('../state/testFrameworkState.js'),PlaywrightDriverModule=require(a83_0x2a957e(0xe0)),TestFrameworkConstants=require('../framework/constants/testFrameworkConstants.js'),GrpcClient=require(a83_0x2a957e(0x90)),CLIUtils=require(a83_0x2a957e(0xd9)),TestInfo=require(a83_0x2a957e(0xa4)),testHubConstants=require('../../../helpers/testhub/constants'),{FRAMEWORKS}=require('../../../helpers/test-observability/constants.js'),BrowserstackCLI=require('../browserstackCLI.js'),{getPlaywrightProvider}=require(a83_0x2a957e(0xd7));class TestHubModule extends BaseModule{[a83_0x2a957e(0xb1)]=createClassLogger(a83_0x2a957e(0xc1));constructor(_0x3adce6,_0x320a61=null){const _0x9e0fd3=a83_0x2a957e,_0xdb8fa1={};_0xdb8fa1[_0x9e0fd3(0xc5)]=_0x9e0fd3(0xd0),_0xdb8fa1['obolV']='TestHubModule';const _0x5b1665=_0xdb8fa1,_0x3fc00f=_0x5b1665['LFFCv'][_0x9e0fd3(0x8d)]('|');let _0x50cae8=0x0;while(!![]){switch(_0x3fc00f[_0x50cae8++]){case'0':super(_0x320a61);continue;case'1':this[_0x9e0fd3(0xa2)]=_0x3adce6;continue;case'2':this[_0x9e0fd3(0x95)]=_0x5b1665[_0x9e0fd3(0x8f)];continue;case'3':process['env'][testHubConstants[_0x9e0fd3(0xcf)]['BROWSERSTACK_TESTHUB_JWT']]=this[_0x9e0fd3(0xa2)]['getJwt']();continue;case'4':process['env'][testHubConstants[_0x9e0fd3(0xcf)][_0x9e0fd3(0xad)]]=this[_0x9e0fd3(0xa2)][_0x9e0fd3(0xe5)]();continue;case'5':AutomationFramework[_0x9e0fd3(0xdd)](AutomationFrameworkState[_0x9e0fd3(0xa1)],HookState[_0x9e0fd3(0xb5)],this[_0x9e0fd3(0xa8)]['bind'](this));continue;case'6':Object[_0x9e0fd3(0xc7)](TestFrameworkState)[_0x9e0fd3(0xce)](_0x1e79ed=>{const _0x46c854=_0x9e0fd3;Object['values'](HookState)[_0x46c854(0xce)](_0x480d93=>{const _0x4f8665=_0x46c854;TestFramework[_0x4f8665(0xdd)](_0x1e79ed,_0x480d93,this[_0x4f8665(0xd5)][_0x4f8665(0xbe)](this));});});continue;case'7':BrowserstackCLI['O11yHashedID']=this[_0x9e0fd3(0xa2)]['getBuildHashedId']();continue;}break;}}['getModuleName'](){const _0xf6d6ed=a83_0x2a957e;return TestHubModule[_0xf6d6ed(0xbb)];}[a83_0x2a957e(0xd5)](_0x44b11f){const _0x33b982=a83_0x2a957e,_0x1cd60f={};_0x1cd60f[_0x33b982(0xe2)]=function(_0x3336e5,_0x337516){return _0x3336e5===_0x337516;};const _0x2b049a=_0x1cd60f,_0x20e702=_0x44b11f[_0x33b982(0xaa)],_0x10e92d=_0x20e702[_0x33b982(0x9c)]();(_0x2b049a[_0x33b982(0xe2)](_0x10e92d,TestFrameworkState['TEST'])||CLIUtils[_0x33b982(0xdb)](_0x10e92d['toString']()[_0x33b982(0x8d)]('.')[0x1]))&&this[_0x33b982(0xcd)](_0x44b11f);}async['sendTestFrameworkEvent'](_0xda6820){const _0x53d211=a83_0x2a957e,_0x19ae7c={};_0x19ae7c[_0x53d211(0xca)]=function(_0x551c45,_0x210e7c){return _0x551c45===_0x210e7c;},_0x19ae7c['SbjzM']=_0x53d211(0x92);const _0x10c64f=_0x19ae7c;try{const _0x2dd0ab=BrowserstackCLI[_0x53d211(0xa3)]()[_0x53d211(0x97)]()[_0x53d211(0xcc)](_0xda6820);if(!_0x2dd0ab||_0x10c64f[_0x53d211(0xca)](Object[_0x53d211(0xbd)](_0x2dd0ab)['length'],0x0)){this[_0x53d211(0xb1)][_0x53d211(0xe9)](_0x10c64f['SbjzM']);return;}const _0x477499=await GrpcClient['getInstance']()[_0x53d211(0xe1)](_0x2dd0ab);this['logger']['debug'](_0x53d211(0xe8)+_0x2dd0ab[_0x53d211(0xc6)]+_0x53d211(0xbf)+_0x2dd0ab[_0x53d211(0xab)]);}catch(_0x343e41){this['logger'][_0x53d211(0x98)]('Error\x20in\x20sendTestFrameworkEvent:\x20'+util['format'](_0x343e41));}}async[a83_0x2a957e(0xa8)](_0x5f52a4){const _0x1dfeff=a83_0x2a957e,_0x55263a={'epZQL':function(_0x2d2122,_0xaed0de){return _0x2d2122===_0xaed0de;},'PNjVr':function(_0x446c2f,_0xe7f97){return _0x446c2f(_0xe7f97);},'iPSwk':'base64'};try{if(_0x5f52a4[_0x1dfeff(0xba)]){const _0x373046=this[_0x1dfeff(0x9b)](_0x5f52a4);this[_0x1dfeff(0xb1)][_0x1dfeff(0xe9)](_0x1dfeff(0xe7)+_0x373046);let _0x59d540;if(this[_0x1dfeff(0xb3)]&&_0x55263a[_0x1dfeff(0x94)](this[_0x1dfeff(0xb3)][_0x1dfeff(0x95)],FRAMEWORKS[_0x1dfeff(0x9e)]))_0x59d540=_0x373046;else this['testFrameworkData']&&_0x55263a[_0x1dfeff(0x94)](this['testFrameworkData'][_0x1dfeff(0x95)],FRAMEWORKS[_0x1dfeff(0xdf)])?_0x59d540=_0x373046:_0x59d540=TestInfo[_0x1dfeff(0xd4)](_0x5f52a4[_0x1dfeff(0xb6)],_0x5f52a4[_0x1dfeff(0xb6)]['retry']);const _0x20045e=TestInfo[_0x1dfeff(0xa6)](_0x59d540),_0x17692c=TestInfo['getTestDetails'](_0x59d540),_0x22c478=_0x5f52a4[_0x1dfeff(0xaa)],_0x42ae58=AutomationFramework[_0x1dfeff(0xc4)](_0x22c478,PlaywrightDriverModule[_0x1dfeff(0xc3)]),_0x14e13a=_0x17692c[TestFrameworkConstants[_0x1dfeff(0xb4)]]||this[_0x1dfeff(0xb3)]&&this[_0x1dfeff(0xb3)]['name'],_0x416b18=_0x17692c[TestFrameworkConstants[_0x1dfeff(0x9d)]]||this['testFrameworkData']&&this[_0x1dfeff(0xb3)][_0x1dfeff(0xa7)],_0x337c9=TestFrameworkState[_0x1dfeff(0xd3)][_0x1dfeff(0xaf)]()[_0x1dfeff(0x8d)]('.')[0x1],_0x140e42=HookState[_0x1dfeff(0xb5)][_0x1dfeff(0xaf)]()[_0x1dfeff(0x8d)]('.')[0x1],_0x431d29=_0x22c478[_0x1dfeff(0xc8)](),_0x204385=AutomationFramework[_0x1dfeff(0xc4)](_0x22c478,PlaywrightDriverModule['KEY_HUB_URL'],''),_0x1846d4={'provider':_0x55263a['PNjVr'](getPlaywrightProvider,_0x204385),'frameworkName':_0x22c478['frameworkName'],'frameworkVersion':_0x22c478['frameworkVersion'],'frameworkSessionId':AutomationFramework['getState'](_0x22c478,PlaywrightDriverModule['KEY_SESSION_ID'],''),'ref':_0x22c478[_0x1dfeff(0xa9)](),'hubUrl':_0x204385};let _0x39c238=AutomationFramework['getState'](_0x22c478,PlaywrightDriverModule['KEY_CAPABILITIES'],{});_0x39c238=Buffer['from'](JSON['stringify'](_0x39c238))[_0x1dfeff(0xaf)](_0x55263a[_0x1dfeff(0x8e)]);const _0x8f8015={'hash':_0x431d29[_0x1dfeff(0xd1)](),'threadId':_0x431d29[_0x1dfeff(0x91)]()['toString'](),'processId':_0x431d29[_0x1dfeff(0x93)]()[_0x1dfeff(0xaf)]()},_0x4d6c32={};_0x4d6c32['platformIndex']=_0x42ae58,_0x4d6c32[_0x1dfeff(0xa0)]=_0x14e13a,_0x4d6c32['testFrameworkVersion']=_0x416b18,_0x4d6c32['testFrameworkState']=_0x337c9,_0x4d6c32[_0x1dfeff(0xc9)]=_0x140e42,_0x4d6c32[_0x1dfeff(0xbc)]=_0x20045e,_0x4d6c32[_0x1dfeff(0xd8)]=_0x1846d4,_0x4d6c32['capabilities']=_0x39c238,_0x4d6c32[_0x1dfeff(0xb2)]=_0x8f8015;const _0x9954c6=_0x4d6c32;this[_0x1dfeff(0xb1)][_0x1dfeff(0xe9)](_0x1dfeff(0xa5)+util[_0x1dfeff(0x8c)](_0x9954c6));const _0x39e844=await GrpcClient[_0x1dfeff(0xa3)]()[_0x1dfeff(0xc0)](_0x9954c6);this[_0x1dfeff(0xb1)]['debug'](_0x1dfeff(0x99)+_0x373046);}}catch(_0x55b140){this['logger'][_0x1dfeff(0x98)](_0x1dfeff(0xe6)+util[_0x1dfeff(0x8c)](_0x55b140));}}}function a83_0x5034(){const _0x2b31d4=['obolV','../grpcClient.js','getThreadId','sendTestFrameworkEvent:\x20No\x20payload\x20created,\x20skipping\x20test\x20framework\x20event','getProcessId','epZQL','name','18720AdbnfA','getTestFramework','error','onPageCreate\x20CBTSession\x20complete\x20for\x20testId:\x20','157953wDvOYz','getTestId','getCurrentTestState','KEY_TEST_FRAMEWORK_VERSION','CUCUMBER','util','testFrameworkName','CREATE','testhubConfig','getInstance','../TestInfo.js','onPageCreate\x20CBTSession\x20payload:\x20','getTestUUID','version','onPageCreate','getRef','instance','hookState','../framework/automationFramework.js','BROWSERSTACK_TESTHUB_UUID','../../../helpers/classLogger.js','toString','exports','logger','executionContext','testFrameworkData','KEY_TEST_FRAMEWORK_NAME','POST','testInfo','162kXFpbW','../state/hookState.js','5329786BqprLN','page','MODULE_NAME','testUuid','keys','bind','\x20hookState:\x20','testSessionEvent','TestHubModule','KEY_TEST_DEFERRED','KEY_PLATFORM_INDEX','getState','LFFCv','testFrameworkState','values','getContext','testHookState','AlEMl','66wWuJym','createTestFrameworkEventPayload','sendTestFrameworkEvent','forEach','ENV_VAR','0|2|1|5|6|3|4|7','getId','72888AgWYpb','TEST','getTestIdentifierFromTestInfo','onAllTestEvents','78438sdeVVn','../../../helpers/helper.js','automationSession','../cliUtils.js','385DFnKrs','matchHookRegex','2590296qxoLYm','registerObserver','../framework/testFramework.js','JEST','./playwrightDriverModule.js','testFrameworkEvent','mrNvm','316200TnmmPR','../state/automationFrameworkState.js','getBuildHashedId','Error\x20in\x20sending\x20CBTSession:\x20','onPageCreate\x20Sending\x20CBT\x20for\x20testId:\x20','sendTestFrameworkEvent\x20complete\x20for\x20testState:\x20','debug','format','split','iPSwk'];a83_0x5034=function(){return _0x2b31d4;};return a83_0x5034();}TestHubModule[a83_0x2a957e(0xbb)]=a83_0x2a957e(0xc1),TestHubModule[a83_0x2a957e(0xc2)]='test_deferred',module[a83_0x2a957e(0xb0)]=TestHubModule;