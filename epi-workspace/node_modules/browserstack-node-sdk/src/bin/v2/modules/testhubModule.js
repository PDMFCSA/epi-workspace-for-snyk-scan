const a85_0x367cbd=a85_0x2b51;(function(_0x34ee2c,_0x37f4f4){const _0x1d2299=a85_0x2b51,_0x3f835c=_0x34ee2c();while(!![]){try{const _0x249dc2=-parseInt(_0x1d2299(0x16f))/0x1*(parseInt(_0x1d2299(0x199))/0x2)+parseInt(_0x1d2299(0x151))/0x3+parseInt(_0x1d2299(0x197))/0x4*(parseInt(_0x1d2299(0x149))/0x5)+parseInt(_0x1d2299(0x172))/0x6*(-parseInt(_0x1d2299(0x191))/0x7)+-parseInt(_0x1d2299(0x187))/0x8*(-parseInt(_0x1d2299(0x17e))/0x9)+-parseInt(_0x1d2299(0x157))/0xa+-parseInt(_0x1d2299(0x16e))/0xb*(parseInt(_0x1d2299(0x142))/0xc);if(_0x249dc2===_0x37f4f4)break;else _0x3f835c['push'](_0x3f835c['shift']());}catch(_0x1bbe2d){_0x3f835c['push'](_0x3f835c['shift']());}}}(a85_0x3538,0xdbb0f));const util=require(a85_0x367cbd(0x156)),BaseModule=require(a85_0x367cbd(0x163)),{createClassLogger}=require(a85_0x367cbd(0x13a)),AutomationFramework=require(a85_0x367cbd(0x159)),AutomationFrameworkState=require(a85_0x367cbd(0x13f)),HookState=require(a85_0x367cbd(0x140)),TestFramework=require(a85_0x367cbd(0x171)),TestFrameworkState=require('../state/testFrameworkState.js'),PlaywrightDriverModule=require(a85_0x367cbd(0x16c)),TestFrameworkConstants=require(a85_0x367cbd(0x168)),GrpcClient=require('../grpcClient.js'),CLIUtils=require(a85_0x367cbd(0x16d)),TestInfo=require('../TestInfo.js'),testHubConstants=require(a85_0x367cbd(0x13e)),{FRAMEWORKS}=require(a85_0x367cbd(0x19a)),helper=require('../../../helpers/helper.js'),LoadTestModule=require(a85_0x367cbd(0x19d)),JestUtils=require('../utils/jest-utils.js'),BrowserstackCLI=require(a85_0x367cbd(0x177)),{getPlaywrightProvider}=require(a85_0x367cbd(0x190));class TestHubModule extends BaseModule{[a85_0x367cbd(0x137)]=createClassLogger('TestHubModule');constructor(_0x1618ff,_0x1c6cf9=null){const _0x1ab2ee=a85_0x367cbd,_0x3192cf={};_0x3192cf[_0x1ab2ee(0x138)]='0|3|4|6|1|8|2|5|7',_0x3192cf['hScoA']=_0x1ab2ee(0x17c);const _0x1ad09c=_0x3192cf,_0x5ac1ab=_0x1ad09c['hlgCN'][_0x1ab2ee(0x14b)]('|');let _0x504fba=0x0;while(!![]){switch(_0x5ac1ab[_0x504fba++]){case'0':super(_0x1c6cf9);continue;case'1':AutomationFramework[_0x1ab2ee(0x176)](AutomationFrameworkState[_0x1ab2ee(0x17f)],HookState[_0x1ab2ee(0x179)],this[_0x1ab2ee(0x175)]['bind'](this));continue;case'2':process[_0x1ab2ee(0x17a)][testHubConstants[_0x1ab2ee(0x13c)][_0x1ab2ee(0x165)]]=this[_0x1ab2ee(0x155)][_0x1ab2ee(0x178)]();continue;case'3':this[_0x1ab2ee(0x188)]=_0x1ad09c['hScoA'];continue;case'4':this[_0x1ab2ee(0x155)]=_0x1618ff;continue;case'5':process[_0x1ab2ee(0x17a)][testHubConstants[_0x1ab2ee(0x13c)][_0x1ab2ee(0x18f)]]=this[_0x1ab2ee(0x155)][_0x1ab2ee(0x15f)]();continue;case'6':this['jestUtils']=new JestUtils();continue;case'7':BrowserstackCLI[_0x1ab2ee(0x13d)]=this[_0x1ab2ee(0x155)][_0x1ab2ee(0x15f)]();continue;case'8':Object[_0x1ab2ee(0x146)](TestFrameworkState)[_0x1ab2ee(0x143)](_0x4a2857=>{const _0x390a43=_0x1ab2ee;Object[_0x390a43(0x146)](HookState)[_0x390a43(0x143)](_0x241b76=>{const _0x256752=_0x390a43;TestFramework[_0x256752(0x176)](_0x4a2857,_0x241b76,this[_0x256752(0x180)][_0x256752(0x141)](this));});});continue;}break;}}[a85_0x367cbd(0x169)](){const _0x3be34d=a85_0x367cbd;return TestHubModule[_0x3be34d(0x166)];}[a85_0x367cbd(0x180)](_0x565fd9){const _0x4144e1=a85_0x367cbd,_0x1a35be={};_0x1a35be[_0x4144e1(0x14a)]=function(_0x1fbff6,_0x44d516){return _0x1fbff6===_0x44d516;};const _0x4683a4=_0x1a35be,_0x298b97=_0x565fd9['instance'],_0x2ea0d0=_0x298b97[_0x4144e1(0x17d)]();(_0x4683a4[_0x4144e1(0x14a)](_0x2ea0d0,TestFrameworkState[_0x4144e1(0x19b)])||CLIUtils[_0x4144e1(0x198)](_0x2ea0d0['toString']()[_0x4144e1(0x14b)]('.')[0x1]))&&this[_0x4144e1(0x184)](_0x565fd9);}async['sendTestFrameworkEvent'](_0x3c3370){const _0x5b09e8=a85_0x367cbd,_0x5c54ef={};_0x5c54ef[_0x5b09e8(0x160)]=function(_0x39f443,_0x4dd12b){return _0x39f443===_0x4dd12b;},_0x5c54ef[_0x5b09e8(0x150)]=_0x5b09e8(0x144);const _0x47a0e4=_0x5c54ef;try{const _0x543ba0=BrowserstackCLI[_0x5b09e8(0x186)]()['getTestFramework']()[_0x5b09e8(0x17b)](_0x3c3370);if(!_0x543ba0||_0x47a0e4[_0x5b09e8(0x160)](Object['keys'](_0x543ba0)['length'],0x0)){this['logger']['debug'](_0x47a0e4[_0x5b09e8(0x150)]);return;}const _0x372fa0=await GrpcClient[_0x5b09e8(0x186)]()[_0x5b09e8(0x154)](_0x543ba0);this['logger']['debug'](_0x5b09e8(0x18b)+_0x543ba0[_0x5b09e8(0x161)]+_0x5b09e8(0x193)+_0x543ba0[_0x5b09e8(0x134)]);}catch(_0xd41e7a){this[_0x5b09e8(0x137)]['error']('Error\x20in\x20sendTestFrameworkEvent:\x20'+util[_0x5b09e8(0x16b)](_0xd41e7a));}}async[a85_0x367cbd(0x175)](_0x1965ec){const _0x2d67a7=a85_0x367cbd,_0x28e8b2={'HkFOH':function(_0x120b7a,_0x188870){return _0x120b7a===_0x188870;},'xtiyP':_0x2d67a7(0x181),'aRaJS':function(_0x5e92fa,_0x3ad0b6){return _0x5e92fa===_0x3ad0b6;},'HfPMM':function(_0x67d1c1,_0xd03704){return _0x67d1c1(_0xd03704);},'zwwzI':_0x2d67a7(0x19c),'EsICW':function(_0x2e3c99,_0xa87969){return _0x2e3c99===_0xa87969;}};try{if(_0x1965ec['page']){const _0x1279a0=this[_0x2d67a7(0x18c)](_0x1965ec);this[_0x2d67a7(0x137)][_0x2d67a7(0x13b)](_0x2d67a7(0x183)+_0x1279a0);if(this[_0x2d67a7(0x170)]&&_0x28e8b2[_0x2d67a7(0x167)](this[_0x2d67a7(0x170)][_0x2d67a7(0x188)],FRAMEWORKS[_0x2d67a7(0x16a)])&&!_0x1965ec[_0x2d67a7(0x182)]){this[_0x2d67a7(0x137)][_0x2d67a7(0x13b)](_0x28e8b2[_0x2d67a7(0x158)]);return;}let _0x820d4e,_0x115ef7;if(this[_0x2d67a7(0x170)]&&_0x28e8b2[_0x2d67a7(0x167)](this[_0x2d67a7(0x170)]['name'],FRAMEWORKS['CUCUMBER']))_0x820d4e=_0x1279a0,_0x115ef7=TestInfo[_0x2d67a7(0x152)](_0x820d4e);else this[_0x2d67a7(0x170)]&&_0x28e8b2['aRaJS'](this[_0x2d67a7(0x170)][_0x2d67a7(0x188)],FRAMEWORKS[_0x2d67a7(0x16a)])?(_0x820d4e=this[_0x2d67a7(0x194)][_0x2d67a7(0x15c)](_0x1965ec[_0x2d67a7(0x182)]),this['logger'][_0x2d67a7(0x13b)](_0x2d67a7(0x15a)+_0x820d4e)):(_0x820d4e=TestInfo['getTestIdentifierFromTestInfo'](_0x1965ec[_0x2d67a7(0x182)],_0x1965ec[_0x2d67a7(0x182)][_0x2d67a7(0x15d)]),_0x115ef7=TestInfo[_0x2d67a7(0x152)](_0x820d4e));const _0x293c8b=TestInfo['getTestDetails'](_0x820d4e),_0x4c40ca=_0x1965ec[_0x2d67a7(0x174)],_0xfe84d2=AutomationFramework['getState'](_0x4c40ca,PlaywrightDriverModule['KEY_PLATFORM_INDEX']),_0x15321d=_0x293c8b?.[TestFrameworkConstants['KEY_TEST_FRAMEWORK_NAME']]||this[_0x2d67a7(0x170)]&&this[_0x2d67a7(0x170)][_0x2d67a7(0x188)],_0x1e3927=_0x293c8b?.[TestFrameworkConstants[_0x2d67a7(0x14c)]]||this[_0x2d67a7(0x170)]&&this[_0x2d67a7(0x170)]['version'],_0x462390=TestFrameworkState['TEST'][_0x2d67a7(0x189)]()[_0x2d67a7(0x14b)]('.')[0x1],_0x10ed22=HookState[_0x2d67a7(0x179)][_0x2d67a7(0x189)]()[_0x2d67a7(0x14b)]('.')[0x1],_0x2d9907=_0x4c40ca[_0x2d67a7(0x195)](),_0x4089cf=AutomationFramework[_0x2d67a7(0x14d)](_0x4c40ca,PlaywrightDriverModule['KEY_HUB_URL'],''),_0x178946={'provider':_0x28e8b2[_0x2d67a7(0x147)](getPlaywrightProvider,_0x4089cf),'frameworkName':_0x4c40ca[_0x2d67a7(0x18e)],'frameworkVersion':_0x4c40ca[_0x2d67a7(0x18a)],'frameworkSessionId':LoadTestModule[_0x2d67a7(0x153)]()?LoadTestModule['getLTSSessionId']():AutomationFramework[_0x2d67a7(0x14d)](_0x4c40ca,PlaywrightDriverModule[_0x2d67a7(0x173)],''),'ref':_0x4c40ca[_0x2d67a7(0x15b)](),'hubUrl':_0x4089cf};let _0x5f03f8=AutomationFramework[_0x2d67a7(0x14d)](_0x4c40ca,PlaywrightDriverModule[_0x2d67a7(0x139)],{});_0x5f03f8=Buffer[_0x2d67a7(0x185)](JSON[_0x2d67a7(0x135)](_0x5f03f8))[_0x2d67a7(0x189)](_0x28e8b2[_0x2d67a7(0x196)]);const _0x58e897={'hash':_0x2d9907[_0x2d67a7(0x148)](),'threadId':_0x2d9907[_0x2d67a7(0x14e)]()[_0x2d67a7(0x189)](),'processId':_0x2d9907['getProcessId']()[_0x2d67a7(0x189)]()},_0x1189b1={};_0x1189b1[_0x2d67a7(0x18d)]=_0x820d4e;const _0x32189c={};_0x32189c['testUuid']=_0x115ef7;const _0x552464={'platformIndex':_0xfe84d2,'testFrameworkName':_0x15321d,'testFrameworkVersion':_0x1e3927,'testFrameworkState':_0x462390,'testHookState':_0x10ed22,...this['testFrameworkData']&&_0x28e8b2[_0x2d67a7(0x167)](this['testFrameworkData'][_0x2d67a7(0x188)],FRAMEWORKS[_0x2d67a7(0x16a)])?_0x1189b1:_0x32189c,'automationSession':_0x178946,'capabilities':_0x5f03f8,'executionContext':_0x58e897};this['logger'][_0x2d67a7(0x13b)](_0x2d67a7(0x192)+util[_0x2d67a7(0x16b)](_0x552464));const _0x148983=await GrpcClient[_0x2d67a7(0x186)]()[_0x2d67a7(0x15e)](_0x552464);this[_0x2d67a7(0x137)][_0x2d67a7(0x13b)](_0x2d67a7(0x14f)+_0x1279a0+(this['testFrameworkData']&&_0x28e8b2[_0x2d67a7(0x164)](this[_0x2d67a7(0x170)][_0x2d67a7(0x188)],FRAMEWORKS[_0x2d67a7(0x16a)])?_0x2d67a7(0x162)+_0x820d4e:''));}}catch(_0x91a951){this[_0x2d67a7(0x137)]['error'](_0x2d67a7(0x145)+util[_0x2d67a7(0x16b)](_0x91a951));}}}TestHubModule[a85_0x367cbd(0x166)]='TestHubModule',TestHubModule[a85_0x367cbd(0x136)]='test_deferred',module['exports']=TestHubModule;function a85_0x2b51(_0x6aea49,_0x73e7cf){const _0x3538d9=a85_0x3538();return a85_0x2b51=function(_0x2b5147,_0x48b097){_0x2b5147=_0x2b5147-0x134;let _0x5b8697=_0x3538d9[_0x2b5147];return _0x5b8697;},a85_0x2b51(_0x6aea49,_0x73e7cf);}function a85_0x3538(){const _0x391c1b=['getRef','recreateIdentifierFromTestInfo','retry','testSessionEvent','getBuildHashedId','kPOab','testFrameworkState',',\x20test_identifier:\x20','./baseModule','EsICW','BROWSERSTACK_TESTHUB_JWT','MODULE_NAME','HkFOH','../framework/constants/testFrameworkConstants.js','getModuleName','JEST','format','./playwrightDriverModule.js','../cliUtils.js','132MJAMpx','10719FAYUOK','testFrameworkData','../framework/testFramework.js','734544LwRzoR','KEY_SESSION_ID','instance','onPageCreate','registerObserver','../browserstackCLI.js','getJwt','POST','env','createTestFrameworkEventPayload','TestHubModule','getCurrentTestState','1224099SBtrgC','CREATE','onAllTestEvents','onPageCreate:\x20Skipping\x20CBT\x20session\x20event\x20-\x20no\x20testInfo\x20(page\x20created\x20outside\x20test\x20context)','testInfo','onPageCreate\x20Sending\x20CBT\x20for\x20testId:\x20','sendTestFrameworkEvent','from','getInstance','72tIxzmP','name','toString','frameworkVersion','sendTestFrameworkEvent\x20complete\x20for\x20testState:\x20','getTestId','test_identifier','frameworkName','BROWSERSTACK_TESTHUB_UUID','../../../helpers/helper.js','14DfwqTv','onPageCreate\x20CBTSession\x20payload:\x20','\x20hookState:\x20','jestUtils','getContext','zwwzI','634152dYryYi','matchHookRegex','96gPTkjz','../../../helpers/test-observability/constants.js','TEST','base64','./loadTestModule.js','hookState','stringify','KEY_TEST_DEFERRED','logger','hlgCN','KEY_CAPABILITIES','../../../helpers/classLogger.js','debug','ENV_VAR','O11yHashedID','../../../helpers/testhub/constants','../state/automationFrameworkState.js','../state/hookState.js','bind','294984qLnqiB','forEach','sendTestFrameworkEvent:\x20No\x20payload\x20created,\x20skipping\x20test\x20framework\x20event','Error\x20in\x20sending\x20CBTSession:\x20','values','HfPMM','getId','45GLCHGZ','vlpCI','split','KEY_TEST_FRAMEWORK_VERSION','getState','getThreadId','onPageCreate\x20CBTSession\x20complete\x20for\x20testId:\x20','tWwuq','2136831FDPfKl','getTestUUID','isLTSSession','testFrameworkEvent','testhubConfig','util','14090190GiqHxP','xtiyP','../framework/automationFramework.js','onPageCreate:\x20Recreated\x20Jest\x20testIdentifier:\x20'];a85_0x3538=function(){return _0x391c1b;};return a85_0x3538();}