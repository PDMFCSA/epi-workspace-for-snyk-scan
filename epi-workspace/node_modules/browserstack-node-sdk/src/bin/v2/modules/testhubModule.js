const a78_0x1d1256=a78_0x1cca;(function(_0x355d5f,_0x53f10f){const _0x2c5ce0=a78_0x1cca,_0x34bf46=_0x355d5f();while(!![]){try{const _0x252cbb=parseInt(_0x2c5ce0(0x1fa))/0x1*(-parseInt(_0x2c5ce0(0x1c0))/0x2)+parseInt(_0x2c5ce0(0x1f2))/0x3*(parseInt(_0x2c5ce0(0x208))/0x4)+-parseInt(_0x2c5ce0(0x205))/0x5*(-parseInt(_0x2c5ce0(0x1c2))/0x6)+parseInt(_0x2c5ce0(0x1f0))/0x7*(parseInt(_0x2c5ce0(0x21d))/0x8)+parseInt(_0x2c5ce0(0x212))/0x9+parseInt(_0x2c5ce0(0x1e7))/0xa*(parseInt(_0x2c5ce0(0x1be))/0xb)+-parseInt(_0x2c5ce0(0x1f4))/0xc;if(_0x252cbb===_0x53f10f)break;else _0x34bf46['push'](_0x34bf46['shift']());}catch(_0x4f153a){_0x34bf46['push'](_0x34bf46['shift']());}}}(a78_0x5d75,0x5f73b));const util=require('util'),BaseModule=require(a78_0x1d1256(0x204)),{createClassLogger}=require(a78_0x1d1256(0x1bd)),AutomationFramework=require(a78_0x1d1256(0x218)),AutomationFrameworkState=require(a78_0x1d1256(0x1cb)),HookState=require(a78_0x1d1256(0x220)),TestFramework=require('../framework/testFramework.js'),TestFrameworkState=require(a78_0x1d1256(0x1f5)),PlaywrightDriverModule=require(a78_0x1d1256(0x1f9)),TestFrameworkConstants=require(a78_0x1d1256(0x20e)),GrpcClient=require(a78_0x1d1256(0x1c9)),CLIUtils=require(a78_0x1d1256(0x1d4)),TestInfo=require('../TestInfo.js'),testHubConstants=require('../../../helpers/testhub/constants'),BrowserstackCLI=require(a78_0x1d1256(0x1cc)),{getPlaywrightProvider}=require(a78_0x1d1256(0x21b)),{getTestRunIdentifier}=require(a78_0x1d1256(0x201));function a78_0x1cca(_0x36d18f,_0x989b20){const _0x5d7508=a78_0x5d75();return a78_0x1cca=function(_0x1cca6d,_0x44afad){_0x1cca6d=_0x1cca6d-0x1b8;let _0x5603d5=_0x5d7508[_0x1cca6d];return _0x5603d5;},a78_0x1cca(_0x36d18f,_0x989b20);}function a78_0x5d75(){const _0xadd2ca=['registerObserver','88PXRBgQ','getModuleName','testFrameworkName','../state/hookState.js','__workerDetails','sendTestFrameworkEvent','hookState','stringify','split','../../../helpers/classLogger.js','11mdKbrV','wJtKI','8566LCsCvp','matchHookRegex','6810OIDPlb','getThreadId','retry','name','getId','platformIndex','getTestUUID','../grpcClient.js','BROWSERSTACK_TESTHUB_JWT','../state/automationFrameworkState.js','../browserstackCLI.js','error','getContext','eventJson','capabilities','POST','BROWSERSTACK_TESTHUB_UUID','format','../cliUtils.js','onPageCreate','testFrameworkState','bind','parallelIndex','CREATE','workerInfo','getState','getCurrentTestState','TEST','env','debug','sendTestFrameworkEvent\x20testId:\x20','uuid','testSessionEvent','result','getAllData','Facle','onAllTestEvents','58510BAmdUw','get','KEY_TEST_FRAMEWORK_VERSION','Error\x20in\x20sending\x20CBTSession:\x20','getTestIdentifierFromTestInfo','tYKCX','onPageCreate\x20CBTSession\x20complete\x20for\x20testId:\x20','KEY_SESSION_ID','toString','456785GBYZTk','KEY_HUB_URL','6PQZDgx','onPageCreate\x20CBTSession\x20payload:\x20','20962668wxQIOD','../state/testFrameworkState.js','dkUis','getTestDetails','KEY_PLATFORM_INDEX','./playwrightDriverModule.js','31gcqHuK','testId','onPageCreate\x20Sending\x20CBT\x20for\x20testId:\x20','testUuid','KEY_TEST_DEFERRED','endedAt','getBuildHashedId','../../playwright/reporter/pwUtils.js','TestHubModule','getProcessId','./baseModule','2535MaGgOa','instance','testInfo','830624wIIDDG','logger','frameworkName','base64','getInstance','KpqWY','../framework/constants/testFrameworkConstants.js','executionContext','hMSOg','MODULE_NAME','5005980sqRFQd','forEach','testhubConfig','ENV_VAR','KEY_TEST_STARTED_AT','values','../framework/automationFramework.js','testFrameworkVersion','test','../../../helpers/helper.js'];a78_0x5d75=function(){return _0xadd2ca;};return a78_0x5d75();}class TestHubModule extends BaseModule{[a78_0x1d1256(0x209)]=createClassLogger(a78_0x1d1256(0x202));constructor(_0x57b5c4){const _0x587956=a78_0x1d1256,_0x1b9912={};_0x1b9912[_0x587956(0x1ec)]='5|6|2|7|1|0|3|4',_0x1b9912['KpqWY']='TestHubModule';const _0x204831=_0x1b9912,_0xedac94=_0x204831['tYKCX'][_0x587956(0x1bc)]('|');let _0x87405d=0x0;while(!![]){switch(_0xedac94[_0x87405d++]){case'0':process[_0x587956(0x1de)][testHubConstants[_0x587956(0x215)][_0x587956(0x1ca)]]=this[_0x587956(0x214)]['getJwt']();continue;case'1':Object['values'](TestFrameworkState)[_0x587956(0x213)](_0x1db6ff=>{const _0x5802a9=_0x587956;Object[_0x5802a9(0x217)](HookState)[_0x5802a9(0x213)](_0x48ebc7=>{const _0x551053=_0x5802a9;TestFramework[_0x551053(0x21c)](_0x1db6ff,_0x48ebc7,this['onAllTestEvents']['bind'](this));});});continue;case'2':this[_0x587956(0x214)]=_0x57b5c4;continue;case'3':process[_0x587956(0x1de)][testHubConstants[_0x587956(0x215)][_0x587956(0x1d2)]]=this[_0x587956(0x214)][_0x587956(0x200)]();continue;case'4':BrowserstackCLI['O11yHashedID']=this[_0x587956(0x214)]['getBuildHashedId']();continue;case'5':super();continue;case'6':this[_0x587956(0x1c5)]=_0x204831[_0x587956(0x20d)];continue;case'7':AutomationFramework[_0x587956(0x21c)](AutomationFrameworkState[_0x587956(0x1d9)],HookState[_0x587956(0x1d1)],this[_0x587956(0x1d5)][_0x587956(0x1d7)](this));continue;}break;}}[a78_0x1d1256(0x21e)](){return TestHubModule['MODULE_NAME'];}[a78_0x1d1256(0x1e6)](_0x232cca){const _0x1675b7=a78_0x1d1256,_0x931432={};_0x931432[_0x1675b7(0x1e5)]=function(_0x5f5c4c,_0x3e75c1){return _0x5f5c4c===_0x3e75c1;};const _0x31e404=_0x931432,_0xabb42a=_0x232cca[_0x1675b7(0x206)],_0x58e657=_0xabb42a[_0x1675b7(0x1dc)]();(_0x31e404[_0x1675b7(0x1e5)](_0x58e657,TestFrameworkState[_0x1675b7(0x1dd)])||CLIUtils[_0x1675b7(0x1c1)](_0x58e657[_0x1675b7(0x1ef)]()[_0x1675b7(0x1bc)]('.')[0x1]))&&this[_0x1675b7(0x1b9)](_0x232cca);}async[a78_0x1d1256(0x1b9)](_0x4d437e){const _0x432914=a78_0x1d1256,_0xc5402b={'dENeg':function(_0x3a91fa,_0x4b0fad,_0x5ad1a7){return _0x3a91fa(_0x4b0fad,_0x5ad1a7);},'dkUis':_0x432914(0x20b)};try{const _0xb62e37=_0x4d437e[_0x432914(0x21a)]['id'],_0x2247cd=_0xc5402b['dENeg'](getTestRunIdentifier,_0x4d437e['test'],_0x4d437e[_0x432914(0x1e3)][_0x432914(0x1c4)]),_0x157633=_0x4d437e['instance'],_0x3b6749=_0x157633[_0x432914(0x1ce)](),_0x2ccfc0=_0x157633[_0x432914(0x1e4)]()[_0x432914(0x1e8)](_0x2247cd);this[_0x432914(0x209)][_0x432914(0x1df)](_0x432914(0x1e0)+_0xb62e37);const {[TestFrameworkConstants['KEY_TEST_FRAMEWORK_NAME']]:_0x1d4f20='',[TestFrameworkConstants[_0x432914(0x1e9)]]:_0x211d99='',[TestFrameworkConstants[_0x432914(0x216)]]:_0x23674f='',[TestFrameworkConstants['KEY_TEST_ENDED_AT']]:_0x53928d=''}=_0x2ccfc0,_0x486120=_0x157633[_0x432914(0x1dc)]()['toString']()['split']('.')[0x1],_0x148b8c=_0x157633['getCurrentHookState']()[_0x432914(0x1ef)]()[_0x432914(0x1bc)]('.')[0x1],_0x3b0e5c=global?.[_0x432914(0x1b8)]?.[_0x432914(0x1da)]?.[_0x432914(0x1d8)];;const _0x496f66=_0x157633['getRef'](),_0x2b73ab=Buffer['from'](JSON[_0x432914(0x1bb)](_0x2ccfc0))[_0x432914(0x1ef)](_0xc5402b[_0x432914(0x1f6)]),_0x5a8c7a={'hash':_0x3b6749['getId'](),'threadId':_0x3b6749[_0x432914(0x1c3)]()[_0x432914(0x1ef)](),'processId':_0x3b6749['getProcessId']()['toString']()},_0x32d1bf={};_0x32d1bf[_0x432914(0x1c7)]=_0x3b0e5c,_0x32d1bf[_0x432914(0x21f)]=_0x1d4f20,_0x32d1bf[_0x432914(0x219)]=_0x211d99,_0x32d1bf['testFrameworkState']=_0x486120,_0x32d1bf[_0x432914(0x1ba)]=_0x148b8c,_0x32d1bf['startedAt']=_0x23674f,_0x32d1bf[_0x432914(0x1ff)]=_0x53928d,_0x32d1bf[_0x432914(0x1e1)]=_0x496f66,_0x32d1bf[_0x432914(0x1cf)]=_0x2b73ab,_0x32d1bf[_0x432914(0x20f)]=_0x5a8c7a;const _0x58f7e3=_0x32d1bf,_0xb9ce2c=await GrpcClient['getInstance']()['testFrameworkEvent'](_0x58f7e3);this[_0x432914(0x209)]['debug']('sendTestFrameworkEvent\x20complete\x20for\x20testId:\x20'+_0xb62e37+'\x20testState:\x20'+_0x486120+'\x20hookState:\x20'+_0x148b8c);}catch(_0x3d28cd){this[_0x432914(0x209)][_0x432914(0x1cd)]('Error\x20in\x20sendTestFrameworkEvent:\x20'+util[_0x432914(0x1d3)](_0x3d28cd));}}async[a78_0x1d1256(0x1d5)](_0x1fcb49){const _0x33b4c3=a78_0x1d1256,_0x1c51b={'wJtKI':function(_0x385dbb,_0x47bb46){return _0x385dbb(_0x47bb46);},'hMSOg':_0x33b4c3(0x20b)};try{if(_0x1fcb49['page']){const _0x1960f0=_0x1fcb49[_0x33b4c3(0x207)][_0x33b4c3(0x1fb)];this[_0x33b4c3(0x209)][_0x33b4c3(0x1df)](_0x33b4c3(0x1fc)+_0x1960f0);const _0x46591e=TestInfo[_0x33b4c3(0x1eb)](_0x1fcb49['testInfo'],_0x1fcb49[_0x33b4c3(0x207)][_0x33b4c3(0x1c4)]),_0x56f306=TestInfo[_0x33b4c3(0x1c8)](_0x46591e),_0x37c453=TestInfo[_0x33b4c3(0x1f7)](_0x46591e),_0x28c96e=_0x1fcb49[_0x33b4c3(0x206)],_0x49278f=AutomationFramework['getState'](_0x28c96e,PlaywrightDriverModule[_0x33b4c3(0x1f8)]),_0x2635bf=_0x37c453[TestFrameworkConstants['KEY_TEST_FRAMEWORK_NAME']],_0x2282f9=_0x37c453[TestFrameworkConstants[_0x33b4c3(0x1e9)]],_0x5ba843=TestFrameworkState[_0x33b4c3(0x1dd)][_0x33b4c3(0x1ef)]()[_0x33b4c3(0x1bc)]('.')[0x1],_0x54ba91=HookState['POST'][_0x33b4c3(0x1ef)]()[_0x33b4c3(0x1bc)]('.')[0x1],_0xef5c6a=_0x28c96e[_0x33b4c3(0x1ce)](),_0x5fd274=AutomationFramework[_0x33b4c3(0x1db)](_0x28c96e,PlaywrightDriverModule[_0x33b4c3(0x1f1)],''),_0x1951bd={'provider':_0x1c51b[_0x33b4c3(0x1bf)](getPlaywrightProvider,_0x5fd274),'frameworkName':_0x28c96e[_0x33b4c3(0x20a)],'frameworkVersion':_0x28c96e['frameworkVersion'],'frameworkSessionId':AutomationFramework[_0x33b4c3(0x1db)](_0x28c96e,PlaywrightDriverModule[_0x33b4c3(0x1ee)],''),'ref':_0x28c96e['getRef'](),'hubUrl':_0x5fd274};let _0x3be942=AutomationFramework[_0x33b4c3(0x1db)](_0x28c96e,PlaywrightDriverModule['KEY_CAPABILITIES'],{});_0x3be942=Buffer['from'](JSON['stringify'](_0x3be942))[_0x33b4c3(0x1ef)](_0x1c51b[_0x33b4c3(0x210)]);const _0x569a24={'hash':_0xef5c6a[_0x33b4c3(0x1c6)](),'threadId':_0xef5c6a[_0x33b4c3(0x1c3)]()[_0x33b4c3(0x1ef)](),'processId':_0xef5c6a[_0x33b4c3(0x203)]()[_0x33b4c3(0x1ef)]()},_0x1d35f6={};_0x1d35f6[_0x33b4c3(0x1c7)]=_0x49278f,_0x1d35f6[_0x33b4c3(0x21f)]=_0x2635bf,_0x1d35f6[_0x33b4c3(0x219)]=_0x2282f9,_0x1d35f6[_0x33b4c3(0x1d6)]=_0x5ba843,_0x1d35f6['testHookState']=_0x54ba91,_0x1d35f6[_0x33b4c3(0x1fd)]=_0x56f306,_0x1d35f6['automationSession']=_0x1951bd,_0x1d35f6[_0x33b4c3(0x1d0)]=_0x3be942,_0x1d35f6[_0x33b4c3(0x20f)]=_0x569a24;const _0x225a7b=_0x1d35f6;this['logger'][_0x33b4c3(0x1df)](_0x33b4c3(0x1f3)+util[_0x33b4c3(0x1d3)](_0x225a7b));const _0x1cfe5b=await GrpcClient[_0x33b4c3(0x20c)]()[_0x33b4c3(0x1e2)](_0x225a7b);this[_0x33b4c3(0x209)]['debug'](_0x33b4c3(0x1ed)+_0x1960f0);}}catch(_0x24c6bd){this[_0x33b4c3(0x209)][_0x33b4c3(0x1cd)](_0x33b4c3(0x1ea)+util['format'](_0x24c6bd));}}}TestHubModule[a78_0x1d1256(0x211)]=a78_0x1d1256(0x202),TestHubModule[a78_0x1d1256(0x1fe)]='test_deferred',module['exports']=TestHubModule;