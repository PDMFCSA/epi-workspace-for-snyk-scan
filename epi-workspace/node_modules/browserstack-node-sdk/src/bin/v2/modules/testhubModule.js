const a73_0x25cb6e=a73_0x2ee5;function a73_0x3bf5(){const _0x702e1a=['base64','O11yHashedID','../../../helpers/helper.js','../../../helpers/classLogger.js','capabilities','testSessionEvent','endedAt','../state/hookState.js','values','forEach','toString','MODULE_NAME','../cliUtils.js','getProcessId','onPageCreate','onAllTestEvents','\x20hookState:\x20','onPageCreate\x20Sending\x20CBT\x20for\x20testId:\x20','468228RgvcBb','113016zBVSbS','sendTestFrameworkEvent\x20testId:\x20','24552zryEvT','../browserstackCLI.js','test','BROWSERSTACK_TESTHUB_UUID','format','stringify','CREATE','77frrrMP','nJSCQ','ScmSG','registerObserver','logger','qibNX','KEY_SESSION_ID','getCurrentTestState','KEY_TEST_FRAMEWORK_NAME','getTestDetails','env','debug','getThreadId','sendTestFrameworkEvent\x20complete\x20for\x20testId:\x20','2173310QfZiTx','./playwrightDriverModule.js','./baseModule','getState','../TestInfo.js','exports','matchHookRegex','frameworkVersion','\x20testState:\x20','testId','error','startedAt','parallelIndex','getCurrentHookState','getRef','from','kEamf','getContext','TEST','testFrameworkEvent','108iymtIs','240705OSgQBf','2090OIxpNc','getJwt','POST','testFrameworkVersion','name','../grpcClient.js','133KWeiLd','getTestUUID','page','309872obUuka','BvZnu','TestHubModule','AZRZY','bind','getInstance','../framework/testFramework.js','Error\x20in\x20sending\x20CBTSession:\x20','onPageCreate\x20CBTSession\x20complete\x20for\x20testId:\x20','split','workerInfo','getBuildHashedId','../state/testFrameworkState.js','util','testhubConfig','automationSession','testHookState','test_deferred','sendTestFrameworkEvent','getId','platformIndex','KEY_TEST_ENDED_AT','3HxwHQd','KEY_TEST_FRAMEWORK_VERSION','KEY_PLATFORM_INDEX','../framework/automationFramework.js','1466438CqcFvh','../../../helpers/testhub/constants','hookState','Error\x20in\x20sendTestFrameworkEvent:\x20','testFrameworkState','instance','testFrameworkName','getAllData','executionContext','KEY_TEST_DEFERRED','getModuleName'];a73_0x3bf5=function(){return _0x702e1a;};return a73_0x3bf5();}function a73_0x2ee5(_0x584ba0,_0x36058f){const _0x3bf5c5=a73_0x3bf5();return a73_0x2ee5=function(_0x2ee594,_0x324aec){_0x2ee594=_0x2ee594-0x13f;let _0x2b06b9=_0x3bf5c5[_0x2ee594];return _0x2b06b9;},a73_0x2ee5(_0x584ba0,_0x36058f);}(function(_0x3312f2,_0x419131){const _0x2fb2ca=a73_0x2ee5,_0x2bb144=_0x3312f2();while(!![]){try{const _0x2cf522=-parseInt(_0x2fb2ca(0x17f))/0x1+-parseInt(_0x2fb2ca(0x146))/0x2*(-parseInt(_0x2fb2ca(0x17b))/0x3)+parseInt(_0x2fb2ca(0x15a))/0x4*(parseInt(_0x2fb2ca(0x15b))/0x5)+parseInt(_0x2fb2ca(0x19d))/0x6*(parseInt(_0x2fb2ca(0x162))/0x7)+-parseInt(_0x2fb2ca(0x165))/0x8+parseInt(_0x2fb2ca(0x19f))/0x9*(-parseInt(_0x2fb2ca(0x15c))/0xa)+parseInt(_0x2fb2ca(0x1a6))/0xb*(parseInt(_0x2fb2ca(0x19c))/0xc);if(_0x2cf522===_0x419131)break;else _0x2bb144['push'](_0x2bb144['shift']());}catch(_0x1b65d9){_0x2bb144['push'](_0x2bb144['shift']());}}}(a73_0x3bf5,0xe604b));const util=require(a73_0x25cb6e(0x172)),BaseModule=require(a73_0x25cb6e(0x148)),{createClassLogger}=require(a73_0x25cb6e(0x18d)),AutomationFramework=require(a73_0x25cb6e(0x17e)),AutomationFrameworkState=require('../state/automationFrameworkState.js'),HookState=require(a73_0x25cb6e(0x191)),TestFramework=require(a73_0x25cb6e(0x16b)),TestFrameworkState=require(a73_0x25cb6e(0x171)),PlaywrightDriverModule=require(a73_0x25cb6e(0x147)),TestFrameworkConstants=require('../framework/constants/testFrameworkConstants.js'),GrpcClient=require(a73_0x25cb6e(0x161)),CLIUtils=require(a73_0x25cb6e(0x196)),TestInfo=require(a73_0x25cb6e(0x14a)),testHubConstants=require(a73_0x25cb6e(0x180)),BrowserstackCLI=require(a73_0x25cb6e(0x1a0)),{getPlaywrightProvider}=require(a73_0x25cb6e(0x18c));class TestHubModule extends BaseModule{[a73_0x25cb6e(0x1aa)]=createClassLogger(a73_0x25cb6e(0x167));constructor(_0x1e608a){const _0x2182ce=a73_0x25cb6e,_0x20744e={};_0x20744e[_0x2182ce(0x166)]='2|1|7|5|0|3|4|6',_0x20744e[_0x2182ce(0x168)]=_0x2182ce(0x167);const _0x3fde7c=_0x20744e,_0x31ce68=_0x3fde7c[_0x2182ce(0x166)][_0x2182ce(0x16e)]('|');let _0x11c1d5=0x0;while(!![]){switch(_0x31ce68[_0x11c1d5++]){case'0':Object[_0x2182ce(0x192)](TestFrameworkState)[_0x2182ce(0x193)](_0x24f055=>{const _0x6f26a1=_0x2182ce;Object[_0x6f26a1(0x192)](HookState)[_0x6f26a1(0x193)](_0x23a333=>{const _0x23d691=_0x6f26a1;TestFramework[_0x23d691(0x1a9)](_0x24f055,_0x23a333,this[_0x23d691(0x199)]['bind'](this));});});continue;case'1':this[_0x2182ce(0x160)]=_0x3fde7c[_0x2182ce(0x168)];continue;case'2':super();continue;case'3':process[_0x2182ce(0x142)][testHubConstants['ENV_VAR']['BROWSERSTACK_TESTHUB_JWT']]=this['testhubConfig'][_0x2182ce(0x15d)]();continue;case'4':process[_0x2182ce(0x142)][testHubConstants['ENV_VAR'][_0x2182ce(0x1a2)]]=this[_0x2182ce(0x173)][_0x2182ce(0x170)]();continue;case'5':AutomationFramework[_0x2182ce(0x1a9)](AutomationFrameworkState[_0x2182ce(0x1a5)],HookState[_0x2182ce(0x15e)],this['onPageCreate'][_0x2182ce(0x169)](this));continue;case'6':BrowserstackCLI[_0x2182ce(0x18b)]=this[_0x2182ce(0x173)]['getBuildHashedId']();continue;case'7':this['testhubConfig']=_0x1e608a;continue;}break;}}[a73_0x25cb6e(0x189)](){return TestHubModule['MODULE_NAME'];}[a73_0x25cb6e(0x199)](_0x1ce8db){const _0x32dadb=a73_0x25cb6e,_0x5576d2={};_0x5576d2['ScmSG']=function(_0x144dfe,_0x1d6faf){return _0x144dfe===_0x1d6faf;};const _0x21a744=_0x5576d2,_0x4fb534=_0x1ce8db[_0x32dadb(0x184)],_0x338f10=_0x4fb534['getCurrentTestState']();(_0x21a744[_0x32dadb(0x1a8)](_0x338f10,TestFrameworkState['TEST'])||CLIUtils[_0x32dadb(0x14c)](_0x338f10[_0x32dadb(0x194)]()[_0x32dadb(0x16e)]('.')[0x1]))&&this[_0x32dadb(0x177)](_0x1ce8db);}async[a73_0x25cb6e(0x177)](_0x1aee90){const _0x41a63d=a73_0x25cb6e,_0x27fa76={};_0x27fa76[_0x41a63d(0x1ab)]=_0x41a63d(0x18a);const _0x25fc6b=_0x27fa76;try{const _0x2f97b0=_0x1aee90[_0x41a63d(0x1a1)]['id'],_0xb4b261=_0x1aee90['instance'],_0x2e7054=_0xb4b261[_0x41a63d(0x157)](),_0x440de1=_0xb4b261[_0x41a63d(0x186)]()['get'](_0x2f97b0);this[_0x41a63d(0x1aa)][_0x41a63d(0x143)](_0x41a63d(0x19e)+_0x2f97b0);const {[TestFrameworkConstants[_0x41a63d(0x140)]]:_0x571923='',[TestFrameworkConstants[_0x41a63d(0x17c)]]:_0x355f8e='',[TestFrameworkConstants['KEY_TEST_STARTED_AT']]:_0x122e1b='',[TestFrameworkConstants[_0x41a63d(0x17a)]]:_0x2dabe9=''}=_0x440de1,_0x5d82d2=_0xb4b261[_0x41a63d(0x13f)]()[_0x41a63d(0x194)]()[_0x41a63d(0x16e)]('.')[0x1],_0x4e0579=_0xb4b261[_0x41a63d(0x153)]()[_0x41a63d(0x194)]()[_0x41a63d(0x16e)]('.')[0x1],_0x2676c2=global?.['__workerDetails']?.[_0x41a63d(0x16f)]?.[_0x41a63d(0x152)];;const _0x1ee8fd=_0xb4b261[_0x41a63d(0x154)](),_0x4723=Buffer[_0x41a63d(0x155)](JSON[_0x41a63d(0x1a4)](_0x440de1))['toString'](_0x25fc6b[_0x41a63d(0x1ab)]),_0x53f4fe={'hash':_0x2e7054[_0x41a63d(0x178)](),'threadId':_0x2e7054[_0x41a63d(0x144)]()[_0x41a63d(0x194)](),'processId':_0x2e7054['getProcessId']()['toString']()},_0xcb825={};_0xcb825['platformIndex']=_0x2676c2,_0xcb825[_0x41a63d(0x185)]=_0x571923,_0xcb825[_0x41a63d(0x15f)]=_0x355f8e,_0xcb825[_0x41a63d(0x183)]=_0x5d82d2,_0xcb825[_0x41a63d(0x181)]=_0x4e0579,_0xcb825[_0x41a63d(0x151)]=_0x122e1b,_0xcb825[_0x41a63d(0x190)]=_0x2dabe9,_0xcb825['uuid']=_0x1ee8fd,_0xcb825['eventJson']=_0x4723,_0xcb825[_0x41a63d(0x187)]=_0x53f4fe;const _0x54f496=_0xcb825,_0xde3da2=await GrpcClient[_0x41a63d(0x16a)]()[_0x41a63d(0x159)](_0x54f496);this['logger'][_0x41a63d(0x143)](_0x41a63d(0x145)+_0x2f97b0+_0x41a63d(0x14e)+_0x5d82d2+_0x41a63d(0x19a)+_0x4e0579);}catch(_0x1d0220){this[_0x41a63d(0x1aa)][_0x41a63d(0x150)](_0x41a63d(0x182)+util[_0x41a63d(0x1a3)](_0x1d0220));}}async[a73_0x25cb6e(0x198)](_0x218574){const _0x33b139=a73_0x25cb6e,_0x1100e7={'kEamf':function(_0x219788,_0x4002d8){return _0x219788(_0x4002d8);},'nJSCQ':_0x33b139(0x18a)};try{if(_0x218574[_0x33b139(0x164)]){const _0x12b7e9=_0x218574['testInfo'][_0x33b139(0x14f)];this[_0x33b139(0x1aa)][_0x33b139(0x143)](_0x33b139(0x19b)+_0x12b7e9);const _0x2d8eac=TestInfo[_0x33b139(0x163)](_0x12b7e9),_0xcd72cb=TestInfo[_0x33b139(0x141)](_0x12b7e9),_0x55784e=_0x218574[_0x33b139(0x184)],_0x158534=AutomationFramework[_0x33b139(0x149)](_0x55784e,PlaywrightDriverModule[_0x33b139(0x17d)]),_0xe5272b=_0xcd72cb[TestFrameworkConstants[_0x33b139(0x140)]],_0x47d699=_0xcd72cb[TestFrameworkConstants['KEY_TEST_FRAMEWORK_VERSION']],_0x2d97a6=TestFrameworkState[_0x33b139(0x158)]['toString']()['split']('.')[0x1],_0xe3a876=HookState['POST'][_0x33b139(0x194)]()[_0x33b139(0x16e)]('.')[0x1],_0x17cc36=_0x55784e['getContext'](),_0x5412ab=AutomationFramework[_0x33b139(0x149)](_0x55784e,PlaywrightDriverModule['KEY_HUB_URL'],''),_0x2fec34={'provider':_0x1100e7[_0x33b139(0x156)](getPlaywrightProvider,_0x5412ab),'frameworkName':_0x55784e['frameworkName'],'frameworkVersion':_0x55784e[_0x33b139(0x14d)],'frameworkSessionId':AutomationFramework[_0x33b139(0x149)](_0x55784e,PlaywrightDriverModule[_0x33b139(0x1ac)],''),'ref':_0x55784e[_0x33b139(0x154)](),'hubUrl':_0x5412ab};let _0x46670a=AutomationFramework[_0x33b139(0x149)](_0x55784e,PlaywrightDriverModule['KEY_CAPABILITIES'],{});_0x46670a=Buffer[_0x33b139(0x155)](JSON[_0x33b139(0x1a4)](_0x46670a))[_0x33b139(0x194)](_0x1100e7[_0x33b139(0x1a7)]);const _0x58e7b4={'hash':_0x17cc36[_0x33b139(0x178)](),'threadId':_0x17cc36['getThreadId']()[_0x33b139(0x194)](),'processId':_0x17cc36[_0x33b139(0x197)]()[_0x33b139(0x194)]()},_0x3a679={};_0x3a679[_0x33b139(0x179)]=_0x158534,_0x3a679['testFrameworkName']=_0xe5272b,_0x3a679[_0x33b139(0x15f)]=_0x47d699,_0x3a679['testFrameworkState']=_0x2d97a6,_0x3a679[_0x33b139(0x175)]=_0xe3a876,_0x3a679['testUuid']=_0x2d8eac,_0x3a679[_0x33b139(0x174)]=_0x2fec34,_0x3a679[_0x33b139(0x18e)]=_0x46670a,_0x3a679['executionContext']=_0x58e7b4;const _0x519529=_0x3a679;this['logger']['debug']('onPageCreate\x20CBTSession\x20payload:\x20'+util[_0x33b139(0x1a3)](_0x519529));const _0x16be6e=await GrpcClient[_0x33b139(0x16a)]()[_0x33b139(0x18f)](_0x519529);this[_0x33b139(0x1aa)][_0x33b139(0x143)](_0x33b139(0x16d)+_0x12b7e9);}}catch(_0x398aa8){this[_0x33b139(0x1aa)][_0x33b139(0x150)](_0x33b139(0x16c)+util[_0x33b139(0x1a3)](_0x398aa8));}}}TestHubModule[a73_0x25cb6e(0x195)]='TestHubModule',TestHubModule[a73_0x25cb6e(0x188)]=a73_0x25cb6e(0x176),module[a73_0x25cb6e(0x14b)]=TestHubModule;