const a16_0x1c228c=a16_0x2d27;function a16_0x2d27(_0xa3be00,_0x4bed47){const _0x3d95d6=a16_0x3d95();return a16_0x2d27=function(_0x2d27ea,_0x5144dd){_0x2d27ea=_0x2d27ea-0x109;let _0xd8e36a=_0x3d95d6[_0x2d27ea];return _0xd8e36a;},a16_0x2d27(_0xa3be00,_0x4bed47);}(function(_0x5d9f3a,_0x1b03d7){const _0x33792b=a16_0x2d27,_0xaa1d87=_0x5d9f3a();while(!![]){try{const _0x3dfefb=-parseInt(_0x33792b(0x117))/0x1+parseInt(_0x33792b(0x15a))/0x2+parseInt(_0x33792b(0x125))/0x3*(-parseInt(_0x33792b(0x16f))/0x4)+parseInt(_0x33792b(0x169))/0x5+parseInt(_0x33792b(0x132))/0x6+parseInt(_0x33792b(0x112))/0x7*(parseInt(_0x33792b(0x10b))/0x8)+parseInt(_0x33792b(0x115))/0x9;if(_0x3dfefb===_0x1b03d7)break;else _0xaa1d87['push'](_0xaa1d87['shift']());}catch(_0x2f1d63){_0xaa1d87['push'](_0xaa1d87['shift']());}}}(a16_0x3d95,0x52985));function a16_0x3d95(){const _0x2aacfe=['SpJEk','gySVR','jest-resolve','ghqvk','browserStackGlobals','split','__jestRetries','capabilities','jestConfig','BSTACK_DELTA','join','cleanupDrivers','isTrue','modifyCommand','node','failFast','__driversArray','builder','wByff','test','Fail-fast\x20is\x20active,\x20skipping\x20test::\x20','../../utils/constants','1072BaeFEt','sessionNameProvided','cleanup','errors','TbRUL','capability','../../../helpers/test-observability/requestQueueHandler','browserstackAgentV2','configuration','../../../helpers/logger','getInstance','failFastActive','__webdriver','SEFuS','sXixD','95360kfOZAr','resolveTestEnvironment','__drivers','testEnvironmentOptions','getTestEnvironment','default','4sMtpLx','isBrowserstackInfra','oZqfz','quit','HPgwE','deMMk','Builder','driver','test_start','skipSessionStatus','8pFVqRF','BSTACK_JEST_TEST_ENV','Error\x20in\x20fail-fast\x20test_done\x20handler:','jest-config','handleTestEvent','setup','testPath','4492558qvCHEL','cwd','browserstackPlatformIndex','1867554KiuUUh','retries__','504286jDBUCn','browserstackPercyBestPlatform','message','name','iZHym','__platformCaps','isNotUndefined','nestedKeyValue','MAOds','__timeout','uQwRt','../../../helpers/helper','GHRCt','skipSessionName','302355PwPEdP','mode','global','EyLca','winstonLogger','test_done','percyCaptureMode','failFastOptions','debug','__esModule','dxcKH','platformCaps','odSta','446832QhqMiP','\x20>\x20','uSode','env','info','../../../helpers/testhub/utils','ejFUF','teardown','NWYQi','shouldProcessEventForTesthub','onTestDone','buildName','ZlbWQ','projectConfig','browserStackPercyOptions','requireModule','jest-environment-node','percy'];a16_0x3d95=function(){return _0x2aacfe;};return a16_0x3d95();}const helper=require(a16_0x1c228c(0x122)),constants=require(a16_0x1c228c(0x159)),{isTestObservabilitySession}=require('../../../helpers/test-observability/utils'),RequestQueueHandler=require(a16_0x1c228c(0x160)),ObservabilityReporter=require('../test-observability/obsReporter'),testhubUtils=require(a16_0x1c228c(0x137)),logger=require(a16_0x1c228c(0x163))[a16_0x1c228c(0x129)],getTestEnvironment=((()=>{const _0x396146=a16_0x1c228c,_0x26fc4d={};_0x26fc4d[_0x396146(0x147)]=_0x396146(0x146),_0x26fc4d[_0x396146(0x144)]=_0x396146(0x10e);const _0x11c730=_0x26fc4d;try{const _0x587156=helper[_0x396146(0x141)](_0x11c730[_0x396146(0x147)]);if(_0x587156[_0x396146(0x16a)])return _0x587156[_0x396146(0x16a)];const _0x213441=helper[_0x396146(0x141)](_0x11c730[_0x396146(0x144)]);if(_0x213441[_0x396146(0x16d)])return _0x213441[_0x396146(0x16d)];}catch{return()=>null;}return()=>null;})()),_jestUserEnvironment=((()=>{const _0x492f43=a16_0x1c228c,_0x20204a={'odSta':function(_0x8a3166,_0x3a748d){return _0x8a3166(_0x3a748d);},'GHRCt':_0x492f43(0x152),'gzVLn':_0x492f43(0x142),'ItviK':function(_0x1d886c,_0xad87d3){return _0x1d886c(_0xad87d3);}},_0x30ec4f=_0x20204a[_0x492f43(0x131)](getTestEnvironment,{'rootDir':process[_0x492f43(0x113)](),'testEnvironment':process[_0x492f43(0x135)][_0x492f43(0x10c)]||_0x20204a[_0x492f43(0x123)]});if(!_0x30ec4f)return _0x20204a['odSta'](_interopRequireDefault,helper['requireModule'](_0x20204a['gzVLn']));return _0x20204a['ItviK'](_interopRequireDefault,helper[_0x492f43(0x141)](_0x30ec4f));})()),_seleniumWebdriver2=((()=>{const _0x304cb5=a16_0x1c228c,_0x2f6bc5={'wByff':function(_0x249635,_0x4662d7){return _0x249635(_0x4662d7);}};try{const _0x4d34c5=helper['requireSeleniumWebdriver']();return helper[_0x304cb5(0x151)](),_0x2f6bc5[_0x304cb5(0x156)](_interopRequireDefault,_0x4d34c5);}catch{return null;}})());function _interopRequireDefault(_0x539151){const _0x22876c=a16_0x1c228c;return _0x539151&&_0x539151[_0x22876c(0x12e)]?_0x539151:{'default':_0x539151};}const originalBuilder=_seleniumWebdriver2?_seleniumWebdriver2[a16_0x1c228c(0x16e)][a16_0x1c228c(0x175)]:null;class CustomEnvironment extends _jestUserEnvironment[a16_0x1c228c(0x16e)]{constructor(_0x2a5c4d){const _0x273540=a16_0x1c228c,_0x36cc46={'NjmcC':_0x273540(0x172),'ejFUF':function(_0x5d07df,_0x4eb51b){return _0x5d07df+_0x4eb51b;},'oZqfz':'bstack:options','taeKw':function(_0x5f07f8,_0x26e973){return _0x5f07f8(_0x26e973);},'deMMk':'../../../helpers/test-orchestration/failfastManager','Ersav':'2|0|3|1|5|7|4|6','EyLca':function(_0x2fbd74,_0x5c5175){return _0x2fbd74(_0x5c5175);},'SEFuS':'../../../index','uQwRt':'testEnvironmentOptions','dxcKH':_0x273540(0x140),'bHvBW':_0x273540(0x143),'uSode':'browserstackPercyBestPlatform','QvNnT':'percyCaptureMode'};super(_0x2a5c4d),this['global'][_0x273540(0x120)]=0x0,this['configuration']={};!_0x2a5c4d[_0x273540(0x16c)]&&(_0x2a5c4d[_0x273540(0x16c)]={});if(helper[_0x273540(0x170)]()){_0x2a5c4d[_0x273540(0x16c)]=_0x2a5c4d[_0x273540(0x13f)]?_0x2a5c4d[_0x273540(0x13f)][_0x273540(0x16c)]:_0x2a5c4d[_0x273540(0x16c)];_seleniumWebdriver2&&(this[_0x273540(0x155)]=new _seleniumWebdriver2[(_0x273540(0x16e))]['Builder']());this[_0x273540(0x15f)]=_0x2a5c4d[_0x273540(0x13f)]?_0x2a5c4d[_0x273540(0x13f)][_0x273540(0x15f)]:_0x2a5c4d[_0x273540(0x15f)],this['global'][_0x273540(0x120)]=_0x36cc46[_0x273540(0x138)](_0x2a5c4d[_0x273540(0x16c)]['timeout__']||0x1388,constants[_0x273540(0x14d)]),this[_0x273540(0x12c)]=_0x2a5c4d[_0x273540(0x16c)][_0x273540(0x153)];if(this['failFastOptions']){const _0x54dfb1=this[_0x273540(0x15f)][_0x36cc46['oZqfz']]?.[_0x273540(0x13d)]||'',_0xd0e72e=this[_0x273540(0x15f)][_0x36cc46[_0x273540(0x171)]]?.['projectName']||'';this[_0x273540(0x153)]=new(_0x36cc46['taeKw'](require,_0x36cc46[_0x273540(0x174)]))(this['failFastOptions'],_0x54dfb1,_0xd0e72e),this[_0x273540(0x127)][_0x273540(0x165)]=![];}helper[_0x273540(0x11d)](_0x2a5c4d['testEnvironmentOptions']['retries__'])&&(this[_0x273540(0x127)][_0x273540(0x14a)]=_0x2a5c4d[_0x273540(0x16c)][_0x273540(0x116)]);}if(testhubUtils[_0x273540(0x13b)]()){const _0x361a84=new ObservabilityReporter();_0x361a84['registerListeners']();}this[_0x273540(0x127)][_0x273540(0x148)]={},this[_0x273540(0x162)]=_0x2a5c4d['testEnvironmentOptions'],this[_0x273540(0x162)]['framework']=constants['FRAMEWORKS']['JEST'],this[_0x273540(0x127)][_0x273540(0x114)]=(_0x2a5c4d['projectConfig']?_0x2a5c4d['projectConfig']['browserstackPlatformIndex']:_0x2a5c4d[_0x273540(0x114)])||0x0,this[_0x273540(0x127)][_0x273540(0x11c)]=this[_0x273540(0x162)]&&this[_0x273540(0x162)][_0x273540(0x130)]&&Array['isArray'](this[_0x273540(0x162)]['platformCaps'])&&this[_0x273540(0x162)]['platformCaps'][this['global']['browserstackPlatformIndex']]||{};const _0x47d61f=this['global'][_0x273540(0x114)],_0x16918f={...this[_0x273540(0x162)],'capability':this['configuration'][_0x273540(0x14b)]&&Array['isArray'](this[_0x273540(0x162)][_0x273540(0x14b)])&&this[_0x273540(0x162)]['capabilities'][_0x47d61f]||{},'platformCaps':this[_0x273540(0x162)][_0x273540(0x130)]&&Array['isArray'](this[_0x273540(0x162)][_0x273540(0x130)])&&this[_0x273540(0x162)]['platformCaps'][_0x47d61f]||{}};delete _0x16918f[_0x273540(0x14b)],this[_0x273540(0x127)][_0x273540(0x14c)]=_0x16918f;if(_seleniumWebdriver2){const _0x506da7=_0x36cc46['Ersav'][_0x273540(0x149)]('|');let _0x214e85=0x0;while(!![]){switch(_0x506da7[_0x214e85++]){case'0':this['global'][_0x273540(0x166)]=_0x36cc46[_0x273540(0x128)](require,_0x36cc46[_0x273540(0x167)])[_0x273540(0x161)]({...this[_0x273540(0x162)],'capability':this[_0x273540(0x15f)]||{}},this,testhubUtils[_0x273540(0x13b)]());continue;case'1':this['global'][_0x273540(0x143)]=helper[_0x273540(0x11e)](_0x2a5c4d,[_0x36cc46['uQwRt'],_0x36cc46['dxcKH'],_0x36cc46['bHvBW']]);continue;case'2':this[_0x273540(0x127)][_0x273540(0x16b)]=[];continue;case'3':this[_0x273540(0x127)][_0x273540(0x118)]=helper[_0x273540(0x11e)](_0x2a5c4d,[_0x36cc46['uQwRt'],_0x36cc46['dxcKH'],_0x36cc46[_0x273540(0x134)]]);continue;case'4':this['global']['__skipSessionStatus']=helper[_0x273540(0x150)](this[_0x273540(0x162)][_0x273540(0x10a)]);continue;case'5':this[_0x273540(0x127)][_0x273540(0x12b)]=helper['nestedKeyValue'](_0x2a5c4d,[_0x36cc46[_0x273540(0x121)],_0x36cc46[_0x273540(0x12f)],_0x36cc46['QvNnT']]);continue;case'6':this[_0x273540(0x127)][_0x273540(0x15c)]=async()=>{const _0x4c0096=_0x273540;await this[_0x4c0096(0x127)][_0x4c0096(0x176)]['quit'](_0x36cc46['NjmcC']);};continue;case'7':helper[_0x273540(0x150)](this[_0x273540(0x162)][_0x273540(0x124)])?this[_0x273540(0x127)][_0x273540(0x15b)]=!![]:this[_0x273540(0x127)][_0x273540(0x15b)]=![];continue;}break;}}}async[a16_0x1c228c(0x139)](){const _0x3b8a90=a16_0x1c228c;_seleniumWebdriver2&&(await helper[_0x3b8a90(0x14f)](this[_0x3b8a90(0x127)][_0x3b8a90(0x154)]),this[_0x3b8a90(0x127)][_0x3b8a90(0x166)][_0x3b8a90(0x175)]=originalBuilder),await RequestQueueHandler[_0x3b8a90(0x164)]()['shutdown']();}async[a16_0x1c228c(0x110)](){}async[a16_0x1c228c(0x10f)](_0x7103be,_0x1bb096){const _0x53d152=a16_0x1c228c,_0x490824={};_0x490824[_0x53d152(0x15e)]=function(_0x500e1a,_0x4d5734){return _0x500e1a===_0x4d5734;},_0x490824[_0x53d152(0x173)]=_0x53d152(0x109),_0x490824['NWYQi']='skip',_0x490824[_0x53d152(0x13e)]=_0x53d152(0x12a),_0x490824['MAOds']=_0x53d152(0x133),_0x490824[_0x53d152(0x11b)]=function(_0x371377,_0x3e7bd6){return _0x371377===_0x3e7bd6;},_0x490824[_0x53d152(0x145)]=_0x53d152(0x10d),_0x490824[_0x53d152(0x168)]='teardown';const _0x39a846=_0x490824,{name:_0x295848}=_0x7103be;if(_0x39a846['TbRUL'](_0x295848,_0x39a846[_0x53d152(0x173)])){this[_0x53d152(0x127)]['testContext']=_0x7103be['test'];if(_0x39a846['TbRUL'](this[_0x53d152(0x127)]['failFastActive'],!![])){const _0x5f376b=_0x7103be[_0x53d152(0x157)][_0x53d152(0x11a)];logger[_0x53d152(0x136)](_0x53d152(0x158)+_0x5f376b),_0x7103be[_0x53d152(0x157)][_0x53d152(0x126)]=_0x39a846[_0x53d152(0x13a)];}}if(this[_0x53d152(0x153)]&&_0x39a846['TbRUL'](_0x295848,_0x39a846[_0x53d152(0x13e)]))try{const _0x515607=_0x7103be[_0x53d152(0x157)][_0x53d152(0x111)][_0x53d152(0x14e)](_0x39a846[_0x53d152(0x11f)]),_0x35aad2=_0x7103be[_0x53d152(0x157)][_0x53d152(0x15d)];await this[_0x53d152(0x153)][_0x53d152(0x13c)](_0x515607,_0x35aad2);const _0x1bced3=await this[_0x53d152(0x153)]['shouldFailFast']();_0x39a846['TbRUL'](this[_0x53d152(0x127)][_0x53d152(0x165)],![])&&_0x39a846['iZHym'](_0x1bced3,!![])&&(this[_0x53d152(0x127)]['failFastActive']=!![]);}catch(_0x1e6aea){logger[_0x53d152(0x12d)](_0x39a846['gySVR'],_0x1e6aea[_0x53d152(0x119)]);}_0x39a846[_0x53d152(0x15e)](_0x295848,_0x39a846['sXixD'])&&(this[_0x53d152(0x153)]&&this['failFast']['cleanup']());}}module['exports']=CustomEnvironment;