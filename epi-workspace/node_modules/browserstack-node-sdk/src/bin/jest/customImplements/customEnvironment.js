const a16_0x1d476f=a16_0x350c;(function(_0x3f3013,_0x599457){const _0x15ae48=a16_0x350c,_0x110042=_0x3f3013();while(!![]){try{const _0x12ddef=-parseInt(_0x15ae48(0x242))/0x1+-parseInt(_0x15ae48(0x220))/0x2*(-parseInt(_0x15ae48(0x1f4))/0x3)+-parseInt(_0x15ae48(0x231))/0x4+-parseInt(_0x15ae48(0x23e))/0x5*(-parseInt(_0x15ae48(0x20e))/0x6)+-parseInt(_0x15ae48(0x22b))/0x7*(parseInt(_0x15ae48(0x1fb))/0x8)+-parseInt(_0x15ae48(0x237))/0x9+parseInt(_0x15ae48(0x1f7))/0xa;if(_0x12ddef===_0x599457)break;else _0x110042['push'](_0x110042['shift']());}catch(_0x1043eb){_0x110042['push'](_0x110042['shift']());}}}(a16_0x33a3,0xd31bb));function a16_0x33a3(){const _0x408f59=['registerListeners','66xwomsi','test','projectConfig','skipSessionStatus','winstonLogger','../../../helpers/testhub/utils','capabilities','percyCaptureMode','getTestEnvironment','shouldProcessEventForTesthub','skipSessionName','rlegY','test_done','testPath','join','requireModule','resolveTestEnvironment','FRAMEWORKS','3073010sbZLQu','browserstackPercyBestPlatform','buildName','skip','cleanupDrivers','zkyrW','split','projectName','LtHvk','testContext','sessionNameProvided','6728323Xvjsfz','failFast','ZQJeB','__webdriver','global','JEST','5510548GYCtcx','nestedKeyValue','VJWdO','BSTACK_DELTA','oSpmy','test_start','1626129jKhmhs','../../../helpers/test-orchestration/failfastManager','tkvRM','teardown','TrMtg','retries__','default','539170udAIOv','setup','../../../index','cleanup','1564508xrjyEK','qJcJs','percy','testEnvironmentOptions','HZwdG','driver','../../../helpers/test-observability/utils','env','nQcxL','framework','jest-environment-node','quit','configuration','uaYtC','jestConfig','2|3|4|7|1|0|6|5','__jestRetries','cpzWf','isNotUndefined','modifyCommand','TAJZF','handleTestEvent','isBrowserstackInfra','PEpYZ','../../../helpers/test-observability/requestQueueHandler','Builder','__timeout','browserstackPlatformIndex','errors','builder','isArray','failFastOptions','cvsqR','../../../helpers/logger','QsJbw','3ZKopBo','platformCaps','ivLUc','22260350hwiFZT','BSTACK_JEST_TEST_ENV','capability','DYxkV','8kDKiTY','__drivers','isTrue','URudM','__skipSessionStatus','RCkYt','YvNnv','name','timeout__','mYwUq','jest-resolve','\x20>\x20','../test-observability/obsReporter','info','browserstackAgentV2','Fail-fast\x20is\x20active,\x20skipping\x20test::\x20','failFastActive','browserStackGlobals'];a16_0x33a3=function(){return _0x408f59;};return a16_0x33a3();}function a16_0x350c(_0x2a38d6,_0x516f76){const _0x33a3e5=a16_0x33a3();return a16_0x350c=function(_0x350c8b,_0x521cbc){_0x350c8b=_0x350c8b-0x1e5;let _0x1a9f83=_0x33a3e5[_0x350c8b];return _0x1a9f83;},a16_0x350c(_0x2a38d6,_0x516f76);}const helper=require('../../../helpers/helper'),constants=require('../../utils/constants'),{isTestObservabilitySession}=require(a16_0x1d476f(0x248)),RequestQueueHandler=require(a16_0x1d476f(0x1e9)),ObservabilityReporter=require(a16_0x1d476f(0x207)),testhubUtils=require(a16_0x1d476f(0x213)),logger=require(a16_0x1d476f(0x1f2))[a16_0x1d476f(0x212)],getTestEnvironment=((()=>{const _0x45ddbd=a16_0x1d476f,_0x5b488d={};_0x5b488d['RCkYt']=_0x45ddbd(0x205),_0x5b488d[_0x45ddbd(0x201)]='jest-config';const _0x7f3aa8=_0x5b488d;try{const _0x479ce7=helper[_0x45ddbd(0x21d)](_0x7f3aa8[_0x45ddbd(0x200)]);if(_0x479ce7[_0x45ddbd(0x21e)])return _0x479ce7[_0x45ddbd(0x21e)];const _0x5a72ea=helper[_0x45ddbd(0x21d)](_0x7f3aa8[_0x45ddbd(0x201)]);if(_0x5a72ea['getTestEnvironment'])return _0x5a72ea[_0x45ddbd(0x216)];}catch{return()=>null;}return()=>null;})()),_jestUserEnvironment=((()=>{const _0x4fa7ca=a16_0x1d476f,_0x3101f1={'PEpYZ':function(_0x45a358,_0x511efa){return _0x45a358(_0x511efa);},'dlNUR':'node','mYwUq':function(_0x449899,_0x1fc585){return _0x449899(_0x1fc585);},'nQcxL':_0x4fa7ca(0x24c)},_0x3cb8d4=_0x3101f1[_0x4fa7ca(0x1e8)](getTestEnvironment,{'rootDir':process['cwd'](),'testEnvironment':process[_0x4fa7ca(0x249)][_0x4fa7ca(0x1f8)]||_0x3101f1['dlNUR']});if(!_0x3cb8d4)return _0x3101f1[_0x4fa7ca(0x204)](_interopRequireDefault,helper['requireModule'](_0x3101f1[_0x4fa7ca(0x24a)]));return _0x3101f1['mYwUq'](_interopRequireDefault,helper[_0x4fa7ca(0x21d)](_0x3cb8d4));})()),_seleniumWebdriver2=((()=>{const _0x1e968a=a16_0x1d476f,_0x245007={'rlegY':function(_0x3ed799,_0x5acd3e){return _0x3ed799(_0x5acd3e);}};try{const _0x1095f9=helper['requireSeleniumWebdriver']();return helper[_0x1e968a(0x255)](),_0x245007[_0x1e968a(0x219)](_interopRequireDefault,_0x1095f9);}catch{return null;}})());function _interopRequireDefault(_0x2d9fb5){return _0x2d9fb5&&_0x2d9fb5['__esModule']?_0x2d9fb5:{'default':_0x2d9fb5};}const originalBuilder=_seleniumWebdriver2?_seleniumWebdriver2[a16_0x1d476f(0x23d)][a16_0x1d476f(0x1ea)]:null;class CustomEnvironment extends _jestUserEnvironment[a16_0x1d476f(0x23d)]{constructor(_0x57b163){const _0x1a1984=a16_0x1d476f,_0x3c5e31={'QsJbw':_0x1a1984(0x24d),'TrMtg':function(_0x15c4ec,_0x56b95b){return _0x15c4ec+_0x56b95b;},'TAJZF':'bstack:options','tkvRM':function(_0x1ef66d,_0x5c0e9e){return _0x1ef66d(_0x5c0e9e);},'Hnwda':_0x1a1984(0x238),'URudM':_0x1a1984(0x251),'uaYtC':'testEnvironmentOptions','ivLUc':'browserStackPercyOptions','ZPhTc':_0x1a1984(0x215),'hFmkB':function(_0xf662b,_0x550d16){return _0xf662b(_0x550d16);},'HZwdG':_0x1a1984(0x240),'oSpmy':'browserstackPercyBestPlatform','zkyrW':_0x1a1984(0x244)};super(_0x57b163),this[_0x1a1984(0x22f)][_0x1a1984(0x1eb)]=0x0,this[_0x1a1984(0x24e)]={};!_0x57b163['testEnvironmentOptions']&&(_0x57b163['testEnvironmentOptions']={});if(helper[_0x1a1984(0x1e7)]()){_0x57b163[_0x1a1984(0x245)]=_0x57b163[_0x1a1984(0x210)]?_0x57b163[_0x1a1984(0x210)][_0x1a1984(0x245)]:_0x57b163[_0x1a1984(0x245)];_seleniumWebdriver2&&(this[_0x1a1984(0x1ee)]=new _seleniumWebdriver2['default']['Builder']());this[_0x1a1984(0x1f9)]=_0x57b163[_0x1a1984(0x210)]?_0x57b163[_0x1a1984(0x210)][_0x1a1984(0x1f9)]:_0x57b163[_0x1a1984(0x1f9)],this['global'][_0x1a1984(0x1eb)]=_0x3c5e31[_0x1a1984(0x23b)](_0x57b163[_0x1a1984(0x245)][_0x1a1984(0x203)]||0x1388,constants[_0x1a1984(0x234)]),this['failFastOptions']=_0x57b163[_0x1a1984(0x245)]['failFast'];if(this[_0x1a1984(0x1f0)]){const _0x304ac0=this[_0x1a1984(0x1f9)][_0x3c5e31[_0x1a1984(0x1e5)]]?.[_0x1a1984(0x222)]||'',_0x243ad8=this[_0x1a1984(0x1f9)][_0x3c5e31[_0x1a1984(0x1e5)]]?.[_0x1a1984(0x227)]||'';this[_0x1a1984(0x22c)]=new(_0x3c5e31[_0x1a1984(0x239)](require,_0x3c5e31['Hnwda']))(this[_0x1a1984(0x1f0)],_0x304ac0,_0x243ad8),this[_0x1a1984(0x22f)]['failFastActive']=![];}helper[_0x1a1984(0x254)](_0x57b163[_0x1a1984(0x245)][_0x1a1984(0x23c)])&&(this[_0x1a1984(0x22f)][_0x1a1984(0x252)]=_0x57b163['testEnvironmentOptions'][_0x1a1984(0x23c)]);}if(testhubUtils[_0x1a1984(0x217)]()){const _0x5ed715=new ObservabilityReporter();_0x5ed715[_0x1a1984(0x20d)]();}this[_0x1a1984(0x22f)][_0x1a1984(0x20c)]={},this[_0x1a1984(0x24e)]=_0x57b163[_0x1a1984(0x245)],this[_0x1a1984(0x24e)][_0x1a1984(0x24b)]=constants[_0x1a1984(0x21f)][_0x1a1984(0x230)],this[_0x1a1984(0x22f)][_0x1a1984(0x1ec)]=(_0x57b163[_0x1a1984(0x210)]?_0x57b163[_0x1a1984(0x210)][_0x1a1984(0x1ec)]:_0x57b163[_0x1a1984(0x1ec)])||0x0,this[_0x1a1984(0x22f)]['__platformCaps']=this['configuration']&&this['configuration'][_0x1a1984(0x1f5)]&&Array[_0x1a1984(0x1ef)](this[_0x1a1984(0x24e)]['platformCaps'])&&this[_0x1a1984(0x24e)][_0x1a1984(0x1f5)][this['global'][_0x1a1984(0x1ec)]]||{};const _0x26bcd1=this['global']['browserstackPlatformIndex'],_0x286a27={...this['configuration'],'capability':this['configuration'][_0x1a1984(0x214)]&&Array['isArray'](this[_0x1a1984(0x24e)][_0x1a1984(0x214)])&&this[_0x1a1984(0x24e)][_0x1a1984(0x214)][_0x26bcd1]||{},'platformCaps':this[_0x1a1984(0x24e)][_0x1a1984(0x1f5)]&&Array['isArray'](this['configuration'][_0x1a1984(0x1f5)])&&this[_0x1a1984(0x24e)][_0x1a1984(0x1f5)][_0x26bcd1]||{}};delete _0x286a27[_0x1a1984(0x214)],this[_0x1a1984(0x22f)][_0x1a1984(0x250)]=_0x286a27;if(_seleniumWebdriver2){const _0x57e3ec=_0x3c5e31[_0x1a1984(0x1fe)][_0x1a1984(0x226)]('|');let _0x21a3ea=0x0;while(!![]){switch(_0x57e3ec[_0x21a3ea++]){case'0':helper['isTrue'](this['configuration'][_0x1a1984(0x218)])?this[_0x1a1984(0x22f)][_0x1a1984(0x22a)]=!![]:this['global'][_0x1a1984(0x22a)]=![];continue;case'1':this['global'][_0x1a1984(0x215)]=helper[_0x1a1984(0x232)](_0x57b163,[_0x3c5e31[_0x1a1984(0x24f)],_0x3c5e31['ivLUc'],_0x3c5e31['ZPhTc']]);continue;case'2':this['global'][_0x1a1984(0x1fc)]=[];continue;case'3':this[_0x1a1984(0x22f)]['__webdriver']=_0x3c5e31['hFmkB'](require,_0x3c5e31[_0x1a1984(0x246)])[_0x1a1984(0x209)]({...this['configuration'],'capability':this[_0x1a1984(0x1f9)]||{}},this,testhubUtils[_0x1a1984(0x217)]());continue;case'4':this[_0x1a1984(0x22f)][_0x1a1984(0x221)]=helper[_0x1a1984(0x232)](_0x57b163,[_0x3c5e31[_0x1a1984(0x24f)],_0x3c5e31[_0x1a1984(0x1f6)],_0x3c5e31[_0x1a1984(0x235)]]);continue;case'5':this[_0x1a1984(0x22f)]['cleanup']=async()=>{const _0x40fbe3=_0x1a1984;await this[_0x40fbe3(0x22f)][_0x40fbe3(0x247)][_0x40fbe3(0x24d)](_0x3c5e31[_0x40fbe3(0x1f3)]);};continue;case'6':this[_0x1a1984(0x22f)][_0x1a1984(0x1ff)]=helper[_0x1a1984(0x1fd)](this[_0x1a1984(0x24e)][_0x1a1984(0x211)]);continue;case'7':this[_0x1a1984(0x22f)]['percy']=helper[_0x1a1984(0x232)](_0x57b163,[_0x3c5e31[_0x1a1984(0x24f)],_0x3c5e31['ivLUc'],_0x3c5e31[_0x1a1984(0x225)]]);continue;}break;}}}async[a16_0x1d476f(0x23a)](){const _0x3f3b3e=a16_0x1d476f;_seleniumWebdriver2&&(await helper[_0x3f3b3e(0x224)](this[_0x3f3b3e(0x22f)]['__driversArray']),this[_0x3f3b3e(0x22f)][_0x3f3b3e(0x22e)][_0x3f3b3e(0x1ea)]=originalBuilder),await RequestQueueHandler['getInstance']()['shutdown']();}async[a16_0x1d476f(0x23f)](){}async[a16_0x1d476f(0x1e6)](_0x247963,_0x3e2460){const _0x6777f6=a16_0x1d476f,_0x1a623f={};_0x1a623f['qJcJs']=function(_0x4414a6,_0x592fdb){return _0x4414a6===_0x592fdb;},_0x1a623f[_0x6777f6(0x228)]=_0x6777f6(0x236),_0x1a623f['DYxkV']=_0x6777f6(0x223),_0x1a623f['nXTTc']=function(_0xa05012,_0x5cad41){return _0xa05012===_0x5cad41;},_0x1a623f['VJWdO']=_0x6777f6(0x21a),_0x1a623f[_0x6777f6(0x253)]=_0x6777f6(0x206),_0x1a623f['ZQJeB']=function(_0x2b26a0,_0x9dec53){return _0x2b26a0===_0x9dec53;},_0x1a623f['iZLrP']='Error\x20in\x20fail-fast\x20test_done\x20handler:',_0x1a623f[_0x6777f6(0x1f1)]=_0x6777f6(0x23a);const _0x9e6e52=_0x1a623f,{name:_0x5023dd}=_0x247963;if(_0x9e6e52[_0x6777f6(0x243)](_0x5023dd,_0x9e6e52[_0x6777f6(0x228)])){this[_0x6777f6(0x22f)][_0x6777f6(0x229)]=_0x247963[_0x6777f6(0x20f)];if(_0x9e6e52[_0x6777f6(0x243)](this[_0x6777f6(0x22f)][_0x6777f6(0x20b)],!![])){const _0x429b26=_0x247963[_0x6777f6(0x20f)][_0x6777f6(0x202)];logger[_0x6777f6(0x208)](_0x6777f6(0x20a)+_0x429b26),_0x247963[_0x6777f6(0x20f)]['mode']=_0x9e6e52[_0x6777f6(0x1fa)];}}if(this[_0x6777f6(0x22c)]&&_0x9e6e52['nXTTc'](_0x5023dd,_0x9e6e52[_0x6777f6(0x233)]))try{const _0x23c443=_0x247963['test'][_0x6777f6(0x21b)][_0x6777f6(0x21c)](_0x9e6e52[_0x6777f6(0x253)]),_0xa9d6e4=_0x247963[_0x6777f6(0x20f)][_0x6777f6(0x1ed)];await this['failFast']['onTestDone'](_0x23c443,_0xa9d6e4);const _0x393303=await this['failFast']['shouldFailFast']();_0x9e6e52['nXTTc'](this[_0x6777f6(0x22f)][_0x6777f6(0x20b)],![])&&_0x9e6e52[_0x6777f6(0x22d)](_0x393303,!![])&&(this[_0x6777f6(0x22f)][_0x6777f6(0x20b)]=!![]);}catch(_0x9817b4){logger['debug'](_0x9e6e52['iZLrP'],_0x9817b4['message']);}_0x9e6e52[_0x6777f6(0x243)](_0x5023dd,_0x9e6e52[_0x6777f6(0x1f1)])&&(this['failFast']&&this[_0x6777f6(0x22c)][_0x6777f6(0x241)]());}}module['exports']=CustomEnvironment;