const a18_0x44bb93=a18_0x4921;function a18_0x1c46(){const _0x57725e=['Builder','jest-environment-node','testContext','testEnvironmentOptions','Fail-fast\x20is\x20active,\x20skipping\x20test::\x20','WUSqa','platformCaps','UpFsw','xaZvQ','join','resolveTestEnvironment','test_start','projectConfig','../test-observability/obsReporter','5|6|1|3|8|7|9|2|0|4','vyQxa','errors','MtcnA','shouldProcessEventForTesthub','9GNaxwC','failFast','2414550qkByNI','69OOFwPu','cleanupDrivers','capability','Error\x20in\x20fail-fast\x20test_done\x20handler:','BSTACK_JEST_TEST_ENV','ORUvj','requireSeleniumWebdriver','percyCaptureMode','skipSessionStatus','shutdown','../../../helpers/logger','driver','quit','__webdriver','KgSRv','browserStackPercyOptions','cwd','failFastActive','pxowH','__skipSessionStatus','../../../helpers/test-orchestration/failfastManager','isBrowserstackInfra','cleanup','isNotUndefined','VsHFR','default','builder','setup','10176890bXxqcz','529325zxVzsh','env','framework','7QIytEZ','getTestEnvironment','MVEKf','test_done','nestedKeyValue','../../utils/constants','configuration','winstonLogger','browserstackPlatformIndex','fGMqU','PXZFU','2AgThMJ','839195KMjowi','name','../../../helpers/test-observability/requestQueueHandler','browserStackGlobals','AeFtD','skipSessionName','teardown','__timeout','bgJlL','orqaR','XMwiO','getInstance','../../../helpers/testhub/utils','HGATV','failFastOptions','registerListeners','wIRUJ','requireModule','../../../index','sessionNameProvided','DcAvz','bstack:options','global','10786831fNEMUV','LkKMb','cDQzk','handleTestEvent','debug','percy','BSTACK_DELTA','test','EihBs','fpElO','__platformCaps','CGyrG','retries__','../../../helpers/test-observability/utils','2734432DaFzsx','CHgbe','__esModule','isTrue','166180daEHIe','onTestDone','info','__driversArray','24iHykUs','browserstackPercyBestPlatform','JEST','jest-config','WQjGz'];a18_0x1c46=function(){return _0x57725e;};return a18_0x1c46();}(function(_0x7274d6,_0x3570f3){const _0x2a364a=a18_0x4921,_0x27b85e=_0x7274d6();while(!![]){try{const _0x4345fc=-parseInt(_0x2a364a(0x1ed))/0x1*(-parseInt(_0x2a364a(0x1ec))/0x2)+-parseInt(_0x2a364a(0x235))/0x3*(parseInt(_0x2a364a(0x216))/0x4)+-parseInt(_0x2a364a(0x252))/0x5+-parseInt(_0x2a364a(0x234))/0x6*(-parseInt(_0x2a364a(0x1e1))/0x7)+parseInt(_0x2a364a(0x212))/0x8*(-parseInt(_0x2a364a(0x232))/0x9)+-parseInt(_0x2a364a(0x251))/0xa+-parseInt(_0x2a364a(0x204))/0xb*(-parseInt(_0x2a364a(0x21a))/0xc);if(_0x4345fc===_0x3570f3)break;else _0x27b85e['push'](_0x27b85e['shift']());}catch(_0x19dab6){_0x27b85e['push'](_0x27b85e['shift']());}}}(a18_0x1c46,0xbee91));const helper=require('../../../helpers/helper'),constants=require(a18_0x44bb93(0x1e6)),{isTestObservabilitySession}=require(a18_0x44bb93(0x211)),RequestQueueHandler=require(a18_0x44bb93(0x1ef)),ObservabilityReporter=require(a18_0x44bb93(0x22c)),testhubUtils=require(a18_0x44bb93(0x1f9)),logger=require(a18_0x44bb93(0x23f))[a18_0x44bb93(0x1e8)],getTestEnvironment=((()=>{const _0x4ec00a=a18_0x44bb93,_0x17edc6={};_0x17edc6[_0x4ec00a(0x24d)]='jest-resolve',_0x17edc6[_0x4ec00a(0x1e3)]=_0x4ec00a(0x21d);const _0x2ce36e=_0x17edc6;try{const _0x4becfb=helper[_0x4ec00a(0x1fe)](_0x2ce36e['VsHFR']);if(_0x4becfb[_0x4ec00a(0x229)])return _0x4becfb[_0x4ec00a(0x229)];const _0x4505f3=helper[_0x4ec00a(0x1fe)](_0x2ce36e[_0x4ec00a(0x1e3)]);if(_0x4505f3[_0x4ec00a(0x1e2)])return _0x4505f3['getTestEnvironment'];}catch{return()=>null;}return()=>null;})()),_jestUserEnvironment=((()=>{const _0x151fda=a18_0x44bb93,_0x4e9a3e={'fpElO':function(_0x4c46f5,_0x192436){return _0x4c46f5(_0x192436);},'CHgbe':'node','MtcnA':function(_0x5b5d86,_0x1b757f){return _0x5b5d86(_0x1b757f);},'ORUvj':_0x151fda(0x220),'VhVuL':function(_0x59b2e9,_0x3d7595){return _0x59b2e9(_0x3d7595);}},_0xad4972=_0x4e9a3e[_0x151fda(0x20d)](getTestEnvironment,{'rootDir':process[_0x151fda(0x245)](),'testEnvironment':process[_0x151fda(0x253)][_0x151fda(0x239)]||_0x4e9a3e[_0x151fda(0x213)]});if(!_0xad4972)return _0x4e9a3e[_0x151fda(0x230)](_interopRequireDefault,helper[_0x151fda(0x1fe)](_0x4e9a3e[_0x151fda(0x23a)]));return _0x4e9a3e['VhVuL'](_interopRequireDefault,helper['requireModule'](_0xad4972));})()),_seleniumWebdriver2=((()=>{const _0x2f702c=a18_0x44bb93,_0x2881cc={'WaeHs':function(_0x3398d0,_0x15cfb8){return _0x3398d0(_0x15cfb8);}};try{const _0x139706=helper[_0x2f702c(0x23b)]();return helper['modifyCommand'](),_0x2881cc['WaeHs'](_interopRequireDefault,_0x139706);}catch{return null;}})());function _interopRequireDefault(_0x3b5f4f){const _0x37e6b5=a18_0x44bb93;return _0x3b5f4f&&_0x3b5f4f[_0x37e6b5(0x214)]?_0x3b5f4f:{'default':_0x3b5f4f};}function a18_0x4921(_0x4e0415,_0x385d66){const _0x1c46d6=a18_0x1c46();return a18_0x4921=function(_0x4921bc,_0x131e3e){_0x4921bc=_0x4921bc-0x1e0;let _0x46d172=_0x1c46d6[_0x4921bc];return _0x46d172;},a18_0x4921(_0x4e0415,_0x385d66);}const originalBuilder=_seleniumWebdriver2?_seleniumWebdriver2[a18_0x44bb93(0x24e)][a18_0x44bb93(0x21f)]:null;class CustomEnvironment extends _jestUserEnvironment[a18_0x44bb93(0x24e)]{constructor(_0x435259){const _0x3cf26a=a18_0x44bb93,_0x3f5426={'WUSqa':_0x3cf26a(0x241),'cDQzk':function(_0x4b5efe,_0x94739c){return _0x4b5efe+_0x94739c;},'KgSRv':_0x3cf26a(0x202),'HGATV':function(_0x3af5d3,_0x28ecb0){return _0x3af5d3(_0x28ecb0);},'ZMTZz':_0x3cf26a(0x249),'tdxbz':_0x3cf26a(0x22d),'AeFtD':_0x3cf26a(0x222),'UpFsw':_0x3cf26a(0x244),'fGMqU':_0x3cf26a(0x21b),'xaZvQ':_0x3cf26a(0x1ff),'vyQxa':_0x3cf26a(0x23c),'WQjGz':_0x3cf26a(0x209),'bgJlL':_0x3cf26a(0x225)};super(_0x435259),this[_0x3cf26a(0x203)][_0x3cf26a(0x1f4)]=0x0,this[_0x3cf26a(0x1e7)]={};!_0x435259[_0x3cf26a(0x222)]&&(_0x435259['testEnvironmentOptions']={});if(helper[_0x3cf26a(0x24a)]()){_0x435259[_0x3cf26a(0x222)]=_0x435259[_0x3cf26a(0x22b)]?_0x435259[_0x3cf26a(0x22b)][_0x3cf26a(0x222)]:_0x435259[_0x3cf26a(0x222)],this[_0x3cf26a(0x24f)]=new _seleniumWebdriver2['default'][(_0x3cf26a(0x21f))](),this[_0x3cf26a(0x237)]=_0x435259[_0x3cf26a(0x22b)]?_0x435259['projectConfig'][_0x3cf26a(0x237)]:_0x435259[_0x3cf26a(0x237)],this[_0x3cf26a(0x203)]['__timeout']=_0x3f5426[_0x3cf26a(0x206)](this['configuration']['timeout__'],constants[_0x3cf26a(0x20a)]),this['failFastOptions']=_0x435259[_0x3cf26a(0x222)][_0x3cf26a(0x233)];if(this[_0x3cf26a(0x1fb)]){const _0x5a8a39=this[_0x3cf26a(0x237)][_0x3f5426[_0x3cf26a(0x243)]]?.['buildName']||'',_0x518b61=this[_0x3cf26a(0x237)][_0x3f5426['KgSRv']]?.['projectName']||'';this['failFast']=new(_0x3f5426['HGATV'](require,_0x3f5426['ZMTZz']))(this[_0x3cf26a(0x1fb)],_0x5a8a39,_0x518b61),this['global'][_0x3cf26a(0x246)]=![];}helper[_0x3cf26a(0x24c)](this['configuration']['retries__'])&&(this[_0x3cf26a(0x203)]['__jestRetries']=this[_0x3cf26a(0x1e7)][_0x3cf26a(0x210)]);}if(testhubUtils[_0x3cf26a(0x231)]()){const _0x1d118f=new ObservabilityReporter();_0x1d118f[_0x3cf26a(0x1fc)]();}this[_0x3cf26a(0x203)][_0x3cf26a(0x1f0)]={},this[_0x3cf26a(0x1e7)]=_0x435259[_0x3cf26a(0x222)],this[_0x3cf26a(0x1e7)][_0x3cf26a(0x1e0)]=constants['FRAMEWORKS'][_0x3cf26a(0x21c)];if(_seleniumWebdriver2){const _0x4a32e0=_0x3f5426['tdxbz']['split']('|');let _0xdec46a=0x0;while(!![]){switch(_0x4a32e0[_0xdec46a++]){case'0':this[_0x3cf26a(0x203)][_0x3cf26a(0x248)]=helper[_0x3cf26a(0x215)](this[_0x3cf26a(0x1e7)][_0x3cf26a(0x23d)]);continue;case'1':this[_0x3cf26a(0x203)]['browserstackPlatformIndex']=(_0x435259['projectConfig']?_0x435259[_0x3cf26a(0x22b)][_0x3cf26a(0x1e9)]:_0x435259[_0x3cf26a(0x1e9)])||0x0;continue;case'2':helper[_0x3cf26a(0x215)](this[_0x3cf26a(0x1e7)][_0x3cf26a(0x1f2)])?this[_0x3cf26a(0x203)][_0x3cf26a(0x200)]=!![]:this[_0x3cf26a(0x203)]['sessionNameProvided']=![];continue;case'3':this['global'][_0x3cf26a(0x21b)]=helper[_0x3cf26a(0x1e5)](_0x435259,[_0x3f5426['AeFtD'],_0x3f5426[_0x3cf26a(0x226)],_0x3f5426[_0x3cf26a(0x1ea)]]);continue;case'4':this[_0x3cf26a(0x203)][_0x3cf26a(0x24b)]=async()=>{const _0x21f2e6=_0x3cf26a;await this['global'][_0x21f2e6(0x240)][_0x21f2e6(0x241)](_0x3f5426[_0x21f2e6(0x224)]);};continue;case'5':this['global']['__drivers']=[];continue;case'6':this[_0x3cf26a(0x203)]['__webdriver']=_0x3f5426[_0x3cf26a(0x1fa)](require,_0x3f5426[_0x3cf26a(0x227)])['browserstackAgentV2']({...this[_0x3cf26a(0x1e7)],'capability':this['capability']||{}},this,testhubUtils[_0x3cf26a(0x231)]());continue;case'7':this[_0x3cf26a(0x203)][_0x3cf26a(0x23c)]=helper['nestedKeyValue'](_0x435259,[_0x3f5426[_0x3cf26a(0x1f1)],_0x3f5426[_0x3cf26a(0x226)],_0x3f5426[_0x3cf26a(0x22e)]]);continue;case'8':this['global'][_0x3cf26a(0x209)]=helper[_0x3cf26a(0x1e5)](_0x435259,[_0x3f5426[_0x3cf26a(0x1f1)],_0x3f5426[_0x3cf26a(0x226)],_0x3f5426[_0x3cf26a(0x21e)]]);continue;case'9':this[_0x3cf26a(0x203)][_0x3cf26a(0x20e)]=helper[_0x3cf26a(0x1e5)](this['configuration'],[_0x3f5426[_0x3cf26a(0x1f5)],this[_0x3cf26a(0x203)]['browserstackPlatformIndex']])||{};continue;}break;}}}async[a18_0x44bb93(0x1f3)](){const _0x3541b5=a18_0x44bb93;_seleniumWebdriver2&&(await helper[_0x3541b5(0x236)](this[_0x3541b5(0x203)][_0x3541b5(0x219)]),this[_0x3541b5(0x203)][_0x3541b5(0x242)][_0x3541b5(0x21f)]=originalBuilder),await RequestQueueHandler[_0x3541b5(0x1f8)]()[_0x3541b5(0x23e)]();}async[a18_0x44bb93(0x250)](){}async[a18_0x44bb93(0x207)](_0xcb513f,_0x1a11b4){const _0xbdabad=a18_0x44bb93,_0x4741b4={};_0x4741b4[_0xbdabad(0x247)]=function(_0x51601b,_0x13d5f2){return _0x51601b===_0x13d5f2;},_0x4741b4['LkKMb']=_0xbdabad(0x22a),_0x4741b4[_0xbdabad(0x1f7)]='skip',_0x4741b4['EihBs']=_0xbdabad(0x1e4),_0x4741b4[_0xbdabad(0x1eb)]='\x20>\x20',_0x4741b4['CGyrG']=function(_0x43219e,_0x256eeb){return _0x43219e===_0x256eeb;},_0x4741b4[_0xbdabad(0x201)]=_0xbdabad(0x238),_0x4741b4[_0xbdabad(0x1fd)]=function(_0x34a2ea,_0x4bddc6){return _0x34a2ea===_0x4bddc6;},_0x4741b4[_0xbdabad(0x1f6)]='teardown';const _0x303e5a=_0x4741b4,{name:_0x97fdf5}=_0xcb513f;if(_0x303e5a['pxowH'](_0x97fdf5,_0x303e5a[_0xbdabad(0x205)])){this[_0xbdabad(0x203)][_0xbdabad(0x221)]=_0xcb513f['test'];if(_0x303e5a['pxowH'](this['global'][_0xbdabad(0x246)],!![])){const _0x10235c=_0xcb513f[_0xbdabad(0x20b)][_0xbdabad(0x1ee)];logger[_0xbdabad(0x218)](_0xbdabad(0x223)+_0x10235c),_0xcb513f[_0xbdabad(0x20b)]['mode']=_0x303e5a[_0xbdabad(0x1f7)];}}if(this['failFast']&&_0x303e5a[_0xbdabad(0x247)](_0x97fdf5,_0x303e5a[_0xbdabad(0x20c)]))try{const _0x55000f=_0xcb513f['test']['testPath'][_0xbdabad(0x228)](_0x303e5a['PXZFU']),_0x50d44f=_0xcb513f['test'][_0xbdabad(0x22f)];await this[_0xbdabad(0x233)][_0xbdabad(0x217)](_0x55000f,_0x50d44f);const _0x4a9535=await this[_0xbdabad(0x233)]['shouldFailFast']();_0x303e5a[_0xbdabad(0x20f)](this[_0xbdabad(0x203)]['failFastActive'],![])&&_0x303e5a[_0xbdabad(0x20f)](_0x4a9535,!![])&&(this[_0xbdabad(0x203)]['failFastActive']=!![]);}catch(_0x36584f){logger[_0xbdabad(0x208)](_0x303e5a[_0xbdabad(0x201)],_0x36584f['message']);}_0x303e5a[_0xbdabad(0x1fd)](_0x97fdf5,_0x303e5a[_0xbdabad(0x1f6)])&&(this[_0xbdabad(0x233)]&&this[_0xbdabad(0x233)]['cleanup']());}}module['exports']=CustomEnvironment;