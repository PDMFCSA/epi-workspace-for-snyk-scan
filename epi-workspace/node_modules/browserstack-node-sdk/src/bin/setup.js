#!/usr/bin/env node

const a45_0x4a8f2d=a45_0x2fdd;(function(_0x4298f4,_0x178fba){const _0x57ef3f=a45_0x2fdd,_0x391377=_0x4298f4();while(!![]){try{const _0x2f9c92=parseInt(_0x57ef3f(0xcd))/0x1+parseInt(_0x57ef3f(0xba))/0x2+parseInt(_0x57ef3f(0xd0))/0x3+-parseInt(_0x57ef3f(0xa1))/0x4+-parseInt(_0x57ef3f(0xa3))/0x5+parseInt(_0x57ef3f(0xa4))/0x6+-parseInt(_0x57ef3f(0xaf))/0x7;if(_0x2f9c92===_0x178fba)break;else _0x391377['push'](_0x391377['shift']());}catch(_0xb0e6d9){_0x391377['push'](_0x391377['shift']());}}}(a45_0x45a0,0x76a4c));const fs=require('fs'),helper=require(a45_0x4a8f2d(0xc6)),utilities=require('../helpers/utilities'),yaml=require('js-yaml'),yargs=require(a45_0x4a8f2d(0xc8)),logger=require(a45_0x4a8f2d(0xb7))['winstonLogger'],configFileTemplate=__dirname+a45_0x4a8f2d(0xa2),configFileTemplatePW=__dirname+a45_0x4a8f2d(0xd6),configFile=process[a45_0x4a8f2d(0xe0)]()+'/browserstack.yml',packageFile=process[a45_0x4a8f2d(0xe0)]()+a45_0x4a8f2d(0xce),frameworks=[a45_0x4a8f2d(0xb9),'jest',a45_0x4a8f2d(0xae),a45_0x4a8f2d(0xd2),'nightwatch',a45_0x4a8f2d(0xbb),a45_0x4a8f2d(0xcb)];let config;logger[a45_0x4a8f2d(0xc0)](a45_0x4a8f2d(0xc1)),createConfigurationFile(yargs['argv'][a45_0x4a8f2d(0xda)],yargs[a45_0x4a8f2d(0xc3)]['key'],yargs['argv']['playwright']);try{sdkSetup();}catch(a45_0x2ea84a){logger[a45_0x4a8f2d(0xa5)]('Error\x20in\x20Fire\x20SDKSetup.\x20Stacktrace:\x20'+a45_0x2ea84a);}addScriptInPackageJson();function createConfigurationFile(_0x45c73e,_0x11d76c,_0x332855=![]){const _0x549960=a45_0x4a8f2d,_0x506f8d={};_0x506f8d[_0x549960(0xe1)]=_0x549960(0xb8),_0x506f8d[_0x549960(0xd8)]=_0x549960(0xc9),_0x506f8d[_0x549960(0xcc)]='YOUR_ACCESS_KEY';const _0x5c75c9=_0x506f8d;try{let _0xf55139=fs[_0x549960(0xde)](_0x332855?configFileTemplatePW:configFileTemplate,_0x5c75c9[_0x549960(0xe1)]);_0x45c73e&&(_0xf55139=_0xf55139[_0x549960(0xaa)](_0x5c75c9['WnMKs'],_0x45c73e)),_0x11d76c&&(_0xf55139=_0xf55139[_0x549960(0xaa)](_0x5c75c9[_0x549960(0xcc)],_0x11d76c)),config=yaml[_0x549960(0xdc)](_0xf55139),fs['writeFileSync'](configFile,_0xf55139,_0x1956c0=>{const _0x434fc8=_0x549960;_0x1956c0&&logger[_0x434fc8(0xa6)](_0x1956c0);});}catch(_0x1f2b2d){logger[_0x549960(0xa6)](_0x1f2b2d);}}function addPostInstallScript(_0x1b595c,_0x83c8bf){const _0x1d6ea8=a45_0x4a8f2d,_0x476faa={};_0x476faa[_0x1d6ea8(0xd7)]=_0x1d6ea8(0xca),_0x476faa[_0x1d6ea8(0xbe)]=_0x1d6ea8(0xc2),_0x476faa[_0x1d6ea8(0xdd)]='\x20&&\x20npm\x20update\x20browserstack-node-sdk';const _0xf310c3=_0x476faa;let _0x7410d1=_0x1b595c[_0xf310c3[_0x1d6ea8(0xd7)]];if(_0x7410d1&&_0x7410d1['includes'](_0xf310c3[_0x1d6ea8(0xbe)]))return;!_0x7410d1?_0x7410d1=_0xf310c3[_0x1d6ea8(0xbe)]:_0x7410d1+=_0xf310c3[_0x1d6ea8(0xdd)],_0x83c8bf[_0x1d6ea8(0xd1)]([_0xf310c3[_0x1d6ea8(0xd7)],_0x7410d1]);}function addScriptInPackageJson(){const _0x46308e=a45_0x4a8f2d,_0x30a8c3={'eppsy':_0x46308e(0xb8),'TIjAi':function(_0x55cee7,_0x148a9e){return _0x55cee7<_0x148a9e;},'oQWbB':function(_0x1cd766,_0x2f5934,_0x1a50c5){return _0x1cd766(_0x2f5934,_0x1a50c5);},'Gylws':function(_0x26141f,_0x1f4bf8,_0xb7c5c2){return _0x26141f(_0x1f4bf8,_0xb7c5c2);},'LDrFy':function(_0x25876b,_0x890051,_0x5d3f9d){return _0x25876b(_0x890051,_0x5d3f9d);},'crJPf':function(_0x4dd209,_0x3ae0e5){return _0x4dd209!==_0x3ae0e5;},'oawcz':_0x46308e(0xe3)},_0x41f817=JSON['parse'](fs[_0x46308e(0xde)](packageFile,_0x30a8c3[_0x46308e(0xac)])),_0x322a3d=[];for(let _0x365e15=0x0;_0x30a8c3[_0x46308e(0xa8)](_0x365e15,frameworks['length']);_0x365e15+=0x1){const _0x57658e=_0x30a8c3[_0x46308e(0xb3)](findScriptsWithFramework,_0x41f817[_0x46308e(0xbc)],frameworks[_0x365e15]);for(let _0x20335e=0x0;_0x30a8c3['TIjAi'](_0x20335e,_0x57658e[_0x46308e(0xb5)]);_0x20335e+=0x1){_0x322a3d[_0x46308e(0xd1)](_0x30a8c3['Gylws'](getUpdatedCommand,_0x41f817[_0x46308e(0xbc)],_0x57658e[_0x20335e]));}_0x30a8c3[_0x46308e(0xb6)](addPostInstallScript,_0x41f817['scripts'],_0x322a3d);}const _0x50301f={..._0x41f817[_0x46308e(0xbc)]},_0x556e93=_0x50301f;for(let _0x151fde=0x0;_0x30a8c3[_0x46308e(0xa8)](_0x151fde,_0x322a3d[_0x46308e(0xb5)]);_0x151fde+=0x1){_0x556e93[_0x322a3d[_0x151fde][0x0]]=_0x322a3d[_0x151fde][0x1];}_0x30a8c3['crJPf'](JSON[_0x46308e(0xc4)](_0x41f817['scripts']),JSON[_0x46308e(0xc4)](_0x556e93))&&(logger[_0x46308e(0xc0)](_0x30a8c3[_0x46308e(0xc7)]),_0x41f817[_0x46308e(0xbc)]=_0x556e93,fs['writeFileSync'](packageFile,JSON[_0x46308e(0xc4)](_0x41f817,null,0x2),_0x18f456=>{_0x18f456&&logger['error'](_0x18f456);}));};function findScriptsWithFramework(_0xf3e2d0,_0xcff916){const _0x2a1530=a45_0x4a8f2d,_0x353a17={};_0x353a17[_0x2a1530(0xdb)]=function(_0x139a4e,_0x2b297b){return _0x139a4e<_0x2b297b;},_0x353a17[_0x2a1530(0xb4)]='browserstack-node-sdk';const _0x4508f4=_0x353a17,_0x127794=[],_0x17e481=Object[_0x2a1530(0xbf)](_0xf3e2d0);for(let _0x6f80e7=0x0;_0x4508f4[_0x2a1530(0xdb)](_0x6f80e7,_0x17e481['length']);_0x6f80e7+=0x1){_0x17e481[_0x6f80e7][0x1][_0x2a1530(0xab)](_0xcff916)&&!_0x17e481[_0x6f80e7][0x1][_0x2a1530(0xab)](_0x4508f4[_0x2a1530(0xb4)])&&_0x127794[_0x2a1530(0xd1)](_0x17e481[_0x6f80e7][0x0]);}return _0x127794;}function getUpdatedCommand(_0x1e1b47,_0x48f98c){const _0x269241=a45_0x4a8f2d,_0x2f7557={};_0x2f7557[_0x269241(0xa7)]=function(_0x29dde8,_0x3a947a){return _0x29dde8!==_0x3a947a;},_0x2f7557[_0x269241(0xd4)]=_0x269241(0xb1),_0x2f7557['gMFdZ']=function(_0x5cc9ff,_0x2bbeda){return _0x5cc9ff===_0x2bbeda;};const _0x45f3ac=_0x2f7557,_0x2b3450=_0x48f98c+'-browserstack',_0x25a733=_0x1e1b47[_0x48f98c],_0x2985d3=_0x25a733[_0x269241(0xb0)]('\x20');for(const _0x33e45d of frameworks){if(_0x45f3ac['naYvT'](_0x2985d3[_0x269241(0xd9)](_0x33e45d),-0x1)){_0x2985d3['splice'](_0x2985d3[_0x269241(0xd9)](_0x33e45d),0x0,_0x45f3ac[_0x269241(0xd4)]);break;}}let _0x39aa60=_0x2985d3[_0x269241(0xdf)]('\x20');return _0x45f3ac['gMFdZ'](_0x39aa60,_0x25a733)&&(_0x39aa60=_0x269241(0xa9)+_0x25a733),[_0x2b3450,_0x39aa60];}function a45_0x2fdd(_0x325157,_0x3435ab){const _0x45a0a3=a45_0x45a0();return a45_0x2fdd=function(_0x2fdd05,_0x2b097f){_0x2fdd05=_0x2fdd05-0xa1;let _0x4be273=_0x45a0a3[_0x2fdd05];return _0x4be273;},a45_0x2fdd(_0x325157,_0x3435ab);}function sdkSetup(){const _0x24cb17=a45_0x4a8f2d,_0xb8e862={};_0xb8e862[_0x24cb17(0xc5)]=_0x24cb17(0xcf),_0xb8e862[_0x24cb17(0xb2)]=_0x24cb17(0xad);const _0x2e9a10=_0xb8e862;if(helper['isUndefined'](config))return;config[_0x24cb17(0xd5)]=_0x2e9a10[_0x24cb17(0xc5)];try{utilities[_0x24cb17(0xe2)](_0x2e9a10['PSWlj'],{},config,'');}catch(_0x32299a){logger[_0x24cb17(0xa5)](_0x24cb17(0xd3)+_0x32299a);}}logger['info'](a45_0x4a8f2d(0xbd));function a45_0x45a0(){const _0x396797=['4406900MeCLdV','329388XaBaTK','debug','error','naYvT','TIjAi','browserstack-node-sdk\x20','replace','includes','eppsy','SDKSetup','cucumber-js','1807645rfIrVe','split','browserstack-node-sdk','PSWlj','oQWbB','GZbFL','length','LDrFy','../helpers/logger','utf8','mocha','1589674yMjtYG','codeceptjs','scripts','Setup\x20completed','KdJuC','entries','info','Creating\x20configuration\x20file...','npm\x20update\x20browserstack-node-sdk','argv','stringify','iZJhB','../helpers/helper','oawcz','yargs','YOUR_USERNAME','postinstall','playwright','UxWrE','251144iPhOKb','/package.json','node-setup','1914510rrcpRb','push','node','Error\x20in\x20Fire\x20SDKSetup.\x20Stacktrace:\x20','rzBou','source','/../../browserstack.pw.yml.sample','tOUuS','WnMKs','indexOf','username','OEKMf','load','htzuZ','readFileSync','join','cwd','EODnx','fireFunnelTestEvent','Adding\x20new\x20script(s)\x20in\x20package.json...','453880yEQWzV','/../../browserstack.yml.sample'];a45_0x45a0=function(){return _0x396797;};return a45_0x45a0();}