#!/usr/bin/env node

function a49_0x4a11(){const _0x320dc1=['eRZyc','1886600ANflWL','tKzOl','splice','ZpCgO','node-setup','ylUhb','readFileSync','browserstack-node-sdk\x20','fireFunnelTestEvent','push','TqlAm','YOUR_USERNAME','SDKSetup','Error\x20in\x20Fire\x20SDKSetup.\x20Stacktrace:\x20','winstonLogger','anabU','PvBlj','split','utf8','lUjib','6613704GAZuyX','HTUep','zKxlg','15WcIbaz','8230635axpZzP','entries','indexOf','zchsZ','YOUR_ACCESS_KEY','writeFileSync','6oUBoIb','5732sNVoNN','/../../browserstack.pw.yml.sample','cNklz','KfAco','../helpers/helper','stringify','js-yaml','debug','length','1081577iaQLbK','info','load','eOCcd','postinstall','/package.json','browserstack-node-sdk','toeET','../helpers/logger','JQedw','WaJhM','Creating\x20configuration\x20file...','11wtBlMj','replace','error','236grhwrS','jest','includes','cDxdX','cvhSj','codeceptjs','scripts','npm\x20update\x20browserstack-node-sdk','argv','node','username','868304numlNq','cwd','3468054VEMDGh','wpOZN','TTldY','playwright'];a49_0x4a11=function(){return _0x320dc1;};return a49_0x4a11();}const a49_0x1454a9=a49_0x250d;(function(_0x1f44ce,_0x19cb15){const _0x589c89=a49_0x250d,_0x2c69a5=_0x1f44ce();while(!![]){try{const _0x3a1493=parseInt(_0x589c89(0xaf))/0x1*(parseInt(_0x589c89(0x97))/0x2)+parseInt(_0x589c89(0xbc))/0x3+-parseInt(_0x589c89(0xba))/0x4*(-parseInt(_0x589c89(0x8f))/0x5)+-parseInt(_0x589c89(0x96))/0x6*(-parseInt(_0x589c89(0xa0))/0x7)+-parseInt(_0x589c89(0x8c))/0x8+-parseInt(_0x589c89(0x90))/0x9+parseInt(_0x589c89(0x78))/0xa*(-parseInt(_0x589c89(0xac))/0xb);if(_0x3a1493===_0x19cb15)break;else _0x2c69a5['push'](_0x2c69a5['shift']());}catch(_0x539b02){_0x2c69a5['push'](_0x2c69a5['shift']());}}}(a49_0x4a11,0xace95));const fs=require('fs'),helper=require(a49_0x1454a9(0x9b)),utilities=require('../helpers/utilities'),yaml=require(a49_0x1454a9(0x9d)),yargs=require('yargs'),logger=require(a49_0x1454a9(0xa8))[a49_0x1454a9(0x86)],configFileTemplate=__dirname+'/../../browserstack.yml.sample',configFileTemplatePW=__dirname+a49_0x1454a9(0x98),configFile=process[a49_0x1454a9(0xbb)]()+'/browserstack.yml',packageFile=process[a49_0x1454a9(0xbb)]()+a49_0x1454a9(0xa5),frameworks=['mocha',a49_0x1454a9(0xb0),'cucumber-js',a49_0x1454a9(0xb8),'nightwatch',a49_0x1454a9(0xb4),a49_0x1454a9(0xbf)];let config;logger[a49_0x1454a9(0xa1)](a49_0x1454a9(0xab)),createConfigurationFile(yargs[a49_0x1454a9(0xb7)][a49_0x1454a9(0xb9)],yargs[a49_0x1454a9(0xb7)]['key'],yargs['argv']['playwright']);try{sdkSetup();}catch(a49_0x10cae2){logger[a49_0x1454a9(0x9e)]('Error\x20in\x20Fire\x20SDKSetup.\x20Stacktrace:\x20'+a49_0x10cae2);}addScriptInPackageJson();function createConfigurationFile(_0x4cfbb2,_0x5711bf,_0x4604c8=![]){const _0xc88a2a=a49_0x1454a9,_0x41babf={};_0x41babf['KfAco']=_0xc88a2a(0x8a),_0x41babf[_0xc88a2a(0x8e)]=_0xc88a2a(0x83),_0x41babf[_0xc88a2a(0x7b)]=_0xc88a2a(0x94);const _0x4eed91=_0x41babf;try{let _0x2168c6=fs[_0xc88a2a(0x7e)](_0x4604c8?configFileTemplatePW:configFileTemplate,_0x4eed91[_0xc88a2a(0x9a)]);_0x4cfbb2&&(_0x2168c6=_0x2168c6[_0xc88a2a(0xad)](_0x4eed91['zKxlg'],_0x4cfbb2)),_0x5711bf&&(_0x2168c6=_0x2168c6[_0xc88a2a(0xad)](_0x4eed91[_0xc88a2a(0x7b)],_0x5711bf)),config=yaml[_0xc88a2a(0xa2)](_0x2168c6),fs[_0xc88a2a(0x95)](configFile,_0x2168c6,_0x19aab3=>{_0x19aab3&&logger['error'](_0x19aab3);});}catch(_0x5a79af){logger[_0xc88a2a(0xae)](_0x5a79af);}}function addPostInstallScript(_0x269179,_0xce13f6){const _0xfde1d0=a49_0x1454a9,_0x220c38={};_0x220c38[_0xfde1d0(0xa9)]=_0xfde1d0(0xa4),_0x220c38['cDxdX']=_0xfde1d0(0xb6),_0x220c38[_0xfde1d0(0xbe)]='\x20&&\x20npm\x20update\x20browserstack-node-sdk';const _0x332038=_0x220c38;let _0x13be7b=_0x269179[_0x332038['JQedw']];if(_0x13be7b&&_0x13be7b[_0xfde1d0(0xb1)](_0x332038[_0xfde1d0(0xb2)]))return;!_0x13be7b?_0x13be7b=_0x332038[_0xfde1d0(0xb2)]:_0x13be7b+=_0x332038['TTldY'],_0xce13f6[_0xfde1d0(0x81)]([_0x332038[_0xfde1d0(0xa9)],_0x13be7b]);}function addScriptInPackageJson(){const _0x3c4bf3=a49_0x1454a9,_0x5af9a3={'PvBlj':_0x3c4bf3(0x8a),'eOCcd':function(_0x22387b,_0x4de799){return _0x22387b<_0x4de799;},'anabU':function(_0x1c588e,_0x2cf572,_0xfe01f8){return _0x1c588e(_0x2cf572,_0xfe01f8);},'eRZyc':function(_0x4859f8,_0x4ec04c){return _0x4859f8<_0x4ec04c;},'ylUhb':function(_0x572739,_0x3cb9fd,_0x589bf4){return _0x572739(_0x3cb9fd,_0x589bf4);},'HTUep':function(_0x3e5820,_0x44855b){return _0x3e5820<_0x44855b;},'zchsZ':function(_0x1e4c3b,_0xc1d9d8){return _0x1e4c3b!==_0xc1d9d8;},'WaJhM':'Adding\x20new\x20script(s)\x20in\x20package.json...'},_0xf6ac95=JSON['parse'](fs[_0x3c4bf3(0x7e)](packageFile,_0x5af9a3[_0x3c4bf3(0x88)])),_0x256d2a=[];for(let _0x5b657c=0x0;_0x5af9a3[_0x3c4bf3(0xa3)](_0x5b657c,frameworks['length']);_0x5b657c+=0x1){const _0x5640a7=_0x5af9a3[_0x3c4bf3(0x87)](findScriptsWithFramework,_0xf6ac95['scripts'],frameworks[_0x5b657c]);for(let _0x223e82=0x0;_0x5af9a3[_0x3c4bf3(0xc0)](_0x223e82,_0x5640a7['length']);_0x223e82+=0x1){_0x256d2a[_0x3c4bf3(0x81)](_0x5af9a3[_0x3c4bf3(0x87)](getUpdatedCommand,_0xf6ac95[_0x3c4bf3(0xb5)],_0x5640a7[_0x223e82]));}_0x5af9a3[_0x3c4bf3(0x7d)](addPostInstallScript,_0xf6ac95[_0x3c4bf3(0xb5)],_0x256d2a);}const _0x5af7f9={..._0xf6ac95['scripts']},_0x2c78cc=_0x5af7f9;for(let _0x32d687=0x0;_0x5af9a3[_0x3c4bf3(0x8d)](_0x32d687,_0x256d2a['length']);_0x32d687+=0x1){_0x2c78cc[_0x256d2a[_0x32d687][0x0]]=_0x256d2a[_0x32d687][0x1];}_0x5af9a3[_0x3c4bf3(0x93)](JSON[_0x3c4bf3(0x9c)](_0xf6ac95[_0x3c4bf3(0xb5)]),JSON[_0x3c4bf3(0x9c)](_0x2c78cc))&&(logger[_0x3c4bf3(0xa1)](_0x5af9a3[_0x3c4bf3(0xaa)]),_0xf6ac95[_0x3c4bf3(0xb5)]=_0x2c78cc,fs[_0x3c4bf3(0x95)](packageFile,JSON[_0x3c4bf3(0x9c)](_0xf6ac95,null,0x2),_0xabf5c1=>{_0xabf5c1&&logger['error'](_0xabf5c1);}));};function findScriptsWithFramework(_0xfd15,_0x23097b){const _0x1130d1=a49_0x1454a9,_0x5bd62c={};_0x5bd62c[_0x1130d1(0x79)]=function(_0x43c2a9,_0x5d5da5){return _0x43c2a9<_0x5d5da5;},_0x5bd62c[_0x1130d1(0x8b)]=_0x1130d1(0xa6);const _0x16fcf6=_0x5bd62c,_0x1009fb=[],_0x372509=Object[_0x1130d1(0x91)](_0xfd15);for(let _0x2aa777=0x0;_0x16fcf6['tKzOl'](_0x2aa777,_0x372509[_0x1130d1(0x9f)]);_0x2aa777+=0x1){_0x372509[_0x2aa777][0x1][_0x1130d1(0xb1)](_0x23097b)&&!_0x372509[_0x2aa777][0x1][_0x1130d1(0xb1)](_0x16fcf6[_0x1130d1(0x8b)])&&_0x1009fb[_0x1130d1(0x81)](_0x372509[_0x2aa777][0x0]);}return _0x1009fb;}function getUpdatedCommand(_0x3e9449,_0x58bb27){const _0x424a82=a49_0x1454a9,_0x1041db={};_0x1041db['TqlAm']=function(_0x472de1,_0x74ae16){return _0x472de1!==_0x74ae16;},_0x1041db[_0x424a82(0x99)]=_0x424a82(0xa6),_0x1041db[_0x424a82(0xb3)]=function(_0x3e290a,_0x2bcd72){return _0x3e290a===_0x2bcd72;};const _0x1ccd4c=_0x1041db,_0xeea635=_0x58bb27+'-browserstack',_0x3e5f27=_0x3e9449[_0x58bb27],_0x509a53=_0x3e5f27[_0x424a82(0x89)]('\x20');for(const _0x56fc9a of frameworks){if(_0x1ccd4c[_0x424a82(0x82)](_0x509a53[_0x424a82(0x92)](_0x56fc9a),-0x1)){_0x509a53[_0x424a82(0x7a)](_0x509a53[_0x424a82(0x92)](_0x56fc9a),0x0,_0x1ccd4c[_0x424a82(0x99)]);break;}}let _0x27b4f9=_0x509a53['join']('\x20');return _0x1ccd4c[_0x424a82(0xb3)](_0x27b4f9,_0x3e5f27)&&(_0x27b4f9=_0x424a82(0x7f)+_0x3e5f27),[_0xeea635,_0x27b4f9];}function sdkSetup(){const _0x1a1ca2=a49_0x1454a9,_0x59e0eb={};_0x59e0eb[_0x1a1ca2(0xbd)]=_0x1a1ca2(0x7c),_0x59e0eb[_0x1a1ca2(0xa7)]=_0x1a1ca2(0x84);const _0x58d587=_0x59e0eb;if(helper['isUndefined'](config))return;config['source']=_0x58d587[_0x1a1ca2(0xbd)];try{utilities[_0x1a1ca2(0x80)](_0x58d587[_0x1a1ca2(0xa7)],{},config,'');}catch(_0x5cb0b7){logger[_0x1a1ca2(0x9e)](_0x1a1ca2(0x85)+_0x5cb0b7);}}function a49_0x250d(_0x41f31c,_0x2a11a9){const _0x4a1150=a49_0x4a11();return a49_0x250d=function(_0x250d6a,_0x300d18){_0x250d6a=_0x250d6a-0x78;let _0xddc352=_0x4a1150[_0x250d6a];return _0xddc352;},a49_0x250d(_0x41f31c,_0x2a11a9);}logger[a49_0x1454a9(0xa1)]('Setup\x20completed');