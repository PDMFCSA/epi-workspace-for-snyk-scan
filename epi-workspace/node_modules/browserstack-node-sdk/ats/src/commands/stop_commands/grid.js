const a21_0x44a585=a21_0x361e;(function(_0x2c45e4,_0x2e3160){const _0x2ec0d7=a21_0x361e,_0x42befe=_0x2c45e4();while(!![]){try{const _0x50bad2=-parseInt(_0x2ec0d7(0x199))/0x1*(-parseInt(_0x2ec0d7(0x1b1))/0x2)+-parseInt(_0x2ec0d7(0x194))/0x3*(parseInt(_0x2ec0d7(0x17a))/0x4)+-parseInt(_0x2ec0d7(0x1a8))/0x5*(-parseInt(_0x2ec0d7(0x1bf))/0x6)+parseInt(_0x2ec0d7(0x1c2))/0x7*(-parseInt(_0x2ec0d7(0x1b4))/0x8)+-parseInt(_0x2ec0d7(0x193))/0x9+parseInt(_0x2ec0d7(0x178))/0xa+-parseInt(_0x2ec0d7(0x1b0))/0xb;if(_0x50bad2===_0x2e3160)break;else _0x42befe['push'](_0x42befe['shift']());}catch(_0x4b40be){_0x42befe['push'](_0x42befe['shift']());}}}(a21_0x513f,0x85646));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x44a585(0x176)),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0x44a585(0x17c)),{sendInstrumentationEvent}=require('../../utils/instrumentationUtils'),webSocketUtils=require(a21_0x44a585(0x1b6)),{createK8sClient}=require(a21_0x44a585(0x18a)),{getCloudProviderObject}=require('../../cloudproviders/utils');exports['command']='grid',exports['desc']='Stop\x20a\x20running\x20Automation\x20grid.',exports['builder']=function(_0x1d7a5d){const _0x2d16b9=a21_0x44a585,_0x7267b0={};_0x7267b0[_0x2d16b9(0x184)]='Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.',_0x7267b0['FjraI']=_0x2d16b9(0x1af),_0x7267b0[_0x2d16b9(0x1a6)]='Skip\x20insecure\x20cert\x20verification.',_0x7267b0[_0x2d16b9(0x1c1)]=_0x2d16b9(0x190),_0x7267b0[_0x2d16b9(0x181)]='help';const _0x254092=_0x7267b0,_0x24f33a={};_0x24f33a[_0x2d16b9(0x1c5)]=_0x254092[_0x2d16b9(0x184)],_0x24f33a[_0x2d16b9(0x18c)]=_0x254092['FjraI'];const _0xa3c272={};_0xa3c272['description']=_0x254092[_0x2d16b9(0x1a6)],_0xa3c272[_0x2d16b9(0x18c)]=_0x254092[_0x2d16b9(0x1c1)],_0xa3c272[_0x2d16b9(0x1ad)]=![];const _0x164284={};return _0x164284[_0x2d16b9(0x1c0)]=_0x24f33a,_0x164284['skip-tls-cert-verify']=_0xa3c272,_0x1d7a5d[_0x2d16b9(0x1bd)](HELP_HEADER_MESSAGE[_0x2d16b9(0x1ab)])['epilogue'](HELP_FOOTER_MESSAGE)[_0x2d16b9(0x1b5)](_0x164284)[_0x2d16b9(0x171)](_0x254092[_0x2d16b9(0x181)])[_0x2d16b9(0x191)];},exports['handler']=async function(_0x5a805b){const _0x346e96=a21_0x44a585,_0x1aff68={'tJiFs':_0x346e96(0x17e),'FjJQv':function(_0x107e01){return _0x107e01();},'sYjwg':_0x346e96(0x18f),'vQihJ':function(_0x332329,_0x55037d,_0x3ff0d9,_0x8a9263,_0x1b505a,_0x2e41a9,_0x3f4666){return _0x332329(_0x55037d,_0x3ff0d9,_0x8a9263,_0x1b505a,_0x2e41a9,_0x3f4666);},'liEXK':_0x346e96(0x1a5),'XOhDZ':_0x346e96(0x19f),'hExnt':function(_0x1a1641,_0x5a9e42,_0x5688eb,_0x262604,_0x2cd223,_0x22aa42,_0x1cc3d8){return _0x1a1641(_0x5a9e42,_0x5688eb,_0x262604,_0x2cd223,_0x22aa42,_0x1cc3d8);},'oxQPz':function(_0x71ddb0){return _0x71ddb0();},'NQIYV':_0x346e96(0x17b),'PDOlw':_0x346e96(0x177),'dHtsP':'Adding\x20Websocket\x20listeners','vqbHk':function(_0x3936fa,_0x509dba,_0x5ddf3d,_0x42ac54){return _0x3936fa(_0x509dba,_0x5ddf3d,_0x42ac54);},'oXVVA':function(_0x5d03ba,_0x9f5adb,_0x1a7160,_0x595b4f,_0xb0de4f,_0x1a357b,_0x5d6272){return _0x5d03ba(_0x9f5adb,_0x1a7160,_0x595b4f,_0xb0de4f,_0x1a357b,_0x5d6272);},'xDrAb':function(_0x22d1f2,_0xb34291,_0x7cbdf){return _0x22d1f2(_0xb34291,_0x7cbdf);},'jqaCa':_0x346e96(0x175),'xswas':function(_0x5da749,_0x27dd25){return _0x5da749===_0x27dd25;},'jadzS':_0x346e96(0x1b7),'qhMSv':_0x346e96(0x1b9),'rKGDC':function(_0x284a03,_0x598860){return _0x284a03===_0x598860;},'ZkjQj':function(_0x5a7d83,_0x4195b2,_0x2b06a2,_0x2822a5,_0x1443da,_0x2b3add,_0x53fee3){return _0x5a7d83(_0x4195b2,_0x2b06a2,_0x2822a5,_0x1443da,_0x2b3add,_0x53fee3);},'SfGRv':'invalid-grid-id','tYNNJ':function(_0x5395a4,_0x4e2d49,_0x5d9eb9,_0x29777b,_0x1fd8b4,_0x29b0c1,_0x44103e){return _0x5395a4(_0x4e2d49,_0x5d9eb9,_0x29777b,_0x1fd8b4,_0x29b0c1,_0x44103e);},'dpurF':_0x346e96(0x187)};let _0x2e2dfe;try{!_0x5a805b[_0x346e96(0x18b)]&&(logger['error'](_0x1aff68[_0x346e96(0x19d)]),process[_0x346e96(0x1b3)](0x1));!fs[_0x346e96(0x195)](_0x1aff68[_0x346e96(0x180)](getCredentialsPath))&&(logger['error'](_0x1aff68[_0x346e96(0x1c4)]),await _0x1aff68[_0x346e96(0x16f)](sendInstrumentationEvent,_0x5a805b,_0x1aff68[_0x346e96(0x185)],messageTypes[_0x346e96(0x188)],_0x1aff68['XOhDZ'],null,_0x5a805b),process[_0x346e96(0x1b3)](0x1));logger['info'](_0x346e96(0x18d)+_0x5a805b['gridId']),await _0x1aff68[_0x346e96(0x183)](sendInstrumentationEvent,_0x5a805b,_0x1aff68[_0x346e96(0x185)],messageTypes[_0x346e96(0x174)],null,null,_0x5a805b);const _0x218307=JSON['parse'](fs['readFileSync'](_0x1aff68[_0x346e96(0x16d)](getCredentialsPath)));global_registry[_0x346e96(0x1bc)]=_0x218307[_0x346e96(0x16b)][_0x346e96(0x170)],global_registry['bstackAccesskey']=_0x218307[_0x346e96(0x16b)][_0x346e96(0x1ac)];const _0x149037=WS_ENDPOINT[_0x346e96(0x192)](_0x1aff68[_0x346e96(0x173)],_0x218307['Browserstack'][_0x346e96(0x170)])['replace'](_0x1aff68[_0x346e96(0x197)],_0x218307['Browserstack']['password']),_0x19c8f0={};_0x19c8f0[_0x346e96(0x17d)]=ws,_0x19c8f0['connectionTimeout']=0x36ee80,_0x2e2dfe=new ReconnectingWebSocket(_0x149037,[],_0x19c8f0),logger[_0x346e96(0x1a4)](_0x1aff68[_0x346e96(0x1a2)]),webSocketUtils[_0x346e96(0x1b2)](_0x2e2dfe,_0x5a805b[_0x346e96(0x18e)],_0x5a805b['password']);const [_0x56dfcc,_0x362b48]=await _0x1aff68[_0x346e96(0x1ba)](getGridDetails,_0x218307['Browserstack']['username'],_0x218307[_0x346e96(0x16b)][_0x346e96(0x1ac)],_0x5a805b[_0x346e96(0x18b)]);if(_0x362b48){const _0xbf7e8e=_0x362b48['info'];global_registry[_0x346e96(0x1a3)]=_0xbf7e8e[_0x346e96(0x1a3)],global_registry[_0x346e96(0x19a)]=_0xbf7e8e[_0x346e96(0x198)],global_registry[_0x346e96(0x179)]=_0xbf7e8e[_0x346e96(0x179)];const _0x13a708=await _0x1aff68['oXVVA'](getCloudProviderObject,_0xbf7e8e['cloudProvider'],_0xbf7e8e[_0x346e96(0x179)],_0xbf7e8e[_0x346e96(0x172)],_0x2e2dfe,webSocketUtils,_0x5a805b),[_0x3c1180,_0x440178,_0xe657f9,_0xe75695,_0x2a07b4,_0x22acc5]=await _0x1aff68[_0x346e96(0x16c)](createK8sClient,_0x13a708,_0x5a805b[_0x346e96(0x1b8)]);await _0x1aff68[_0x346e96(0x16c)](scaleDownHubDeployment,_0x440178,_0xbf7e8e['name']),logger[_0x346e96(0x19c)](_0x1aff68[_0x346e96(0x1a7)]),process['exit'](0x0);}_0x1aff68[_0x346e96(0x186)](_0x56dfcc[_0x346e96(0x1c3)],0x191)&&(logger[_0x346e96(0x1a0)](_0x1aff68[_0x346e96(0x1ae)]),await _0x1aff68[_0x346e96(0x19e)](sendInstrumentationEvent,_0x5a805b,_0x1aff68[_0x346e96(0x185)],messageTypes[_0x346e96(0x188)],_0x1aff68[_0x346e96(0x1a1)],null,_0x5a805b),process[_0x346e96(0x1b3)](0x1)),_0x1aff68[_0x346e96(0x16e)](_0x56dfcc[_0x346e96(0x1c3)],0x190)&&(logger[_0x346e96(0x1a0)](JSON[_0x346e96(0x1aa)](_0x56dfcc['body'])[_0x346e96(0x196)]),await _0x1aff68[_0x346e96(0x1bb)](sendInstrumentationEvent,_0x5a805b,_0x1aff68[_0x346e96(0x185)],messageTypes[_0x346e96(0x188)],_0x1aff68[_0x346e96(0x1a9)],null,_0x5a805b),process['exit'](0x1)),logger['error'](_0x346e96(0x182)+JSON['stringify'](_0x56dfcc)),await _0x1aff68[_0x346e96(0x17f)](sendInstrumentationEvent,_0x5a805b,_0x1aff68[_0x346e96(0x185)],messageTypes[_0x346e96(0x188)],_0x1aff68[_0x346e96(0x189)],_0x56dfcc,_0x5a805b),process[_0x346e96(0x1b3)](0x1);}catch(_0x8f9ef4){const _0x1792c0=_0x346e96(0x19b)+_0x8f9ef4+'\x20\x0a'+JSON[_0x346e96(0x1be)](_0x8f9ef4['stack'])+'\x20';logger[_0x346e96(0x1a0)](_0x1792c0),process[_0x346e96(0x1b3)](0x1);}};function a21_0x361e(_0x5e70f0,_0x1f20ce){const _0x513f8f=a21_0x513f();return a21_0x361e=function(_0x361ecc,_0x89f578){_0x361ecc=_0x361ecc-0x16b;let _0x116a91=_0x513f8f[_0x361ecc];return _0x116a91;},a21_0x361e(_0x5e70f0,_0x1f20ce);}function a21_0x513f(){const _0x50045a=['Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','hExnt','zHium','liEXK','xswas','server-error','ERROR','dpurF','../../utils/createk8sClient','gridId','type','Stopping\x20grid\x20','user','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','boolean','argv','replace','2767914UghUHM','27285vZdDVs','existsSync','message','PDOlw','region','232886NuICzD','clusterRegion','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','info','tJiFs','oXVVA','init-not-called','error','qhMSv','dHtsP','cloudProvider','debug','stop-grid-called','jothT','jqaCa','105OdNimY','SfGRv','parse','stop','password','default','jadzS','string','731049kLxtVa','2EZmVfB','addListeners','exit','152Gbdidk','options','../../utils/webSocketUtils','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','skipTlsCertVerify','unauthorised','vqbHk','ZkjQj','bstackUsername','usage','stringify','305010uxmphL','grid-id','TisLN','355873OqvSEm','statusCode','sYjwg','description','Browserstack','xDrAb','oxQPz','rKGDC','vQihJ','username','help','name','NQIYV','INFO','Grid\x20stoppped.','../../config/constants','<PasswordPlaceholder>','9224140oygdqO','clusterName','148WDtTdX','<UsernamePlaceholder>','../../utils/gridComponents','WebSocket','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','tYNNJ','FjJQv','WkluH'];a21_0x513f=function(){return _0x50045a;};return a21_0x513f();}