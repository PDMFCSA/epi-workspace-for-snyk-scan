const a21_0x585c28=a21_0x3c3d;function a21_0x19fe(){const _0x1bd796=['3605tzhYRk','clusterName','usage','stop','unauthorised','init-not-called','Browserstack','46GRXTzJ','stop-grid-called','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','KMHlt','../../config/constants','fBRPg','stack','FDXll','clusterRegion','DDQmF','../../utils/instrumentationUtils','description','fNIkT','pUyWq','addListeners','OWXUk','stringify','grid-id','command','2550rCmCgV','152hDZmEA','vbgtc','../../config/logger','DgwWo','error','jlwsd','../../utils/gridComponents','<PasswordPlaceholder>','GeYuG','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','statusCode','zcDFN','cCDGN','INFO','boolean','OHrOW','Grid\x20stoppped.','../../utils/createk8sClient','exit','407ETFXHW','bhueo','parse','body','aNJOq','829335fqCVgP','Stopping\x20grid\x20','SYHdz','zarsT','sVovE','existsSync','15753IRjwEB','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','bstackUsername','grid','../../utils/webSocketUtils','password','invalid-grid-id','837592GmgJKN','WaSDh','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','cloudProvider','SEsPF','username','message','reconnecting-websocket','6571CdmBBD','debug','jexTH','Stop\x20a\x20running\x20Automation\x20grid.','tQaws','default','help','server-error','VFSIz','readFileSync','info','48460JryUpW','bcwEU','user','gridId','name','connectionTimeout','desc','skip-tls-cert-verify','<UsernamePlaceholder>','ERROR','replace','403875LfXVTU','YkpZG'];a21_0x19fe=function(){return _0x1bd796;};return a21_0x19fe();}function a21_0x3c3d(_0x37596b,_0x42bd03){const _0x19fed6=a21_0x19fe();return a21_0x3c3d=function(_0x3c3d15,_0x4ab59e){_0x3c3d15=_0x3c3d15-0xe8;let _0x54e824=_0x19fed6[_0x3c3d15];return _0x54e824;},a21_0x3c3d(_0x37596b,_0x42bd03);}(function(_0x1396b4,_0x451c6a){const _0x320304=a21_0x3c3d,_0x3666e0=_0x1396b4();while(!![]){try{const _0x111256=-parseInt(_0x320304(0x139))/0x1*(-parseInt(_0x320304(0xf7))/0x2)+-parseInt(_0x320304(0x129))/0x3*(parseInt(_0x320304(0x10b))/0x4)+parseInt(_0x320304(0x123))/0x5+-parseInt(_0x320304(0x10a))/0x6*(parseInt(_0x320304(0xf0))/0x7)+parseInt(_0x320304(0x130))/0x8+-parseInt(_0x320304(0xee))/0x9+parseInt(_0x320304(0x144))/0xa*(parseInt(_0x320304(0x11e))/0xb);if(_0x111256===_0x451c6a)break;else _0x3666e0['push'](_0x3666e0['shift']());}catch(_0x202286){_0x3666e0['push'](_0x3666e0['shift']());}}}(a21_0x19fe,0x219f1));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x585c28(0x138)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x585c28(0xfb)),{logger}=require(a21_0x585c28(0x10d)),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0x585c28(0x111)),{sendInstrumentationEvent}=require(a21_0x585c28(0x101)),webSocketUtils=require(a21_0x585c28(0x12d)),{createK8sClient}=require(a21_0x585c28(0x11c)),{getCloudProviderObject}=require('../../cloudproviders/utils');exports[a21_0x585c28(0x109)]=a21_0x585c28(0x12c),exports[a21_0x585c28(0xe9)]=a21_0x585c28(0x13c),exports['builder']=function(_0x3f3688){const _0x18d280=a21_0x585c28,_0x548a6a={};_0x548a6a['bhueo']=_0x18d280(0x133),_0x548a6a[_0x18d280(0x125)]='string',_0x548a6a[_0x18d280(0x126)]='Skip\x20insecure\x20cert\x20verification.',_0x548a6a[_0x18d280(0x103)]=_0x18d280(0x119),_0x548a6a['DgwWo']='help';const _0x370756=_0x548a6a,_0x4148ce={};_0x4148ce[_0x18d280(0x102)]=_0x370756[_0x18d280(0x11f)],_0x4148ce['type']=_0x370756[_0x18d280(0x125)];const _0x236e5c={};_0x236e5c[_0x18d280(0x102)]=_0x370756[_0x18d280(0x126)],_0x236e5c['type']=_0x370756[_0x18d280(0x103)],_0x236e5c[_0x18d280(0x13e)]=![];const _0x2042f4={};return _0x2042f4[_0x18d280(0x108)]=_0x4148ce,_0x2042f4[_0x18d280(0xea)]=_0x236e5c,_0x3f3688[_0x18d280(0xf2)](HELP_HEADER_MESSAGE[_0x18d280(0xf3)])['epilogue'](HELP_FOOTER_MESSAGE)['options'](_0x2042f4)[_0x18d280(0x13f)](_0x370756[_0x18d280(0x10e)])['argv'];},exports['handler']=async function(_0x23c3b0){const _0x1dbdf7=a21_0x585c28,_0x2d5147={'aNJOq':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','SEsPF':function(_0xe1091d){return _0xe1091d();},'zcDFN':_0x1dbdf7(0x114),'tQaws':function(_0x579739,_0x12e44c,_0x431657,_0x12ab4a,_0x58f2b2,_0xb7ae65,_0x3ce442){return _0x579739(_0x12e44c,_0x431657,_0x12ab4a,_0x58f2b2,_0xb7ae65,_0x3ce442);},'jlwsd':_0x1dbdf7(0xf8),'KMHlt':_0x1dbdf7(0xf5),'fBRPg':function(_0x1628cd,_0x323ce5,_0x1e27d4,_0x597d91,_0x6013aa,_0x24a34b,_0x386415){return _0x1628cd(_0x323ce5,_0x1e27d4,_0x597d91,_0x6013aa,_0x24a34b,_0x386415);},'pUyWq':function(_0x2a8f9f){return _0x2a8f9f();},'DDQmF':_0x1dbdf7(0xeb),'bcwEU':_0x1dbdf7(0x112),'WaSDh':'Adding\x20Websocket\x20listeners','OWXUk':function(_0x8cfd8e,_0x315806,_0x5e21dd,_0x34acdf){return _0x8cfd8e(_0x315806,_0x5e21dd,_0x34acdf);},'sVovE':function(_0x147608,_0x510373,_0x21826b,_0x30e1c5,_0x5683a9,_0x291030,_0x20faf5){return _0x147608(_0x510373,_0x21826b,_0x30e1c5,_0x5683a9,_0x291030,_0x20faf5);},'MrYzN':function(_0x11ede0,_0x2ec05e,_0x5ceead){return _0x11ede0(_0x2ec05e,_0x5ceead);},'GeYuG':function(_0x389f5e,_0xffee59,_0x1269f6){return _0x389f5e(_0xffee59,_0x1269f6);},'OHrOW':_0x1dbdf7(0x11b),'VFSIz':function(_0x35e6ee,_0x26c5c4){return _0x35e6ee===_0x26c5c4;},'YkpZG':_0x1dbdf7(0x12a),'vbgtc':_0x1dbdf7(0xf4),'FDXll':function(_0x273ebb,_0x29e7ff,_0x3d13b1,_0x441254,_0x2dcd36,_0x324ca1,_0x4bccd4){return _0x273ebb(_0x29e7ff,_0x3d13b1,_0x441254,_0x2dcd36,_0x324ca1,_0x4bccd4);},'cCDGN':_0x1dbdf7(0x12f),'jexTH':_0x1dbdf7(0x140)};let _0x280fd3;try{!_0x23c3b0[_0x1dbdf7(0x147)]&&(logger[_0x1dbdf7(0x10f)](_0x2d5147[_0x1dbdf7(0x122)]),process[_0x1dbdf7(0x11d)](0x1));!fs[_0x1dbdf7(0x128)](_0x2d5147[_0x1dbdf7(0x135)](getCredentialsPath))&&(logger[_0x1dbdf7(0x10f)](_0x2d5147[_0x1dbdf7(0x116)]),await _0x2d5147[_0x1dbdf7(0x13d)](sendInstrumentationEvent,_0x23c3b0,_0x2d5147[_0x1dbdf7(0x110)],messageTypes[_0x1dbdf7(0xec)],_0x2d5147[_0x1dbdf7(0xfa)],null,_0x23c3b0),process['exit'](0x1));logger[_0x1dbdf7(0x143)](_0x1dbdf7(0x124)+_0x23c3b0[_0x1dbdf7(0x147)]),await _0x2d5147[_0x1dbdf7(0xfc)](sendInstrumentationEvent,_0x23c3b0,_0x2d5147[_0x1dbdf7(0x110)],messageTypes[_0x1dbdf7(0x118)],null,null,_0x23c3b0);const _0x477c2a=JSON[_0x1dbdf7(0x120)](fs[_0x1dbdf7(0x142)](_0x2d5147[_0x1dbdf7(0x104)](getCredentialsPath)));global_registry[_0x1dbdf7(0x12b)]=_0x477c2a['Browserstack'][_0x1dbdf7(0x136)],global_registry['bstackAccesskey']=_0x477c2a[_0x1dbdf7(0xf6)]['password'];const _0x58fe29=WS_ENDPOINT[_0x1dbdf7(0xed)](_0x2d5147[_0x1dbdf7(0x100)],_0x477c2a['Browserstack'][_0x1dbdf7(0x136)])[_0x1dbdf7(0xed)](_0x2d5147[_0x1dbdf7(0x145)],_0x477c2a[_0x1dbdf7(0xf6)][_0x1dbdf7(0x12e)]),_0x148769={};_0x148769['WebSocket']=ws,_0x148769[_0x1dbdf7(0xe8)]=0x36ee80,_0x280fd3=new ReconnectingWebSocket(_0x58fe29,[],_0x148769),logger[_0x1dbdf7(0x13a)](_0x2d5147[_0x1dbdf7(0x131)]),webSocketUtils[_0x1dbdf7(0x105)](_0x280fd3,_0x23c3b0[_0x1dbdf7(0x146)],_0x23c3b0[_0x1dbdf7(0x12e)]);const [_0x43063d,_0x1073f0]=await _0x2d5147[_0x1dbdf7(0x106)](getGridDetails,_0x477c2a[_0x1dbdf7(0xf6)][_0x1dbdf7(0x136)],_0x477c2a[_0x1dbdf7(0xf6)][_0x1dbdf7(0x12e)],_0x23c3b0['gridId']);if(_0x1073f0){const _0x5ca22e=_0x1073f0[_0x1dbdf7(0x143)];global_registry[_0x1dbdf7(0x134)]=_0x5ca22e[_0x1dbdf7(0x134)],global_registry[_0x1dbdf7(0xff)]=_0x5ca22e['region'],global_registry['clusterName']=_0x5ca22e[_0x1dbdf7(0xf1)];const _0x2b9ed7=await _0x2d5147[_0x1dbdf7(0x127)](getCloudProviderObject,_0x5ca22e['cloudProvider'],_0x5ca22e[_0x1dbdf7(0xf1)],_0x5ca22e[_0x1dbdf7(0x148)],_0x280fd3,webSocketUtils,_0x23c3b0),[_0x3273af,_0xd8b976,_0x4a394e,_0x1c612f,_0x2209ae,_0x4f9341]=await _0x2d5147['MrYzN'](createK8sClient,_0x2b9ed7,_0x23c3b0['skipTlsCertVerify']);await _0x2d5147[_0x1dbdf7(0x113)](scaleDownHubDeployment,_0xd8b976,_0x5ca22e[_0x1dbdf7(0x148)]),logger[_0x1dbdf7(0x143)](_0x2d5147[_0x1dbdf7(0x11a)]),process[_0x1dbdf7(0x11d)](0x0);}_0x2d5147[_0x1dbdf7(0x141)](_0x43063d[_0x1dbdf7(0x115)],0x191)&&(logger[_0x1dbdf7(0x10f)](_0x2d5147[_0x1dbdf7(0xef)]),await _0x2d5147[_0x1dbdf7(0x127)](sendInstrumentationEvent,_0x23c3b0,_0x2d5147[_0x1dbdf7(0x110)],messageTypes['ERROR'],_0x2d5147[_0x1dbdf7(0x10c)],null,_0x23c3b0),process['exit'](0x1)),_0x2d5147[_0x1dbdf7(0x141)](_0x43063d[_0x1dbdf7(0x115)],0x190)&&(logger['error'](JSON['parse'](_0x43063d[_0x1dbdf7(0x121)])[_0x1dbdf7(0x137)]),await _0x2d5147[_0x1dbdf7(0xfe)](sendInstrumentationEvent,_0x23c3b0,_0x2d5147['jlwsd'],messageTypes[_0x1dbdf7(0xec)],_0x2d5147[_0x1dbdf7(0x117)],null,_0x23c3b0),process['exit'](0x1)),logger[_0x1dbdf7(0x10f)](_0x1dbdf7(0x132)+JSON['stringify'](_0x43063d)),await _0x2d5147[_0x1dbdf7(0xfc)](sendInstrumentationEvent,_0x23c3b0,_0x2d5147[_0x1dbdf7(0x110)],messageTypes[_0x1dbdf7(0xec)],_0x2d5147[_0x1dbdf7(0x13b)],_0x43063d,_0x23c3b0),process[_0x1dbdf7(0x11d)](0x1);}catch(_0x3e6641){const _0x4c5a6e=_0x1dbdf7(0xf9)+_0x3e6641+'\x20\x0a'+JSON[_0x1dbdf7(0x107)](_0x3e6641[_0x1dbdf7(0xfd)])+'\x20';logger[_0x1dbdf7(0x10f)](_0x4c5a6e),process[_0x1dbdf7(0x11d)](0x1);}};