const a21_0x1ddc3c=a21_0x976c;(function(_0x253c9b,_0x1c7460){const _0x55f548=a21_0x976c,_0x1aade5=_0x253c9b();while(!![]){try{const _0x30d543=parseInt(_0x55f548(0xda))/0x1*(-parseInt(_0x55f548(0xf1))/0x2)+-parseInt(_0x55f548(0xf0))/0x3*(parseInt(_0x55f548(0xeb))/0x4)+-parseInt(_0x55f548(0xdf))/0x5+-parseInt(_0x55f548(0x119))/0x6*(-parseInt(_0x55f548(0xe3))/0x7)+parseInt(_0x55f548(0x103))/0x8*(parseInt(_0x55f548(0xd9))/0x9)+parseInt(_0x55f548(0xcd))/0xa*(-parseInt(_0x55f548(0xc7))/0xb)+parseInt(_0x55f548(0xdb))/0xc;if(_0x30d543===_0x1c7460)break;else _0x1aade5['push'](_0x1aade5['shift']());}catch(_0x1fe788){_0x1aade5['push'](_0x1aade5['shift']());}}}(a21_0x3bff,0xe98f0));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x1ddc3c(0x104)),{logger}=require(a21_0x1ddc3c(0x109)),{getCredentialsPath,getGridDetails}=require(a21_0x1ddc3c(0xde)),{scaleDownHubDeployment}=require(a21_0x1ddc3c(0x120)),{sendInstrumentationEvent}=require(a21_0x1ddc3c(0xf4)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require('../../utils/createk8sClient'),{getCloudProviderObject}=require(a21_0x1ddc3c(0x101));exports['command']=a21_0x1ddc3c(0x10f),exports['desc']=a21_0x1ddc3c(0xff),exports[a21_0x1ddc3c(0x10a)]=function(_0x197522){const _0x206692=a21_0x1ddc3c,_0x43554a={};_0x43554a['RIbyj']=_0x206692(0xe1),_0x43554a[_0x206692(0x115)]=_0x206692(0x10e),_0x43554a[_0x206692(0x10d)]=_0x206692(0xfa),_0x43554a['clhqA']=_0x206692(0xed),_0x43554a[_0x206692(0xdc)]=_0x206692(0x113);const _0x2b977f=_0x43554a,_0x26f8d7={};_0x26f8d7['description']=_0x2b977f['RIbyj'],_0x26f8d7[_0x206692(0xc6)]=_0x2b977f['UdRiz'];const _0x4f4f18={};_0x4f4f18[_0x206692(0xd4)]=_0x2b977f[_0x206692(0x10d)],_0x4f4f18[_0x206692(0xc6)]=_0x2b977f['clhqA'],_0x4f4f18[_0x206692(0xef)]=![];const _0x1334d8={};return _0x1334d8[_0x206692(0x118)]=_0x26f8d7,_0x1334d8['skip-tls-cert-verify']=_0x4f4f18,_0x197522[_0x206692(0xc8)](HELP_HEADER_MESSAGE[_0x206692(0xea)])[_0x206692(0x111)](HELP_FOOTER_MESSAGE)[_0x206692(0x10b)](_0x1334d8)[_0x206692(0x113)](_0x2b977f[_0x206692(0xdc)])[_0x206692(0xcf)];},exports['handler']=async function(_0x170d24){const _0x4a8166=a21_0x1ddc3c,_0x38c553={'URYfM':_0x4a8166(0xe9),'oKEks':function(_0x2119c2){return _0x2119c2();},'YWiVq':_0x4a8166(0xf5),'tAhMA':function(_0x2e4112,_0x4e136f,_0xd76206,_0x438c7b,_0x3c3320,_0x425b01,_0x2e55b8){return _0x2e4112(_0x4e136f,_0xd76206,_0x438c7b,_0x3c3320,_0x425b01,_0x2e55b8);},'dQerw':_0x4a8166(0x116),'iMnsp':_0x4a8166(0xec),'ZTrCW':function(_0x5c7885){return _0x5c7885();},'WVnoQ':'<UsernamePlaceholder>','DQWgX':_0x4a8166(0xfb),'OxOdZ':_0x4a8166(0x11d),'ywcaZ':function(_0x5e1c61,_0x3d23e1,_0x381200,_0x1baca2){return _0x5e1c61(_0x3d23e1,_0x381200,_0x1baca2);},'hYzIv':function(_0x2eaa1d,_0x1558a1,_0x4a6a5f,_0x22f687,_0x7bfd34,_0x537732,_0x5cb398){return _0x2eaa1d(_0x1558a1,_0x4a6a5f,_0x22f687,_0x7bfd34,_0x537732,_0x5cb398);},'DHJfe':function(_0x2e1b6e,_0x5dde0f,_0x3fad01){return _0x2e1b6e(_0x5dde0f,_0x3fad01);},'oXuok':function(_0x204b1a,_0x57ea8c,_0x23376d){return _0x204b1a(_0x57ea8c,_0x23376d);},'zthpc':_0x4a8166(0x102),'KAOke':function(_0x4846cb,_0x513022){return _0x4846cb===_0x513022;},'jsnPg':_0x4a8166(0xc5),'ctMNi':function(_0x2a980e,_0x2129d4,_0x42740f,_0x4c9364,_0x5aed40,_0x5b8be5,_0x43d549){return _0x2a980e(_0x2129d4,_0x42740f,_0x4c9364,_0x5aed40,_0x5b8be5,_0x43d549);},'iyTIk':'unauthorised','ysuGc':_0x4a8166(0xe6),'XWEkF':_0x4a8166(0xc4)};let _0x5e11c4;try{!_0x170d24[_0x4a8166(0x108)]&&(logger[_0x4a8166(0xfe)](_0x38c553[_0x4a8166(0xd2)]),process[_0x4a8166(0xf7)](0x1));!fs[_0x4a8166(0xd8)](_0x38c553[_0x4a8166(0x105)](getCredentialsPath))&&(logger[_0x4a8166(0xfe)](_0x38c553[_0x4a8166(0xd7)]),await _0x38c553[_0x4a8166(0x11c)](sendInstrumentationEvent,_0x170d24,_0x38c553[_0x4a8166(0xcb)],messageTypes['ERROR'],_0x38c553[_0x4a8166(0x123)],null,_0x170d24),process[_0x4a8166(0xf7)](0x1));logger[_0x4a8166(0xe7)](_0x4a8166(0x122)+_0x170d24[_0x4a8166(0x108)]),await _0x38c553['tAhMA'](sendInstrumentationEvent,_0x170d24,_0x38c553[_0x4a8166(0xcb)],messageTypes[_0x4a8166(0xe0)],null,null,_0x170d24);const _0x4d7466=JSON[_0x4a8166(0xe2)](fs[_0x4a8166(0xdd)](_0x38c553['ZTrCW'](getCredentialsPath)));global_registry[_0x4a8166(0x121)]=_0x4d7466[_0x4a8166(0x11e)][_0x4a8166(0xd0)],global_registry[_0x4a8166(0xc3)]=_0x4d7466[_0x4a8166(0x11e)][_0x4a8166(0xce)];const _0x4f24f9=WS_ENDPOINT[_0x4a8166(0xfd)](_0x38c553['WVnoQ'],_0x4d7466['Browserstack']['username'])[_0x4a8166(0xfd)](_0x38c553['DQWgX'],_0x4d7466[_0x4a8166(0x11e)][_0x4a8166(0xce)]),_0x2247ec={};_0x2247ec[_0x4a8166(0x107)]=ws,_0x2247ec[_0x4a8166(0x11b)]=0x36ee80,_0x5e11c4=new ReconnectingWebSocket(_0x4f24f9,[],_0x2247ec),logger[_0x4a8166(0xd1)](_0x38c553[_0x4a8166(0x117)]),webSocketUtils[_0x4a8166(0x100)](_0x5e11c4,_0x170d24[_0x4a8166(0xf3)],_0x170d24[_0x4a8166(0xce)]);const [_0x5757f5,_0x4ab16f]=await _0x38c553[_0x4a8166(0xca)](getGridDetails,_0x4d7466['Browserstack']['username'],_0x4d7466['Browserstack'][_0x4a8166(0xce)],_0x170d24[_0x4a8166(0x108)]);if(_0x4ab16f){const _0x36e0f0=_0x4ab16f[_0x4a8166(0xe7)];global_registry[_0x4a8166(0xf8)]=_0x36e0f0['cloudProvider'],global_registry['clusterRegion']=_0x36e0f0[_0x4a8166(0xe8)],global_registry['clusterName']=_0x36e0f0['clusterName'];const _0x2ebb38=await _0x38c553[_0x4a8166(0xd3)](getCloudProviderObject,_0x36e0f0[_0x4a8166(0xf8)],_0x36e0f0[_0x4a8166(0xee)],_0x36e0f0[_0x4a8166(0x114)],_0x5e11c4,webSocketUtils,_0x170d24),[_0x2257c8,_0x54be95,_0x51ba9f,_0x1f5092,_0x4ada81,_0x2ec639]=await _0x38c553[_0x4a8166(0xe4)](createK8sClient,_0x2ebb38,_0x170d24[_0x4a8166(0xd5)]);await _0x38c553[_0x4a8166(0xc9)](scaleDownHubDeployment,_0x54be95,_0x36e0f0[_0x4a8166(0x114)]),logger[_0x4a8166(0xe7)](_0x38c553[_0x4a8166(0xd6)]),process[_0x4a8166(0xf7)](0x0);}_0x38c553[_0x4a8166(0x112)](_0x5757f5[_0x4a8166(0xcc)],0x191)&&(logger['error'](_0x38c553['jsnPg']),await _0x38c553['ctMNi'](sendInstrumentationEvent,_0x170d24,_0x38c553['dQerw'],messageTypes[_0x4a8166(0xe5)],_0x38c553[_0x4a8166(0xc2)],null,_0x170d24),process[_0x4a8166(0xf7)](0x1)),_0x38c553[_0x4a8166(0x112)](_0x5757f5[_0x4a8166(0xcc)],0x190)&&(logger['error'](JSON['parse'](_0x5757f5[_0x4a8166(0x11a)])[_0x4a8166(0x106)]),await _0x38c553[_0x4a8166(0x11f)](sendInstrumentationEvent,_0x170d24,_0x38c553[_0x4a8166(0xcb)],messageTypes[_0x4a8166(0xe5)],_0x38c553[_0x4a8166(0xf6)],null,_0x170d24),process['exit'](0x1)),logger[_0x4a8166(0xfe)](_0x4a8166(0xfc)+JSON[_0x4a8166(0xf2)](_0x5757f5)),await _0x38c553[_0x4a8166(0x11f)](sendInstrumentationEvent,_0x170d24,_0x38c553[_0x4a8166(0xcb)],messageTypes[_0x4a8166(0xe5)],_0x38c553[_0x4a8166(0x10c)],_0x5757f5,_0x170d24),process[_0x4a8166(0xf7)](0x1);}catch(_0x3b119a){const _0x349de7=_0x4a8166(0xf9)+_0x3b119a+'\x20\x0a'+JSON['stringify'](_0x3b119a[_0x4a8166(0x110)])+'\x20';logger['error'](_0x349de7),process[_0x4a8166(0xf7)](0x1);}};function a21_0x976c(_0x3dea18,_0x3b2b40){const _0x3bffab=a21_0x3bff();return a21_0x976c=function(_0x976c0b,_0x45d336){_0x976c0b=_0x976c0b-0xc2;let _0x26b636=_0x3bffab[_0x976c0b];return _0x26b636;},a21_0x976c(_0x3dea18,_0x3b2b40);}function a21_0x3bff(){const _0x4535fc=['OxOdZ','grid-id','30mfrYCF','body','connectionTimeout','tAhMA','Adding\x20Websocket\x20listeners','Browserstack','ctMNi','../../utils/gridComponents','bstackUsername','Stopping\x20grid\x20','iMnsp','iyTIk','bstackAccesskey','server-error','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','type','11jRnDBP','usage','oXuok','ywcaZ','dQerw','statusCode','77860KqDLLL','password','argv','username','debug','URYfM','hYzIv','description','skipTlsCertVerify','zthpc','YWiVq','existsSync','851850wjBFdI','125359FlEVKz','1854924zlTPxC','SjjzA','readFileSync','../../utils/utilityMethods','1703680qKFOCw','INFO','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','parse','1860929gIRvDv','DHJfe','ERROR','invalid-grid-id','info','region','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','stop','44108IixdIN','init-not-called','boolean','clusterName','default','375ebCaul','2nsttEb','stringify','user','../../utils/instrumentationUtils','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','ysuGc','exit','cloudProvider','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','Skip\x20insecure\x20cert\x20verification.','<PasswordPlaceholder>','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','replace','error','Stop\x20a\x20running\x20Automation\x20grid.','addListeners','../../cloudproviders/utils','Grid\x20stoppped.','112kFeuAs','../../config/constants','oKEks','message','WebSocket','gridId','../../config/logger','builder','options','XWEkF','KZxPB','string','grid','stack','epilogue','KAOke','help','name','UdRiz','stop-grid-called'];a21_0x3bff=function(){return _0x4535fc;};return a21_0x3bff();}