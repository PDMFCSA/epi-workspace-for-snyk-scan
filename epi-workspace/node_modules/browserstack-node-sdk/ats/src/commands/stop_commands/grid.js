const a21_0x2328d5=a21_0x4161;(function(_0x44274b,_0x4a69ef){const _0x4bae00=a21_0x4161,_0x5c42a7=_0x44274b();while(!![]){try{const _0x3efd5f=parseInt(_0x4bae00(0x162))/0x1*(-parseInt(_0x4bae00(0x128))/0x2)+-parseInt(_0x4bae00(0x141))/0x3*(parseInt(_0x4bae00(0x17d))/0x4)+parseInt(_0x4bae00(0x15b))/0x5*(-parseInt(_0x4bae00(0x164))/0x6)+-parseInt(_0x4bae00(0x137))/0x7+-parseInt(_0x4bae00(0x142))/0x8+parseInt(_0x4bae00(0x156))/0x9*(parseInt(_0x4bae00(0x14d))/0xa)+parseInt(_0x4bae00(0x14f))/0xb*(parseInt(_0x4bae00(0x12b))/0xc);if(_0x3efd5f===_0x4a69ef)break;else _0x5c42a7['push'](_0x5c42a7['shift']());}catch(_0x300ba4){_0x5c42a7['push'](_0x5c42a7['shift']());}}}(a21_0x2f31,0xa7422));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x2328d5(0x134)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x2328d5(0x160)),{logger}=require(a21_0x2328d5(0x17c)),{getCredentialsPath,getGridDetails}=require(a21_0x2328d5(0x14e)),{scaleDownHubDeployment}=require(a21_0x2328d5(0x153)),{sendInstrumentationEvent}=require('../../utils/instrumentationUtils'),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x2328d5(0x11e)),{getCloudProviderObject}=require(a21_0x2328d5(0x124));function a21_0x2f31(){const _0x308a7=['stop-grid-called','ERROR','grid-id','username','argv','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','password','Adding\x20Websocket\x20listeners','connectionTimeout','stack','addListeners','epilogue','cFkvS','AcovS','../../config/logger','991372JRtHLf','gridId','../../utils/createk8sClient','clusterRegion','jWEBD','bstackUsername','boolean','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','../../cloudproviders/utils','MMQBc','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','server-error','2sDvDps','readFileSync','description','53471748pILDxI','replace','error','string','Grid\x20stoppped.','fPdmd','WebSocket','JCnDk','existsSync','reconnecting-websocket','cloudProvider','stringify','9479043BshOpp','stop','exit','KvJEb','gGxas','dkVhQ','nILNh','XcIHF','region','dyFEo','12dsubJk','2959504ydNRng','init-not-called','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','name','xwLYL','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','OTcbs','Stopping\x20grid\x20','statusCode','unauthorised','eBbFq','2780630joPBLl','../../utils/utilityMethods','11BPpIce','options','twoob','clusterName','../../utils/gridComponents','Browserstack','parse','9zNJaZx','command','eWlSO','SxFVy','nwEWM','415gsuRsF','skipTlsCertVerify','desc','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','handler','../../config/constants','debug','70482TLCiuP','fznLl','91302SDTdOY','invalid-grid-id','bstackAccesskey','type','info','help','TLUTY','lvUja','kxawr','JyrMD'];a21_0x2f31=function(){return _0x308a7;};return a21_0x2f31();}function a21_0x4161(_0x5b7fe3,_0x125ec9){const _0x2f31e6=a21_0x2f31();return a21_0x4161=function(_0x4161f6,_0x2eaf99){_0x4161f6=_0x4161f6-0x11e;let _0x33c471=_0x2f31e6[_0x4161f6];return _0x33c471;},a21_0x4161(_0x5b7fe3,_0x125ec9);}exports[a21_0x2328d5(0x157)]='grid',exports[a21_0x2328d5(0x15d)]='Stop\x20a\x20running\x20Automation\x20grid.',exports['builder']=function(_0x50da85){const _0x3a2b88=a21_0x2328d5,_0x29872f={};_0x29872f['dyFEo']=_0x3a2b88(0x147),_0x29872f[_0x3a2b88(0x13c)]=_0x3a2b88(0x12e),_0x29872f['MMQBc']='Skip\x20insecure\x20cert\x20verification.',_0x29872f['JyrMD']=_0x3a2b88(0x122),_0x29872f[_0x3a2b88(0x17a)]=_0x3a2b88(0x169);const _0xcebb67=_0x29872f,_0xa21ede={};_0xa21ede[_0x3a2b88(0x12a)]=_0xcebb67[_0x3a2b88(0x140)],_0xa21ede[_0x3a2b88(0x167)]=_0xcebb67[_0x3a2b88(0x13c)];const _0x3df526={};_0x3df526[_0x3a2b88(0x12a)]=_0xcebb67[_0x3a2b88(0x125)],_0x3df526['type']=_0xcebb67[_0x3a2b88(0x16d)],_0x3df526['default']=![];const _0x542c46={};return _0x542c46[_0x3a2b88(0x170)]=_0xa21ede,_0x542c46['skip-tls-cert-verify']=_0x3df526,_0x50da85['usage'](HELP_HEADER_MESSAGE[_0x3a2b88(0x138)])[_0x3a2b88(0x179)](HELP_FOOTER_MESSAGE)[_0x3a2b88(0x150)](_0x542c46)[_0x3a2b88(0x169)](_0xcebb67[_0x3a2b88(0x17a)])[_0x3a2b88(0x172)];},exports[a21_0x2328d5(0x15f)]=async function(_0x368392){const _0x4b881a=a21_0x2328d5,_0x311ee8={'nwEWM':_0x4b881a(0x126),'fznLl':function(_0x13d9e3){return _0x13d9e3();},'EWuLu':_0x4b881a(0x173),'jWEBD':function(_0x55ae2d,_0x1dd725,_0x5ddc96,_0x236526,_0x3ee95b,_0x431862,_0x19fa37){return _0x55ae2d(_0x1dd725,_0x5ddc96,_0x236526,_0x3ee95b,_0x431862,_0x19fa37);},'KvJEb':_0x4b881a(0x16e),'TLUTY':_0x4b881a(0x143),'nILNh':function(_0x22dcdc,_0x2c2140,_0x2e278e,_0x25602e,_0x48c208,_0x4c40e4,_0x1504e4){return _0x22dcdc(_0x2c2140,_0x2e278e,_0x25602e,_0x48c208,_0x4c40e4,_0x1504e4);},'dhRTF':'<UsernamePlaceholder>','gGxas':'<PasswordPlaceholder>','SxFVy':_0x4b881a(0x175),'xwLYL':function(_0x1a0d1d,_0xdc4624,_0x4a9893,_0x5a9e64){return _0x1a0d1d(_0xdc4624,_0x4a9893,_0x5a9e64);},'lvUja':function(_0xacfc2d,_0x16f93f,_0x5dbc9b,_0x20235b,_0x30e8d0,_0x282475,_0x52f9a5){return _0xacfc2d(_0x16f93f,_0x5dbc9b,_0x20235b,_0x30e8d0,_0x282475,_0x52f9a5);},'XcIHF':function(_0x39e2fe,_0x3c4be6,_0x50dda1){return _0x39e2fe(_0x3c4be6,_0x50dda1);},'JCnDk':_0x4b881a(0x12f),'OTcbs':function(_0x327bce,_0x2f5aca){return _0x327bce===_0x2f5aca;},'AcovS':_0x4b881a(0x144),'kxawr':function(_0x268c22,_0x19125e,_0x3f092d,_0x3a5825,_0x37eb56,_0x1ad5f4,_0x23e8a5){return _0x268c22(_0x19125e,_0x3f092d,_0x3a5825,_0x37eb56,_0x1ad5f4,_0x23e8a5);},'fPdmd':_0x4b881a(0x14b),'twoob':function(_0x250d83,_0x525069,_0x23be9c,_0xb98780,_0x172c91,_0x4a38fe,_0x1eac45){return _0x250d83(_0x525069,_0x23be9c,_0xb98780,_0x172c91,_0x4a38fe,_0x1eac45);},'eBbFq':_0x4b881a(0x165),'eWlSO':_0x4b881a(0x127)};let _0x3837ce;try{!_0x368392[_0x4b881a(0x17e)]&&(logger[_0x4b881a(0x12d)](_0x311ee8[_0x4b881a(0x15a)]),process['exit'](0x1));!fs[_0x4b881a(0x133)](_0x311ee8['fznLl'](getCredentialsPath))&&(logger['error'](_0x311ee8['EWuLu']),await _0x311ee8[_0x4b881a(0x120)](sendInstrumentationEvent,_0x368392,_0x311ee8[_0x4b881a(0x13a)],messageTypes[_0x4b881a(0x16f)],_0x311ee8[_0x4b881a(0x16a)],null,_0x368392),process[_0x4b881a(0x139)](0x1));logger[_0x4b881a(0x168)](_0x4b881a(0x149)+_0x368392['gridId']),await _0x311ee8[_0x4b881a(0x13d)](sendInstrumentationEvent,_0x368392,_0x311ee8[_0x4b881a(0x13a)],messageTypes['INFO'],null,null,_0x368392);const _0x1cacce=JSON[_0x4b881a(0x155)](fs[_0x4b881a(0x129)](_0x311ee8[_0x4b881a(0x163)](getCredentialsPath)));global_registry[_0x4b881a(0x121)]=_0x1cacce[_0x4b881a(0x154)]['username'],global_registry[_0x4b881a(0x166)]=_0x1cacce[_0x4b881a(0x154)]['password'];const _0x2c8467=WS_ENDPOINT[_0x4b881a(0x12c)](_0x311ee8['dhRTF'],_0x1cacce['Browserstack'][_0x4b881a(0x171)])[_0x4b881a(0x12c)](_0x311ee8[_0x4b881a(0x13b)],_0x1cacce[_0x4b881a(0x154)][_0x4b881a(0x174)]),_0x382c7f={};_0x382c7f[_0x4b881a(0x131)]=ws,_0x382c7f[_0x4b881a(0x176)]=0x36ee80,_0x3837ce=new ReconnectingWebSocket(_0x2c8467,[],_0x382c7f),logger[_0x4b881a(0x161)](_0x311ee8[_0x4b881a(0x159)]),webSocketUtils[_0x4b881a(0x178)](_0x3837ce,_0x368392['user'],_0x368392[_0x4b881a(0x174)]);const [_0x3d7208,_0x5e3d5f]=await _0x311ee8[_0x4b881a(0x146)](getGridDetails,_0x1cacce['Browserstack']['username'],_0x1cacce['Browserstack']['password'],_0x368392['gridId']);if(_0x5e3d5f){const _0x338ed7=_0x5e3d5f['info'];global_registry['cloudProvider']=_0x338ed7[_0x4b881a(0x135)],global_registry[_0x4b881a(0x11f)]=_0x338ed7[_0x4b881a(0x13f)],global_registry[_0x4b881a(0x152)]=_0x338ed7[_0x4b881a(0x152)];const _0x1990e4=await _0x311ee8[_0x4b881a(0x16b)](getCloudProviderObject,_0x338ed7[_0x4b881a(0x135)],_0x338ed7['clusterName'],_0x338ed7[_0x4b881a(0x145)],_0x3837ce,webSocketUtils,_0x368392),[_0x18a273,_0x162f37,_0x1c4bfd,_0x198e15,_0x20bfdf,_0x33096b]=await _0x311ee8[_0x4b881a(0x13e)](createK8sClient,_0x1990e4,_0x368392[_0x4b881a(0x15c)]);await _0x311ee8[_0x4b881a(0x13e)](scaleDownHubDeployment,_0x162f37,_0x338ed7[_0x4b881a(0x145)]),logger[_0x4b881a(0x168)](_0x311ee8[_0x4b881a(0x132)]),process[_0x4b881a(0x139)](0x0);}_0x311ee8[_0x4b881a(0x148)](_0x3d7208[_0x4b881a(0x14a)],0x191)&&(logger[_0x4b881a(0x12d)](_0x311ee8[_0x4b881a(0x17b)]),await _0x311ee8[_0x4b881a(0x16c)](sendInstrumentationEvent,_0x368392,_0x311ee8[_0x4b881a(0x13a)],messageTypes[_0x4b881a(0x16f)],_0x311ee8[_0x4b881a(0x130)],null,_0x368392),process[_0x4b881a(0x139)](0x1)),_0x311ee8['OTcbs'](_0x3d7208[_0x4b881a(0x14a)],0x190)&&(logger[_0x4b881a(0x12d)](JSON[_0x4b881a(0x155)](_0x3d7208['body'])['message']),await _0x311ee8[_0x4b881a(0x151)](sendInstrumentationEvent,_0x368392,_0x311ee8['KvJEb'],messageTypes[_0x4b881a(0x16f)],_0x311ee8[_0x4b881a(0x14c)],null,_0x368392),process[_0x4b881a(0x139)](0x1)),logger['error'](_0x4b881a(0x15e)+JSON['stringify'](_0x3d7208)),await _0x311ee8['lvUja'](sendInstrumentationEvent,_0x368392,_0x311ee8[_0x4b881a(0x13a)],messageTypes['ERROR'],_0x311ee8[_0x4b881a(0x158)],_0x3d7208,_0x368392),process['exit'](0x1);}catch(_0x50b590){const _0x9ad13b=_0x4b881a(0x123)+_0x50b590+'\x20\x0a'+JSON[_0x4b881a(0x136)](_0x50b590[_0x4b881a(0x177)])+'\x20';logger[_0x4b881a(0x12d)](_0x9ad13b),process[_0x4b881a(0x139)](0x1);}};