const a21_0x364c10=a21_0x1b76;(function(_0x4ce5d0,_0x579f95){const _0x3bd951=a21_0x1b76,_0x5b8b23=_0x4ce5d0();while(!![]){try{const _0x5a97a7=-parseInt(_0x3bd951(0x137))/0x1*(parseInt(_0x3bd951(0x15c))/0x2)+-parseInt(_0x3bd951(0x133))/0x3*(-parseInt(_0x3bd951(0x176))/0x4)+parseInt(_0x3bd951(0x13a))/0x5+-parseInt(_0x3bd951(0x155))/0x6*(parseInt(_0x3bd951(0x181))/0x7)+parseInt(_0x3bd951(0x130))/0x8*(-parseInt(_0x3bd951(0x140))/0x9)+parseInt(_0x3bd951(0x171))/0xa*(-parseInt(_0x3bd951(0x15f))/0xb)+parseInt(_0x3bd951(0x134))/0xc;if(_0x5a97a7===_0x579f95)break;else _0x5b8b23['push'](_0x5b8b23['shift']());}catch(_0x2d6970){_0x5b8b23['push'](_0x5b8b23['shift']());}}}(a21_0x2433,0xa3067));function a21_0x1b76(_0x4fa788,_0x3c918b){const _0x2433db=a21_0x2433();return a21_0x1b76=function(_0x1b762f,_0x486e4e){_0x1b762f=_0x1b762f-0x12f;let _0x25c390=_0x2433db[_0x1b762f];return _0x25c390;},a21_0x1b76(_0x4fa788,_0x3c918b);}function a21_0x2433(){const _0x259ed9=['skipTlsCertVerify','addListeners','readFileSync','ERROR','clusterRegion','handler','snyoP','parse','4949YUzszx','../../utils/gridComponents','Browserstack','bstackAccesskey','INFO','replace','type','error','fAvlI','EyNaX','string','QxGJy','3544YFqbnB','epilogue','body','33ZBoMve','12671556QCpxma','exit','builder','5409yfIYKE','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','Stop\x20a\x20running\x20Automation\x20grid.','427305JbOypv','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','wapDB','grid','../../config/constants','sazrk','10683VxylYv','../../config/logger','existsSync','wilCr','AlUae','options','argv','clusterName','username','pzWrB','<PasswordPlaceholder>','WsHpg','help','description','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','stop','name','stringify','stack','gDvTW','684palEEH','unauthorised','gridId','TUJdH','Skip\x20insecure\x20cert\x20verification.','MnNhh','invalid-grid-id','134ZvsnZR','info','Ltqph','9076892wZnXmR','AbWuG','password','ysFTR','reconnecting-websocket','desc','connectionTimeout','xDSun','PZNwt','user','XjjSk','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','default','../../utils/instrumentationUtils','Stopping\x20grid\x20','rHyRX','cloudProvider','server-error','10GutVOE','init-not-called','command','QDjod','xHZng','480124JaDWZZ','statusCode','qnEhB'];a21_0x2433=function(){return _0x259ed9;};return a21_0x2433();}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x364c10(0x163)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x364c10(0x13e)),{logger}=require(a21_0x364c10(0x141)),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0x364c10(0x182)),{sendInstrumentationEvent}=require(a21_0x364c10(0x16c)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require('../../utils/createk8sClient'),{getCloudProviderObject}=require('../../cloudproviders/utils');exports[a21_0x364c10(0x173)]=a21_0x364c10(0x13d),exports[a21_0x364c10(0x164)]=a21_0x364c10(0x139),exports[a21_0x364c10(0x136)]=function(_0x2f46b0){const _0x3b550b=a21_0x364c10,_0x3d0c1f={};_0x3d0c1f[_0x3b550b(0x160)]=_0x3b550b(0x14e),_0x3d0c1f[_0x3b550b(0x189)]=_0x3b550b(0x18b),_0x3d0c1f[_0x3b550b(0x175)]=_0x3b550b(0x159),_0x3d0c1f['XjjSk']='boolean',_0x3d0c1f['Ltqph']=_0x3b550b(0x14c);const _0x5e9632=_0x3d0c1f,_0x116a5c={};_0x116a5c['description']=_0x5e9632[_0x3b550b(0x160)],_0x116a5c[_0x3b550b(0x187)]=_0x5e9632['fAvlI'];const _0x259509={};_0x259509[_0x3b550b(0x14d)]=_0x5e9632['xHZng'],_0x259509['type']=_0x5e9632[_0x3b550b(0x169)],_0x259509[_0x3b550b(0x16b)]=![];const _0x415a84={};return _0x415a84['grid-id']=_0x116a5c,_0x415a84['skip-tls-cert-verify']=_0x259509,_0x2f46b0['usage'](HELP_HEADER_MESSAGE[_0x3b550b(0x150)])[_0x3b550b(0x131)](HELP_FOOTER_MESSAGE)[_0x3b550b(0x145)](_0x415a84)['help'](_0x5e9632[_0x3b550b(0x15e)])[_0x3b550b(0x146)];},exports[a21_0x364c10(0x17e)]=async function(_0x29a26f){const _0x5389ad=a21_0x364c10,_0x50b17d={'WsHpg':_0x5389ad(0x14f),'xDSun':function(_0x1e173f){return _0x1e173f();},'TUJdH':_0x5389ad(0x13b),'rHyRX':function(_0x1f7f04,_0x42a50f,_0x35b18d,_0x471694,_0x42c1fe,_0x503c10,_0x59ab06){return _0x1f7f04(_0x42a50f,_0x35b18d,_0x471694,_0x42c1fe,_0x503c10,_0x59ab06);},'sazrk':'stop-grid-called','QDjod':_0x5389ad(0x172),'tIzHg':function(_0x370ee6,_0x1e7721,_0x30ccd2,_0xd5888d,_0x37437f,_0xfa98eb,_0x572372){return _0x370ee6(_0x1e7721,_0x30ccd2,_0xd5888d,_0x37437f,_0xfa98eb,_0x572372);},'QxGJy':'<UsernamePlaceholder>','qnEhB':_0x5389ad(0x14a),'PGRSJ':'Adding\x20Websocket\x20listeners','MnNhh':function(_0x2505af,_0x83beca,_0x352456,_0x49b0c5){return _0x2505af(_0x83beca,_0x352456,_0x49b0c5);},'pzWrB':function(_0x5e2930,_0x292a5d,_0x37be0,_0x1a6c7b,_0x15e6ae,_0x399882,_0x19ac7d){return _0x5e2930(_0x292a5d,_0x37be0,_0x1a6c7b,_0x15e6ae,_0x399882,_0x19ac7d);},'EyNaX':function(_0x135bfe,_0x4f122b,_0x5bd5d4){return _0x135bfe(_0x4f122b,_0x5bd5d4);},'snyoP':'Grid\x20stoppped.','PZNwt':function(_0x24ccd2,_0x61c0f3){return _0x24ccd2===_0x61c0f3;},'AlUae':_0x5389ad(0x16a),'wapDB':function(_0x919803,_0xb08558,_0x5411f5,_0x250992,_0x36a187,_0x19d165,_0x2398fa){return _0x919803(_0xb08558,_0x5411f5,_0x250992,_0x36a187,_0x19d165,_0x2398fa);},'wilCr':_0x5389ad(0x156),'zvlpZ':function(_0x5af93a,_0x3b47ff,_0x100516,_0x542d64,_0x355b26,_0x152ea7,_0x5567b0){return _0x5af93a(_0x3b47ff,_0x100516,_0x542d64,_0x355b26,_0x152ea7,_0x5567b0);},'gDvTW':_0x5389ad(0x15b),'ysFTR':function(_0x183ad1,_0x51ff61,_0x2b8255,_0x20f821,_0x2027f3,_0x2b52b8,_0x5f4207){return _0x183ad1(_0x51ff61,_0x2b8255,_0x20f821,_0x2027f3,_0x2b52b8,_0x5f4207);},'vCGbd':_0x5389ad(0x170)};let _0x548d11;try{!_0x29a26f['gridId']&&(logger[_0x5389ad(0x188)](_0x50b17d[_0x5389ad(0x14b)]),process[_0x5389ad(0x135)](0x1));!fs[_0x5389ad(0x142)](_0x50b17d['xDSun'](getCredentialsPath))&&(logger[_0x5389ad(0x188)](_0x50b17d[_0x5389ad(0x158)]),await _0x50b17d[_0x5389ad(0x16e)](sendInstrumentationEvent,_0x29a26f,_0x50b17d['sazrk'],messageTypes['ERROR'],_0x50b17d[_0x5389ad(0x174)],null,_0x29a26f),process[_0x5389ad(0x135)](0x1));logger['info'](_0x5389ad(0x16d)+_0x29a26f[_0x5389ad(0x157)]),await _0x50b17d['tIzHg'](sendInstrumentationEvent,_0x29a26f,_0x50b17d['sazrk'],messageTypes[_0x5389ad(0x185)],null,null,_0x29a26f);const _0xba10f3=JSON['parse'](fs[_0x5389ad(0x17b)](_0x50b17d[_0x5389ad(0x166)](getCredentialsPath)));global_registry['bstackUsername']=_0xba10f3[_0x5389ad(0x183)][_0x5389ad(0x148)],global_registry[_0x5389ad(0x184)]=_0xba10f3['Browserstack']['password'];const _0x3faac1=WS_ENDPOINT[_0x5389ad(0x186)](_0x50b17d[_0x5389ad(0x12f)],_0xba10f3[_0x5389ad(0x183)][_0x5389ad(0x148)])['replace'](_0x50b17d[_0x5389ad(0x178)],_0xba10f3[_0x5389ad(0x183)][_0x5389ad(0x161)]),_0x2fd5f6={};_0x2fd5f6['WebSocket']=ws,_0x2fd5f6[_0x5389ad(0x165)]=0x36ee80,_0x548d11=new ReconnectingWebSocket(_0x3faac1,[],_0x2fd5f6),logger['debug'](_0x50b17d['PGRSJ']),webSocketUtils[_0x5389ad(0x17a)](_0x548d11,_0x29a26f[_0x5389ad(0x168)],_0x29a26f[_0x5389ad(0x161)]);const [_0x34686c,_0x5cfccd]=await _0x50b17d[_0x5389ad(0x15a)](getGridDetails,_0xba10f3[_0x5389ad(0x183)][_0x5389ad(0x148)],_0xba10f3['Browserstack'][_0x5389ad(0x161)],_0x29a26f[_0x5389ad(0x157)]);if(_0x5cfccd){const _0x381c03=_0x5cfccd['info'];global_registry['cloudProvider']=_0x381c03[_0x5389ad(0x16f)],global_registry[_0x5389ad(0x17d)]=_0x381c03['region'],global_registry[_0x5389ad(0x147)]=_0x381c03['clusterName'];const _0xe826a1=await _0x50b17d[_0x5389ad(0x149)](getCloudProviderObject,_0x381c03[_0x5389ad(0x16f)],_0x381c03[_0x5389ad(0x147)],_0x381c03[_0x5389ad(0x151)],_0x548d11,webSocketUtils,_0x29a26f),[_0x10a106,_0x236be4,_0x5704de,_0xdf1b87,_0x30d01a,_0x36f708]=await _0x50b17d[_0x5389ad(0x18a)](createK8sClient,_0xe826a1,_0x29a26f[_0x5389ad(0x179)]);await _0x50b17d[_0x5389ad(0x18a)](scaleDownHubDeployment,_0x236be4,_0x381c03[_0x5389ad(0x151)]),logger[_0x5389ad(0x15d)](_0x50b17d[_0x5389ad(0x17f)]),process[_0x5389ad(0x135)](0x0);}_0x50b17d[_0x5389ad(0x167)](_0x34686c[_0x5389ad(0x177)],0x191)&&(logger[_0x5389ad(0x188)](_0x50b17d[_0x5389ad(0x144)]),await _0x50b17d[_0x5389ad(0x13c)](sendInstrumentationEvent,_0x29a26f,_0x50b17d[_0x5389ad(0x13f)],messageTypes['ERROR'],_0x50b17d[_0x5389ad(0x143)],null,_0x29a26f),process['exit'](0x1)),_0x50b17d[_0x5389ad(0x167)](_0x34686c[_0x5389ad(0x177)],0x190)&&(logger[_0x5389ad(0x188)](JSON[_0x5389ad(0x180)](_0x34686c[_0x5389ad(0x132)])['message']),await _0x50b17d['zvlpZ'](sendInstrumentationEvent,_0x29a26f,_0x50b17d['sazrk'],messageTypes[_0x5389ad(0x17c)],_0x50b17d[_0x5389ad(0x154)],null,_0x29a26f),process['exit'](0x1)),logger[_0x5389ad(0x188)](_0x5389ad(0x138)+JSON['stringify'](_0x34686c)),await _0x50b17d[_0x5389ad(0x162)](sendInstrumentationEvent,_0x29a26f,_0x50b17d[_0x5389ad(0x13f)],messageTypes[_0x5389ad(0x17c)],_0x50b17d['vCGbd'],_0x34686c,_0x29a26f),process[_0x5389ad(0x135)](0x1);}catch(_0x352a5b){const _0x35cc11='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x352a5b+'\x20\x0a'+JSON[_0x5389ad(0x152)](_0x352a5b[_0x5389ad(0x153)])+'\x20';logger[_0x5389ad(0x188)](_0x35cc11),process['exit'](0x1);}};