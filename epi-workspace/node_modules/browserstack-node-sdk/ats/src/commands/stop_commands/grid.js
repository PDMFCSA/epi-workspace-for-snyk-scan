const a21_0x3f5f4b=a21_0x3c7a;(function(_0x50c62d,_0x476a60){const _0x2866e6=a21_0x3c7a,_0x5b6b56=_0x50c62d();while(!![]){try{const _0x4606f5=parseInt(_0x2866e6(0x10c))/0x1*(-parseInt(_0x2866e6(0x11c))/0x2)+-parseInt(_0x2866e6(0x12b))/0x3*(parseInt(_0x2866e6(0x128))/0x4)+-parseInt(_0x2866e6(0x10d))/0x5+-parseInt(_0x2866e6(0x126))/0x6*(-parseInt(_0x2866e6(0xf6))/0x7)+-parseInt(_0x2866e6(0x117))/0x8+-parseInt(_0x2866e6(0x114))/0x9*(-parseInt(_0x2866e6(0x125))/0xa)+parseInt(_0x2866e6(0x110))/0xb*(parseInt(_0x2866e6(0xfe))/0xc);if(_0x4606f5===_0x476a60)break;else _0x5b6b56['push'](_0x5b6b56['shift']());}catch(_0x2b5d0f){_0x5b6b56['push'](_0x5b6b56['shift']());}}}(a21_0x5a71,0x744c1));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x3f5f4b(0xdf)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x3f5f4b(0x129)),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require(a21_0x3f5f4b(0xd8)),{scaleDownHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require(a21_0x3f5f4b(0x101)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require('../../utils/createk8sClient'),{getCloudProviderObject}=require(a21_0x3f5f4b(0xd5));function a21_0x3c7a(_0x478a3d,_0x2911fa){const _0x5a71f2=a21_0x5a71();return a21_0x3c7a=function(_0x3c7a3b,_0x310dba){_0x3c7a3b=_0x3c7a3b-0xd0;let _0x5209ce=_0x5a71f2[_0x3c7a3b];return _0x5209ce;},a21_0x3c7a(_0x478a3d,_0x2911fa);}exports[a21_0x3f5f4b(0xf5)]=a21_0x3f5f4b(0xed),exports['desc']=a21_0x3f5f4b(0x11e),exports[a21_0x3f5f4b(0xe7)]=function(_0x15a928){const _0x368500=a21_0x3f5f4b,_0x2fc8d3={};_0x2fc8d3[_0x368500(0x124)]='Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.',_0x2fc8d3['eUizm']=_0x368500(0x119),_0x2fc8d3[_0x368500(0xde)]=_0x368500(0x102),_0x2fc8d3[_0x368500(0xd2)]=_0x368500(0x112),_0x2fc8d3[_0x368500(0xe2)]='help';const _0x22b994=_0x2fc8d3,_0x2a86de={};_0x2a86de[_0x368500(0xdc)]=_0x22b994[_0x368500(0x124)],_0x2a86de[_0x368500(0xea)]=_0x22b994['eUizm'];const _0x2dd9b9={};_0x2dd9b9[_0x368500(0xdc)]=_0x22b994[_0x368500(0xde)],_0x2dd9b9['type']=_0x22b994[_0x368500(0xd2)],_0x2dd9b9[_0x368500(0xfa)]=![];const _0x19131f={};return _0x19131f[_0x368500(0xd4)]=_0x2a86de,_0x19131f[_0x368500(0xd1)]=_0x2dd9b9,_0x15a928['usage'](HELP_HEADER_MESSAGE[_0x368500(0xf4)])['epilogue'](HELP_FOOTER_MESSAGE)[_0x368500(0x123)](_0x19131f)['help'](_0x22b994[_0x368500(0xe2)])[_0x368500(0xdb)];},exports['handler']=async function(_0x2cf0ca){const _0x29c40d=a21_0x3f5f4b,_0x4a9ba0={'kVgns':_0x29c40d(0x118),'mwrZZ':function(_0x3777aa){return _0x3777aa();},'RVspc':'Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','MrCIN':function(_0x55a96b,_0x1ae2c4,_0x128258,_0x4d6acf,_0x104460,_0x3a7d80,_0x5478f6){return _0x55a96b(_0x1ae2c4,_0x128258,_0x4d6acf,_0x104460,_0x3a7d80,_0x5478f6);},'Arxnc':_0x29c40d(0x10b),'JUjUR':_0x29c40d(0xe8),'CiHdh':function(_0x5e067e){return _0x5e067e();},'JJFcY':'<UsernamePlaceholder>','fTdbq':_0x29c40d(0x109),'HZgok':'Adding\x20Websocket\x20listeners','Zdezp':function(_0x12c679,_0x6cca00,_0x231e5b,_0x2981a3){return _0x12c679(_0x6cca00,_0x231e5b,_0x2981a3);},'zxbds':function(_0x5d3e22,_0x1a2eb6,_0x2c7933){return _0x5d3e22(_0x1a2eb6,_0x2c7933);},'rfgnB':function(_0x33d287,_0x18a67a,_0x1daab9){return _0x33d287(_0x18a67a,_0x1daab9);},'wFOGM':'Grid\x20stoppped.','LUJAz':function(_0x28a2dd,_0x31e482){return _0x28a2dd===_0x31e482;},'rjkvJ':_0x29c40d(0xf2),'zFHAW':function(_0x2cc0ee,_0x48026d,_0x4700f9,_0x342e3b,_0x348383,_0x32f108,_0x3947b8){return _0x2cc0ee(_0x48026d,_0x4700f9,_0x342e3b,_0x348383,_0x32f108,_0x3947b8);},'iuMQq':_0x29c40d(0xd7),'EccqF':function(_0x389c87,_0x1ac3e4,_0x3ed0d8,_0x5af114,_0x52fe26,_0x4ac64e,_0x16da4f){return _0x389c87(_0x1ac3e4,_0x3ed0d8,_0x5af114,_0x52fe26,_0x4ac64e,_0x16da4f);},'TDhql':_0x29c40d(0xf8),'HAlrD':_0x29c40d(0xe5)};let _0x501eb8;try{!_0x2cf0ca[_0x29c40d(0xd3)]&&(logger['error'](_0x4a9ba0[_0x29c40d(0xfb)]),process[_0x29c40d(0xe4)](0x1));!fs[_0x29c40d(0xf3)](_0x4a9ba0[_0x29c40d(0x111)](getCredentialsPath))&&(logger[_0x29c40d(0x10e)](_0x4a9ba0[_0x29c40d(0x120)]),await _0x4a9ba0['MrCIN'](sendInstrumentationEvent,_0x2cf0ca,_0x4a9ba0[_0x29c40d(0x11b)],messageTypes[_0x29c40d(0x108)],_0x4a9ba0['JUjUR'],null,_0x2cf0ca),process['exit'](0x1));logger[_0x29c40d(0x12a)](_0x29c40d(0x10f)+_0x2cf0ca[_0x29c40d(0xd3)]),await _0x4a9ba0[_0x29c40d(0x127)](sendInstrumentationEvent,_0x2cf0ca,_0x4a9ba0[_0x29c40d(0x11b)],messageTypes[_0x29c40d(0xf0)],null,null,_0x2cf0ca);const _0x3fa6ea=JSON['parse'](fs[_0x29c40d(0xe6)](_0x4a9ba0[_0x29c40d(0x116)](getCredentialsPath)));global_registry[_0x29c40d(0xd9)]=_0x3fa6ea[_0x29c40d(0xdd)][_0x29c40d(0x115)],global_registry[_0x29c40d(0x11f)]=_0x3fa6ea[_0x29c40d(0xdd)][_0x29c40d(0x104)];const _0xcc8c82=WS_ENDPOINT['replace'](_0x4a9ba0[_0x29c40d(0xe0)],_0x3fa6ea[_0x29c40d(0xdd)]['username'])[_0x29c40d(0xee)](_0x4a9ba0[_0x29c40d(0xe3)],_0x3fa6ea[_0x29c40d(0xdd)][_0x29c40d(0x104)]),_0x459c35={};_0x459c35[_0x29c40d(0x100)]=ws,_0x459c35[_0x29c40d(0x105)]=0x36ee80,_0x501eb8=new ReconnectingWebSocket(_0xcc8c82,[],_0x459c35),logger[_0x29c40d(0xf1)](_0x4a9ba0['HZgok']),webSocketUtils['addListeners'](_0x501eb8,_0x2cf0ca[_0x29c40d(0x11d)],_0x2cf0ca['password']);const [_0x18a5da,_0x2b9349]=await _0x4a9ba0[_0x29c40d(0xec)](getGridDetails,_0x3fa6ea[_0x29c40d(0xdd)][_0x29c40d(0x115)],_0x3fa6ea[_0x29c40d(0xdd)][_0x29c40d(0x104)],_0x2cf0ca[_0x29c40d(0xd3)]);if(_0x2b9349){const _0x209d9a=_0x2b9349['info'];global_registry[_0x29c40d(0x121)]=_0x209d9a[_0x29c40d(0x121)],global_registry[_0x29c40d(0xf7)]=_0x209d9a[_0x29c40d(0x10a)],global_registry[_0x29c40d(0xe1)]=_0x209d9a[_0x29c40d(0xe1)];const _0x15278a=await _0x4a9ba0[_0x29c40d(0x127)](getCloudProviderObject,_0x209d9a[_0x29c40d(0x121)],_0x209d9a[_0x29c40d(0xe1)],_0x209d9a[_0x29c40d(0xef)],_0x501eb8,webSocketUtils,_0x2cf0ca),[_0x100e34,_0x517df9,_0x5d3559,_0x268435,_0x21f1af,_0x33e071]=await _0x4a9ba0[_0x29c40d(0xfc)](createK8sClient,_0x15278a,_0x2cf0ca[_0x29c40d(0xe9)]);await _0x4a9ba0[_0x29c40d(0x12c)](scaleDownHubDeployment,_0x517df9,_0x209d9a[_0x29c40d(0xef)]),logger[_0x29c40d(0x12a)](_0x4a9ba0[_0x29c40d(0xfd)]),process[_0x29c40d(0xe4)](0x0);}_0x4a9ba0[_0x29c40d(0x107)](_0x18a5da[_0x29c40d(0x103)],0x191)&&(logger['error'](_0x4a9ba0[_0x29c40d(0xf9)]),await _0x4a9ba0['zFHAW'](sendInstrumentationEvent,_0x2cf0ca,_0x4a9ba0[_0x29c40d(0x11b)],messageTypes[_0x29c40d(0x108)],_0x4a9ba0[_0x29c40d(0xd0)],null,_0x2cf0ca),process[_0x29c40d(0xe4)](0x1)),_0x4a9ba0[_0x29c40d(0x107)](_0x18a5da[_0x29c40d(0x103)],0x190)&&(logger[_0x29c40d(0x10e)](JSON[_0x29c40d(0x106)](_0x18a5da[_0x29c40d(0x11a)])[_0x29c40d(0xd6)]),await _0x4a9ba0[_0x29c40d(0xff)](sendInstrumentationEvent,_0x2cf0ca,_0x4a9ba0[_0x29c40d(0x11b)],messageTypes[_0x29c40d(0x108)],_0x4a9ba0[_0x29c40d(0x113)],null,_0x2cf0ca),process[_0x29c40d(0xe4)](0x1)),logger[_0x29c40d(0x10e)]('Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20'+JSON['stringify'](_0x18a5da)),await _0x4a9ba0[_0x29c40d(0x127)](sendInstrumentationEvent,_0x2cf0ca,_0x4a9ba0[_0x29c40d(0x11b)],messageTypes['ERROR'],_0x4a9ba0[_0x29c40d(0x122)],_0x18a5da,_0x2cf0ca),process[_0x29c40d(0xe4)](0x1);}catch(_0x1a0df2){const _0x9b6d23='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x1a0df2+'\x20\x0a'+JSON[_0x29c40d(0xda)](_0x1a0df2[_0x29c40d(0xeb)])+'\x20';logger['error'](_0x9b6d23),process[_0x29c40d(0xe4)](0x1);}};function a21_0x5a71(){const _0x31473c=['command','1407PPlecg','clusterRegion','invalid-grid-id','rjkvJ','default','kVgns','zxbds','wFOGM','111660euinLQ','EccqF','WebSocket','../../utils/instrumentationUtils','Skip\x20insecure\x20cert\x20verification.','statusCode','password','connectionTimeout','parse','LUJAz','ERROR','<PasswordPlaceholder>','region','stop-grid-called','11UVgEMD','2915370eWemmc','error','Stopping\x20grid\x20','1166RogJiQ','mwrZZ','boolean','TDhql','8475723SqqbrX','username','CiHdh','3033688PcawAK','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','string','body','Arxnc','128236nESsvB','user','Stop\x20a\x20running\x20Automation\x20grid.','bstackAccesskey','RVspc','cloudProvider','HAlrD','options','coZzg','10HqTNqX','9924aiAZcY','MrCIN','36TyBTlS','../../config/constants','info','38865pQsYsf','rfgnB','iuMQq','skip-tls-cert-verify','zmBcW','gridId','grid-id','../../cloudproviders/utils','message','unauthorised','../../utils/utilityMethods','bstackUsername','stringify','argv','description','Browserstack','TixiU','reconnecting-websocket','JJFcY','clusterName','icMSH','fTdbq','exit','server-error','readFileSync','builder','init-not-called','skipTlsCertVerify','type','stack','Zdezp','grid','replace','name','INFO','debug','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','existsSync','stop'];a21_0x5a71=function(){return _0x31473c;};return a21_0x5a71();}