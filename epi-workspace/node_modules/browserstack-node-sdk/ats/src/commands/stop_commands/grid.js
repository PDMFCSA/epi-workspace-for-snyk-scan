const a21_0xdf6f2d=a21_0x471b;function a21_0x471b(_0x555126,_0x3d19b6){const _0x14a5ed=a21_0x14a5();return a21_0x471b=function(_0x471b56,_0x17e20a){_0x471b56=_0x471b56-0x17d;let _0x4d7257=_0x14a5ed[_0x471b56];return _0x4d7257;},a21_0x471b(_0x555126,_0x3d19b6);}(function(_0x358da1,_0x1e64b1){const _0x5e36a1=a21_0x471b,_0x41d674=_0x358da1();while(!![]){try{const _0x11419b=-parseInt(_0x5e36a1(0x1c9))/0x1+-parseInt(_0x5e36a1(0x1cc))/0x2+-parseInt(_0x5e36a1(0x1bf))/0x3+-parseInt(_0x5e36a1(0x18c))/0x4*(-parseInt(_0x5e36a1(0x1ac))/0x5)+parseInt(_0x5e36a1(0x1d9))/0x6*(-parseInt(_0x5e36a1(0x1ce))/0x7)+parseInt(_0x5e36a1(0x1d7))/0x8*(parseInt(_0x5e36a1(0x1af))/0x9)+parseInt(_0x5e36a1(0x190))/0xa;if(_0x11419b===_0x1e64b1)break;else _0x41d674['push'](_0x41d674['shift']());}catch(_0x4d2c5a){_0x41d674['push'](_0x41d674['shift']());}}}(a21_0x14a5,0xcbc2a));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0xdf6f2d(0x19c)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0xdf6f2d(0x1c1)),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0xdf6f2d(0x184)),{sendInstrumentationEvent}=require('../../utils/instrumentationUtils'),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require('../../utils/createk8sClient'),{getCloudProviderObject}=require('../../cloudproviders/utils');function a21_0x14a5(){const _0x353496=['usage','stop-grid-called','<UsernamePlaceholder>','wzlCP','username','ERROR','yjSee','4938633WrukAA','kJFil','../../config/constants','HRJzb','epilogue','help','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','<PasswordPlaceholder>','options','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','101589Xwczks','handler','grid','1351920LRbXdJ','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','72317LGBHmT','error','Browserstack','info','addListeners','init-not-called','grid-id','CFibH','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','1480ehSmTw','existsSync','294WAjGXx','description','skip-tls-cert-verify','Adding\x20Websocket\x20listeners','desc','stringify','bstackAccesskey','clusterRegion','../../utils/gridComponents','body','exit','kluRF','parse','message','cloudProvider','yBftV','4SMloJk','stack','MsNux','nmxoA','24262750OfrkoH','replace','unauthorised','bstackUsername','clusterName','YlZYe','rgyvu','XXqNY','enqfC','connectionTimeout','user','Skip\x20insecure\x20cert\x20verification.','reconnecting-websocket','command','Hbtpl','AzrLH','server-error','Stop\x20a\x20running\x20Automation\x20grid.','Grid\x20stoppped.','name','readFileSync','boolean','string','ohhdQ','Eyeoj','GVqIy','type','BGuUG','1954605nhGnJO','skipTlsCertVerify','INFO','46089qCWEJq','IWqBL','statusCode','jwJGL','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','password','argv','LlbQH','gridId'];a21_0x14a5=function(){return _0x353496;};return a21_0x14a5();}exports[a21_0xdf6f2d(0x19d)]=a21_0xdf6f2d(0x1cb),exports[a21_0xdf6f2d(0x180)]=a21_0xdf6f2d(0x1a1),exports['builder']=function(_0x1a82dc){const _0x41e6e3=a21_0xdf6f2d,_0x56a296={};_0x56a296[_0x41e6e3(0x1ab)]=_0x41e6e3(0x1c5),_0x56a296[_0x41e6e3(0x1bb)]=_0x41e6e3(0x1a6),_0x56a296['yjSee']=_0x41e6e3(0x19b),_0x56a296[_0x41e6e3(0x1b6)]=_0x41e6e3(0x1a5),_0x56a296[_0x41e6e3(0x1a7)]='help';const _0x17b12b=_0x56a296,_0x20dbee={};_0x20dbee[_0x41e6e3(0x17d)]=_0x17b12b[_0x41e6e3(0x1ab)],_0x20dbee['type']=_0x17b12b[_0x41e6e3(0x1bb)];const _0x344125={};_0x344125[_0x41e6e3(0x17d)]=_0x17b12b[_0x41e6e3(0x1be)],_0x344125[_0x41e6e3(0x1aa)]=_0x17b12b[_0x41e6e3(0x1b6)],_0x344125['default']=![];const _0x2047a2={};return _0x2047a2[_0x41e6e3(0x1d4)]=_0x20dbee,_0x2047a2[_0x41e6e3(0x17e)]=_0x344125,_0x1a82dc[_0x41e6e3(0x1b8)](HELP_HEADER_MESSAGE['stop'])[_0x41e6e3(0x1c3)](HELP_FOOTER_MESSAGE)[_0x41e6e3(0x1c7)](_0x2047a2)[_0x41e6e3(0x1c4)](_0x17b12b['ohhdQ'])[_0x41e6e3(0x1b5)];},exports[a21_0xdf6f2d(0x1ca)]=async function(_0x13cf93){const _0x32fa74=a21_0xdf6f2d,_0x4ca3ae={'Eyeoj':_0x32fa74(0x1cd),'kluRF':function(_0x411415){return _0x411415();},'cyvSK':_0x32fa74(0x1c8),'nmxoA':function(_0x21147f,_0x8ee122,_0x3f45ef,_0x191142,_0x3fd3ed,_0x467331,_0x11ead1){return _0x21147f(_0x8ee122,_0x3f45ef,_0x191142,_0x3fd3ed,_0x467331,_0x11ead1);},'yBftV':_0x32fa74(0x1b9),'rgyvu':_0x32fa74(0x1d3),'Hbtpl':function(_0x17369d){return _0x17369d();},'GlHDz':_0x32fa74(0x1ba),'wITEB':_0x32fa74(0x1c6),'jwJGL':_0x32fa74(0x17f),'chQPA':function(_0x58847a,_0x3d78b7,_0x26ad12,_0xac97b8){return _0x58847a(_0x3d78b7,_0x26ad12,_0xac97b8);},'MsNux':function(_0x370d8a,_0x48876a,_0x175b8f,_0x3b2848,_0x24978a,_0x559c32,_0x468f33){return _0x370d8a(_0x48876a,_0x175b8f,_0x3b2848,_0x24978a,_0x559c32,_0x468f33);},'kJFil':function(_0x65bfec,_0x3f33b7,_0x4b0543){return _0x65bfec(_0x3f33b7,_0x4b0543);},'CFibH':function(_0x331af8,_0x4fe099,_0x5598e2){return _0x331af8(_0x4fe099,_0x5598e2);},'HRJzb':_0x32fa74(0x1a2),'enqfC':function(_0x3e3bc3,_0x468177){return _0x3e3bc3===_0x468177;},'IWqBL':_0x32fa74(0x1d6),'YlZYe':_0x32fa74(0x192),'XXqNY':function(_0x569922,_0xbfff5e,_0x5eb464,_0x3443e7,_0x1a5286,_0x5a4901,_0x388611){return _0x569922(_0xbfff5e,_0x5eb464,_0x3443e7,_0x1a5286,_0x5a4901,_0x388611);},'AzrLH':'invalid-grid-id','GVqIy':_0x32fa74(0x1a0)};let _0x4c649f;try{!_0x13cf93[_0x32fa74(0x1b7)]&&(logger[_0x32fa74(0x1cf)](_0x4ca3ae[_0x32fa74(0x1a8)]),process[_0x32fa74(0x186)](0x1));!fs[_0x32fa74(0x1d8)](_0x4ca3ae[_0x32fa74(0x187)](getCredentialsPath))&&(logger[_0x32fa74(0x1cf)](_0x4ca3ae['cyvSK']),await _0x4ca3ae[_0x32fa74(0x18f)](sendInstrumentationEvent,_0x13cf93,_0x4ca3ae[_0x32fa74(0x18b)],messageTypes['ERROR'],_0x4ca3ae[_0x32fa74(0x196)],null,_0x13cf93),process[_0x32fa74(0x186)](0x1));logger['info']('Stopping\x20grid\x20'+_0x13cf93[_0x32fa74(0x1b7)]),await _0x4ca3ae['nmxoA'](sendInstrumentationEvent,_0x13cf93,_0x4ca3ae['yBftV'],messageTypes[_0x32fa74(0x1ae)],null,null,_0x13cf93);const _0x1bf97f=JSON['parse'](fs[_0x32fa74(0x1a4)](_0x4ca3ae[_0x32fa74(0x19e)](getCredentialsPath)));global_registry[_0x32fa74(0x193)]=_0x1bf97f[_0x32fa74(0x1d0)][_0x32fa74(0x1bc)],global_registry[_0x32fa74(0x182)]=_0x1bf97f['Browserstack'][_0x32fa74(0x1b4)];const _0x334520=WS_ENDPOINT[_0x32fa74(0x191)](_0x4ca3ae['GlHDz'],_0x1bf97f[_0x32fa74(0x1d0)][_0x32fa74(0x1bc)])[_0x32fa74(0x191)](_0x4ca3ae['wITEB'],_0x1bf97f[_0x32fa74(0x1d0)]['password']),_0x1c46f9={};_0x1c46f9['WebSocket']=ws,_0x1c46f9[_0x32fa74(0x199)]=0x36ee80,_0x4c649f=new ReconnectingWebSocket(_0x334520,[],_0x1c46f9),logger['debug'](_0x4ca3ae[_0x32fa74(0x1b2)]),webSocketUtils[_0x32fa74(0x1d2)](_0x4c649f,_0x13cf93[_0x32fa74(0x19a)],_0x13cf93['password']);const [_0xde5ca2,_0x3f681b]=await _0x4ca3ae['chQPA'](getGridDetails,_0x1bf97f[_0x32fa74(0x1d0)][_0x32fa74(0x1bc)],_0x1bf97f['Browserstack'][_0x32fa74(0x1b4)],_0x13cf93['gridId']);if(_0x3f681b){const _0x339a4f=_0x3f681b[_0x32fa74(0x1d1)];global_registry['cloudProvider']=_0x339a4f[_0x32fa74(0x18a)],global_registry[_0x32fa74(0x183)]=_0x339a4f['region'],global_registry[_0x32fa74(0x194)]=_0x339a4f['clusterName'];const _0x1fbae0=await _0x4ca3ae['MsNux'](getCloudProviderObject,_0x339a4f[_0x32fa74(0x18a)],_0x339a4f[_0x32fa74(0x194)],_0x339a4f[_0x32fa74(0x1a3)],_0x4c649f,webSocketUtils,_0x13cf93),[_0x79ea67,_0x52aa28,_0x17f6a0,_0x35e4e6,_0x5374be,_0xd21e94]=await _0x4ca3ae[_0x32fa74(0x1c0)](createK8sClient,_0x1fbae0,_0x13cf93[_0x32fa74(0x1ad)]);await _0x4ca3ae[_0x32fa74(0x1d5)](scaleDownHubDeployment,_0x52aa28,_0x339a4f[_0x32fa74(0x1a3)]),logger[_0x32fa74(0x1d1)](_0x4ca3ae[_0x32fa74(0x1c2)]),process[_0x32fa74(0x186)](0x0);}_0x4ca3ae[_0x32fa74(0x198)](_0xde5ca2[_0x32fa74(0x1b1)],0x191)&&(logger[_0x32fa74(0x1cf)](_0x4ca3ae[_0x32fa74(0x1b0)]),await _0x4ca3ae[_0x32fa74(0x18e)](sendInstrumentationEvent,_0x13cf93,_0x4ca3ae[_0x32fa74(0x18b)],messageTypes[_0x32fa74(0x1bd)],_0x4ca3ae[_0x32fa74(0x195)],null,_0x13cf93),process[_0x32fa74(0x186)](0x1)),_0x4ca3ae[_0x32fa74(0x198)](_0xde5ca2[_0x32fa74(0x1b1)],0x190)&&(logger['error'](JSON[_0x32fa74(0x188)](_0xde5ca2[_0x32fa74(0x185)])[_0x32fa74(0x189)]),await _0x4ca3ae[_0x32fa74(0x197)](sendInstrumentationEvent,_0x13cf93,_0x4ca3ae[_0x32fa74(0x18b)],messageTypes['ERROR'],_0x4ca3ae[_0x32fa74(0x19f)],null,_0x13cf93),process[_0x32fa74(0x186)](0x1)),logger[_0x32fa74(0x1cf)]('Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20'+JSON[_0x32fa74(0x181)](_0xde5ca2)),await _0x4ca3ae[_0x32fa74(0x18f)](sendInstrumentationEvent,_0x13cf93,_0x4ca3ae['yBftV'],messageTypes['ERROR'],_0x4ca3ae[_0x32fa74(0x1a9)],_0xde5ca2,_0x13cf93),process[_0x32fa74(0x186)](0x1);}catch(_0x5f25d8){const _0xf665c0=_0x32fa74(0x1b3)+_0x5f25d8+'\x20\x0a'+JSON[_0x32fa74(0x181)](_0x5f25d8[_0x32fa74(0x18d)])+'\x20';logger['error'](_0xf665c0),process['exit'](0x1);}};