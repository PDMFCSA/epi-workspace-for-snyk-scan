const a21_0x18db47=a21_0x414b;function a21_0x414b(_0x5bae41,_0x39a06e){const _0x4e6dab=a21_0x4e6d();return a21_0x414b=function(_0x414b93,_0x4818c6){_0x414b93=_0x414b93-0x141;let _0x189d7b=_0x4e6dab[_0x414b93];return _0x189d7b;},a21_0x414b(_0x5bae41,_0x39a06e);}function a21_0x4e6d(){const _0x16234f=['Browserstack','305yGjQQH','21444jrAfJY','../../utils/gridComponents','boolean','../../config/logger','replace','MaIqq','18MBdxmQ','reconnecting-websocket','description','body','TJhEl','invalid-grid-id','grid-id','OKmXc','type','Stopping\x20grid\x20','exit','statusCode','TJhWJ','hwgDW','../../config/constants','gridId','pdLPh','help','Adding\x20Websocket\x20listeners','../../utils/createk8sClient','VOEHt','TYTtV','epilogue','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','YTkKi','name','options','info','ERROR','../../utils/instrumentationUtils','Grid\x20stoppped.','clusterName','rMcpK','cEeFh','Stop\x20a\x20running\x20Automation\x20grid.','existsSync','2506312hOcyRy','INFO','grid','stop','Xuqid','connectionTimeout','aUPwA','string','AtUQl','zuLog','addListeners','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','parse','password','builder','init-not-called','MLjRc','6TcaSun','154484qWEWLE','WebSocket','980932iCUXGY','server-error','zFuRG','../../utils/webSocketUtils','2HwMlGb','bDWmT','region','skipTlsCertVerify','rqjFj','QJYxm','gbdzm','error','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','bstackAccesskey','cloudProvider','<PasswordPlaceholder>','oSZoN','oAMiE','clusterRegion','2725422xgtYYV','unauthorised','603506hPQhhO','2804990bujdav','bstackUsername','username','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'];a21_0x4e6d=function(){return _0x16234f;};return a21_0x4e6d();}(function(_0x46da2a,_0x58be7b){const _0x1319d3=a21_0x414b,_0x3be9fe=_0x46da2a();while(!![]){try{const _0x572ab8=-parseInt(_0x1319d3(0x174))/0x1*(parseInt(_0x1319d3(0x163))/0x2)+-parseInt(_0x1319d3(0x15c))/0x3*(parseInt(_0x1319d3(0x15f))/0x4)+-parseInt(_0x1319d3(0x17a))/0x5*(-parseInt(_0x1319d3(0x17b))/0x6)+parseInt(_0x1319d3(0x172))/0x7+parseInt(_0x1319d3(0x14b))/0x8+parseInt(_0x1319d3(0x181))/0x9*(parseInt(_0x1319d3(0x175))/0xa)+-parseInt(_0x1319d3(0x15d))/0xb;if(_0x572ab8===_0x58be7b)break;else _0x3be9fe['push'](_0x3be9fe['shift']());}catch(_0x17314b){_0x3be9fe['push'](_0x3be9fe['shift']());}}}(a21_0x4e6d,0x5b37f));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x18db47(0x182)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x18db47(0x18f)),{logger}=require(a21_0x18db47(0x17e)),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0x18db47(0x17c)),{sendInstrumentationEvent}=require(a21_0x18db47(0x144)),webSocketUtils=require(a21_0x18db47(0x162)),{createK8sClient}=require(a21_0x18db47(0x194)),{getCloudProviderObject}=require('../../cloudproviders/utils');exports['command']=a21_0x18db47(0x14d),exports['desc']=a21_0x18db47(0x149),exports[a21_0x18db47(0x159)]=function(_0x260879){const _0x234f3a=a21_0x18db47,_0x5456d6={};_0x5456d6[_0x234f3a(0x169)]='Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.',_0x5456d6[_0x234f3a(0x14f)]=_0x234f3a(0x152),_0x5456d6[_0x234f3a(0x154)]='Skip\x20insecure\x20cert\x20verification.',_0x5456d6[_0x234f3a(0x164)]=_0x234f3a(0x17d),_0x5456d6[_0x234f3a(0x195)]=_0x234f3a(0x192);const _0x237c97=_0x5456d6,_0x20d831={};_0x20d831[_0x234f3a(0x183)]=_0x237c97['gbdzm'],_0x20d831[_0x234f3a(0x189)]=_0x237c97[_0x234f3a(0x14f)];const _0x1e7cec={};_0x1e7cec['description']=_0x237c97[_0x234f3a(0x154)],_0x1e7cec[_0x234f3a(0x189)]=_0x237c97[_0x234f3a(0x164)],_0x1e7cec['default']=![];const _0x442d5e={};return _0x442d5e[_0x234f3a(0x187)]=_0x20d831,_0x442d5e['skip-tls-cert-verify']=_0x1e7cec,_0x260879['usage'](HELP_HEADER_MESSAGE[_0x234f3a(0x14e)])[_0x234f3a(0x197)](HELP_FOOTER_MESSAGE)[_0x234f3a(0x141)](_0x442d5e)[_0x234f3a(0x192)](_0x237c97[_0x234f3a(0x195)])['argv'];},exports['handler']=async function(_0x3a948a){const _0x57047d=a21_0x18db47,_0x26d62f={'QJYxm':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','MaIqq':function(_0x2eef50){return _0x2eef50();},'oSZoN':_0x57047d(0x156),'OKmXc':function(_0x2b46e5,_0x36c8f9,_0xbebd6,_0x2706f6,_0x58b696,_0x4fc556,_0x479312){return _0x2b46e5(_0x36c8f9,_0xbebd6,_0x2706f6,_0x58b696,_0x4fc556,_0x479312);},'zFuRG':'stop-grid-called','hwgDW':_0x57047d(0x15a),'AtUQl':function(_0x48c521){return _0x48c521();},'pdLPh':'<UsernamePlaceholder>','TYTtV':_0x57047d(0x16e),'aUPwA':_0x57047d(0x193),'oAMiE':function(_0x3e4dbb,_0x199087,_0x4567e7,_0x2a9d05){return _0x3e4dbb(_0x199087,_0x4567e7,_0x2a9d05);},'YTkKi':function(_0xb8c791,_0x2fe2fe,_0x31e011,_0x5e7fc6,_0x3a151f,_0x42fa3e,_0x5c6192){return _0xb8c791(_0x2fe2fe,_0x31e011,_0x5e7fc6,_0x3a151f,_0x42fa3e,_0x5c6192);},'PWEFK':function(_0x47e30e,_0x273de0,_0x7a5f34){return _0x47e30e(_0x273de0,_0x7a5f34);},'rqjFj':function(_0x3ab81b,_0x235075,_0x535946){return _0x3ab81b(_0x235075,_0x535946);},'MLjRc':_0x57047d(0x145),'cEeFh':function(_0x26263c,_0x31ce77){return _0x26263c===_0x31ce77;},'xBDrG':_0x57047d(0x198),'rMcpK':function(_0x172f7a,_0x32a444,_0x31c7b6,_0x18def7,_0x1a3867,_0x338e86,_0x1c93d4){return _0x172f7a(_0x32a444,_0x31c7b6,_0x18def7,_0x1a3867,_0x338e86,_0x1c93d4);},'QKFvO':_0x57047d(0x173),'PmzwG':_0x57047d(0x186),'TJhEl':function(_0x2a464d,_0x5a7cf6,_0x1c0c97,_0x1a769e,_0x1114cd,_0xdd0850,_0x463791){return _0x2a464d(_0x5a7cf6,_0x1c0c97,_0x1a769e,_0x1114cd,_0xdd0850,_0x463791);},'TJhWJ':_0x57047d(0x160)};let _0x469ff7;try{!_0x3a948a[_0x57047d(0x190)]&&(logger['error'](_0x26d62f[_0x57047d(0x168)]),process['exit'](0x1));!fs[_0x57047d(0x14a)](_0x26d62f[_0x57047d(0x180)](getCredentialsPath))&&(logger[_0x57047d(0x16a)](_0x26d62f[_0x57047d(0x16f)]),await _0x26d62f[_0x57047d(0x188)](sendInstrumentationEvent,_0x3a948a,_0x26d62f[_0x57047d(0x161)],messageTypes['ERROR'],_0x26d62f[_0x57047d(0x18e)],null,_0x3a948a),process['exit'](0x1));logger[_0x57047d(0x142)](_0x57047d(0x18a)+_0x3a948a['gridId']),await _0x26d62f['OKmXc'](sendInstrumentationEvent,_0x3a948a,_0x26d62f[_0x57047d(0x161)],messageTypes[_0x57047d(0x14c)],null,null,_0x3a948a);const _0x8ee1fc=JSON[_0x57047d(0x157)](fs['readFileSync'](_0x26d62f[_0x57047d(0x153)](getCredentialsPath)));global_registry[_0x57047d(0x176)]=_0x8ee1fc[_0x57047d(0x179)][_0x57047d(0x177)],global_registry[_0x57047d(0x16c)]=_0x8ee1fc[_0x57047d(0x179)][_0x57047d(0x158)];const _0x303586=WS_ENDPOINT['replace'](_0x26d62f[_0x57047d(0x191)],_0x8ee1fc['Browserstack']['username'])[_0x57047d(0x17f)](_0x26d62f[_0x57047d(0x196)],_0x8ee1fc[_0x57047d(0x179)]['password']),_0x47d41b={};_0x47d41b[_0x57047d(0x15e)]=ws,_0x47d41b[_0x57047d(0x150)]=0x36ee80,_0x469ff7=new ReconnectingWebSocket(_0x303586,[],_0x47d41b),logger['debug'](_0x26d62f[_0x57047d(0x151)]),webSocketUtils[_0x57047d(0x155)](_0x469ff7,_0x3a948a['user'],_0x3a948a[_0x57047d(0x158)]);const [_0x1bc127,_0xb9c235]=await _0x26d62f[_0x57047d(0x170)](getGridDetails,_0x8ee1fc[_0x57047d(0x179)]['username'],_0x8ee1fc[_0x57047d(0x179)][_0x57047d(0x158)],_0x3a948a[_0x57047d(0x190)]);if(_0xb9c235){const _0x2a2f09=_0xb9c235[_0x57047d(0x142)];global_registry[_0x57047d(0x16d)]=_0x2a2f09[_0x57047d(0x16d)],global_registry[_0x57047d(0x171)]=_0x2a2f09[_0x57047d(0x165)],global_registry[_0x57047d(0x146)]=_0x2a2f09[_0x57047d(0x146)];const _0x2a9608=await _0x26d62f[_0x57047d(0x199)](getCloudProviderObject,_0x2a2f09[_0x57047d(0x16d)],_0x2a2f09[_0x57047d(0x146)],_0x2a2f09[_0x57047d(0x19a)],_0x469ff7,webSocketUtils,_0x3a948a),[_0x14d559,_0x8fd974,_0xf0bcb2,_0x146b39,_0x12ad47,_0x4521d3]=await _0x26d62f['PWEFK'](createK8sClient,_0x2a9608,_0x3a948a[_0x57047d(0x166)]);await _0x26d62f[_0x57047d(0x167)](scaleDownHubDeployment,_0x8fd974,_0x2a2f09[_0x57047d(0x19a)]),logger['info'](_0x26d62f[_0x57047d(0x15b)]),process['exit'](0x0);}_0x26d62f['cEeFh'](_0x1bc127[_0x57047d(0x18c)],0x191)&&(logger[_0x57047d(0x16a)](_0x26d62f['xBDrG']),await _0x26d62f[_0x57047d(0x147)](sendInstrumentationEvent,_0x3a948a,_0x26d62f[_0x57047d(0x161)],messageTypes[_0x57047d(0x143)],_0x26d62f['QKFvO'],null,_0x3a948a),process[_0x57047d(0x18b)](0x1)),_0x26d62f[_0x57047d(0x148)](_0x1bc127['statusCode'],0x190)&&(logger['error'](JSON['parse'](_0x1bc127[_0x57047d(0x184)])['message']),await _0x26d62f['YTkKi'](sendInstrumentationEvent,_0x3a948a,_0x26d62f['zFuRG'],messageTypes[_0x57047d(0x143)],_0x26d62f['PmzwG'],null,_0x3a948a),process[_0x57047d(0x18b)](0x1)),logger[_0x57047d(0x16a)](_0x57047d(0x16b)+JSON['stringify'](_0x1bc127)),await _0x26d62f[_0x57047d(0x185)](sendInstrumentationEvent,_0x3a948a,_0x26d62f[_0x57047d(0x161)],messageTypes[_0x57047d(0x143)],_0x26d62f[_0x57047d(0x18d)],_0x1bc127,_0x3a948a),process[_0x57047d(0x18b)](0x1);}catch(_0x5792d9){const _0x2989e6=_0x57047d(0x178)+_0x5792d9+'\x20\x0a'+JSON['stringify'](_0x5792d9['stack'])+'\x20';logger[_0x57047d(0x16a)](_0x2989e6),process['exit'](0x1);}};