const a21_0x4c6938=a21_0x10bc;(function(_0xea4057,_0x1f0999){const _0x21c3cf=a21_0x10bc,_0x1fe4ab=_0xea4057();while(!![]){try{const _0x4d659f=parseInt(_0x21c3cf(0x1ca))/0x1*(parseInt(_0x21c3cf(0x1be))/0x2)+-parseInt(_0x21c3cf(0x191))/0x3*(-parseInt(_0x21c3cf(0x193))/0x4)+-parseInt(_0x21c3cf(0x1b6))/0x5*(-parseInt(_0x21c3cf(0x190))/0x6)+parseInt(_0x21c3cf(0x1ba))/0x7+parseInt(_0x21c3cf(0x198))/0x8*(-parseInt(_0x21c3cf(0x197))/0x9)+parseInt(_0x21c3cf(0x1c5))/0xa+-parseInt(_0x21c3cf(0x1d1))/0xb*(parseInt(_0x21c3cf(0x19b))/0xc);if(_0x4d659f===_0x1f0999)break;else _0x1fe4ab['push'](_0x1fe4ab['shift']());}catch(_0x579912){_0x1fe4ab['push'](_0x1fe4ab['shift']());}}}(a21_0x21d7,0x1a42b));function a21_0x21d7(){const _0x2d1bd3=['DvvBv','163193mwriQk','username','MzytS','INFO','qsqMN','clusterRegion','bstackUsername','6674327TDcbnE','KWPRA','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','grid','JTqHL','stringify','command','info','existsSync','EKBCK','bstackAccesskey','clusterName','string','name','unauthorised','Browserstack','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','reconnecting-websocket','qkhIY','exit','../../utils/instrumentationUtils','546xBllSN','51pqipZr','readFileSync','44276jgputY','Adding\x20Websocket\x20listeners','parse','skip-tls-cert-verify','6381YjFiUz','712SRvjKj','error','Skip\x20insecure\x20cert\x20verification.','12PclZzd','vAFLN','password','aNVtO','statusCode','WebSocket','cloudProvider','gridId','Stop\x20a\x20running\x20Automation\x20grid.','stop-grid-called','../../cloudproviders/utils','boolean','HBdzT','IhFZl','handler','TqLrJ','argv','stop','description','addListeners','muMJz','TEpfV','QczWR','ERROR','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','help','message','11815VMSjyg','../../utils/gridComponents','options','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','1363908KKdkpp','body','server-error','../../utils/createk8sClient','2PuCzAB','LTvFO','<UsernamePlaceholder>','MJkuD','type','Lnpzl','debug','161780fSnjVc','connectionTimeout','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','ahNoQ'];a21_0x21d7=function(){return _0x2d1bd3;};return a21_0x21d7();}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x4c6938(0x18c)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require('../../config/constants'),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0x4c6938(0x1b7)),{sendInstrumentationEvent}=require(a21_0x4c6938(0x18f)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x4c6938(0x1bd)),{getCloudProviderObject}=require(a21_0x4c6938(0x1a5));function a21_0x10bc(_0x14cfea,_0x1103cc){const _0x21d750=a21_0x21d7();return a21_0x10bc=function(_0x10bc13,_0x48fb0a){_0x10bc13=_0x10bc13-0x188;let _0x30fbdb=_0x21d750[_0x10bc13];return _0x30fbdb;},a21_0x10bc(_0x14cfea,_0x1103cc);}exports[a21_0x4c6938(0x1d7)]=a21_0x4c6938(0x1d4),exports['desc']=a21_0x4c6938(0x1a3),exports['builder']=function(_0x4233a2){const _0x1c575f=a21_0x4c6938,_0x276261={};_0x276261[_0x1c575f(0x1a8)]=_0x1c575f(0x1c7),_0x276261[_0x1c575f(0x1d2)]=_0x1c575f(0x1dd),_0x276261[_0x1c575f(0x19c)]=_0x1c575f(0x19a),_0x276261['rkUeP']=_0x1c575f(0x1a6),_0x276261['yrTHi']='help';const _0x1b9956=_0x276261,_0x5d337f={};_0x5d337f[_0x1c575f(0x1ad)]=_0x1b9956[_0x1c575f(0x1a8)],_0x5d337f[_0x1c575f(0x1c2)]=_0x1b9956[_0x1c575f(0x1d2)];const _0x11dba4={};_0x11dba4['description']=_0x1b9956[_0x1c575f(0x19c)],_0x11dba4[_0x1c575f(0x1c2)]=_0x1b9956['rkUeP'],_0x11dba4['default']=![];const _0x4c3e02={};return _0x4c3e02['grid-id']=_0x5d337f,_0x4c3e02[_0x1c575f(0x196)]=_0x11dba4,_0x4233a2['usage'](HELP_HEADER_MESSAGE[_0x1c575f(0x1ac)])['epilogue'](HELP_FOOTER_MESSAGE)[_0x1c575f(0x1b8)](_0x4c3e02)[_0x1c575f(0x1b4)](_0x1b9956['yrTHi'])[_0x1c575f(0x1ab)];},exports[a21_0x4c6938(0x1a9)]=async function(_0x2ea5b6){const _0x585ba1=a21_0x4c6938,_0x3c7620={'TEpfV':_0x585ba1(0x18b),'aNVtO':function(_0x227fdb){return _0x227fdb();},'qkhIY':_0x585ba1(0x1b3),'HBdzT':function(_0x15bd7e,_0x327bfd,_0x3e6601,_0x113425,_0x38fcd6,_0x1ac93a,_0x599be7){return _0x15bd7e(_0x327bfd,_0x3e6601,_0x113425,_0x38fcd6,_0x1ac93a,_0x599be7);},'JTqHL':_0x585ba1(0x1a4),'LTvFO':'init-not-called','Lnpzl':function(_0x48d895,_0x95a6a0,_0x45f8d1,_0x4fdc50,_0x457b69,_0x42ad8b,_0x5cee71){return _0x48d895(_0x95a6a0,_0x45f8d1,_0x4fdc50,_0x457b69,_0x42ad8b,_0x5cee71);},'qsqMN':function(_0x5243f1){return _0x5243f1();},'lySdU':_0x585ba1(0x1c0),'MJkuD':'<PasswordPlaceholder>','TqLrJ':_0x585ba1(0x194),'gMbCn':function(_0x907627,_0x19b94f,_0x144d71,_0xab3615){return _0x907627(_0x19b94f,_0x144d71,_0xab3615);},'MzytS':function(_0x70fc27,_0x383dc2,_0x2a5418){return _0x70fc27(_0x383dc2,_0x2a5418);},'QczWR':'Grid\x20stoppped.','ahNoQ':function(_0x14194b,_0x3cacc9){return _0x14194b===_0x3cacc9;},'DvvBv':_0x585ba1(0x1b9),'EKBCK':function(_0x4a6c06,_0x788bbb,_0x4a8840,_0x4eb470,_0x4a5027,_0x393200,_0x832615){return _0x4a6c06(_0x788bbb,_0x4a8840,_0x4eb470,_0x4a5027,_0x393200,_0x832615);},'CfoLN':_0x585ba1(0x189),'hLtPO':function(_0x457598,_0x2aaa4f){return _0x457598===_0x2aaa4f;},'muMJz':'invalid-grid-id','JEYUa':_0x585ba1(0x1bc)};let _0x445c83;try{!_0x2ea5b6[_0x585ba1(0x1a2)]&&(logger[_0x585ba1(0x199)](_0x3c7620[_0x585ba1(0x1b0)]),process[_0x585ba1(0x18e)](0x1));!fs[_0x585ba1(0x1d9)](_0x3c7620[_0x585ba1(0x19e)](getCredentialsPath))&&(logger[_0x585ba1(0x199)](_0x3c7620[_0x585ba1(0x18d)]),await _0x3c7620[_0x585ba1(0x1a7)](sendInstrumentationEvent,_0x2ea5b6,_0x3c7620[_0x585ba1(0x1d5)],messageTypes['ERROR'],_0x3c7620[_0x585ba1(0x1bf)],null,_0x2ea5b6),process[_0x585ba1(0x18e)](0x1));logger[_0x585ba1(0x1d8)]('Stopping\x20grid\x20'+_0x2ea5b6[_0x585ba1(0x1a2)]),await _0x3c7620[_0x585ba1(0x1c3)](sendInstrumentationEvent,_0x2ea5b6,_0x3c7620[_0x585ba1(0x1d5)],messageTypes[_0x585ba1(0x1cd)],null,null,_0x2ea5b6);const _0x4ff244=JSON[_0x585ba1(0x195)](fs[_0x585ba1(0x192)](_0x3c7620[_0x585ba1(0x1ce)](getCredentialsPath)));global_registry[_0x585ba1(0x1d0)]=_0x4ff244[_0x585ba1(0x18a)]['username'],global_registry[_0x585ba1(0x1db)]=_0x4ff244[_0x585ba1(0x18a)][_0x585ba1(0x19d)];const _0x2ebdea=WS_ENDPOINT['replace'](_0x3c7620['lySdU'],_0x4ff244[_0x585ba1(0x18a)]['username'])['replace'](_0x3c7620[_0x585ba1(0x1c1)],_0x4ff244[_0x585ba1(0x18a)]['password']),_0x3af231={};_0x3af231[_0x585ba1(0x1a0)]=ws,_0x3af231[_0x585ba1(0x1c6)]=0x36ee80,_0x445c83=new ReconnectingWebSocket(_0x2ebdea,[],_0x3af231),logger[_0x585ba1(0x1c4)](_0x3c7620[_0x585ba1(0x1aa)]),webSocketUtils[_0x585ba1(0x1ae)](_0x445c83,_0x2ea5b6['user'],_0x2ea5b6[_0x585ba1(0x19d)]);const [_0x2f1ebc,_0x38e195]=await _0x3c7620['gMbCn'](getGridDetails,_0x4ff244[_0x585ba1(0x18a)][_0x585ba1(0x1cb)],_0x4ff244['Browserstack'][_0x585ba1(0x19d)],_0x2ea5b6[_0x585ba1(0x1a2)]);if(_0x38e195){const _0x3d228a=_0x38e195[_0x585ba1(0x1d8)];global_registry['cloudProvider']=_0x3d228a[_0x585ba1(0x1a1)],global_registry[_0x585ba1(0x1cf)]=_0x3d228a['region'],global_registry['clusterName']=_0x3d228a['clusterName'];const _0x1524a3=await _0x3c7620['Lnpzl'](getCloudProviderObject,_0x3d228a[_0x585ba1(0x1a1)],_0x3d228a[_0x585ba1(0x1dc)],_0x3d228a[_0x585ba1(0x188)],_0x445c83,webSocketUtils,_0x2ea5b6),[_0x5e896c,_0x599abb,_0x984908,_0xf81522,_0x13a0df,_0x5d5855]=await _0x3c7620[_0x585ba1(0x1cc)](createK8sClient,_0x1524a3,_0x2ea5b6['skipTlsCertVerify']);await _0x3c7620[_0x585ba1(0x1cc)](scaleDownHubDeployment,_0x599abb,_0x3d228a['name']),logger[_0x585ba1(0x1d8)](_0x3c7620[_0x585ba1(0x1b1)]),process['exit'](0x0);}_0x3c7620[_0x585ba1(0x1c8)](_0x2f1ebc['statusCode'],0x191)&&(logger[_0x585ba1(0x199)](_0x3c7620[_0x585ba1(0x1c9)]),await _0x3c7620[_0x585ba1(0x1da)](sendInstrumentationEvent,_0x2ea5b6,_0x3c7620[_0x585ba1(0x1d5)],messageTypes[_0x585ba1(0x1b2)],_0x3c7620['CfoLN'],null,_0x2ea5b6),process[_0x585ba1(0x18e)](0x1)),_0x3c7620['hLtPO'](_0x2f1ebc[_0x585ba1(0x19f)],0x190)&&(logger['error'](JSON['parse'](_0x2f1ebc[_0x585ba1(0x1bb)])[_0x585ba1(0x1b5)]),await _0x3c7620[_0x585ba1(0x1da)](sendInstrumentationEvent,_0x2ea5b6,_0x3c7620['JTqHL'],messageTypes[_0x585ba1(0x1b2)],_0x3c7620[_0x585ba1(0x1af)],null,_0x2ea5b6),process[_0x585ba1(0x18e)](0x1)),logger[_0x585ba1(0x199)]('Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20'+JSON['stringify'](_0x2f1ebc)),await _0x3c7620['HBdzT'](sendInstrumentationEvent,_0x2ea5b6,_0x3c7620[_0x585ba1(0x1d5)],messageTypes['ERROR'],_0x3c7620['JEYUa'],_0x2f1ebc,_0x2ea5b6),process[_0x585ba1(0x18e)](0x1);}catch(_0x3593a4){const _0x2d33c5=_0x585ba1(0x1d3)+_0x3593a4+'\x20\x0a'+JSON[_0x585ba1(0x1d6)](_0x3593a4['stack'])+'\x20';logger[_0x585ba1(0x199)](_0x2d33c5),process[_0x585ba1(0x18e)](0x1);}};