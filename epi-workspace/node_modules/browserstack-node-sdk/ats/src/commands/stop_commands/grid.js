const a21_0x565dfe=a21_0xa877;(function(_0x1536fb,_0x4d73ae){const _0x273829=a21_0xa877,_0xc6a3e0=_0x1536fb();while(!![]){try{const _0x499ec8=parseInt(_0x273829(0x17c))/0x1*(parseInt(_0x273829(0x197))/0x2)+-parseInt(_0x273829(0x18f))/0x3+parseInt(_0x273829(0x175))/0x4*(-parseInt(_0x273829(0x199))/0x5)+-parseInt(_0x273829(0x176))/0x6*(-parseInt(_0x273829(0x191))/0x7)+-parseInt(_0x273829(0x188))/0x8+-parseInt(_0x273829(0x1ac))/0x9+parseInt(_0x273829(0x1a2))/0xa*(parseInt(_0x273829(0x19b))/0xb);if(_0x499ec8===_0x4d73ae)break;else _0xc6a3e0['push'](_0xc6a3e0['shift']());}catch(_0x48773c){_0xc6a3e0['push'](_0xc6a3e0['shift']());}}}(a21_0x3d06,0xc6c18));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x565dfe(0x17f)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require('../../config/constants'),{logger}=require(a21_0x565dfe(0x194)),{getCredentialsPath,getGridDetails}=require(a21_0x565dfe(0x166)),{scaleDownHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require(a21_0x565dfe(0x17b)),webSocketUtils=require(a21_0x565dfe(0x18e)),{createK8sClient}=require('../../utils/createk8sClient'),{getCloudProviderObject}=require(a21_0x565dfe(0x1a3));function a21_0xa877(_0x3358d0,_0x2b6e9c){const _0x3d06e6=a21_0x3d06();return a21_0xa877=function(_0xa87713,_0x5797dc){_0xa87713=_0xa87713-0x159;let _0x24488b=_0x3d06e6[_0xa87713];return _0x24488b;},a21_0xa877(_0x3358d0,_0x2b6e9c);}function a21_0x3d06(){const _0x442be8=['readFileSync','init-not-called','WebSocket','MpVNh','gjXle','ERROR','12856896rFguky','default','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','qfoqj','stop','exit','RClPI','Ymbqy','Stopping\x20grid\x20','ilvMu','replace','user','builder','epilogue','stringify','../../utils/utilityMethods','type','<UsernamePlaceholder>','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','BptIO','Stop\x20a\x20running\x20Automation\x20grid.','clusterName','XjUZV','addListeners','gridId','unauthorised','message','NXyrA','stop-grid-called','KNsIi','5075368IyCGFp','24jdOnmg','bbGuG','yViSH','debug','region','../../utils/instrumentationUtils','761PgvkLO','xsJyb','error','reconnecting-websocket','invalid-grid-id','QBCek','cTMnL','server-error','name','UtSbQ','connectionTimeout','gvYxU','10416784BnQwrK','description','cloudProvider','usage','password','Browserstack','../../utils/webSocketUtils','370797YsvKLk','username','634144RHjZjJ','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','body','../../config/logger','PHXZM','hfMiD','1832uJyPPn','jVBjc','5EHYIUI','parse','33gmPKwm','grid','help','statusCode','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','info','12925810PZObJP','../../cloudproviders/utils','bstackUsername','Grid\x20stoppped.'];a21_0x3d06=function(){return _0x442be8;};return a21_0x3d06();}exports['command']=a21_0x565dfe(0x19c),exports['desc']=a21_0x565dfe(0x16b),exports[a21_0x565dfe(0x163)]=function(_0x115e26){const _0x28c276=a21_0x565dfe,_0x3e0942={};_0x3e0942[_0x28c276(0x182)]=_0x28c276(0x19f),_0x3e0942[_0x28c276(0x15d)]='string',_0x3e0942[_0x28c276(0x160)]='Skip\x20insecure\x20cert\x20verification.',_0x3e0942[_0x28c276(0x195)]='boolean',_0x3e0942[_0x28c276(0x196)]=_0x28c276(0x19d);const _0x4e54b4=_0x3e0942,_0x523b86={};_0x523b86[_0x28c276(0x189)]=_0x4e54b4[_0x28c276(0x182)],_0x523b86[_0x28c276(0x167)]=_0x4e54b4[_0x28c276(0x15d)];const _0x45ad3f={};_0x45ad3f['description']=_0x4e54b4['ilvMu'],_0x45ad3f['type']=_0x4e54b4[_0x28c276(0x195)],_0x45ad3f[_0x28c276(0x1ad)]=![];const _0x3a321f={};return _0x3a321f['grid-id']=_0x523b86,_0x3a321f['skip-tls-cert-verify']=_0x45ad3f,_0x115e26[_0x28c276(0x18b)](HELP_HEADER_MESSAGE[_0x28c276(0x15b)])[_0x28c276(0x164)](HELP_FOOTER_MESSAGE)['options'](_0x3a321f)[_0x28c276(0x19d)](_0x4e54b4[_0x28c276(0x196)])['argv'];},exports['handler']=async function(_0x4bd82a){const _0x4060e3=a21_0x565dfe,_0xfc31be={'KNsIi':_0x4060e3(0x169),'NXyrA':function(_0x54fe7c){return _0x54fe7c();},'xsJyb':'Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','gjXle':function(_0xee6caa,_0x5022df,_0x283d42,_0x4fd21e,_0x2fb48e,_0x67ab6b,_0x2ff7f3){return _0xee6caa(_0x5022df,_0x283d42,_0x4fd21e,_0x2fb48e,_0x67ab6b,_0x2ff7f3);},'qfoqj':_0x4060e3(0x173),'EpPnx':_0x4060e3(0x1a7),'QBCek':function(_0x5d3fa0,_0x5e85b3,_0x2eb827,_0x410dc5,_0x3028cc,_0x3c296a,_0x21b70c){return _0x5d3fa0(_0x5e85b3,_0x2eb827,_0x410dc5,_0x3028cc,_0x3c296a,_0x21b70c);},'MpVNh':function(_0x4f920c){return _0x4f920c();},'UtSbQ':_0x4060e3(0x168),'iFXdV':'<PasswordPlaceholder>','lugJb':'Adding\x20Websocket\x20listeners','bbGuG':function(_0x354e09,_0xe1f5b3,_0x3abfb0,_0x51f0e3){return _0x354e09(_0xe1f5b3,_0x3abfb0,_0x51f0e3);},'BaiIM':function(_0x5f3b8f,_0x3bdaf9,_0x474135){return _0x5f3b8f(_0x3bdaf9,_0x474135);},'BptIO':function(_0x25024c,_0x23ef77,_0x41db18){return _0x25024c(_0x23ef77,_0x41db18);},'gvYxU':_0x4060e3(0x1a5),'XjUZV':function(_0x1cd4b4,_0x1112eb){return _0x1cd4b4===_0x1112eb;},'jRaTb':_0x4060e3(0x159),'jVBjc':_0x4060e3(0x170),'Ymbqy':_0x4060e3(0x180),'yViSH':_0x4060e3(0x183)};let _0x56adeb;try{!_0x4bd82a['gridId']&&(logger['error'](_0xfc31be[_0x4060e3(0x174)]),process[_0x4060e3(0x15c)](0x1));!fs['existsSync'](_0xfc31be[_0x4060e3(0x172)](getCredentialsPath))&&(logger[_0x4060e3(0x17e)](_0xfc31be[_0x4060e3(0x17d)]),await _0xfc31be['gjXle'](sendInstrumentationEvent,_0x4bd82a,_0xfc31be[_0x4060e3(0x15a)],messageTypes[_0x4060e3(0x1ab)],_0xfc31be['EpPnx'],null,_0x4bd82a),process['exit'](0x1));logger[_0x4060e3(0x1a1)](_0x4060e3(0x15f)+_0x4bd82a[_0x4060e3(0x16f)]),await _0xfc31be['QBCek'](sendInstrumentationEvent,_0x4bd82a,_0xfc31be['qfoqj'],messageTypes['INFO'],null,null,_0x4bd82a);const _0x3d83db=JSON[_0x4060e3(0x19a)](fs[_0x4060e3(0x1a6)](_0xfc31be[_0x4060e3(0x1a9)](getCredentialsPath)));global_registry[_0x4060e3(0x1a4)]=_0x3d83db[_0x4060e3(0x18d)][_0x4060e3(0x190)],global_registry['bstackAccesskey']=_0x3d83db[_0x4060e3(0x18d)][_0x4060e3(0x18c)];const _0x381298=WS_ENDPOINT[_0x4060e3(0x161)](_0xfc31be[_0x4060e3(0x185)],_0x3d83db[_0x4060e3(0x18d)][_0x4060e3(0x190)])['replace'](_0xfc31be['iFXdV'],_0x3d83db[_0x4060e3(0x18d)]['password']),_0x3d82f8={};_0x3d82f8[_0x4060e3(0x1a8)]=ws,_0x3d82f8[_0x4060e3(0x186)]=0x36ee80,_0x56adeb=new ReconnectingWebSocket(_0x381298,[],_0x3d82f8),logger[_0x4060e3(0x179)](_0xfc31be['lugJb']),webSocketUtils[_0x4060e3(0x16e)](_0x56adeb,_0x4bd82a[_0x4060e3(0x162)],_0x4bd82a[_0x4060e3(0x18c)]);const [_0x1edae9,_0x5d6021]=await _0xfc31be[_0x4060e3(0x177)](getGridDetails,_0x3d83db[_0x4060e3(0x18d)][_0x4060e3(0x190)],_0x3d83db[_0x4060e3(0x18d)][_0x4060e3(0x18c)],_0x4bd82a[_0x4060e3(0x16f)]);if(_0x5d6021){const _0x34e474=_0x5d6021[_0x4060e3(0x1a1)];global_registry[_0x4060e3(0x18a)]=_0x34e474[_0x4060e3(0x18a)],global_registry['clusterRegion']=_0x34e474[_0x4060e3(0x17a)],global_registry[_0x4060e3(0x16c)]=_0x34e474[_0x4060e3(0x16c)];const _0x31c253=await _0xfc31be[_0x4060e3(0x1aa)](getCloudProviderObject,_0x34e474[_0x4060e3(0x18a)],_0x34e474[_0x4060e3(0x16c)],_0x34e474[_0x4060e3(0x184)],_0x56adeb,webSocketUtils,_0x4bd82a),[_0xade885,_0x1cdf08,_0xf339e4,_0x3315c1,_0x3a35c2,_0x3e3fe7]=await _0xfc31be['BaiIM'](createK8sClient,_0x31c253,_0x4bd82a['skipTlsCertVerify']);await _0xfc31be[_0x4060e3(0x16a)](scaleDownHubDeployment,_0x1cdf08,_0x34e474[_0x4060e3(0x184)]),logger['info'](_0xfc31be[_0x4060e3(0x187)]),process[_0x4060e3(0x15c)](0x0);}_0xfc31be[_0x4060e3(0x16d)](_0x1edae9[_0x4060e3(0x19e)],0x191)&&(logger[_0x4060e3(0x17e)](_0xfc31be['jRaTb']),await _0xfc31be[_0x4060e3(0x1aa)](sendInstrumentationEvent,_0x4bd82a,_0xfc31be[_0x4060e3(0x15a)],messageTypes[_0x4060e3(0x1ab)],_0xfc31be[_0x4060e3(0x198)],null,_0x4bd82a),process[_0x4060e3(0x15c)](0x1)),_0xfc31be[_0x4060e3(0x16d)](_0x1edae9['statusCode'],0x190)&&(logger[_0x4060e3(0x17e)](JSON['parse'](_0x1edae9[_0x4060e3(0x193)])[_0x4060e3(0x171)]),await _0xfc31be[_0x4060e3(0x1aa)](sendInstrumentationEvent,_0x4bd82a,_0xfc31be[_0x4060e3(0x15a)],messageTypes[_0x4060e3(0x1ab)],_0xfc31be[_0x4060e3(0x15e)],null,_0x4bd82a),process[_0x4060e3(0x15c)](0x1)),logger[_0x4060e3(0x17e)](_0x4060e3(0x192)+JSON[_0x4060e3(0x165)](_0x1edae9)),await _0xfc31be[_0x4060e3(0x181)](sendInstrumentationEvent,_0x4bd82a,_0xfc31be['qfoqj'],messageTypes[_0x4060e3(0x1ab)],_0xfc31be[_0x4060e3(0x178)],_0x1edae9,_0x4bd82a),process[_0x4060e3(0x15c)](0x1);}catch(_0x3a11ef){const _0x857626=_0x4060e3(0x1a0)+_0x3a11ef+'\x20\x0a'+JSON[_0x4060e3(0x165)](_0x3a11ef['stack'])+'\x20';logger[_0x4060e3(0x17e)](_0x857626),process[_0x4060e3(0x15c)](0x1);}};