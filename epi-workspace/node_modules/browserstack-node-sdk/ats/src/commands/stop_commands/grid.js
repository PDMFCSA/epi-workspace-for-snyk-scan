const a21_0x1edb65=a21_0x15ff;(function(_0x5d14f0,_0x396ecc){const _0x50e450=a21_0x15ff,_0xa7856a=_0x5d14f0();while(!![]){try{const _0x31c85f=parseInt(_0x50e450(0x1cb))/0x1*(-parseInt(_0x50e450(0x1da))/0x2)+-parseInt(_0x50e450(0x1eb))/0x3+parseInt(_0x50e450(0x1e3))/0x4*(-parseInt(_0x50e450(0x1b0))/0x5)+parseInt(_0x50e450(0x1b6))/0x6+-parseInt(_0x50e450(0x1fa))/0x7*(parseInt(_0x50e450(0x1b2))/0x8)+parseInt(_0x50e450(0x1fc))/0x9+parseInt(_0x50e450(0x1c0))/0xa;if(_0x31c85f===_0x396ecc)break;else _0xa7856a['push'](_0xa7856a['shift']());}catch(_0x3d2f64){_0xa7856a['push'](_0xa7856a['shift']());}}}(a21_0x6760,0xf2e8c));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x1edb65(0x1d9)),{logger}=require(a21_0x1edb65(0x1b1)),{getCredentialsPath,getGridDetails}=require(a21_0x1edb65(0x1c6)),{scaleDownHubDeployment}=require(a21_0x1edb65(0x1a4)),{sendInstrumentationEvent}=require(a21_0x1edb65(0x1d0)),webSocketUtils=require(a21_0x1edb65(0x1e8)),{createK8sClient}=require(a21_0x1edb65(0x1f8)),{getCloudProviderObject}=require(a21_0x1edb65(0x1ee));exports[a21_0x1edb65(0x1dc)]=a21_0x1edb65(0x1f1),exports['desc']='Stop\x20a\x20running\x20Automation\x20grid.',exports[a21_0x1edb65(0x1a6)]=function(_0x4ec716){const _0x23442f=a21_0x1edb65,_0x4fd2a0={};_0x4fd2a0[_0x23442f(0x1b3)]='Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.',_0x4fd2a0[_0x23442f(0x1f0)]=_0x23442f(0x1bc),_0x4fd2a0[_0x23442f(0x1a3)]=_0x23442f(0x1ca),_0x4fd2a0[_0x23442f(0x1c1)]=_0x23442f(0x1a2),_0x4fd2a0['VEKFJ']=_0x23442f(0x1c9);const _0x31f53c=_0x4fd2a0,_0x58a22e={};_0x58a22e[_0x23442f(0x1b8)]=_0x31f53c[_0x23442f(0x1b3)],_0x58a22e['type']=_0x31f53c[_0x23442f(0x1f0)];const _0x1bc602={};_0x1bc602[_0x23442f(0x1b8)]=_0x31f53c[_0x23442f(0x1a3)],_0x1bc602['type']=_0x31f53c[_0x23442f(0x1c1)],_0x1bc602[_0x23442f(0x1c3)]=![];const _0x35d6db={};return _0x35d6db['grid-id']=_0x58a22e,_0x35d6db['skip-tls-cert-verify']=_0x1bc602,_0x4ec716['usage'](HELP_HEADER_MESSAGE[_0x23442f(0x1bb)])[_0x23442f(0x1de)](HELP_FOOTER_MESSAGE)[_0x23442f(0x1fe)](_0x35d6db)[_0x23442f(0x1c9)](_0x31f53c[_0x23442f(0x1bd)])[_0x23442f(0x1f7)];},exports['handler']=async function(_0x428237){const _0x26c7d7=a21_0x1edb65,_0x2508a4={'ZVSDw':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','bEKQl':function(_0x291e6f){return _0x291e6f();},'VekeD':_0x26c7d7(0x1ec),'nhozy':function(_0x103c2b,_0x264aac,_0x20fb38,_0x1dff0e,_0x5bd2d2,_0x1001e7,_0x4d935c){return _0x103c2b(_0x264aac,_0x20fb38,_0x1dff0e,_0x5bd2d2,_0x1001e7,_0x4d935c);},'ioJKX':_0x26c7d7(0x1e6),'EtJpG':'init-not-called','fIfgB':function(_0x52cf4e,_0x31e8b6,_0xb1208f,_0x57d917,_0x1776d5,_0x1a24de,_0x445c9e){return _0x52cf4e(_0x31e8b6,_0xb1208f,_0x57d917,_0x1776d5,_0x1a24de,_0x445c9e);},'KfiEr':function(_0x4b6c82){return _0x4b6c82();},'FGfUV':_0x26c7d7(0x1f4),'ptpty':_0x26c7d7(0x1c4),'eYZMa':_0x26c7d7(0x1c8),'ghqYO':function(_0x22e205,_0x53c5af,_0x7ba058,_0x568de2){return _0x22e205(_0x53c5af,_0x7ba058,_0x568de2);},'qytph':function(_0x94cbb9,_0x429156,_0x53c1f8){return _0x94cbb9(_0x429156,_0x53c1f8);},'OTBVq':function(_0x10f964,_0x2c240f,_0x504c63){return _0x10f964(_0x2c240f,_0x504c63);},'gqpmd':_0x26c7d7(0x1be),'SdKsz':function(_0x2b9128,_0x2717db){return _0x2b9128===_0x2717db;},'UmbWd':_0x26c7d7(0x1d1),'rBqRZ':function(_0x1b1614,_0x1d8bc9,_0x4dbbd7,_0x228203,_0x24f027,_0x1187e6,_0x25a4b1){return _0x1b1614(_0x1d8bc9,_0x4dbbd7,_0x228203,_0x24f027,_0x1187e6,_0x25a4b1);},'nMxGW':_0x26c7d7(0x1fb),'zPUjw':function(_0x465a8c,_0x220413,_0x4cf00a,_0x3e71f9,_0xf9648d,_0x376ecb,_0x90e55c){return _0x465a8c(_0x220413,_0x4cf00a,_0x3e71f9,_0xf9648d,_0x376ecb,_0x90e55c);},'YExsG':_0x26c7d7(0x1ea),'VPLTL':function(_0x12e1f3,_0x3e5735,_0x4f0e26,_0x43c522,_0x2c7e4e,_0x14786a,_0x121570){return _0x12e1f3(_0x3e5735,_0x4f0e26,_0x43c522,_0x2c7e4e,_0x14786a,_0x121570);},'iibOu':_0x26c7d7(0x1df)};let _0x57174a;try{!_0x428237[_0x26c7d7(0x1e4)]&&(logger[_0x26c7d7(0x1dd)](_0x2508a4[_0x26c7d7(0x1c7)]),process[_0x26c7d7(0x1cd)](0x1));!fs[_0x26c7d7(0x1a7)](_0x2508a4[_0x26c7d7(0x1ce)](getCredentialsPath))&&(logger[_0x26c7d7(0x1dd)](_0x2508a4[_0x26c7d7(0x1af)]),await _0x2508a4[_0x26c7d7(0x1cf)](sendInstrumentationEvent,_0x428237,_0x2508a4[_0x26c7d7(0x1b4)],messageTypes[_0x26c7d7(0x1e1)],_0x2508a4['EtJpG'],null,_0x428237),process[_0x26c7d7(0x1cd)](0x1));logger[_0x26c7d7(0x1ad)]('Stopping\x20grid\x20'+_0x428237[_0x26c7d7(0x1e4)]),await _0x2508a4[_0x26c7d7(0x1e7)](sendInstrumentationEvent,_0x428237,_0x2508a4['ioJKX'],messageTypes[_0x26c7d7(0x1bf)],null,null,_0x428237);const _0x345792=JSON['parse'](fs[_0x26c7d7(0x1b5)](_0x2508a4[_0x26c7d7(0x1aa)](getCredentialsPath)));global_registry[_0x26c7d7(0x1d7)]=_0x345792[_0x26c7d7(0x1b9)][_0x26c7d7(0x1e5)],global_registry['bstackAccesskey']=_0x345792[_0x26c7d7(0x1b9)][_0x26c7d7(0x1ac)];const _0x413cd4=WS_ENDPOINT[_0x26c7d7(0x1d8)](_0x2508a4[_0x26c7d7(0x1f9)],_0x345792[_0x26c7d7(0x1b9)][_0x26c7d7(0x1e5)])[_0x26c7d7(0x1d8)](_0x2508a4[_0x26c7d7(0x1a9)],_0x345792[_0x26c7d7(0x1b9)]['password']),_0x3897bc={};_0x3897bc[_0x26c7d7(0x1ed)]=ws,_0x3897bc[_0x26c7d7(0x1d2)]=0x36ee80,_0x57174a=new ReconnectingWebSocket(_0x413cd4,[],_0x3897bc),logger[_0x26c7d7(0x1f5)](_0x2508a4[_0x26c7d7(0x1e2)]),webSocketUtils[_0x26c7d7(0x1d5)](_0x57174a,_0x428237[_0x26c7d7(0x1fd)],_0x428237['password']);const [_0x27681b,_0x39982c]=await _0x2508a4[_0x26c7d7(0x1e0)](getGridDetails,_0x345792[_0x26c7d7(0x1b9)][_0x26c7d7(0x1e5)],_0x345792[_0x26c7d7(0x1b9)]['password'],_0x428237[_0x26c7d7(0x1e4)]);if(_0x39982c){const _0xe4a743=_0x39982c[_0x26c7d7(0x1ad)];global_registry['cloudProvider']=_0xe4a743['cloudProvider'],global_registry[_0x26c7d7(0x1c5)]=_0xe4a743['region'],global_registry[_0x26c7d7(0x1ab)]=_0xe4a743[_0x26c7d7(0x1ab)];const _0x2271ca=await _0x2508a4[_0x26c7d7(0x1e7)](getCloudProviderObject,_0xe4a743[_0x26c7d7(0x1ba)],_0xe4a743[_0x26c7d7(0x1ab)],_0xe4a743[_0x26c7d7(0x1ef)],_0x57174a,webSocketUtils,_0x428237),[_0x17955b,_0x4f91a1,_0x343762,_0x3bb221,_0x4a8356,_0xa0b87a]=await _0x2508a4[_0x26c7d7(0x1f3)](createK8sClient,_0x2271ca,_0x428237[_0x26c7d7(0x1e9)]);await _0x2508a4['OTBVq'](scaleDownHubDeployment,_0x4f91a1,_0xe4a743[_0x26c7d7(0x1ef)]),logger[_0x26c7d7(0x1ad)](_0x2508a4['gqpmd']),process['exit'](0x0);}_0x2508a4[_0x26c7d7(0x1cc)](_0x27681b['statusCode'],0x191)&&(logger[_0x26c7d7(0x1dd)](_0x2508a4['UmbWd']),await _0x2508a4[_0x26c7d7(0x1c2)](sendInstrumentationEvent,_0x428237,_0x2508a4[_0x26c7d7(0x1b4)],messageTypes[_0x26c7d7(0x1e1)],_0x2508a4[_0x26c7d7(0x1a8)],null,_0x428237),process[_0x26c7d7(0x1cd)](0x1)),_0x2508a4['SdKsz'](_0x27681b[_0x26c7d7(0x1ae)],0x190)&&(logger['error'](JSON[_0x26c7d7(0x1db)](_0x27681b['body'])[_0x26c7d7(0x1a5)]),await _0x2508a4['zPUjw'](sendInstrumentationEvent,_0x428237,_0x2508a4['ioJKX'],messageTypes[_0x26c7d7(0x1e1)],_0x2508a4[_0x26c7d7(0x1b7)],null,_0x428237),process[_0x26c7d7(0x1cd)](0x1)),logger[_0x26c7d7(0x1dd)](_0x26c7d7(0x1d4)+JSON['stringify'](_0x27681b)),await _0x2508a4[_0x26c7d7(0x1f2)](sendInstrumentationEvent,_0x428237,_0x2508a4[_0x26c7d7(0x1b4)],messageTypes[_0x26c7d7(0x1e1)],_0x2508a4[_0x26c7d7(0x1d6)],_0x27681b,_0x428237),process[_0x26c7d7(0x1cd)](0x1);}catch(_0x1a9ff2){const _0xce68fe='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x1a9ff2+'\x20\x0a'+JSON[_0x26c7d7(0x1d3)](_0x1a9ff2[_0x26c7d7(0x1f6)])+'\x20';logger[_0x26c7d7(0x1dd)](_0xce68fe),process[_0x26c7d7(0x1cd)](0x1);}};function a21_0x15ff(_0x3cc404,_0x327507){const _0x676044=a21_0x6760();return a21_0x15ff=function(_0x15ffa8,_0x1bedf4){_0x15ffa8=_0x15ffa8-0x1a2;let _0x2b71be=_0x676044[_0x15ffa8];return _0x2b71be;},a21_0x15ff(_0x3cc404,_0x327507);}function a21_0x6760(){const _0x2e4390=['help','Skip\x20insecure\x20cert\x20verification.','383927Theqnm','SdKsz','exit','bEKQl','nhozy','../../utils/instrumentationUtils','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','connectionTimeout','stringify','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','addListeners','iibOu','bstackUsername','replace','../../config/constants','2CklAVQ','parse','command','error','epilogue','server-error','ghqYO','ERROR','eYZMa','1973848MmRnvB','gridId','username','stop-grid-called','fIfgB','../../utils/webSocketUtils','skipTlsCertVerify','invalid-grid-id','3460350UYUzKc','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','WebSocket','../../cloudproviders/utils','name','KwSor','grid','VPLTL','qytph','<UsernamePlaceholder>','debug','stack','argv','../../utils/createk8sClient','FGfUV','7UriySC','unauthorised','1881990RVoBdy','user','options','boolean','uNKgL','../../utils/gridComponents','message','builder','existsSync','nMxGW','ptpty','KfiEr','clusterName','password','info','statusCode','VekeD','5KjkyhH','../../config/logger','11341048TbJAgw','qAXjo','ioJKX','readFileSync','872598SrUZiA','YExsG','description','Browserstack','cloudProvider','stop','string','VEKFJ','Grid\x20stoppped.','INFO','40888830RSTUAR','NDlGj','rBqRZ','default','<PasswordPlaceholder>','clusterRegion','../../utils/utilityMethods','ZVSDw','Adding\x20Websocket\x20listeners'];a21_0x6760=function(){return _0x2e4390;};return a21_0x6760();}