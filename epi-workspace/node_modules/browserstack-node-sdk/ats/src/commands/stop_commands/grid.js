const a21_0x187fcf=a21_0x354e;(function(_0x1bc4ea,_0x78237a){const _0x4f9bc9=a21_0x354e,_0x3a53d4=_0x1bc4ea();while(!![]){try{const _0x3885e5=-parseInt(_0x4f9bc9(0x19b))/0x1+parseInt(_0x4f9bc9(0x153))/0x2*(-parseInt(_0x4f9bc9(0x160))/0x3)+-parseInt(_0x4f9bc9(0x16f))/0x4*(parseInt(_0x4f9bc9(0x173))/0x5)+parseInt(_0x4f9bc9(0x195))/0x6*(parseInt(_0x4f9bc9(0x1a2))/0x7)+-parseInt(_0x4f9bc9(0x174))/0x8+parseInt(_0x4f9bc9(0x15e))/0x9*(-parseInt(_0x4f9bc9(0x17f))/0xa)+parseInt(_0x4f9bc9(0x159))/0xb;if(_0x3885e5===_0x78237a)break;else _0x3a53d4['push'](_0x3a53d4['shift']());}catch(_0x433c00){_0x3a53d4['push'](_0x3a53d4['shift']());}}}(a21_0x4596,0xe593a));function a21_0x4596(){const _0x57c3a7=['JtpWh','2855247lfffHH','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','debug','WebSocket','FqKCe','skip-tls-cert-verify','dxazI','../../utils/gridComponents','XAmtC','desc','clusterName','vwHif','grid-id','Stop\x20a\x20running\x20Automation\x20grid.','Adding\x20Websocket\x20listeners','3548oRrKWw','jaMDW','init-not-called','../../cloudproviders/utils','4630zphzUv','7107432DqODux','password','kAQiR','<PasswordPlaceholder>','stack','exit','readFileSync','info','replace','OpFRe','parse','10ZajozB','Browserstack','unauthorised','RjyDh','name','error','OcOiZ','cloudProvider','gridId','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','bstackUsername','../../utils/createk8sClient','UHQdL','reconnecting-websocket','qCqbc','WdtAe','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','stringify','Stopping\x20grid\x20','grid','user','138JUDUPQ','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','string','command','stop-grid-called','description','141437cRUdoX','rnywf','type','cZGnV','XXgsq','qknEk','username','171031oQIZQG','cGirN','server-error','2flGFjv','ERROR','clusterRegion','connectionTimeout','OcKVu','../../utils/instrumentationUtils','38718504ycAvcS','yhopC','help','usage','YAZNA','3046500KanlpD'];a21_0x4596=function(){return _0x57c3a7;};return a21_0x4596();}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x187fcf(0x18c)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require('../../config/constants'),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0x187fcf(0x167)),{sendInstrumentationEvent}=require(a21_0x187fcf(0x158)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x187fcf(0x18a)),{getCloudProviderObject}=require(a21_0x187fcf(0x172));function a21_0x354e(_0x3cc5c1,_0x38f3ed){const _0x45962f=a21_0x4596();return a21_0x354e=function(_0x354ec8,_0x1497ba){_0x354ec8=_0x354ec8-0x152;let _0x5d8ac4=_0x45962f[_0x354ec8];return _0x5d8ac4;},a21_0x354e(_0x3cc5c1,_0x38f3ed);}exports[a21_0x187fcf(0x198)]=a21_0x187fcf(0x193),exports[a21_0x187fcf(0x169)]=a21_0x187fcf(0x16d),exports['builder']=function(_0x30a3aa){const _0x591b39=a21_0x187fcf,_0x489835={};_0x489835[_0x591b39(0x19c)]=_0x591b39(0x190),_0x489835[_0x591b39(0x18b)]=_0x591b39(0x197),_0x489835[_0x591b39(0x164)]='Skip\x20insecure\x20cert\x20verification.',_0x489835['yhopC']='boolean',_0x489835[_0x591b39(0x157)]=_0x591b39(0x15b);const _0x4daa8e=_0x489835,_0x1f69f6={};_0x1f69f6[_0x591b39(0x19a)]=_0x4daa8e[_0x591b39(0x19c)],_0x1f69f6[_0x591b39(0x19d)]=_0x4daa8e['UHQdL'];const _0x418cb3={};_0x418cb3[_0x591b39(0x19a)]=_0x4daa8e[_0x591b39(0x164)],_0x418cb3[_0x591b39(0x19d)]=_0x4daa8e[_0x591b39(0x15a)],_0x418cb3['default']=![];const _0x174308={};return _0x174308[_0x591b39(0x16c)]=_0x1f69f6,_0x174308[_0x591b39(0x165)]=_0x418cb3,_0x30a3aa[_0x591b39(0x15c)](HELP_HEADER_MESSAGE['stop'])['epilogue'](HELP_FOOTER_MESSAGE)['options'](_0x174308)[_0x591b39(0x15b)](_0x4daa8e[_0x591b39(0x157)])['argv'];},exports['handler']=async function(_0x2a7dd4){const _0x1926e2=a21_0x187fcf,_0x199d9a={'kAQiR':_0x1926e2(0x196),'XAmtC':function(_0x3b9e11){return _0x3b9e11();},'aHEzB':_0x1926e2(0x161),'mtgbt':function(_0x1e7c45,_0x210776,_0x287f19,_0x30b844,_0x3f4f30,_0x11fc31,_0x5d7c94){return _0x1e7c45(_0x210776,_0x287f19,_0x30b844,_0x3f4f30,_0x11fc31,_0x5d7c94);},'OpFRe':_0x1926e2(0x199),'OcOiZ':_0x1926e2(0x171),'JtpWh':function(_0x3899a4,_0x62c8b1,_0x4759e8,_0x3a22be,_0x6768a,_0x2d521e,_0x350b9c){return _0x3899a4(_0x62c8b1,_0x4759e8,_0x3a22be,_0x6768a,_0x2d521e,_0x350b9c);},'RjyDh':function(_0x3b3cb9){return _0x3b3cb9();},'OfMQb':'<UsernamePlaceholder>','WdtAe':_0x1926e2(0x177),'NjRUD':_0x1926e2(0x16e),'cGirN':function(_0x278a98,_0x5c6117,_0x142498,_0x1f06d9){return _0x278a98(_0x5c6117,_0x142498,_0x1f06d9);},'YAZNA':function(_0x28ed47,_0xbcac63,_0x3d0e46,_0x240a91,_0x501a3f,_0x3a32cb,_0x15a5c0){return _0x28ed47(_0xbcac63,_0x3d0e46,_0x240a91,_0x501a3f,_0x3a32cb,_0x15a5c0);},'cZGnV':function(_0x5b42c8,_0x4f95a5,_0xe2f396){return _0x5b42c8(_0x4f95a5,_0xe2f396);},'qCqbc':'Grid\x20stoppped.','dxazI':function(_0xfa2a31,_0x32f4b7){return _0xfa2a31===_0x32f4b7;},'vwHif':_0x1926e2(0x18f),'qknEk':_0x1926e2(0x181),'jaMDW':function(_0x4e69bb,_0x2680b3){return _0x4e69bb===_0x2680b3;},'sUJck':function(_0x16ac9f,_0x92926e,_0x369a45,_0xe8de82,_0x23dc2d,_0x56263e,_0xd5ab76){return _0x16ac9f(_0x92926e,_0x369a45,_0xe8de82,_0x23dc2d,_0x56263e,_0xd5ab76);},'mIHJy':'invalid-grid-id','XXgsq':_0x1926e2(0x152)};let _0x1014ee;try{!_0x2a7dd4[_0x1926e2(0x187)]&&(logger[_0x1926e2(0x184)](_0x199d9a[_0x1926e2(0x176)]),process[_0x1926e2(0x179)](0x1));!fs['existsSync'](_0x199d9a[_0x1926e2(0x168)](getCredentialsPath))&&(logger['error'](_0x199d9a['aHEzB']),await _0x199d9a['mtgbt'](sendInstrumentationEvent,_0x2a7dd4,_0x199d9a[_0x1926e2(0x17d)],messageTypes[_0x1926e2(0x154)],_0x199d9a[_0x1926e2(0x185)],null,_0x2a7dd4),process[_0x1926e2(0x179)](0x1));logger[_0x1926e2(0x17b)](_0x1926e2(0x192)+_0x2a7dd4[_0x1926e2(0x187)]),await _0x199d9a[_0x1926e2(0x15f)](sendInstrumentationEvent,_0x2a7dd4,_0x199d9a[_0x1926e2(0x17d)],messageTypes['INFO'],null,null,_0x2a7dd4);const _0x228266=JSON[_0x1926e2(0x17e)](fs[_0x1926e2(0x17a)](_0x199d9a[_0x1926e2(0x182)](getCredentialsPath)));global_registry[_0x1926e2(0x189)]=_0x228266[_0x1926e2(0x180)]['username'],global_registry['bstackAccesskey']=_0x228266[_0x1926e2(0x180)][_0x1926e2(0x175)];const _0x2a9d59=WS_ENDPOINT['replace'](_0x199d9a['OfMQb'],_0x228266[_0x1926e2(0x180)][_0x1926e2(0x1a1)])[_0x1926e2(0x17c)](_0x199d9a[_0x1926e2(0x18e)],_0x228266[_0x1926e2(0x180)][_0x1926e2(0x175)]),_0x3fb59f={};_0x3fb59f[_0x1926e2(0x163)]=ws,_0x3fb59f[_0x1926e2(0x156)]=0x36ee80,_0x1014ee=new ReconnectingWebSocket(_0x2a9d59,[],_0x3fb59f),logger[_0x1926e2(0x162)](_0x199d9a['NjRUD']),webSocketUtils['addListeners'](_0x1014ee,_0x2a7dd4[_0x1926e2(0x194)],_0x2a7dd4[_0x1926e2(0x175)]);const [_0x4590dd,_0xa964fb]=await _0x199d9a[_0x1926e2(0x1a3)](getGridDetails,_0x228266[_0x1926e2(0x180)]['username'],_0x228266[_0x1926e2(0x180)][_0x1926e2(0x175)],_0x2a7dd4[_0x1926e2(0x187)]);if(_0xa964fb){const _0x3991bf=_0xa964fb[_0x1926e2(0x17b)];global_registry[_0x1926e2(0x186)]=_0x3991bf[_0x1926e2(0x186)],global_registry[_0x1926e2(0x155)]=_0x3991bf['region'],global_registry[_0x1926e2(0x16a)]=_0x3991bf[_0x1926e2(0x16a)];const _0xe0596d=await _0x199d9a[_0x1926e2(0x15d)](getCloudProviderObject,_0x3991bf[_0x1926e2(0x186)],_0x3991bf['clusterName'],_0x3991bf[_0x1926e2(0x183)],_0x1014ee,webSocketUtils,_0x2a7dd4),[_0x326368,_0x505ef4,_0x13b25f,_0x668812,_0x35fec8,_0x448fcd]=await _0x199d9a[_0x1926e2(0x19e)](createK8sClient,_0xe0596d,_0x2a7dd4['skipTlsCertVerify']);await _0x199d9a['cZGnV'](scaleDownHubDeployment,_0x505ef4,_0x3991bf[_0x1926e2(0x183)]),logger[_0x1926e2(0x17b)](_0x199d9a[_0x1926e2(0x18d)]),process['exit'](0x0);}_0x199d9a[_0x1926e2(0x166)](_0x4590dd['statusCode'],0x191)&&(logger['error'](_0x199d9a[_0x1926e2(0x16b)]),await _0x199d9a['mtgbt'](sendInstrumentationEvent,_0x2a7dd4,_0x199d9a[_0x1926e2(0x17d)],messageTypes[_0x1926e2(0x154)],_0x199d9a[_0x1926e2(0x1a0)],null,_0x2a7dd4),process[_0x1926e2(0x179)](0x1)),_0x199d9a[_0x1926e2(0x170)](_0x4590dd['statusCode'],0x190)&&(logger['error'](JSON[_0x1926e2(0x17e)](_0x4590dd['body'])['message']),await _0x199d9a['sUJck'](sendInstrumentationEvent,_0x2a7dd4,_0x199d9a['OpFRe'],messageTypes[_0x1926e2(0x154)],_0x199d9a['mIHJy'],null,_0x2a7dd4),process[_0x1926e2(0x179)](0x1)),logger[_0x1926e2(0x184)](_0x1926e2(0x188)+JSON[_0x1926e2(0x191)](_0x4590dd)),await _0x199d9a[_0x1926e2(0x15d)](sendInstrumentationEvent,_0x2a7dd4,_0x199d9a[_0x1926e2(0x17d)],messageTypes['ERROR'],_0x199d9a[_0x1926e2(0x19f)],_0x4590dd,_0x2a7dd4),process['exit'](0x1);}catch(_0x4db0bd){const _0x3a0183='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x4db0bd+'\x20\x0a'+JSON[_0x1926e2(0x191)](_0x4db0bd[_0x1926e2(0x178)])+'\x20';logger[_0x1926e2(0x184)](_0x3a0183),process[_0x1926e2(0x179)](0x1);}};