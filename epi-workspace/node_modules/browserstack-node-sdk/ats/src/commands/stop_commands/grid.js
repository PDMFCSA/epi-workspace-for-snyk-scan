const a21_0x486318=a21_0x4182;function a21_0x4182(_0x20494b,_0x4e69fa){const _0x110b3e=a21_0x110b();return a21_0x4182=function(_0x4182be,_0x5e29b5){_0x4182be=_0x4182be-0x13b;let _0x19b184=_0x110b3e[_0x4182be];return _0x19b184;},a21_0x4182(_0x20494b,_0x4e69fa);}(function(_0x3ebe84,_0x4997d7){const _0x460a8c=a21_0x4182,_0x2d9dbe=_0x3ebe84();while(!![]){try{const _0x1beeba=-parseInt(_0x460a8c(0x142))/0x1*(-parseInt(_0x460a8c(0x150))/0x2)+parseInt(_0x460a8c(0x188))/0x3+parseInt(_0x460a8c(0x15d))/0x4+parseInt(_0x460a8c(0x16a))/0x5*(-parseInt(_0x460a8c(0x163))/0x6)+-parseInt(_0x460a8c(0x18e))/0x7*(parseInt(_0x460a8c(0x174))/0x8)+parseInt(_0x460a8c(0x176))/0x9*(parseInt(_0x460a8c(0x18a))/0xa)+-parseInt(_0x460a8c(0x156))/0xb*(parseInt(_0x460a8c(0x17a))/0xc);if(_0x1beeba===_0x4997d7)break;else _0x2d9dbe['push'](_0x2d9dbe['shift']());}catch(_0x1706bd){_0x2d9dbe['push'](_0x2d9dbe['shift']());}}}(a21_0x110b,0x999f9));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x486318(0x16c)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x486318(0x140)),{logger}=require(a21_0x486318(0x14f)),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0x486318(0x148)),{sendInstrumentationEvent}=require(a21_0x486318(0x18b)),webSocketUtils=require(a21_0x486318(0x144)),{createK8sClient}=require(a21_0x486318(0x147)),{getCloudProviderObject}=require(a21_0x486318(0x154));exports[a21_0x486318(0x18c)]=a21_0x486318(0x16e),exports['desc']='Stop\x20a\x20running\x20Automation\x20grid.',exports[a21_0x486318(0x14b)]=function(_0x2b41f0){const _0x5b3468=a21_0x486318,_0x48306a={};_0x48306a[_0x5b3468(0x168)]=_0x5b3468(0x159),_0x48306a[_0x5b3468(0x193)]=_0x5b3468(0x14d),_0x48306a[_0x5b3468(0x157)]='Skip\x20insecure\x20cert\x20verification.',_0x48306a[_0x5b3468(0x16d)]=_0x5b3468(0x141),_0x48306a[_0x5b3468(0x179)]=_0x5b3468(0x187);const _0x34d5ec=_0x48306a,_0xdbac56={};_0xdbac56[_0x5b3468(0x17c)]=_0x34d5ec['obleC'],_0xdbac56['type']=_0x34d5ec[_0x5b3468(0x193)];const _0x43a3f2={};_0x43a3f2['description']=_0x34d5ec[_0x5b3468(0x157)],_0x43a3f2['type']=_0x34d5ec['fYJPg'],_0x43a3f2['default']=![];const _0x57461b={};return _0x57461b[_0x5b3468(0x167)]=_0xdbac56,_0x57461b[_0x5b3468(0x146)]=_0x43a3f2,_0x2b41f0['usage'](HELP_HEADER_MESSAGE['stop'])[_0x5b3468(0x15a)](HELP_FOOTER_MESSAGE)[_0x5b3468(0x177)](_0x57461b)['help'](_0x34d5ec[_0x5b3468(0x179)])['argv'];},exports[a21_0x486318(0x184)]=async function(_0x59decf){const _0x375937=a21_0x486318,_0x4c36bb={'nxPqG':_0x375937(0x152),'RyyCe':function(_0x682a9b){return _0x682a9b();},'VDYKc':'Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','YBbEC':function(_0x566095,_0x513500,_0x4d1633,_0x4538e5,_0x1e2a9f,_0x402032,_0x3bf579){return _0x566095(_0x513500,_0x4d1633,_0x4538e5,_0x1e2a9f,_0x402032,_0x3bf579);},'ILdDS':'stop-grid-called','WIBZI':_0x375937(0x17b),'MocnL':_0x375937(0x18f),'znRTn':_0x375937(0x182),'sngyN':_0x375937(0x153),'qYpub':function(_0x10b01e,_0x4ddfbc,_0x2727f8,_0x7027c0){return _0x10b01e(_0x4ddfbc,_0x2727f8,_0x7027c0);},'VHpHC':function(_0x54e17a,_0x508a27,_0x407680,_0x407bf2,_0xfad37e,_0x5cef1f,_0x14f0ac){return _0x54e17a(_0x508a27,_0x407680,_0x407bf2,_0xfad37e,_0x5cef1f,_0x14f0ac);},'gzxCZ':function(_0x52211e,_0x3f1272,_0x12c96c){return _0x52211e(_0x3f1272,_0x12c96c);},'OiLEF':_0x375937(0x194),'yOHxX':function(_0x52682d,_0x2e8b81){return _0x52682d===_0x2e8b81;},'nqyNo':_0x375937(0x166),'FgDeI':function(_0x5a849c,_0x1a6542,_0x4b3c3e,_0x47fc29,_0x4e8793,_0x38eb4e,_0x3f26cd){return _0x5a849c(_0x1a6542,_0x4b3c3e,_0x47fc29,_0x4e8793,_0x38eb4e,_0x3f26cd);},'ivOBm':_0x375937(0x198),'KmuNX':function(_0x130ec1,_0x3c8dfb){return _0x130ec1===_0x3c8dfb;},'NcqJR':function(_0x49b697,_0x5ede8e,_0x3d9fd3,_0x3abb3e,_0x18900b,_0x53bf2e,_0x331ab4){return _0x49b697(_0x5ede8e,_0x3d9fd3,_0x3abb3e,_0x18900b,_0x53bf2e,_0x331ab4);},'hPMFz':'invalid-grid-id','fNSAR':_0x375937(0x189)};let _0x28b2fc;try{!_0x59decf[_0x375937(0x14e)]&&(logger['error'](_0x4c36bb[_0x375937(0x149)]),process['exit'](0x1));!fs[_0x375937(0x18d)](_0x4c36bb[_0x375937(0x16b)](getCredentialsPath))&&(logger['error'](_0x4c36bb['VDYKc']),await _0x4c36bb['YBbEC'](sendInstrumentationEvent,_0x59decf,_0x4c36bb[_0x375937(0x170)],messageTypes['ERROR'],_0x4c36bb[_0x375937(0x143)],null,_0x59decf),process[_0x375937(0x180)](0x1));logger[_0x375937(0x13e)](_0x375937(0x185)+_0x59decf[_0x375937(0x14e)]),await _0x4c36bb[_0x375937(0x178)](sendInstrumentationEvent,_0x59decf,_0x4c36bb[_0x375937(0x170)],messageTypes[_0x375937(0x14c)],null,null,_0x59decf);const _0x218c91=JSON[_0x375937(0x14a)](fs['readFileSync'](_0x4c36bb[_0x375937(0x16b)](getCredentialsPath)));global_registry[_0x375937(0x190)]=_0x218c91[_0x375937(0x155)][_0x375937(0x192)],global_registry[_0x375937(0x175)]=_0x218c91[_0x375937(0x155)][_0x375937(0x162)];const _0x5c6645=WS_ENDPOINT['replace'](_0x4c36bb[_0x375937(0x181)],_0x218c91[_0x375937(0x155)]['username'])[_0x375937(0x17e)](_0x4c36bb[_0x375937(0x15e)],_0x218c91[_0x375937(0x155)][_0x375937(0x162)]),_0x5cf30f={};_0x5cf30f['WebSocket']=ws,_0x5cf30f[_0x375937(0x196)]=0x36ee80,_0x28b2fc=new ReconnectingWebSocket(_0x5c6645,[],_0x5cf30f),logger[_0x375937(0x16f)](_0x4c36bb[_0x375937(0x173)]),webSocketUtils[_0x375937(0x169)](_0x28b2fc,_0x59decf[_0x375937(0x199)],_0x59decf['password']);const [_0x1fded9,_0x13d773]=await _0x4c36bb[_0x375937(0x13c)](getGridDetails,_0x218c91[_0x375937(0x155)][_0x375937(0x192)],_0x218c91[_0x375937(0x155)][_0x375937(0x162)],_0x59decf[_0x375937(0x14e)]);if(_0x13d773){const _0x563c34=_0x13d773[_0x375937(0x13e)];global_registry[_0x375937(0x15c)]=_0x563c34[_0x375937(0x15c)],global_registry['clusterRegion']=_0x563c34[_0x375937(0x151)],global_registry[_0x375937(0x197)]=_0x563c34[_0x375937(0x197)];const _0x74e363=await _0x4c36bb[_0x375937(0x15b)](getCloudProviderObject,_0x563c34[_0x375937(0x15c)],_0x563c34[_0x375937(0x197)],_0x563c34[_0x375937(0x191)],_0x28b2fc,webSocketUtils,_0x59decf),[_0x143b92,_0x2c7c5e,_0xd9aa32,_0x2b1038,_0x105720,_0x2cef98]=await _0x4c36bb[_0x375937(0x172)](createK8sClient,_0x74e363,_0x59decf[_0x375937(0x17d)]);await _0x4c36bb[_0x375937(0x172)](scaleDownHubDeployment,_0x2c7c5e,_0x563c34['name']),logger['info'](_0x4c36bb['OiLEF']),process['exit'](0x0);}_0x4c36bb[_0x375937(0x171)](_0x1fded9[_0x375937(0x158)],0x191)&&(logger[_0x375937(0x165)](_0x4c36bb[_0x375937(0x13b)]),await _0x4c36bb['FgDeI'](sendInstrumentationEvent,_0x59decf,_0x4c36bb[_0x375937(0x170)],messageTypes[_0x375937(0x13d)],_0x4c36bb[_0x375937(0x13f)],null,_0x59decf),process[_0x375937(0x180)](0x1)),_0x4c36bb[_0x375937(0x164)](_0x1fded9['statusCode'],0x190)&&(logger[_0x375937(0x165)](JSON[_0x375937(0x14a)](_0x1fded9[_0x375937(0x186)])[_0x375937(0x161)]),await _0x4c36bb[_0x375937(0x183)](sendInstrumentationEvent,_0x59decf,_0x4c36bb[_0x375937(0x170)],messageTypes[_0x375937(0x13d)],_0x4c36bb[_0x375937(0x195)],null,_0x59decf),process['exit'](0x1)),logger['error'](_0x375937(0x160)+JSON[_0x375937(0x17f)](_0x1fded9)),await _0x4c36bb[_0x375937(0x183)](sendInstrumentationEvent,_0x59decf,_0x4c36bb[_0x375937(0x170)],messageTypes['ERROR'],_0x4c36bb['fNSAR'],_0x1fded9,_0x59decf),process[_0x375937(0x180)](0x1);}catch(_0x48643f){const _0x8cd3b2=_0x375937(0x15f)+_0x48643f+'\x20\x0a'+JSON[_0x375937(0x17f)](_0x48643f[_0x375937(0x145)])+'\x20';logger[_0x375937(0x165)](_0x8cd3b2),process[_0x375937(0x180)](0x1);}};function a21_0x110b(){const _0x11a7fd=['xspac','Grid\x20stoppped.','hPMFz','connectionTimeout','clusterName','unauthorised','user','nqyNo','qYpub','ERROR','info','ivOBm','../../config/constants','boolean','18002PLnlUp','WIBZI','../../utils/webSocketUtils','stack','skip-tls-cert-verify','../../utils/createk8sClient','../../utils/gridComponents','nxPqG','parse','builder','INFO','string','gridId','../../config/logger','122IzTgUf','region','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','Adding\x20Websocket\x20listeners','../../cloudproviders/utils','Browserstack','31451981UBSYku','bVZTW','statusCode','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','epilogue','VHpHC','cloudProvider','4830840mBTjRv','znRTn','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','message','password','12DWifxU','KmuNX','error','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','grid-id','obleC','addListeners','29310mvBUkL','RyyCe','reconnecting-websocket','fYJPg','grid','debug','ILdDS','yOHxX','gzxCZ','sngyN','72328VAgVoD','bstackAccesskey','9WNhTlU','options','YBbEC','ZgqFS','12YxnWrb','init-not-called','description','skipTlsCertVerify','replace','stringify','exit','MocnL','<PasswordPlaceholder>','NcqJR','handler','Stopping\x20grid\x20','body','help','3447858KipWcv','server-error','7593570ECvymr','../../utils/instrumentationUtils','command','existsSync','553vNUUer','<UsernamePlaceholder>','bstackUsername','name','username'];a21_0x110b=function(){return _0x11a7fd;};return a21_0x110b();}