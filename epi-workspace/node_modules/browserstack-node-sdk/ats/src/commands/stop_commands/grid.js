const a21_0x3394fd=a21_0x94dd;function a21_0x94dd(_0xee7f6e,_0x1f4a76){const _0x20de2d=a21_0x20de();return a21_0x94dd=function(_0x94dd0f,_0x411688){_0x94dd0f=_0x94dd0f-0x14f;let _0xa35a83=_0x20de2d[_0x94dd0f];return _0xa35a83;},a21_0x94dd(_0xee7f6e,_0x1f4a76);}(function(_0x71041f,_0x18cc17){const _0x254b6f=a21_0x94dd,_0x1aa120=_0x71041f();while(!![]){try{const _0x10b620=-parseInt(_0x254b6f(0x17e))/0x1*(parseInt(_0x254b6f(0x191))/0x2)+-parseInt(_0x254b6f(0x1ab))/0x3+-parseInt(_0x254b6f(0x172))/0x4+parseInt(_0x254b6f(0x1ad))/0x5+-parseInt(_0x254b6f(0x185))/0x6*(parseInt(_0x254b6f(0x1ac))/0x7)+parseInt(_0x254b6f(0x169))/0x8+-parseInt(_0x254b6f(0x168))/0x9*(-parseInt(_0x254b6f(0x14f))/0xa);if(_0x10b620===_0x18cc17)break;else _0x1aa120['push'](_0x1aa120['shift']());}catch(_0x425792){_0x1aa120['push'](_0x1aa120['shift']());}}}(a21_0x20de,0x27830));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x3394fd(0x165)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x3394fd(0x186)),{logger}=require(a21_0x3394fd(0x163)),{getCredentialsPath,getGridDetails}=require(a21_0x3394fd(0x17c)),{scaleDownHubDeployment}=require(a21_0x3394fd(0x19c)),{sendInstrumentationEvent}=require(a21_0x3394fd(0x177)),webSocketUtils=require(a21_0x3394fd(0x170)),{createK8sClient}=require('../../utils/createk8sClient'),{getCloudProviderObject}=require('../../cloudproviders/utils');function a21_0x20de(){const _0x4769e6=['ERROR','name','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','XUcmO','nmgOh','user','KpTDx','908268ZRwwDu','35tEBTZf','581430kYpiqQ','LPMHZ','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','password','30xXAjcb','MGHgN','message','vuODu','usage','fnYHy','Adding\x20Websocket\x20listeners','handler','skip-tls-cert-verify','default','string','invalid-grid-id','stop','Stopping\x20grid\x20','cloudProvider','Qdjna','WebSocket','bstackAccesskey','parse','uEhvG','../../config/logger','kZLjn','reconnecting-websocket','INFO','Browserstack','2013471uOsFDO','1479024aJQkYa','FZkEM','command','addListeners','RpLlD','boolean','region','../../utils/webSocketUtils','skipTlsCertVerify','821732bCZPip','Grid\x20stoppped.','<PasswordPlaceholder>','readFileSync','type','../../utils/instrumentationUtils','desc','WNCQn','stack','username','../../utils/utilityMethods','stringify','509yvDntr','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','MwPAd','argv','sJTWj','error','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','134922rZmEVH','../../config/constants','aaEYi','statusCode','exit','CbOmv','connectionTimeout','unauthorised','LRmst','info','grid','body','746rdVaRZ','Stop\x20a\x20running\x20Automation\x20grid.','JyytA','fZSit','replace','epilogue','QOLKh','options','builder','stop-grid-called','description','../../utils/gridComponents','server-error','TaIAW','gridId','kWpYu','rovvo','existsSync','clusterName'];a21_0x20de=function(){return _0x4769e6;};return a21_0x20de();}exports[a21_0x3394fd(0x16b)]=a21_0x3394fd(0x18f),exports[a21_0x3394fd(0x178)]=a21_0x3394fd(0x192),exports[a21_0x3394fd(0x199)]=function(_0x21dcde){const _0x3ea6ba=a21_0x3394fd,_0x4fdca3={};_0x4fdca3[_0x3ea6ba(0x16d)]=_0x3ea6ba(0x1a6),_0x4fdca3[_0x3ea6ba(0x18a)]=_0x3ea6ba(0x159),_0x4fdca3[_0x3ea6ba(0x193)]='Skip\x20insecure\x20cert\x20verification.',_0x4fdca3[_0x3ea6ba(0x152)]=_0x3ea6ba(0x16e),_0x4fdca3[_0x3ea6ba(0x180)]='help';const _0x42286c=_0x4fdca3,_0x2c5f48={};_0x2c5f48[_0x3ea6ba(0x19b)]=_0x42286c[_0x3ea6ba(0x16d)],_0x2c5f48[_0x3ea6ba(0x176)]=_0x42286c[_0x3ea6ba(0x18a)];const _0x2bb1d7={};_0x2bb1d7[_0x3ea6ba(0x19b)]=_0x42286c[_0x3ea6ba(0x193)],_0x2bb1d7[_0x3ea6ba(0x176)]=_0x42286c[_0x3ea6ba(0x152)],_0x2bb1d7[_0x3ea6ba(0x158)]=![];const _0x47a6f4={};return _0x47a6f4['grid-id']=_0x2c5f48,_0x47a6f4[_0x3ea6ba(0x157)]=_0x2bb1d7,_0x21dcde[_0x3ea6ba(0x153)](HELP_HEADER_MESSAGE[_0x3ea6ba(0x15b)])[_0x3ea6ba(0x196)](HELP_FOOTER_MESSAGE)[_0x3ea6ba(0x198)](_0x47a6f4)['help'](_0x42286c['MwPAd'])[_0x3ea6ba(0x181)];},exports[a21_0x3394fd(0x156)]=async function(_0x525de7){const _0x62a187=a21_0x3394fd,_0xf04999={'XUcmO':_0x62a187(0x1af),'nmgOh':function(_0x56776f){return _0x56776f();},'LRmst':_0x62a187(0x184),'kWpYu':function(_0x433949,_0x13102d,_0x5d31bc,_0x25c488,_0x2943d4,_0x7ce6d1,_0x16766e){return _0x433949(_0x13102d,_0x5d31bc,_0x25c488,_0x2943d4,_0x7ce6d1,_0x16766e);},'MGHgN':_0x62a187(0x19a),'sJTWj':'init-not-called','MagPv':function(_0x35a30b){return _0x35a30b();},'QOLKh':'<UsernamePlaceholder>','aaEYi':_0x62a187(0x174),'TaIAW':_0x62a187(0x155),'mMRwJ':function(_0x5d3b4a,_0x78185d,_0x4e34bf,_0x4b7345){return _0x5d3b4a(_0x78185d,_0x4e34bf,_0x4b7345);},'LPMHZ':function(_0x4e1c69,_0x327866,_0xf1efe2,_0x4bdd34,_0x37cd53,_0x51d401,_0xb497f7){return _0x4e1c69(_0x327866,_0xf1efe2,_0x4bdd34,_0x37cd53,_0x51d401,_0xb497f7);},'Qdjna':function(_0x1329c6,_0x147e07,_0x284a6d){return _0x1329c6(_0x147e07,_0x284a6d);},'fZSit':function(_0xbb104a,_0x36f09e,_0x42cc74){return _0xbb104a(_0x36f09e,_0x42cc74);},'kZLjn':_0x62a187(0x173),'rovvo':function(_0x36fa8b,_0xdd0e50){return _0x36fa8b===_0xdd0e50;},'fnYHy':'Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','WNCQn':_0x62a187(0x18c),'FZkEM':function(_0x4b6893,_0x59053c){return _0x4b6893===_0x59053c;},'KpTDx':_0x62a187(0x15a),'ymQRa':function(_0x2dd08c,_0x4c6e26,_0x1ed25b,_0x3f7600,_0x2d8d86,_0x3f86de,_0x32b4ad){return _0x2dd08c(_0x4c6e26,_0x1ed25b,_0x3f7600,_0x2d8d86,_0x3f86de,_0x32b4ad);},'uEhvG':_0x62a187(0x19d)};let _0x2f2869;try{!_0x525de7[_0x62a187(0x19f)]&&(logger[_0x62a187(0x183)](_0xf04999[_0x62a187(0x1a7)]),process[_0x62a187(0x189)](0x1));!fs[_0x62a187(0x1a2)](_0xf04999[_0x62a187(0x1a8)](getCredentialsPath))&&(logger[_0x62a187(0x183)](_0xf04999[_0x62a187(0x18d)]),await _0xf04999[_0x62a187(0x1a0)](sendInstrumentationEvent,_0x525de7,_0xf04999['MGHgN'],messageTypes['ERROR'],_0xf04999[_0x62a187(0x182)],null,_0x525de7),process[_0x62a187(0x189)](0x1));logger[_0x62a187(0x18e)](_0x62a187(0x15c)+_0x525de7[_0x62a187(0x19f)]),await _0xf04999[_0x62a187(0x1a0)](sendInstrumentationEvent,_0x525de7,_0xf04999[_0x62a187(0x150)],messageTypes[_0x62a187(0x166)],null,null,_0x525de7);const _0x1ca2ae=JSON[_0x62a187(0x161)](fs[_0x62a187(0x175)](_0xf04999['MagPv'](getCredentialsPath)));global_registry['bstackUsername']=_0x1ca2ae[_0x62a187(0x167)]['username'],global_registry[_0x62a187(0x160)]=_0x1ca2ae[_0x62a187(0x167)][_0x62a187(0x1b1)];const _0x336893=WS_ENDPOINT[_0x62a187(0x195)](_0xf04999[_0x62a187(0x197)],_0x1ca2ae['Browserstack'][_0x62a187(0x17b)])[_0x62a187(0x195)](_0xf04999[_0x62a187(0x187)],_0x1ca2ae['Browserstack'][_0x62a187(0x1b1)]),_0xcda159={};_0xcda159[_0x62a187(0x15f)]=ws,_0xcda159[_0x62a187(0x18b)]=0x36ee80,_0x2f2869=new ReconnectingWebSocket(_0x336893,[],_0xcda159),logger['debug'](_0xf04999[_0x62a187(0x19e)]),webSocketUtils[_0x62a187(0x16c)](_0x2f2869,_0x525de7[_0x62a187(0x1a9)],_0x525de7['password']);const [_0x1ad600,_0x30339f]=await _0xf04999['mMRwJ'](getGridDetails,_0x1ca2ae[_0x62a187(0x167)][_0x62a187(0x17b)],_0x1ca2ae[_0x62a187(0x167)][_0x62a187(0x1b1)],_0x525de7['gridId']);if(_0x30339f){const _0x5cc81b=_0x30339f['info'];global_registry[_0x62a187(0x15d)]=_0x5cc81b['cloudProvider'],global_registry['clusterRegion']=_0x5cc81b[_0x62a187(0x16f)],global_registry[_0x62a187(0x1a3)]=_0x5cc81b[_0x62a187(0x1a3)];const _0x3f2d73=await _0xf04999[_0x62a187(0x1ae)](getCloudProviderObject,_0x5cc81b['cloudProvider'],_0x5cc81b[_0x62a187(0x1a3)],_0x5cc81b[_0x62a187(0x1a5)],_0x2f2869,webSocketUtils,_0x525de7),[_0x5b99a7,_0x6888ca,_0xaca439,_0x36dc38,_0x2e6133,_0x2dea12]=await _0xf04999[_0x62a187(0x15e)](createK8sClient,_0x3f2d73,_0x525de7[_0x62a187(0x171)]);await _0xf04999[_0x62a187(0x194)](scaleDownHubDeployment,_0x6888ca,_0x5cc81b[_0x62a187(0x1a5)]),logger[_0x62a187(0x18e)](_0xf04999[_0x62a187(0x164)]),process[_0x62a187(0x189)](0x0);}_0xf04999[_0x62a187(0x1a1)](_0x1ad600[_0x62a187(0x188)],0x191)&&(logger['error'](_0xf04999[_0x62a187(0x154)]),await _0xf04999[_0x62a187(0x1ae)](sendInstrumentationEvent,_0x525de7,_0xf04999[_0x62a187(0x150)],messageTypes['ERROR'],_0xf04999[_0x62a187(0x179)],null,_0x525de7),process['exit'](0x1)),_0xf04999[_0x62a187(0x16a)](_0x1ad600[_0x62a187(0x188)],0x190)&&(logger[_0x62a187(0x183)](JSON[_0x62a187(0x161)](_0x1ad600[_0x62a187(0x190)])[_0x62a187(0x151)]),await _0xf04999[_0x62a187(0x1ae)](sendInstrumentationEvent,_0x525de7,_0xf04999[_0x62a187(0x150)],messageTypes[_0x62a187(0x1a4)],_0xf04999[_0x62a187(0x1aa)],null,_0x525de7),process['exit'](0x1)),logger[_0x62a187(0x183)](_0x62a187(0x17f)+JSON[_0x62a187(0x17d)](_0x1ad600)),await _0xf04999['ymQRa'](sendInstrumentationEvent,_0x525de7,_0xf04999[_0x62a187(0x150)],messageTypes[_0x62a187(0x1a4)],_0xf04999[_0x62a187(0x162)],_0x1ad600,_0x525de7),process[_0x62a187(0x189)](0x1);}catch(_0x1dacd3){const _0x4bdaea=_0x62a187(0x1b0)+_0x1dacd3+'\x20\x0a'+JSON[_0x62a187(0x17d)](_0x1dacd3[_0x62a187(0x17a)])+'\x20';logger[_0x62a187(0x183)](_0x4bdaea),process['exit'](0x1);}};