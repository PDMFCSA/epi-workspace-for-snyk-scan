const a21_0x578ebe=a21_0x5c3c;(function(_0x317886,_0x16598f){const _0x4b6aa4=a21_0x5c3c,_0x1bb00f=_0x317886();while(!![]){try{const _0x169dba=parseInt(_0x4b6aa4(0x14c))/0x1*(parseInt(_0x4b6aa4(0x174))/0x2)+-parseInt(_0x4b6aa4(0x188))/0x3+parseInt(_0x4b6aa4(0x140))/0x4*(parseInt(_0x4b6aa4(0x171))/0x5)+parseInt(_0x4b6aa4(0x145))/0x6+-parseInt(_0x4b6aa4(0x150))/0x7*(parseInt(_0x4b6aa4(0x134))/0x8)+parseInt(_0x4b6aa4(0x14f))/0x9*(-parseInt(_0x4b6aa4(0x175))/0xa)+parseInt(_0x4b6aa4(0x13a))/0xb*(-parseInt(_0x4b6aa4(0x17d))/0xc);if(_0x169dba===_0x16598f)break;else _0x1bb00f['push'](_0x1bb00f['shift']());}catch(_0x543c79){_0x1bb00f['push'](_0x1bb00f['shift']());}}}(a21_0x109d,0xa1219));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x578ebe(0x16f)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x578ebe(0x18f)),{logger}=require(a21_0x578ebe(0x15f)),{getCredentialsPath,getGridDetails}=require(a21_0x578ebe(0x183)),{scaleDownHubDeployment}=require(a21_0x578ebe(0x181)),{sendInstrumentationEvent}=require('../../utils/instrumentationUtils'),webSocketUtils=require(a21_0x578ebe(0x170)),{createK8sClient}=require(a21_0x578ebe(0x142)),{getCloudProviderObject}=require('../../cloudproviders/utils');function a21_0x5c3c(_0x2c07fa,_0x13e5bb){const _0x109d0c=a21_0x109d();return a21_0x5c3c=function(_0x5c3c99,_0x809516){_0x5c3c99=_0x5c3c99-0x130;let _0x23de68=_0x109d0c[_0x5c3c99];return _0x23de68;},a21_0x5c3c(_0x2c07fa,_0x13e5bb);}exports[a21_0x578ebe(0x133)]='grid',exports['desc']=a21_0x578ebe(0x169),exports[a21_0x578ebe(0x18a)]=function(_0x1f8b7d){const _0x4c744e=a21_0x578ebe,_0x1ea7a9={};_0x1ea7a9[_0x4c744e(0x151)]=_0x4c744e(0x15e),_0x1ea7a9['uzUUI']=_0x4c744e(0x14d),_0x1ea7a9[_0x4c744e(0x137)]=_0x4c744e(0x154),_0x1ea7a9['WpWcc']='boolean',_0x1ea7a9[_0x4c744e(0x13b)]='help';const _0x47d4e7=_0x1ea7a9,_0x5cdbc1={};_0x5cdbc1[_0x4c744e(0x17a)]=_0x47d4e7['BmyYE'],_0x5cdbc1[_0x4c744e(0x187)]=_0x47d4e7[_0x4c744e(0x13e)];const _0x24dcaf={};_0x24dcaf['description']=_0x47d4e7[_0x4c744e(0x137)],_0x24dcaf[_0x4c744e(0x187)]=_0x47d4e7[_0x4c744e(0x15a)],_0x24dcaf[_0x4c744e(0x143)]=![];const _0x596e16={};return _0x596e16[_0x4c744e(0x172)]=_0x5cdbc1,_0x596e16[_0x4c744e(0x17e)]=_0x24dcaf,_0x1f8b7d[_0x4c744e(0x16c)](HELP_HEADER_MESSAGE[_0x4c744e(0x17b)])[_0x4c744e(0x136)](HELP_FOOTER_MESSAGE)[_0x4c744e(0x167)](_0x596e16)[_0x4c744e(0x14e)](_0x47d4e7['WJbXi'])[_0x4c744e(0x190)];},exports[a21_0x578ebe(0x179)]=async function(_0x5db5d4){const _0x4e61e7=a21_0x578ebe,_0x1fd3da={'iAtOd':_0x4e61e7(0x18e),'nGWYJ':function(_0x551328){return _0x551328();},'QmJic':'Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','qjpnR':function(_0x229c20,_0x48a4de,_0x4799f1,_0x573d3f,_0x12a7d4,_0x15c021,_0x5495fd){return _0x229c20(_0x48a4de,_0x4799f1,_0x573d3f,_0x12a7d4,_0x15c021,_0x5495fd);},'MjdrF':'stop-grid-called','sgJhA':_0x4e61e7(0x163),'mKgvh':function(_0xe4b243,_0x68da65,_0x3003be,_0x22771e,_0x409014,_0x468733,_0x456c55){return _0xe4b243(_0x68da65,_0x3003be,_0x22771e,_0x409014,_0x468733,_0x456c55);},'nXZvo':function(_0x42e1c1){return _0x42e1c1();},'EnYKc':_0x4e61e7(0x182),'uIAvf':_0x4e61e7(0x147),'VpJJZ':_0x4e61e7(0x13f),'FmBFU':function(_0x25f6df,_0x2136fa,_0x2fcfe0,_0x320441){return _0x25f6df(_0x2136fa,_0x2fcfe0,_0x320441);},'CimVV':function(_0x119457,_0xb7dbdc,_0x4e31a9,_0x5e8d12,_0x18b0b8,_0x340170,_0x303d7f){return _0x119457(_0xb7dbdc,_0x4e31a9,_0x5e8d12,_0x18b0b8,_0x340170,_0x303d7f);},'UhmYW':function(_0x52333b,_0x7810ba,_0x3f1292){return _0x52333b(_0x7810ba,_0x3f1292);},'SicxM':function(_0x11924d,_0x4dab52,_0x2ef928){return _0x11924d(_0x4dab52,_0x2ef928);},'NMrbQ':_0x4e61e7(0x160),'gRDih':function(_0x29261f,_0x233804){return _0x29261f===_0x233804;},'JevOS':_0x4e61e7(0x164),'uGCUz':_0x4e61e7(0x15b),'DpGlf':function(_0x3b5b46,_0x1a886a){return _0x3b5b46===_0x1a886a;},'wSNfr':_0x4e61e7(0x16a),'GiOaa':function(_0x8fe3f8,_0x59c5ae,_0xb0364,_0x219646,_0x3c1d84,_0x3ec2ae,_0x41e062){return _0x8fe3f8(_0x59c5ae,_0xb0364,_0x219646,_0x3c1d84,_0x3ec2ae,_0x41e062);},'RoLxp':'server-error'};let _0x2dd6d2;try{!_0x5db5d4[_0x4e61e7(0x155)]&&(logger['error'](_0x1fd3da['iAtOd']),process[_0x4e61e7(0x132)](0x1));!fs['existsSync'](_0x1fd3da[_0x4e61e7(0x166)](getCredentialsPath))&&(logger[_0x4e61e7(0x185)](_0x1fd3da['QmJic']),await _0x1fd3da[_0x4e61e7(0x159)](sendInstrumentationEvent,_0x5db5d4,_0x1fd3da[_0x4e61e7(0x16e)],messageTypes[_0x4e61e7(0x17c)],_0x1fd3da['sgJhA'],null,_0x5db5d4),process['exit'](0x1));logger[_0x4e61e7(0x153)](_0x4e61e7(0x16b)+_0x5db5d4[_0x4e61e7(0x155)]),await _0x1fd3da[_0x4e61e7(0x138)](sendInstrumentationEvent,_0x5db5d4,_0x1fd3da['MjdrF'],messageTypes[_0x4e61e7(0x152)],null,null,_0x5db5d4);const _0x2ef1db=JSON[_0x4e61e7(0x18d)](fs['readFileSync'](_0x1fd3da[_0x4e61e7(0x18c)](getCredentialsPath)));global_registry['bstackUsername']=_0x2ef1db['Browserstack'][_0x4e61e7(0x178)],global_registry[_0x4e61e7(0x146)]=_0x2ef1db['Browserstack']['password'];const _0x335524=WS_ENDPOINT[_0x4e61e7(0x13d)](_0x1fd3da[_0x4e61e7(0x135)],_0x2ef1db['Browserstack'][_0x4e61e7(0x178)])[_0x4e61e7(0x13d)](_0x1fd3da[_0x4e61e7(0x149)],_0x2ef1db[_0x4e61e7(0x161)][_0x4e61e7(0x131)]),_0x524d22={};_0x524d22[_0x4e61e7(0x15d)]=ws,_0x524d22[_0x4e61e7(0x176)]=0x36ee80,_0x2dd6d2=new ReconnectingWebSocket(_0x335524,[],_0x524d22),logger[_0x4e61e7(0x14b)](_0x1fd3da['VpJJZ']),webSocketUtils[_0x4e61e7(0x184)](_0x2dd6d2,_0x5db5d4[_0x4e61e7(0x130)],_0x5db5d4[_0x4e61e7(0x131)]);const [_0xf06dd5,_0xf02dc2]=await _0x1fd3da['FmBFU'](getGridDetails,_0x2ef1db[_0x4e61e7(0x161)][_0x4e61e7(0x178)],_0x2ef1db[_0x4e61e7(0x161)]['password'],_0x5db5d4[_0x4e61e7(0x155)]);if(_0xf02dc2){const _0x1aa5bd=_0xf02dc2[_0x4e61e7(0x153)];global_registry['cloudProvider']=_0x1aa5bd[_0x4e61e7(0x158)],global_registry[_0x4e61e7(0x180)]=_0x1aa5bd['region'],global_registry['clusterName']=_0x1aa5bd['clusterName'];const _0x4e1688=await _0x1fd3da['CimVV'](getCloudProviderObject,_0x1aa5bd[_0x4e61e7(0x158)],_0x1aa5bd[_0x4e61e7(0x17f)],_0x1aa5bd[_0x4e61e7(0x156)],_0x2dd6d2,webSocketUtils,_0x5db5d4),[_0x1e283e,_0x125101,_0xdbaf1d,_0x5ae0f6,_0x1300f7,_0x2a574c]=await _0x1fd3da[_0x4e61e7(0x16d)](createK8sClient,_0x4e1688,_0x5db5d4[_0x4e61e7(0x165)]);await _0x1fd3da[_0x4e61e7(0x141)](scaleDownHubDeployment,_0x125101,_0x1aa5bd['name']),logger[_0x4e61e7(0x153)](_0x1fd3da[_0x4e61e7(0x189)]),process['exit'](0x0);}_0x1fd3da[_0x4e61e7(0x18b)](_0xf06dd5[_0x4e61e7(0x186)],0x191)&&(logger[_0x4e61e7(0x185)](_0x1fd3da[_0x4e61e7(0x173)]),await _0x1fd3da[_0x4e61e7(0x162)](sendInstrumentationEvent,_0x5db5d4,_0x1fd3da['MjdrF'],messageTypes[_0x4e61e7(0x17c)],_0x1fd3da[_0x4e61e7(0x14a)],null,_0x5db5d4),process[_0x4e61e7(0x132)](0x1)),_0x1fd3da[_0x4e61e7(0x13c)](_0xf06dd5['statusCode'],0x190)&&(logger['error'](JSON['parse'](_0xf06dd5['body'])[_0x4e61e7(0x144)]),await _0x1fd3da[_0x4e61e7(0x138)](sendInstrumentationEvent,_0x5db5d4,_0x1fd3da['MjdrF'],messageTypes['ERROR'],_0x1fd3da[_0x4e61e7(0x157)],null,_0x5db5d4),process['exit'](0x1)),logger[_0x4e61e7(0x185)](_0x4e61e7(0x15c)+JSON[_0x4e61e7(0x139)](_0xf06dd5)),await _0x1fd3da[_0x4e61e7(0x148)](sendInstrumentationEvent,_0x5db5d4,_0x1fd3da[_0x4e61e7(0x16e)],messageTypes[_0x4e61e7(0x17c)],_0x1fd3da['RoLxp'],_0xf06dd5,_0x5db5d4),process[_0x4e61e7(0x132)](0x1);}catch(_0xdf5194){const _0x5a8368=_0x4e61e7(0x177)+_0xdf5194+'\x20\x0a'+JSON[_0x4e61e7(0x139)](_0xdf5194[_0x4e61e7(0x168)])+'\x20';logger[_0x4e61e7(0x185)](_0x5a8368),process[_0x4e61e7(0x132)](0x1);}};function a21_0x109d(){const _0x226cb7=['argv','user','password','exit','command','2497120cFrhAf','EnYKc','epilogue','NQmyB','mKgvh','stringify','11XehUhT','WJbXi','DpGlf','replace','uzUUI','Adding\x20Websocket\x20listeners','183860UPiZHq','SicxM','../../utils/createk8sClient','default','message','2499966pRcihR','bstackAccesskey','<PasswordPlaceholder>','GiOaa','uIAvf','uGCUz','debug','394EmlVKf','string','help','9dxxfBr','7EXjmqk','BmyYE','INFO','info','Skip\x20insecure\x20cert\x20verification.','gridId','name','wSNfr','cloudProvider','qjpnR','WpWcc','unauthorised','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','WebSocket','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','../../config/logger','Grid\x20stoppped.','Browserstack','CimVV','init-not-called','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','skipTlsCertVerify','nGWYJ','options','stack','Stop\x20a\x20running\x20Automation\x20grid.','invalid-grid-id','Stopping\x20grid\x20','usage','UhmYW','MjdrF','reconnecting-websocket','../../utils/webSocketUtils','35SfZSIK','grid-id','JevOS','4832WIMOpp','1223450yohFbu','connectionTimeout','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','username','handler','description','stop','ERROR','5085924OEhkad','skip-tls-cert-verify','clusterName','clusterRegion','../../utils/gridComponents','<UsernamePlaceholder>','../../utils/utilityMethods','addListeners','error','statusCode','type','516045UbQmTb','NMrbQ','builder','gRDih','nXZvo','parse','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','../../config/constants'];a21_0x109d=function(){return _0x226cb7;};return a21_0x109d();}