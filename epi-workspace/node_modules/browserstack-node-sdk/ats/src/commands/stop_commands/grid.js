const a21_0x567b11=a21_0xe546;(function(_0x658961,_0x3020b5){const _0x2fa11b=a21_0xe546,_0x13774e=_0x658961();while(!![]){try{const _0x397d1c=parseInt(_0x2fa11b(0x11c))/0x1+-parseInt(_0x2fa11b(0xf8))/0x2*(-parseInt(_0x2fa11b(0x132))/0x3)+-parseInt(_0x2fa11b(0x133))/0x4+-parseInt(_0x2fa11b(0x121))/0x5+-parseInt(_0x2fa11b(0x141))/0x6*(-parseInt(_0x2fa11b(0xf7))/0x7)+parseInt(_0x2fa11b(0x13c))/0x8+-parseInt(_0x2fa11b(0x149))/0x9*(-parseInt(_0x2fa11b(0x102))/0xa);if(_0x397d1c===_0x3020b5)break;else _0x13774e['push'](_0x13774e['shift']());}catch(_0x44b813){_0x13774e['push'](_0x13774e['shift']());}}}(a21_0x31cc,0x60877));function a21_0x31cc(){const _0x51ded4=['argv','../../config/logger','desc','3775080MZkduX','Browserstack','ERROR','HqEsS','password','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','username','parse','readFileSync','help','fJgHi','grid-id','user','boolean','type','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','rZrEr','405doHaSe','666160nHxowm','../../utils/webSocketUtils','vPszQ','AUBJv','Adding\x20Websocket\x20listeners','../../utils/instrumentationUtils','invalid-grid-id','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','SMxgz','669416KWDBuC','../../utils/gridComponents','Stop\x20a\x20running\x20Automation\x20grid.','<PasswordPlaceholder>','../../cloudproviders/utils','210rEursR','name','server-error','gridId','body','cVDGY','KedvX','skipTlsCertVerify','17379xLWtHM','hNRiy','INFO','stringify','jBGkQ','options','rpedd','info','140819FViYtx','1106kISLaf','unauthorised','debug','upNEj','error','VFgYN','cloudProvider','statusCode','stop','Stopping\x20grid\x20','590kMsRyc','bstackUsername','ZQfFv','TXErf','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','existsSync','exit','region','../../utils/createk8sClient','stop-grid-called','bstackAccesskey','BNxkK','<UsernamePlaceholder>','stack','Grid\x20stoppped.','description','clusterRegion','qpVEC','clusterName','message','../../config/constants','init-not-called','ufSqF','builder','../../utils/utilityMethods','340583UgvprP','fsJnq'];a21_0x31cc=function(){return _0x51ded4;};return a21_0x31cc();}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x567b11(0x117)),{logger}=require(a21_0x567b11(0x11f)),{getCredentialsPath,getGridDetails}=require(a21_0x567b11(0x11b)),{scaleDownHubDeployment}=require(a21_0x567b11(0x13d)),{sendInstrumentationEvent}=require(a21_0x567b11(0x138)),webSocketUtils=require(a21_0x567b11(0x134)),{createK8sClient}=require(a21_0x567b11(0x10b)),{getCloudProviderObject}=require(a21_0x567b11(0x140));function a21_0xe546(_0x34fe6c,_0x2993e3){const _0x31cc79=a21_0x31cc();return a21_0xe546=function(_0xe54640,_0x185b31){_0xe54640=_0xe54640-0xf6;let _0x559e13=_0x31cc79[_0xe54640];return _0x559e13;},a21_0xe546(_0x34fe6c,_0x2993e3);}exports['command']='grid',exports[a21_0x567b11(0x120)]=a21_0x567b11(0x13e),exports[a21_0x567b11(0x11a)]=function(_0x2a8bd1){const _0x5f19ef=a21_0x567b11,_0x57d676={};_0x57d676['TDvzk']=_0x5f19ef(0x106),_0x57d676[_0x5f19ef(0x13b)]='string',_0x57d676[_0x5f19ef(0x131)]='Skip\x20insecure\x20cert\x20verification.',_0x57d676[_0x5f19ef(0x14a)]=_0x5f19ef(0x12e),_0x57d676['cVDGY']=_0x5f19ef(0x12a);const _0x45f9a5=_0x57d676,_0x1c3fa1={};_0x1c3fa1[_0x5f19ef(0x112)]=_0x45f9a5['TDvzk'],_0x1c3fa1[_0x5f19ef(0x12f)]=_0x45f9a5[_0x5f19ef(0x13b)];const _0x2d1948={};_0x2d1948[_0x5f19ef(0x112)]=_0x45f9a5['rZrEr'],_0x2d1948[_0x5f19ef(0x12f)]=_0x45f9a5['hNRiy'],_0x2d1948['default']=![];const _0x565d88={};return _0x565d88[_0x5f19ef(0x12c)]=_0x1c3fa1,_0x565d88['skip-tls-cert-verify']=_0x2d1948,_0x2a8bd1['usage'](HELP_HEADER_MESSAGE[_0x5f19ef(0x100)])['epilogue'](HELP_FOOTER_MESSAGE)[_0x5f19ef(0x14e)](_0x565d88)[_0x5f19ef(0x12a)](_0x45f9a5[_0x5f19ef(0x146)])[_0x5f19ef(0x11e)];},exports['handler']=async function(_0x2f2445){const _0x81dce=a21_0x567b11,_0x129dd5={'dZfTt':_0x81dce(0x126),'ufSqF':function(_0x126e04){return _0x126e04();},'fsJnq':_0x81dce(0x13a),'vPszQ':function(_0x981095,_0x214e41,_0x2a0a16,_0x556a51,_0x4e56d9,_0x49a824,_0x327a4a){return _0x981095(_0x214e41,_0x2a0a16,_0x556a51,_0x4e56d9,_0x49a824,_0x327a4a);},'BNxkK':_0x81dce(0x10c),'AUBJv':_0x81dce(0x118),'gaCkX':function(_0x1d6cc7,_0x3daf12,_0x173307,_0x18e967,_0x7f3935,_0x2fda6f,_0x3221a9){return _0x1d6cc7(_0x3daf12,_0x173307,_0x18e967,_0x7f3935,_0x2fda6f,_0x3221a9);},'jBGkQ':_0x81dce(0x10f),'KedvX':_0x81dce(0x13f),'MSROn':_0x81dce(0x137),'yJKjW':function(_0x617ab8,_0x133ff7,_0x2a3851,_0x402972){return _0x617ab8(_0x133ff7,_0x2a3851,_0x402972);},'fJgHi':function(_0x2a5e38,_0x4c934f,_0x1e61cf){return _0x2a5e38(_0x4c934f,_0x1e61cf);},'kOwuQ':_0x81dce(0x111),'VFgYN':function(_0x541fc8,_0x413f54){return _0x541fc8===_0x413f54;},'TXErf':'Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','HqEsS':_0x81dce(0xf9),'ZQfFv':function(_0x2f0697,_0x4f969d,_0x1496a3,_0x442d75,_0x491792,_0x5c8e74,_0x2d32a6){return _0x2f0697(_0x4f969d,_0x1496a3,_0x442d75,_0x491792,_0x5c8e74,_0x2d32a6);},'qpVEC':_0x81dce(0x139),'upNEj':function(_0x46e46e,_0x1acc30,_0x2fe981,_0x13ea7e,_0x4e2992,_0x520c09,_0xddff5a){return _0x46e46e(_0x1acc30,_0x2fe981,_0x13ea7e,_0x4e2992,_0x520c09,_0xddff5a);},'rpedd':_0x81dce(0x143)};let _0x223c5a;try{!_0x2f2445[_0x81dce(0x144)]&&(logger[_0x81dce(0xfc)](_0x129dd5['dZfTt']),process['exit'](0x1));!fs[_0x81dce(0x108)](_0x129dd5['ufSqF'](getCredentialsPath))&&(logger[_0x81dce(0xfc)](_0x129dd5[_0x81dce(0x11d)]),await _0x129dd5[_0x81dce(0x135)](sendInstrumentationEvent,_0x2f2445,_0x129dd5[_0x81dce(0x10e)],messageTypes['ERROR'],_0x129dd5[_0x81dce(0x136)],null,_0x2f2445),process[_0x81dce(0x109)](0x1));logger[_0x81dce(0xf6)](_0x81dce(0x101)+_0x2f2445[_0x81dce(0x144)]),await _0x129dd5['gaCkX'](sendInstrumentationEvent,_0x2f2445,_0x129dd5[_0x81dce(0x10e)],messageTypes[_0x81dce(0x14b)],null,null,_0x2f2445);const _0x551c4d=JSON[_0x81dce(0x128)](fs[_0x81dce(0x129)](_0x129dd5[_0x81dce(0x119)](getCredentialsPath)));global_registry[_0x81dce(0x103)]=_0x551c4d[_0x81dce(0x122)][_0x81dce(0x127)],global_registry[_0x81dce(0x10d)]=_0x551c4d['Browserstack'][_0x81dce(0x125)];const _0x36498e=WS_ENDPOINT['replace'](_0x129dd5[_0x81dce(0x14d)],_0x551c4d['Browserstack'][_0x81dce(0x127)])['replace'](_0x129dd5[_0x81dce(0x147)],_0x551c4d[_0x81dce(0x122)][_0x81dce(0x125)]),_0x4e11be={};_0x4e11be['WebSocket']=ws,_0x4e11be['connectionTimeout']=0x36ee80,_0x223c5a=new ReconnectingWebSocket(_0x36498e,[],_0x4e11be),logger[_0x81dce(0xfa)](_0x129dd5['MSROn']),webSocketUtils['addListeners'](_0x223c5a,_0x2f2445[_0x81dce(0x12d)],_0x2f2445[_0x81dce(0x125)]);const [_0x197d1e,_0x2a8e52]=await _0x129dd5['yJKjW'](getGridDetails,_0x551c4d['Browserstack'][_0x81dce(0x127)],_0x551c4d[_0x81dce(0x122)][_0x81dce(0x125)],_0x2f2445[_0x81dce(0x144)]);if(_0x2a8e52){const _0x143838=_0x2a8e52[_0x81dce(0xf6)];global_registry[_0x81dce(0xfe)]=_0x143838[_0x81dce(0xfe)],global_registry[_0x81dce(0x113)]=_0x143838[_0x81dce(0x10a)],global_registry['clusterName']=_0x143838['clusterName'];const _0x2dffc0=await _0x129dd5[_0x81dce(0x135)](getCloudProviderObject,_0x143838[_0x81dce(0xfe)],_0x143838[_0x81dce(0x115)],_0x143838[_0x81dce(0x142)],_0x223c5a,webSocketUtils,_0x2f2445),[_0x53230e,_0x568ae9,_0x267976,_0x14c442,_0x140708,_0x1fe750]=await _0x129dd5[_0x81dce(0x12b)](createK8sClient,_0x2dffc0,_0x2f2445[_0x81dce(0x148)]);await _0x129dd5[_0x81dce(0x12b)](scaleDownHubDeployment,_0x568ae9,_0x143838[_0x81dce(0x142)]),logger[_0x81dce(0xf6)](_0x129dd5['kOwuQ']),process[_0x81dce(0x109)](0x0);}_0x129dd5[_0x81dce(0xfd)](_0x197d1e['statusCode'],0x191)&&(logger['error'](_0x129dd5[_0x81dce(0x105)]),await _0x129dd5[_0x81dce(0x135)](sendInstrumentationEvent,_0x2f2445,_0x129dd5['BNxkK'],messageTypes[_0x81dce(0x123)],_0x129dd5[_0x81dce(0x124)],null,_0x2f2445),process[_0x81dce(0x109)](0x1)),_0x129dd5[_0x81dce(0xfd)](_0x197d1e[_0x81dce(0xff)],0x190)&&(logger[_0x81dce(0xfc)](JSON['parse'](_0x197d1e[_0x81dce(0x145)])[_0x81dce(0x116)]),await _0x129dd5[_0x81dce(0x104)](sendInstrumentationEvent,_0x2f2445,_0x129dd5[_0x81dce(0x10e)],messageTypes[_0x81dce(0x123)],_0x129dd5[_0x81dce(0x114)],null,_0x2f2445),process[_0x81dce(0x109)](0x1)),logger[_0x81dce(0xfc)](_0x81dce(0x130)+JSON['stringify'](_0x197d1e)),await _0x129dd5[_0x81dce(0xfb)](sendInstrumentationEvent,_0x2f2445,_0x129dd5['BNxkK'],messageTypes[_0x81dce(0x123)],_0x129dd5[_0x81dce(0x14f)],_0x197d1e,_0x2f2445),process['exit'](0x1);}catch(_0x2dc5bc){const _0xd8e337=_0x81dce(0x107)+_0x2dc5bc+'\x20\x0a'+JSON[_0x81dce(0x14c)](_0x2dc5bc[_0x81dce(0x110)])+'\x20';logger[_0x81dce(0xfc)](_0xd8e337),process['exit'](0x1);}};