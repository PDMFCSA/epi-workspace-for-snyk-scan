const a21_0x1ae0b5=a21_0x31b6;(function(_0x2d5026,_0x2f1199){const _0x219858=a21_0x31b6,_0x3584f0=_0x2d5026();while(!![]){try{const _0x7f4aaf=-parseInt(_0x219858(0xb2))/0x1*(parseInt(_0x219858(0xb0))/0x2)+-parseInt(_0x219858(0x91))/0x3+-parseInt(_0x219858(0x95))/0x4*(parseInt(_0x219858(0x75))/0x5)+parseInt(_0x219858(0x96))/0x6*(-parseInt(_0x219858(0x88))/0x7)+-parseInt(_0x219858(0x97))/0x8+parseInt(_0x219858(0xa2))/0x9+-parseInt(_0x219858(0x84))/0xa*(-parseInt(_0x219858(0x9f))/0xb);if(_0x7f4aaf===_0x2f1199)break;else _0x3584f0['push'](_0x3584f0['shift']());}catch(_0x36b0e1){_0x3584f0['push'](_0x3584f0['shift']());}}}(a21_0x20b8,0x80490));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x1ae0b5(0x86)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x1ae0b5(0xac)),{logger}=require(a21_0x1ae0b5(0xc1)),{getCredentialsPath,getGridDetails}=require(a21_0x1ae0b5(0xc4)),{scaleDownHubDeployment}=require(a21_0x1ae0b5(0x9a)),{sendInstrumentationEvent}=require(a21_0x1ae0b5(0x81)),webSocketUtils=require(a21_0x1ae0b5(0xa8)),{createK8sClient}=require(a21_0x1ae0b5(0xc6)),{getCloudProviderObject}=require(a21_0x1ae0b5(0x99));function a21_0x31b6(_0x5b1b2e,_0x1118c1){const _0x20b899=a21_0x20b8();return a21_0x31b6=function(_0x31b6de,_0x195c33){_0x31b6de=_0x31b6de-0x6e;let _0x4b1ddb=_0x20b899[_0x31b6de];return _0x4b1ddb;},a21_0x31b6(_0x5b1b2e,_0x1118c1);}function a21_0x20b8(){const _0x18c7a5=['error','string','bvLCa','Adding\x20Websocket\x20listeners','495nvZcbn','lulAP','nYHFC','2992662UTVmaF','Stop\x20a\x20running\x20Automation\x20grid.','unauthorised','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','oFgwM','<UsernamePlaceholder>','../../utils/webSocketUtils','muReI','bstackUsername','default','../../config/constants','name','PxWmo','Grid\x20stoppped.','38ilBuFg','type','51983TMOrtT','XqGIP','existsSync','statusCode','sSbEw','help','IaWhs','HzxYP','debug','exit','JFJUs','builder','invalid-grid-id','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','../../config/logger','Stopping\x20grid\x20','username','../../utils/utilityMethods','NMSFO','../../utils/createk8sClient','readFileSync','stringify','IAyny','gridId','stop','boolean','clusterName','description','user','server-error','cloudProvider','4666205XpRnIq','BOmTb','iAAbp','Skip\x20insecure\x20cert\x20verification.','mcyLN','password','stack','Browserstack','dbFOs','message','info','FTJRk','../../utils/instrumentationUtils','MxFFm','grid','790930MJxgUT','desc','reconnecting-websocket','skip-tls-cert-verify','6294190BkBxRq','connectionTimeout','body','INFO','handler','ZYSGB','parse','jAQlZ','ERROR','915030xUuCOI','replace','mcmom','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','4TUWvWk','6mVlJTF','1929192qKlkPp','flGZA','../../cloudproviders/utils','../../utils/gridComponents'];a21_0x20b8=function(){return _0x18c7a5;};return a21_0x20b8();}exports['command']=a21_0x1ae0b5(0x83),exports[a21_0x1ae0b5(0x85)]=a21_0x1ae0b5(0xa3),exports[a21_0x1ae0b5(0xbd)]=function(_0x44abb1){const _0x43627d=a21_0x1ae0b5,_0x1c3c7c={};_0x1c3c7c[_0x43627d(0x79)]='Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.',_0x1c3c7c['XqGIP']=_0x43627d(0x9c),_0x1c3c7c[_0x43627d(0xbc)]=_0x43627d(0x78),_0x1c3c7c[_0x43627d(0x7d)]=_0x43627d(0x6f),_0x1c3c7c[_0x43627d(0xa1)]=_0x43627d(0xb7);const _0x22d340=_0x1c3c7c,_0x454ade={};_0x454ade[_0x43627d(0x71)]=_0x22d340['mcyLN'],_0x454ade[_0x43627d(0xb1)]=_0x22d340[_0x43627d(0xb3)];const _0x3fc700={};_0x3fc700[_0x43627d(0x71)]=_0x22d340[_0x43627d(0xbc)],_0x3fc700[_0x43627d(0xb1)]=_0x22d340[_0x43627d(0x7d)],_0x3fc700[_0x43627d(0xab)]=![];const _0x33c2b6={};return _0x33c2b6['grid-id']=_0x454ade,_0x33c2b6[_0x43627d(0x87)]=_0x3fc700,_0x44abb1['usage'](HELP_HEADER_MESSAGE[_0x43627d(0x6e)])['epilogue'](HELP_FOOTER_MESSAGE)['options'](_0x33c2b6)['help'](_0x22d340[_0x43627d(0xa1)])['argv'];},exports[a21_0x1ae0b5(0x8c)]=async function(_0x45a172){const _0x50f9d4=a21_0x1ae0b5,_0x4047eb={'aqgkI':_0x50f9d4(0x94),'sSbEw':function(_0x1b02e4){return _0x1b02e4();},'MxFFm':_0x50f9d4(0xbf),'kvdNd':function(_0x279749,_0x2653b4,_0x2b0715,_0xf76728,_0x940fa2,_0x27d140,_0x50c1df){return _0x279749(_0x2653b4,_0x2b0715,_0xf76728,_0x940fa2,_0x27d140,_0x50c1df);},'lulAP':'stop-grid-called','mcmom':'init-not-called','HzxYP':function(_0xe7200a,_0x5e4a63,_0x32890e,_0x44d944,_0x56c29e,_0x3ed77d,_0x2a564){return _0xe7200a(_0x5e4a63,_0x32890e,_0x44d944,_0x56c29e,_0x3ed77d,_0x2a564);},'NMSFO':_0x50f9d4(0xa7),'jAQlZ':'<PasswordPlaceholder>','muReI':_0x50f9d4(0x9e),'iAAbp':function(_0x5ebad5,_0x2d399f,_0x4c9d25,_0x4e4e3b){return _0x5ebad5(_0x2d399f,_0x4c9d25,_0x4e4e3b);},'ZYSGB':function(_0x396c1b,_0xaac8f0,_0x53414a){return _0x396c1b(_0xaac8f0,_0x53414a);},'nudLk':function(_0x3306ea,_0x59c849,_0x471c1f){return _0x3306ea(_0x59c849,_0x471c1f);},'bvLCa':_0x50f9d4(0xaf),'FTJRk':function(_0x2e6e7d,_0x2030a3){return _0x2e6e7d===_0x2030a3;},'flGZA':_0x50f9d4(0xc0),'IaWhs':function(_0x21e4d5,_0x322326,_0x4d4642,_0x246c6d,_0x37485e,_0x4a1ae7,_0x51b4d0){return _0x21e4d5(_0x322326,_0x4d4642,_0x246c6d,_0x37485e,_0x4a1ae7,_0x51b4d0);},'IAyny':_0x50f9d4(0xa4),'PxWmo':function(_0xdd42e6,_0x1e84ca){return _0xdd42e6===_0x1e84ca;},'BOmTb':function(_0x14e541,_0xb8337a,_0x147c0a,_0x1af19a,_0x1fc56c,_0x240728,_0x298f2e){return _0x14e541(_0xb8337a,_0x147c0a,_0x1af19a,_0x1fc56c,_0x240728,_0x298f2e);},'attcr':_0x50f9d4(0xbe),'oFgwM':_0x50f9d4(0x73)};let _0x2164da;try{!_0x45a172[_0x50f9d4(0xca)]&&(logger[_0x50f9d4(0x9b)](_0x4047eb['aqgkI']),process['exit'](0x1));!fs[_0x50f9d4(0xb4)](_0x4047eb[_0x50f9d4(0xb6)](getCredentialsPath))&&(logger[_0x50f9d4(0x9b)](_0x4047eb[_0x50f9d4(0x82)]),await _0x4047eb['kvdNd'](sendInstrumentationEvent,_0x45a172,_0x4047eb['lulAP'],messageTypes['ERROR'],_0x4047eb[_0x50f9d4(0x93)],null,_0x45a172),process[_0x50f9d4(0xbb)](0x1));logger[_0x50f9d4(0x7f)](_0x50f9d4(0xc2)+_0x45a172[_0x50f9d4(0xca)]),await _0x4047eb[_0x50f9d4(0xb9)](sendInstrumentationEvent,_0x45a172,_0x4047eb[_0x50f9d4(0xa0)],messageTypes[_0x50f9d4(0x8b)],null,null,_0x45a172);const _0x40e05e=JSON[_0x50f9d4(0x8e)](fs[_0x50f9d4(0xc7)](_0x4047eb[_0x50f9d4(0xb6)](getCredentialsPath)));global_registry[_0x50f9d4(0xaa)]=_0x40e05e[_0x50f9d4(0x7c)][_0x50f9d4(0xc3)],global_registry['bstackAccesskey']=_0x40e05e[_0x50f9d4(0x7c)]['password'];const _0x2b3e74=WS_ENDPOINT['replace'](_0x4047eb[_0x50f9d4(0xc5)],_0x40e05e[_0x50f9d4(0x7c)]['username'])[_0x50f9d4(0x92)](_0x4047eb[_0x50f9d4(0x8f)],_0x40e05e[_0x50f9d4(0x7c)][_0x50f9d4(0x7a)]),_0x1a53d1={};_0x1a53d1['WebSocket']=ws,_0x1a53d1[_0x50f9d4(0x89)]=0x36ee80,_0x2164da=new ReconnectingWebSocket(_0x2b3e74,[],_0x1a53d1),logger[_0x50f9d4(0xba)](_0x4047eb[_0x50f9d4(0xa9)]),webSocketUtils['addListeners'](_0x2164da,_0x45a172[_0x50f9d4(0x72)],_0x45a172[_0x50f9d4(0x7a)]);const [_0x358fd6,_0x5d65a4]=await _0x4047eb[_0x50f9d4(0x77)](getGridDetails,_0x40e05e['Browserstack'][_0x50f9d4(0xc3)],_0x40e05e['Browserstack'][_0x50f9d4(0x7a)],_0x45a172[_0x50f9d4(0xca)]);if(_0x5d65a4){const _0x3c0223=_0x5d65a4[_0x50f9d4(0x7f)];global_registry[_0x50f9d4(0x74)]=_0x3c0223['cloudProvider'],global_registry['clusterRegion']=_0x3c0223['region'],global_registry[_0x50f9d4(0x70)]=_0x3c0223[_0x50f9d4(0x70)];const _0x4d0535=await _0x4047eb[_0x50f9d4(0xb9)](getCloudProviderObject,_0x3c0223[_0x50f9d4(0x74)],_0x3c0223[_0x50f9d4(0x70)],_0x3c0223['name'],_0x2164da,webSocketUtils,_0x45a172),[_0x2391f3,_0x31230d,_0x535a80,_0x837b8d,_0x569dc9,_0x4bbafe]=await _0x4047eb[_0x50f9d4(0x8d)](createK8sClient,_0x4d0535,_0x45a172['skipTlsCertVerify']);await _0x4047eb['nudLk'](scaleDownHubDeployment,_0x31230d,_0x3c0223[_0x50f9d4(0xad)]),logger[_0x50f9d4(0x7f)](_0x4047eb[_0x50f9d4(0x9d)]),process[_0x50f9d4(0xbb)](0x0);}_0x4047eb[_0x50f9d4(0x80)](_0x358fd6[_0x50f9d4(0xb5)],0x191)&&(logger['error'](_0x4047eb[_0x50f9d4(0x98)]),await _0x4047eb[_0x50f9d4(0xb8)](sendInstrumentationEvent,_0x45a172,_0x4047eb['lulAP'],messageTypes[_0x50f9d4(0x90)],_0x4047eb[_0x50f9d4(0xc9)],null,_0x45a172),process[_0x50f9d4(0xbb)](0x1)),_0x4047eb[_0x50f9d4(0xae)](_0x358fd6[_0x50f9d4(0xb5)],0x190)&&(logger[_0x50f9d4(0x9b)](JSON[_0x50f9d4(0x8e)](_0x358fd6[_0x50f9d4(0x8a)])[_0x50f9d4(0x7e)]),await _0x4047eb[_0x50f9d4(0x76)](sendInstrumentationEvent,_0x45a172,_0x4047eb[_0x50f9d4(0xa0)],messageTypes[_0x50f9d4(0x90)],_0x4047eb['attcr'],null,_0x45a172),process[_0x50f9d4(0xbb)](0x1)),logger[_0x50f9d4(0x9b)](_0x50f9d4(0xa5)+JSON[_0x50f9d4(0xc8)](_0x358fd6)),await _0x4047eb[_0x50f9d4(0x76)](sendInstrumentationEvent,_0x45a172,_0x4047eb[_0x50f9d4(0xa0)],messageTypes[_0x50f9d4(0x90)],_0x4047eb[_0x50f9d4(0xa6)],_0x358fd6,_0x45a172),process[_0x50f9d4(0xbb)](0x1);}catch(_0xe4221e){const _0x576a0e='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0xe4221e+'\x20\x0a'+JSON[_0x50f9d4(0xc8)](_0xe4221e[_0x50f9d4(0x7b)])+'\x20';logger[_0x50f9d4(0x9b)](_0x576a0e),process[_0x50f9d4(0xbb)](0x1);}};