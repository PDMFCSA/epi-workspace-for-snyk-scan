const a21_0x5cee62=a21_0x4a92;function a21_0x5300(){const _0x4ceec4=['../../utils/createk8sClient','990235eEnTvG','<PasswordPlaceholder>','jHWFX','iVTdh','Skip\x20insecure\x20cert\x20verification.','../../utils/gridComponents','EyQqb','message','statusCode','gridId','addListeners','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','error','handler','aVwmx','stringify','8273778FgXgnT','desc','exit','debug','boolean','help','../../utils/utilityMethods','description','clusterRegion','4oCgvpq','DOSeP','../../utils/instrumentationUtils','UnldA','invalid-grid-id','MObBv','rvetH','554TcMfpJ','stop-grid-called','wlLpD','760YisJwx','cloudProvider','Stopping\x20grid\x20','password','replace','nDnUG','LfZxz','6325272lAXpiL','PMXvn','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','name','default','kiPtu','string','region','stop','kyBHF','qlBZw','OwdOt','sGpJi','INFO','usage','QsgAy','body','grid-id','username','grid','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','nYjuz','../../cloudproviders/utils','ZkwmS','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','../../utils/webSocketUtils','CEOqr','AXxsj','builder','2886632LhLjbH','parse','<UsernamePlaceholder>','WebSocket','3891AwksyK','skip-tls-cert-verify','Adding\x20Websocket\x20listeners','bstackUsername','stack','ERROR','Grid\x20stoppped.','clusterName','Browserstack','XfCeR','epilogue','unauthorised','type','info','1495647mzEtlK','../../config/logger','59877YGOuPH','init-not-called','qGSlQ','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20'];a21_0x5300=function(){return _0x4ceec4;};return a21_0x5300();}function a21_0x4a92(_0x1c7d1d,_0x53f329){const _0x530099=a21_0x5300();return a21_0x4a92=function(_0x4a92d3,_0x521a9c){_0x4a92d3=_0x4a92d3-0x1c6;let _0x14419a=_0x530099[_0x4a92d3];return _0x14419a;},a21_0x4a92(_0x1c7d1d,_0x53f329);}(function(_0x44ec41,_0x198945){const _0x19a574=a21_0x4a92,_0xb2af68=_0x44ec41();while(!![]){try{const _0x2bf49d=-parseInt(_0x19a574(0x221))/0x1*(-parseInt(_0x19a574(0x1f6))/0x2)+-parseInt(_0x19a574(0x1cf))/0x3*(parseInt(_0x19a574(0x1ef))/0x4)+-parseInt(_0x19a574(0x1d6))/0x5+-parseInt(_0x19a574(0x1e6))/0x6+parseInt(_0x19a574(0x21d))/0x7+parseInt(_0x19a574(0x200))/0x8+-parseInt(_0x19a574(0x1d1))/0x9*(-parseInt(_0x19a574(0x1f9))/0xa);if(_0x2bf49d===_0x198945)break;else _0xb2af68['push'](_0xb2af68['shift']());}catch(_0x6108f0){_0xb2af68['push'](_0xb2af68['shift']());}}}(a21_0x5300,0xad8ff));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require('../../config/constants'),{logger}=require(a21_0x5cee62(0x1d0)),{getCredentialsPath,getGridDetails}=require(a21_0x5cee62(0x1ec)),{scaleDownHubDeployment}=require(a21_0x5cee62(0x1db)),{sendInstrumentationEvent}=require(a21_0x5cee62(0x1f1)),webSocketUtils=require(a21_0x5cee62(0x219)),{createK8sClient}=require(a21_0x5cee62(0x1d5)),{getCloudProviderObject}=require(a21_0x5cee62(0x216));exports['command']=a21_0x5cee62(0x213),exports[a21_0x5cee62(0x1e7)]='Stop\x20a\x20running\x20Automation\x20grid.',exports[a21_0x5cee62(0x21c)]=function(_0x1738d6){const _0x5f2b5a=a21_0x5cee62,_0x37551c={};_0x37551c[_0x5f2b5a(0x1ff)]=_0x5f2b5a(0x202),_0x37551c[_0x5f2b5a(0x205)]=_0x5f2b5a(0x206),_0x37551c['PMXvn']=_0x5f2b5a(0x1da),_0x37551c[_0x5f2b5a(0x20a)]=_0x5f2b5a(0x1ea),_0x37551c[_0x5f2b5a(0x1fe)]=_0x5f2b5a(0x1eb);const _0x52d77b=_0x37551c,_0x5cdcd7={};_0x5cdcd7[_0x5f2b5a(0x1ed)]=_0x52d77b[_0x5f2b5a(0x1ff)],_0x5cdcd7['type']=_0x52d77b['kiPtu'];const _0x466fa3={};_0x466fa3[_0x5f2b5a(0x1ed)]=_0x52d77b[_0x5f2b5a(0x201)],_0x466fa3[_0x5f2b5a(0x1cd)]=_0x52d77b['qlBZw'],_0x466fa3[_0x5f2b5a(0x204)]=![];const _0x14588f={};return _0x14588f[_0x5f2b5a(0x211)]=_0x5cdcd7,_0x14588f[_0x5f2b5a(0x222)]=_0x466fa3,_0x1738d6[_0x5f2b5a(0x20e)](HELP_HEADER_MESSAGE[_0x5f2b5a(0x208)])[_0x5f2b5a(0x1cb)](HELP_FOOTER_MESSAGE)['options'](_0x14588f)[_0x5f2b5a(0x1eb)](_0x52d77b[_0x5f2b5a(0x1fe)])['argv'];},exports[a21_0x5cee62(0x1e3)]=async function(_0x790eda){const _0x4892c4=a21_0x5cee62,_0x2761b5={'DOSeP':_0x4892c4(0x1e1),'zEsgM':function(_0x252527){return _0x252527();},'sGpJi':_0x4892c4(0x218),'rvetH':function(_0x33ec5b,_0x2e34ac,_0x9f3392,_0x1bc7cd,_0x165b28,_0x3f842f,_0x12199){return _0x33ec5b(_0x2e34ac,_0x9f3392,_0x1bc7cd,_0x165b28,_0x3f842f,_0x12199);},'qGSlQ':_0x4892c4(0x1f7),'jHWFX':_0x4892c4(0x1d2),'nYjuz':function(_0x4549a9,_0x262b72,_0x29ede2,_0x16b579,_0x310dc6,_0x1852c9,_0x177aae){return _0x4549a9(_0x262b72,_0x29ede2,_0x16b579,_0x310dc6,_0x1852c9,_0x177aae);},'iVTdh':function(_0x46de30){return _0x46de30();},'CEOqr':_0x4892c4(0x21f),'EyQqb':_0x4892c4(0x1d7),'ZkwmS':_0x4892c4(0x223),'iBadF':function(_0x567724,_0x338738,_0x157aa7,_0x3fe2e2){return _0x567724(_0x338738,_0x157aa7,_0x3fe2e2);},'UnldA':function(_0x2d49df,_0x2336aa,_0x4afea8,_0x341997,_0x250ea6,_0x16f5c5,_0x57ccc1){return _0x2d49df(_0x2336aa,_0x4afea8,_0x341997,_0x250ea6,_0x16f5c5,_0x57ccc1);},'MObBv':function(_0x376839,_0x44495b,_0x2b8f63){return _0x376839(_0x44495b,_0x2b8f63);},'OwdOt':function(_0x583e77,_0x566d68,_0x4621ed){return _0x583e77(_0x566d68,_0x4621ed);},'aVwmx':_0x4892c4(0x1c7),'kyBHF':function(_0x4cb67b,_0x274796){return _0x4cb67b===_0x274796;},'WFnMY':_0x4892c4(0x214),'LeUsZ':_0x4892c4(0x1cc),'XfCeR':function(_0x328ba9,_0x570ab3){return _0x328ba9===_0x570ab3;},'zesvh':function(_0x3c2bd1,_0x274f5a,_0x5d8606,_0x1b07b1,_0x501587,_0x3e1071,_0x330dfa){return _0x3c2bd1(_0x274f5a,_0x5d8606,_0x1b07b1,_0x501587,_0x3e1071,_0x330dfa);},'AXxsj':_0x4892c4(0x1f3),'wlLpD':function(_0xf705f8,_0x552e05,_0x47b604,_0x24add0,_0x4b99f9,_0x1aa46a,_0x2e19ab){return _0xf705f8(_0x552e05,_0x47b604,_0x24add0,_0x4b99f9,_0x1aa46a,_0x2e19ab);},'QsgAy':'server-error'};let _0x4c4455;try{!_0x790eda[_0x4892c4(0x1df)]&&(logger['error'](_0x2761b5[_0x4892c4(0x1f0)]),process[_0x4892c4(0x1e8)](0x1));!fs['existsSync'](_0x2761b5['zEsgM'](getCredentialsPath))&&(logger[_0x4892c4(0x1e2)](_0x2761b5[_0x4892c4(0x20c)]),await _0x2761b5[_0x4892c4(0x1f5)](sendInstrumentationEvent,_0x790eda,_0x2761b5[_0x4892c4(0x1d3)],messageTypes['ERROR'],_0x2761b5[_0x4892c4(0x1d8)],null,_0x790eda),process[_0x4892c4(0x1e8)](0x1));logger[_0x4892c4(0x1ce)](_0x4892c4(0x1fb)+_0x790eda[_0x4892c4(0x1df)]),await _0x2761b5[_0x4892c4(0x215)](sendInstrumentationEvent,_0x790eda,_0x2761b5['qGSlQ'],messageTypes[_0x4892c4(0x20d)],null,null,_0x790eda);const _0x517984=JSON['parse'](fs['readFileSync'](_0x2761b5[_0x4892c4(0x1d9)](getCredentialsPath)));global_registry[_0x4892c4(0x224)]=_0x517984[_0x4892c4(0x1c9)]['username'],global_registry['bstackAccesskey']=_0x517984[_0x4892c4(0x1c9)]['password'];const _0x20e563=WS_ENDPOINT[_0x4892c4(0x1fd)](_0x2761b5[_0x4892c4(0x21a)],_0x517984['Browserstack']['username'])[_0x4892c4(0x1fd)](_0x2761b5[_0x4892c4(0x1dc)],_0x517984[_0x4892c4(0x1c9)][_0x4892c4(0x1fc)]),_0x125d3a={};_0x125d3a[_0x4892c4(0x220)]=ws,_0x125d3a['connectionTimeout']=0x36ee80,_0x4c4455=new ReconnectingWebSocket(_0x20e563,[],_0x125d3a),logger[_0x4892c4(0x1e9)](_0x2761b5[_0x4892c4(0x217)]),webSocketUtils[_0x4892c4(0x1e0)](_0x4c4455,_0x790eda['user'],_0x790eda[_0x4892c4(0x1fc)]);const [_0x19a7e1,_0xe0b098]=await _0x2761b5['iBadF'](getGridDetails,_0x517984['Browserstack'][_0x4892c4(0x212)],_0x517984[_0x4892c4(0x1c9)][_0x4892c4(0x1fc)],_0x790eda['gridId']);if(_0xe0b098){const _0x11b9a1=_0xe0b098[_0x4892c4(0x1ce)];global_registry[_0x4892c4(0x1fa)]=_0x11b9a1[_0x4892c4(0x1fa)],global_registry[_0x4892c4(0x1ee)]=_0x11b9a1[_0x4892c4(0x207)],global_registry[_0x4892c4(0x1c8)]=_0x11b9a1[_0x4892c4(0x1c8)];const _0x357cd3=await _0x2761b5[_0x4892c4(0x1f2)](getCloudProviderObject,_0x11b9a1['cloudProvider'],_0x11b9a1['clusterName'],_0x11b9a1['name'],_0x4c4455,webSocketUtils,_0x790eda),[_0x481058,_0x1e3bce,_0x23e058,_0x36b122,_0x2b3866,_0x43637b]=await _0x2761b5[_0x4892c4(0x1f4)](createK8sClient,_0x357cd3,_0x790eda['skipTlsCertVerify']);await _0x2761b5[_0x4892c4(0x20b)](scaleDownHubDeployment,_0x1e3bce,_0x11b9a1[_0x4892c4(0x203)]),logger[_0x4892c4(0x1ce)](_0x2761b5[_0x4892c4(0x1e4)]),process[_0x4892c4(0x1e8)](0x0);}_0x2761b5[_0x4892c4(0x209)](_0x19a7e1[_0x4892c4(0x1de)],0x191)&&(logger[_0x4892c4(0x1e2)](_0x2761b5['WFnMY']),await _0x2761b5[_0x4892c4(0x215)](sendInstrumentationEvent,_0x790eda,_0x2761b5['qGSlQ'],messageTypes[_0x4892c4(0x1c6)],_0x2761b5['LeUsZ'],null,_0x790eda),process[_0x4892c4(0x1e8)](0x1)),_0x2761b5[_0x4892c4(0x1ca)](_0x19a7e1[_0x4892c4(0x1de)],0x190)&&(logger[_0x4892c4(0x1e2)](JSON[_0x4892c4(0x21e)](_0x19a7e1[_0x4892c4(0x210)])[_0x4892c4(0x1dd)]),await _0x2761b5['zesvh'](sendInstrumentationEvent,_0x790eda,_0x2761b5['qGSlQ'],messageTypes[_0x4892c4(0x1c6)],_0x2761b5[_0x4892c4(0x21b)],null,_0x790eda),process['exit'](0x1)),logger[_0x4892c4(0x1e2)](_0x4892c4(0x1d4)+JSON[_0x4892c4(0x1e5)](_0x19a7e1)),await _0x2761b5[_0x4892c4(0x1f8)](sendInstrumentationEvent,_0x790eda,_0x2761b5[_0x4892c4(0x1d3)],messageTypes[_0x4892c4(0x1c6)],_0x2761b5[_0x4892c4(0x20f)],_0x19a7e1,_0x790eda),process[_0x4892c4(0x1e8)](0x1);}catch(_0x1f6542){const _0x9f46bf='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x1f6542+'\x20\x0a'+JSON[_0x4892c4(0x1e5)](_0x1f6542[_0x4892c4(0x225)])+'\x20';logger[_0x4892c4(0x1e2)](_0x9f46bf),process['exit'](0x1);}};