const a21_0x9ab8cd=a21_0x4494;(function(_0x550496,_0x158476){const _0xc3e899=a21_0x4494,_0x31501c=_0x550496();while(!![]){try{const _0x57ea12=-parseInt(_0xc3e899(0x1bd))/0x1+-parseInt(_0xc3e899(0x1ee))/0x2*(parseInt(_0xc3e899(0x1ed))/0x3)+parseInt(_0xc3e899(0x1d3))/0x4+parseInt(_0xc3e899(0x1ce))/0x5*(-parseInt(_0xc3e899(0x1e7))/0x6)+-parseInt(_0xc3e899(0x1c5))/0x7*(parseInt(_0xc3e899(0x1be))/0x8)+parseInt(_0xc3e899(0x1d7))/0x9*(parseInt(_0xc3e899(0x1e9))/0xa)+-parseInt(_0xc3e899(0x1e3))/0xb*(-parseInt(_0xc3e899(0x1e0))/0xc);if(_0x57ea12===_0x158476)break;else _0x31501c['push'](_0x31501c['shift']());}catch(_0xb0552d){_0x31501c['push'](_0x31501c['shift']());}}}(a21_0x3c07,0x3b738));function a21_0x4494(_0x376a93,_0x13cfec){const _0x3c079f=a21_0x3c07();return a21_0x4494=function(_0x4494db,_0x12fa90){_0x4494db=_0x4494db-0x1a8;let _0x42362c=_0x3c079f[_0x4494db];return _0x42362c;},a21_0x4494(_0x376a93,_0x13cfec);}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require('../../config/constants'),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require(a21_0x9ab8cd(0x1d0)),{scaleDownHubDeployment}=require(a21_0x9ab8cd(0x1a8)),{sendInstrumentationEvent}=require(a21_0x9ab8cd(0x1ba)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x9ab8cd(0x1c0)),{getCloudProviderObject}=require(a21_0x9ab8cd(0x1c7));function a21_0x3c07(){const _0x150f4e=['command','../../utils/utilityMethods','builder','Grid\x20stoppped.','149696sEEcAJ','qqMqw','wIMby','PmjjR','9fQiqBX','Browserstack','CVBXA','<PasswordPlaceholder>','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','epilogue','LMXCD','uCrxt','UIqNi','48xtVmGM','WJbmt','description','3081881CJvrrJ','Adding\x20Websocket\x20listeners','addListeners','QiUdO','6faeJLt','info','2876710XwuotY','stop-grid-called','statusCode','readFileSync','1113963TFuxWB','2UHwfjU','PxGWD','HEiAp','lrEOP','clusterRegion','clusterName','password','connectionTimeout','gridId','type','desc','grid-id','boolean','unauthorised','message','replace','../../utils/gridComponents','help','sfJMi','region','bstackAccesskey','gITIU','body','Skip\x20insecure\x20cert\x20verification.','default','stringify','handler','INFO','name','skip-tls-cert-verify','exit','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','stack','username','../../utils/instrumentationUtils','argv','string','361540JuNgcg','8ILGirA','invalid-grid-id','../../utils/createk8sClient','LwHzQ','server-error','QouJj','ERROR','1510201DUBCpb','CzIvV','../../cloudproviders/utils','error','SmEsa','grid','tPsdT','cloudProvider','debug','1268315GYRJID'];a21_0x3c07=function(){return _0x150f4e;};return a21_0x3c07();}exports[a21_0x9ab8cd(0x1cf)]=a21_0x9ab8cd(0x1ca),exports[a21_0x9ab8cd(0x1f8)]='Stop\x20a\x20running\x20Automation\x20grid.',exports[a21_0x9ab8cd(0x1d1)]=function(_0x3da052){const _0x9a6ede=a21_0x9ab8cd,_0x2a3d8c={};_0x2a3d8c[_0x9a6ede(0x1d6)]=_0x9a6ede(0x1b7),_0x2a3d8c[_0x9a6ede(0x1f0)]=_0x9a6ede(0x1bc),_0x2a3d8c[_0x9a6ede(0x1f1)]=_0x9a6ede(0x1af),_0x2a3d8c[_0x9a6ede(0x1e6)]=_0x9a6ede(0x1fa),_0x2a3d8c['CzIvV']=_0x9a6ede(0x1a9);const _0xeafcbd=_0x2a3d8c,_0x2e9742={};_0x2e9742[_0x9a6ede(0x1e2)]=_0xeafcbd[_0x9a6ede(0x1d6)],_0x2e9742[_0x9a6ede(0x1f7)]=_0xeafcbd[_0x9a6ede(0x1f0)];const _0x3c654a={};_0x3c654a[_0x9a6ede(0x1e2)]=_0xeafcbd[_0x9a6ede(0x1f1)],_0x3c654a[_0x9a6ede(0x1f7)]=_0xeafcbd[_0x9a6ede(0x1e6)],_0x3c654a[_0x9a6ede(0x1b0)]=![];const _0xf91e4c={};return _0xf91e4c[_0x9a6ede(0x1f9)]=_0x2e9742,_0xf91e4c[_0x9a6ede(0x1b5)]=_0x3c654a,_0x3da052['usage'](HELP_HEADER_MESSAGE['stop'])[_0x9a6ede(0x1dc)](HELP_FOOTER_MESSAGE)['options'](_0xf91e4c)[_0x9a6ede(0x1a9)](_0xeafcbd[_0x9a6ede(0x1c6)])[_0x9a6ede(0x1bb)];},exports[a21_0x9ab8cd(0x1b2)]=async function(_0x3a1f5a){const _0x5d6e07=a21_0x9ab8cd,_0x56b4e9={'uCrxt':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','SmEsa':function(_0x304236){return _0x304236();},'sfJMi':'Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','LwHzQ':function(_0x53ba47,_0x20c2ff,_0x1dcee0,_0x10b7fe,_0x337052,_0x4b3f53,_0xcbcff8){return _0x53ba47(_0x20c2ff,_0x1dcee0,_0x10b7fe,_0x337052,_0x4b3f53,_0xcbcff8);},'QouJj':_0x5d6e07(0x1ea),'cRENx':'init-not-called','wIMby':function(_0x41a727){return _0x41a727();},'gbhHa':'<UsernamePlaceholder>','kFQGm':_0x5d6e07(0x1da),'SaPjU':_0x5d6e07(0x1e4),'LMXCD':function(_0x55ccda,_0x4901fa,_0x2052f7,_0x5366d8){return _0x55ccda(_0x4901fa,_0x2052f7,_0x5366d8);},'tPsdT':function(_0x3ee92f,_0x1b3906,_0x136d7d,_0x136d83,_0x32e559,_0x1faacb,_0x4716ba){return _0x3ee92f(_0x1b3906,_0x136d7d,_0x136d83,_0x32e559,_0x1faacb,_0x4716ba);},'UIqNi':function(_0x34dee5,_0x3c12ee,_0x1375f4){return _0x34dee5(_0x3c12ee,_0x1375f4);},'CVBXA':_0x5d6e07(0x1d2),'AkBZw':function(_0x3610c3,_0x5019fe){return _0x3610c3===_0x5019fe;},'qqMqw':'Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','WJbmt':_0x5d6e07(0x1fb),'PxGWD':function(_0x3bfb98,_0x1acb8e){return _0x3bfb98===_0x1acb8e;},'RCmNk':_0x5d6e07(0x1bf),'pzxVz':function(_0x424562,_0x19eba0,_0x5ccd37,_0x312efe,_0x245a15,_0x316921,_0x156166){return _0x424562(_0x19eba0,_0x5ccd37,_0x312efe,_0x245a15,_0x316921,_0x156166);},'gITIU':_0x5d6e07(0x1c2)};let _0x4bebcd;try{!_0x3a1f5a[_0x5d6e07(0x1f6)]&&(logger[_0x5d6e07(0x1c8)](_0x56b4e9[_0x5d6e07(0x1de)]),process[_0x5d6e07(0x1b6)](0x1));!fs['existsSync'](_0x56b4e9[_0x5d6e07(0x1c9)](getCredentialsPath))&&(logger[_0x5d6e07(0x1c8)](_0x56b4e9[_0x5d6e07(0x1aa)]),await _0x56b4e9[_0x5d6e07(0x1c1)](sendInstrumentationEvent,_0x3a1f5a,_0x56b4e9['QouJj'],messageTypes[_0x5d6e07(0x1c4)],_0x56b4e9['cRENx'],null,_0x3a1f5a),process['exit'](0x1));logger[_0x5d6e07(0x1e8)]('Stopping\x20grid\x20'+_0x3a1f5a[_0x5d6e07(0x1f6)]),await _0x56b4e9[_0x5d6e07(0x1c1)](sendInstrumentationEvent,_0x3a1f5a,_0x56b4e9[_0x5d6e07(0x1c3)],messageTypes[_0x5d6e07(0x1b3)],null,null,_0x3a1f5a);const _0x415cb6=JSON['parse'](fs[_0x5d6e07(0x1ec)](_0x56b4e9[_0x5d6e07(0x1d5)](getCredentialsPath)));global_registry['bstackUsername']=_0x415cb6[_0x5d6e07(0x1d8)][_0x5d6e07(0x1b9)],global_registry[_0x5d6e07(0x1ac)]=_0x415cb6['Browserstack']['password'];const _0x241ade=WS_ENDPOINT[_0x5d6e07(0x1fd)](_0x56b4e9['gbhHa'],_0x415cb6[_0x5d6e07(0x1d8)][_0x5d6e07(0x1b9)])[_0x5d6e07(0x1fd)](_0x56b4e9['kFQGm'],_0x415cb6[_0x5d6e07(0x1d8)][_0x5d6e07(0x1f4)]),_0x6188cd={};_0x6188cd['WebSocket']=ws,_0x6188cd[_0x5d6e07(0x1f5)]=0x36ee80,_0x4bebcd=new ReconnectingWebSocket(_0x241ade,[],_0x6188cd),logger[_0x5d6e07(0x1cd)](_0x56b4e9['SaPjU']),webSocketUtils[_0x5d6e07(0x1e5)](_0x4bebcd,_0x3a1f5a['user'],_0x3a1f5a[_0x5d6e07(0x1f4)]);const [_0x46990c,_0x170604]=await _0x56b4e9[_0x5d6e07(0x1dd)](getGridDetails,_0x415cb6[_0x5d6e07(0x1d8)][_0x5d6e07(0x1b9)],_0x415cb6['Browserstack'][_0x5d6e07(0x1f4)],_0x3a1f5a[_0x5d6e07(0x1f6)]);if(_0x170604){const _0x4f3f93=_0x170604[_0x5d6e07(0x1e8)];global_registry['cloudProvider']=_0x4f3f93[_0x5d6e07(0x1cc)],global_registry[_0x5d6e07(0x1f2)]=_0x4f3f93[_0x5d6e07(0x1ab)],global_registry[_0x5d6e07(0x1f3)]=_0x4f3f93['clusterName'];const _0x19afdf=await _0x56b4e9['tPsdT'](getCloudProviderObject,_0x4f3f93['cloudProvider'],_0x4f3f93[_0x5d6e07(0x1f3)],_0x4f3f93['name'],_0x4bebcd,webSocketUtils,_0x3a1f5a),[_0x1707bb,_0x1d283c,_0x4b20a5,_0x2084c6,_0x336de5,_0x4515a8]=await _0x56b4e9[_0x5d6e07(0x1df)](createK8sClient,_0x19afdf,_0x3a1f5a['skipTlsCertVerify']);await _0x56b4e9[_0x5d6e07(0x1df)](scaleDownHubDeployment,_0x1d283c,_0x4f3f93[_0x5d6e07(0x1b4)]),logger[_0x5d6e07(0x1e8)](_0x56b4e9[_0x5d6e07(0x1d9)]),process[_0x5d6e07(0x1b6)](0x0);}_0x56b4e9['AkBZw'](_0x46990c[_0x5d6e07(0x1eb)],0x191)&&(logger[_0x5d6e07(0x1c8)](_0x56b4e9[_0x5d6e07(0x1d4)]),await _0x56b4e9['LwHzQ'](sendInstrumentationEvent,_0x3a1f5a,_0x56b4e9[_0x5d6e07(0x1c3)],messageTypes[_0x5d6e07(0x1c4)],_0x56b4e9[_0x5d6e07(0x1e1)],null,_0x3a1f5a),process['exit'](0x1)),_0x56b4e9[_0x5d6e07(0x1ef)](_0x46990c['statusCode'],0x190)&&(logger['error'](JSON['parse'](_0x46990c[_0x5d6e07(0x1ae)])[_0x5d6e07(0x1fc)]),await _0x56b4e9[_0x5d6e07(0x1cb)](sendInstrumentationEvent,_0x3a1f5a,_0x56b4e9[_0x5d6e07(0x1c3)],messageTypes[_0x5d6e07(0x1c4)],_0x56b4e9['RCmNk'],null,_0x3a1f5a),process[_0x5d6e07(0x1b6)](0x1)),logger[_0x5d6e07(0x1c8)]('Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20'+JSON[_0x5d6e07(0x1b1)](_0x46990c)),await _0x56b4e9['pzxVz'](sendInstrumentationEvent,_0x3a1f5a,_0x56b4e9['QouJj'],messageTypes[_0x5d6e07(0x1c4)],_0x56b4e9[_0x5d6e07(0x1ad)],_0x46990c,_0x3a1f5a),process[_0x5d6e07(0x1b6)](0x1);}catch(_0x809269){const _0x472f05=_0x5d6e07(0x1db)+_0x809269+'\x20\x0a'+JSON[_0x5d6e07(0x1b1)](_0x809269[_0x5d6e07(0x1b8)])+'\x20';logger['error'](_0x472f05),process[_0x5d6e07(0x1b6)](0x1);}};