const a21_0x3bf5bc=a21_0x111f;function a21_0x111f(_0x5cc024,_0x21d2f5){const _0xc8ea5f=a21_0xc8ea();return a21_0x111f=function(_0x111f8e,_0x80b9f9){_0x111f8e=_0x111f8e-0x1a7;let _0x3d05d7=_0xc8ea5f[_0x111f8e];return _0x3d05d7;},a21_0x111f(_0x5cc024,_0x21d2f5);}function a21_0xc8ea(){const _0x6685ac=['xMkBg','../../cloudproviders/utils','server-error','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','907497LEOYJF','NRVrI','type','stringify','debug','parse','IWPxO','unauthorised','5238226Bhxhph','password','8998ZvNUSC','bstackUsername','statusCode','epilogue','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','irgkX','skipTlsCertVerify','../../utils/utilityMethods','message','../../utils/instrumentationUtils','invalid-grid-id','argv','qlTvC','<UsernamePlaceholder>','tnZaG','FNRDO','usage','YVHuS','existsSync','uFHBy','Stopping\x20grid\x20','2870mRbEZG','options','info','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','87900YeFZBT','NmZQV','53346jmEyQQ','clusterName','cloudProvider','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','boolean','clusterRegion','stop-grid-called','description','aRgsY','help','IKllR','skip-tls-cert-verify','builder','gridId','afbWW','12BOZwpl','ERROR','exit','1407GsVhac','GiqOH','init-not-called','../../config/constants','MQfYr','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','username','grid-id','stop','WebSocket','../../config/logger','972128XLHEyD','handler','Adding\x20Websocket\x20listeners','Browserstack','error','reconnecting-websocket','command','name','IXUht','addListeners','Stop\x20a\x20running\x20Automation\x20grid.','Grid\x20stoppped.','115XoIEDl','ORALP','string','uMLsA','LkPMI','5416aHOWsy','../../utils/webSocketUtils','user','wLjig'];a21_0xc8ea=function(){return _0x6685ac;};return a21_0xc8ea();}(function(_0x3ccefb,_0x171c47){const _0x4f62ad=a21_0x111f,_0x1002f1=_0x3ccefb();while(!![]){try{const _0x5e5f6d=-parseInt(_0x4f62ad(0x1c5))/0x1*(parseInt(_0x4f62ad(0x1b4))/0x2)+-parseInt(_0x4f62ad(0x1c8))/0x3*(-parseInt(_0x4f62ad(0x1e4))/0x4)+parseInt(_0x4f62ad(0x1df))/0x5*(-parseInt(_0x4f62ad(0x1b6))/0x6)+parseInt(_0x4f62ad(0x1f4))/0x7+parseInt(_0x4f62ad(0x1d3))/0x8+-parseInt(_0x4f62ad(0x1ec))/0x9+-parseInt(_0x4f62ad(0x1b0))/0xa*(parseInt(_0x4f62ad(0x1f6))/0xb);if(_0x5e5f6d===_0x171c47)break;else _0x1002f1['push'](_0x1002f1['shift']());}catch(_0x4a62e9){_0x1002f1['push'](_0x1002f1['shift']());}}}(a21_0xc8ea,0x6ac78));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x3bf5bc(0x1d8)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x3bf5bc(0x1cb)),{logger}=require(a21_0x3bf5bc(0x1d2)),{getCredentialsPath,getGridDetails}=require(a21_0x3bf5bc(0x1fd)),{scaleDownHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require(a21_0x3bf5bc(0x1ff)),webSocketUtils=require(a21_0x3bf5bc(0x1e5)),{createK8sClient}=require('../../utils/createk8sClient'),{getCloudProviderObject}=require(a21_0x3bf5bc(0x1e9));exports[a21_0x3bf5bc(0x1d9)]='grid',exports['desc']=a21_0x3bf5bc(0x1dd),exports[a21_0x3bf5bc(0x1c2)]=function(_0x413f0f){const _0x1c01f9=a21_0x3bf5bc,_0x343c16={};_0x343c16[_0x1c01f9(0x1a9)]=_0x1c01f9(0x1b9),_0x343c16['uFHBy']=_0x1c01f9(0x1e1),_0x343c16[_0x1c01f9(0x1e0)]='Skip\x20insecure\x20cert\x20verification.',_0x343c16[_0x1c01f9(0x1be)]=_0x1c01f9(0x1ba),_0x343c16[_0x1c01f9(0x1e7)]='help';const _0x3b7040=_0x343c16,_0x5723bf={};_0x5723bf['description']=_0x3b7040[_0x1c01f9(0x1a9)],_0x5723bf[_0x1c01f9(0x1ee)]=_0x3b7040[_0x1c01f9(0x1ae)];const _0x32bc06={};_0x32bc06[_0x1c01f9(0x1bd)]=_0x3b7040[_0x1c01f9(0x1e0)],_0x32bc06[_0x1c01f9(0x1ee)]=_0x3b7040[_0x1c01f9(0x1be)],_0x32bc06['default']=![];const _0x3c71ec={};return _0x3c71ec[_0x1c01f9(0x1cf)]=_0x5723bf,_0x3c71ec[_0x1c01f9(0x1c1)]=_0x32bc06,_0x413f0f[_0x1c01f9(0x1ab)](HELP_HEADER_MESSAGE[_0x1c01f9(0x1d0)])[_0x1c01f9(0x1f9)](HELP_FOOTER_MESSAGE)[_0x1c01f9(0x1b1)](_0x3c71ec)[_0x1c01f9(0x1bf)](_0x3b7040['wLjig'])[_0x1c01f9(0x201)];},exports[a21_0x3bf5bc(0x1d4)]=async function(_0x1a1d39){const _0x258c66=a21_0x3bf5bc,_0x443abc={'NmZQV':_0x258c66(0x1fa),'YVHuS':function(_0x143034){return _0x143034();},'qlTvC':_0x258c66(0x1cd),'NRVrI':function(_0x5a0658,_0x4ae4d4,_0x26df66,_0x658e3a,_0xcdc096,_0xfc9bb1,_0x30a6d7){return _0x5a0658(_0x4ae4d4,_0x26df66,_0x658e3a,_0xcdc096,_0xfc9bb1,_0x30a6d7);},'IWPxO':_0x258c66(0x1bc),'LkPMI':_0x258c66(0x1ca),'irgkX':function(_0x2f31c,_0x2ff9bd,_0x9f582,_0x4cb080,_0x445d23,_0x1a6d2d,_0x358018){return _0x2f31c(_0x2ff9bd,_0x9f582,_0x4cb080,_0x445d23,_0x1a6d2d,_0x358018);},'GiqOH':function(_0x246005){return _0x246005();},'afbWW':_0x258c66(0x1a8),'xQgZc':'<PasswordPlaceholder>','uMLsA':_0x258c66(0x1d5),'HEjiv':function(_0x2a6177,_0x68a68f,_0x5d6a24,_0x13a00a){return _0x2a6177(_0x68a68f,_0x5d6a24,_0x13a00a);},'xMkBg':function(_0x57bc3d,_0x309a51,_0x317dd6){return _0x57bc3d(_0x309a51,_0x317dd6);},'cOJgo':_0x258c66(0x1de),'ipNTd':function(_0xfef393,_0x28ee44){return _0xfef393===_0x28ee44;},'CkfkL':_0x258c66(0x1b3),'IKllR':function(_0x8d1911,_0x4f7fe0,_0x59a1b7,_0x405fbb,_0x187c4d,_0x81bbc5,_0x29ae3f){return _0x8d1911(_0x4f7fe0,_0x59a1b7,_0x405fbb,_0x187c4d,_0x81bbc5,_0x29ae3f);},'MQfYr':_0x258c66(0x1f3),'oieCS':function(_0x2e9951,_0x435dd0){return _0x2e9951===_0x435dd0;},'IXUht':_0x258c66(0x200),'FNRDO':_0x258c66(0x1ea)};let _0x22a3f0;try{!_0x1a1d39[_0x258c66(0x1c3)]&&(logger[_0x258c66(0x1d7)](_0x443abc[_0x258c66(0x1b5)]),process[_0x258c66(0x1c7)](0x1));!fs[_0x258c66(0x1ad)](_0x443abc[_0x258c66(0x1ac)](getCredentialsPath))&&(logger[_0x258c66(0x1d7)](_0x443abc[_0x258c66(0x1a7)]),await _0x443abc[_0x258c66(0x1ed)](sendInstrumentationEvent,_0x1a1d39,_0x443abc[_0x258c66(0x1f2)],messageTypes[_0x258c66(0x1c6)],_0x443abc[_0x258c66(0x1e3)],null,_0x1a1d39),process['exit'](0x1));logger[_0x258c66(0x1b2)](_0x258c66(0x1af)+_0x1a1d39[_0x258c66(0x1c3)]),await _0x443abc['irgkX'](sendInstrumentationEvent,_0x1a1d39,_0x443abc['IWPxO'],messageTypes['INFO'],null,null,_0x1a1d39);const _0x5860ef=JSON[_0x258c66(0x1f1)](fs['readFileSync'](_0x443abc[_0x258c66(0x1c9)](getCredentialsPath)));global_registry[_0x258c66(0x1f7)]=_0x5860ef['Browserstack'][_0x258c66(0x1ce)],global_registry['bstackAccesskey']=_0x5860ef[_0x258c66(0x1d6)][_0x258c66(0x1f5)];const _0x3d4932=WS_ENDPOINT['replace'](_0x443abc[_0x258c66(0x1c4)],_0x5860ef[_0x258c66(0x1d6)][_0x258c66(0x1ce)])['replace'](_0x443abc['xQgZc'],_0x5860ef[_0x258c66(0x1d6)][_0x258c66(0x1f5)]),_0x13f51d={};_0x13f51d[_0x258c66(0x1d1)]=ws,_0x13f51d['connectionTimeout']=0x36ee80,_0x22a3f0=new ReconnectingWebSocket(_0x3d4932,[],_0x13f51d),logger[_0x258c66(0x1f0)](_0x443abc[_0x258c66(0x1e2)]),webSocketUtils[_0x258c66(0x1dc)](_0x22a3f0,_0x1a1d39[_0x258c66(0x1e6)],_0x1a1d39[_0x258c66(0x1f5)]);const [_0x5e3d6b,_0x2ee0a9]=await _0x443abc['HEjiv'](getGridDetails,_0x5860ef['Browserstack']['username'],_0x5860ef['Browserstack']['password'],_0x1a1d39[_0x258c66(0x1c3)]);if(_0x2ee0a9){const _0x3e8b04=_0x2ee0a9[_0x258c66(0x1b2)];global_registry[_0x258c66(0x1b8)]=_0x3e8b04['cloudProvider'],global_registry[_0x258c66(0x1bb)]=_0x3e8b04['region'],global_registry['clusterName']=_0x3e8b04['clusterName'];const _0x3a7c1a=await _0x443abc[_0x258c66(0x1fb)](getCloudProviderObject,_0x3e8b04[_0x258c66(0x1b8)],_0x3e8b04[_0x258c66(0x1b7)],_0x3e8b04[_0x258c66(0x1da)],_0x22a3f0,webSocketUtils,_0x1a1d39),[_0x1e734e,_0x5b35d4,_0x5f116a,_0x526c77,_0x4b7ada,_0x55b0fc]=await _0x443abc[_0x258c66(0x1e8)](createK8sClient,_0x3a7c1a,_0x1a1d39[_0x258c66(0x1fc)]);await _0x443abc['xMkBg'](scaleDownHubDeployment,_0x5b35d4,_0x3e8b04[_0x258c66(0x1da)]),logger['info'](_0x443abc['cOJgo']),process[_0x258c66(0x1c7)](0x0);}_0x443abc['ipNTd'](_0x5e3d6b['statusCode'],0x191)&&(logger[_0x258c66(0x1d7)](_0x443abc['CkfkL']),await _0x443abc[_0x258c66(0x1c0)](sendInstrumentationEvent,_0x1a1d39,_0x443abc[_0x258c66(0x1f2)],messageTypes[_0x258c66(0x1c6)],_0x443abc[_0x258c66(0x1cc)],null,_0x1a1d39),process['exit'](0x1)),_0x443abc['oieCS'](_0x5e3d6b[_0x258c66(0x1f8)],0x190)&&(logger['error'](JSON[_0x258c66(0x1f1)](_0x5e3d6b['body'])[_0x258c66(0x1fe)]),await _0x443abc['IKllR'](sendInstrumentationEvent,_0x1a1d39,_0x443abc[_0x258c66(0x1f2)],messageTypes['ERROR'],_0x443abc[_0x258c66(0x1db)],null,_0x1a1d39),process[_0x258c66(0x1c7)](0x1)),logger[_0x258c66(0x1d7)](_0x258c66(0x1eb)+JSON[_0x258c66(0x1ef)](_0x5e3d6b)),await _0x443abc['IKllR'](sendInstrumentationEvent,_0x1a1d39,_0x443abc[_0x258c66(0x1f2)],messageTypes[_0x258c66(0x1c6)],_0x443abc[_0x258c66(0x1aa)],_0x5e3d6b,_0x1a1d39),process['exit'](0x1);}catch(_0x2a6a4d){const _0x4d33cc='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x2a6a4d+'\x20\x0a'+JSON[_0x258c66(0x1ef)](_0x2a6a4d['stack'])+'\x20';logger[_0x258c66(0x1d7)](_0x4d33cc),process[_0x258c66(0x1c7)](0x1);}};