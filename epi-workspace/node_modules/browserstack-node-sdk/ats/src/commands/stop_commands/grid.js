const a21_0x3bb6c4=a21_0x3b8a;function a21_0x3b8a(_0x2d1d6b,_0x4d1823){const _0x2ca86f=a21_0x2ca8();return a21_0x3b8a=function(_0x3b8ad4,_0x4f75aa){_0x3b8ad4=_0x3b8ad4-0xc0;let _0x55af42=_0x2ca86f[_0x3b8ad4];return _0x55af42;},a21_0x3b8a(_0x2d1d6b,_0x4d1823);}function a21_0x2ca8(){const _0x263fbd=['TyhVM','string','20aAMnzA','<PasswordPlaceholder>','goPLk','grid','help','924888mQQefW','633747erbFWN','username','sZRYk','server-error','builder','options','clusterName','init-not-called','stop-grid-called','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','replace','bQDFu','../../config/constants','Grid\x20stoppped.','../../utils/gridComponents','skipTlsCertVerify','vQsWD','KFRrW','default','user','connectionTimeout','statusCode','readFileSync','2TtgKCd','info','usage','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','15844190ZUTKKx','grid-id','635604mTkwXc','WTUsX','CFDAP','error','lltFH','cloudProvider','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','stop','handler','bstackAccesskey','exit','eZJcI','sPeHl','reconnecting-websocket','dNOjh','HzWJM','169913eNbqVq','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','stack','parse','argv','password','OpANO','stringify','message','desc','INFO','epilogue','Adding\x20Websocket\x20listeners','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','Eqqsi','12976722iWHgmp','FSYna','yYUCr','yuSlz','Stop\x20a\x20running\x20Automation\x20grid.','8kUxnGo','KrNWR','region','WebSocket','../../utils/utilityMethods','Browserstack','../../utils/createk8sClient','existsSync','Skip\x20insecure\x20cert\x20verification.','uXffG','addListeners','../../config/logger','command','Stopping\x20grid\x20','WjIFT','bwHnO','2138549HZUuLK','type','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','bstackUsername','gridId','boolean','../../utils/instrumentationUtils','LPByw','ERROR','name','mVXOW','lkkvM'];a21_0x2ca8=function(){return _0x263fbd;};return a21_0x2ca8();}(function(_0x30f35f,_0x15a6a6){const _0x401537=a21_0x3b8a,_0x53b544=_0x30f35f();while(!![]){try{const _0x45e0cf=-parseInt(_0x401537(0xe1))/0x1*(parseInt(_0x401537(0xcb))/0x2)+-parseInt(_0x401537(0x119))/0x3+parseInt(_0x401537(0x118))/0x4+-parseInt(_0x401537(0x113))/0x5*(-parseInt(_0x401537(0xd1))/0x6)+parseInt(_0x401537(0x105))/0x7+parseInt(_0x401537(0xf5))/0x8*(-parseInt(_0x401537(0xf0))/0x9)+parseInt(_0x401537(0xcf))/0xa;if(_0x45e0cf===_0x15a6a6)break;else _0x53b544['push'](_0x53b544['shift']());}catch(_0x509c2e){_0x53b544['push'](_0x53b544['shift']());}}}(a21_0x2ca8,0xb03c8));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x3bb6c4(0xde)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x3bb6c4(0xc0)),{logger}=require(a21_0x3bb6c4(0x100)),{getCredentialsPath,getGridDetails}=require(a21_0x3bb6c4(0xf9)),{scaleDownHubDeployment}=require(a21_0x3bb6c4(0xc2)),{sendInstrumentationEvent}=require(a21_0x3bb6c4(0x10b)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x3bb6c4(0xfb)),{getCloudProviderObject}=require('../../cloudproviders/utils');exports[a21_0x3bb6c4(0x101)]=a21_0x3bb6c4(0x116),exports[a21_0x3bb6c4(0xea)]=a21_0x3bb6c4(0xf4),exports[a21_0x3bb6c4(0x11d)]=function(_0x5469e1){const _0x2dbc53=a21_0x3bb6c4,_0x6ac579={};_0x6ac579[_0x2dbc53(0xfe)]=_0x2dbc53(0xe2),_0x6ac579[_0x2dbc53(0x110)]=_0x2dbc53(0x112),_0x6ac579[_0x2dbc53(0x103)]=_0x2dbc53(0xfd),_0x6ac579[_0x2dbc53(0x124)]=_0x2dbc53(0x10a),_0x6ac579[_0x2dbc53(0xdd)]=_0x2dbc53(0x117);const _0x1315d6=_0x6ac579,_0x571a17={};_0x571a17['description']=_0x1315d6['uXffG'],_0x571a17[_0x2dbc53(0x106)]=_0x1315d6[_0x2dbc53(0x110)];const _0x2dbe7e={};_0x2dbe7e['description']=_0x1315d6[_0x2dbc53(0x103)],_0x2dbe7e['type']=_0x1315d6['bQDFu'],_0x2dbe7e[_0x2dbc53(0xc6)]=![];const _0x37f468={};return _0x37f468[_0x2dbc53(0xd0)]=_0x571a17,_0x37f468['skip-tls-cert-verify']=_0x2dbe7e,_0x5469e1[_0x2dbc53(0xcd)](HELP_HEADER_MESSAGE[_0x2dbc53(0xd8)])[_0x2dbc53(0xec)](HELP_FOOTER_MESSAGE)[_0x2dbc53(0x11e)](_0x37f468)['help'](_0x1315d6[_0x2dbc53(0xdd)])[_0x2dbc53(0xe5)];},exports[a21_0x3bb6c4(0xd9)]=async function(_0x4b262c){const _0x364777=a21_0x3bb6c4,_0x3b10f3={'tbJVM':_0x364777(0x107),'WTUsX':function(_0x592ab4){return _0x592ab4();},'OpANO':_0x364777(0xee),'Eqqsi':function(_0x1da891,_0x4e9d53,_0x5d41e7,_0xe17130,_0x39f20c,_0x10ca28,_0xfa5b36){return _0x1da891(_0x4e9d53,_0x5d41e7,_0xe17130,_0x39f20c,_0x10ca28,_0xfa5b36);},'goPLk':_0x364777(0x121),'KrNWR':_0x364777(0x120),'eZJcI':function(_0x5c2933){return _0x5c2933();},'lltFH':'<UsernamePlaceholder>','HzWJM':_0x364777(0x114),'vQsWD':_0x364777(0xed),'CFDAP':function(_0x11245f,_0x20cace,_0x56894a,_0x13b342){return _0x11245f(_0x20cace,_0x56894a,_0x13b342);},'LPByw':function(_0x5c1465,_0x7904b2,_0x1714d8,_0x466e15,_0x9e315a,_0x4d8756,_0x4a0eb2){return _0x5c1465(_0x7904b2,_0x1714d8,_0x466e15,_0x9e315a,_0x4d8756,_0x4a0eb2);},'mVXOW':function(_0x50ad5d,_0x2bd7ab,_0x3924ad){return _0x50ad5d(_0x2bd7ab,_0x3924ad);},'sZRYk':function(_0x2556c7,_0x1fda1f,_0x11c99d){return _0x2556c7(_0x1fda1f,_0x11c99d);},'yuSlz':_0x364777(0xc1),'TyhVM':function(_0x35df5b,_0x47b9d5){return _0x35df5b===_0x47b9d5;},'bVpUE':_0x364777(0xce),'tGkkh':function(_0x4f66b4,_0x90bb42,_0x4f9f70,_0x2a77c5,_0x33ae6f,_0xfa234c,_0x1ef80d){return _0x4f66b4(_0x90bb42,_0x4f9f70,_0x2a77c5,_0x33ae6f,_0xfa234c,_0x1ef80d);},'mUzMj':'unauthorised','KFRrW':function(_0x38fbfa,_0x3e407f){return _0x38fbfa===_0x3e407f;},'FSYna':function(_0xc825ff,_0x2597fc,_0x4400fc,_0x12413a,_0x110b85,_0x313e35,_0x3dbab7){return _0xc825ff(_0x2597fc,_0x4400fc,_0x12413a,_0x110b85,_0x313e35,_0x3dbab7);},'bwHnO':'invalid-grid-id','dNOjh':function(_0x5e7714,_0x24b456,_0x12ac1a,_0x561754,_0x3f8969,_0x55c982,_0x27bf8e){return _0x5e7714(_0x24b456,_0x12ac1a,_0x561754,_0x3f8969,_0x55c982,_0x27bf8e);},'yYUCr':_0x364777(0x11c)};let _0x500d42;try{!_0x4b262c[_0x364777(0x109)]&&(logger[_0x364777(0xd4)](_0x3b10f3['tbJVM']),process[_0x364777(0xdb)](0x1));!fs[_0x364777(0xfc)](_0x3b10f3[_0x364777(0xd2)](getCredentialsPath))&&(logger[_0x364777(0xd4)](_0x3b10f3[_0x364777(0xe7)]),await _0x3b10f3[_0x364777(0xef)](sendInstrumentationEvent,_0x4b262c,_0x3b10f3[_0x364777(0x115)],messageTypes[_0x364777(0x10d)],_0x3b10f3[_0x364777(0xf6)],null,_0x4b262c),process[_0x364777(0xdb)](0x1));logger['info'](_0x364777(0x102)+_0x4b262c[_0x364777(0x109)]),await _0x3b10f3['Eqqsi'](sendInstrumentationEvent,_0x4b262c,_0x3b10f3[_0x364777(0x115)],messageTypes[_0x364777(0xeb)],null,null,_0x4b262c);const _0xddf2ff=JSON[_0x364777(0xe4)](fs[_0x364777(0xca)](_0x3b10f3[_0x364777(0xdc)](getCredentialsPath)));global_registry[_0x364777(0x108)]=_0xddf2ff[_0x364777(0xfa)][_0x364777(0x11a)],global_registry[_0x364777(0xda)]=_0xddf2ff[_0x364777(0xfa)]['password'];const _0x465de3=WS_ENDPOINT['replace'](_0x3b10f3[_0x364777(0xd5)],_0xddf2ff[_0x364777(0xfa)][_0x364777(0x11a)])[_0x364777(0x123)](_0x3b10f3[_0x364777(0xe0)],_0xddf2ff[_0x364777(0xfa)][_0x364777(0xe6)]),_0x2560a1={};_0x2560a1[_0x364777(0xf8)]=ws,_0x2560a1[_0x364777(0xc8)]=0x36ee80,_0x500d42=new ReconnectingWebSocket(_0x465de3,[],_0x2560a1),logger['debug'](_0x3b10f3[_0x364777(0xc4)]),webSocketUtils[_0x364777(0xff)](_0x500d42,_0x4b262c[_0x364777(0xc7)],_0x4b262c[_0x364777(0xe6)]);const [_0x5b235e,_0x566ff7]=await _0x3b10f3[_0x364777(0xd3)](getGridDetails,_0xddf2ff[_0x364777(0xfa)][_0x364777(0x11a)],_0xddf2ff['Browserstack'][_0x364777(0xe6)],_0x4b262c[_0x364777(0x109)]);if(_0x566ff7){const _0x5ba7a0=_0x566ff7['info'];global_registry[_0x364777(0xd6)]=_0x5ba7a0[_0x364777(0xd6)],global_registry['clusterRegion']=_0x5ba7a0[_0x364777(0xf7)],global_registry[_0x364777(0x11f)]=_0x5ba7a0[_0x364777(0x11f)];const _0x3da368=await _0x3b10f3[_0x364777(0x10c)](getCloudProviderObject,_0x5ba7a0[_0x364777(0xd6)],_0x5ba7a0[_0x364777(0x11f)],_0x5ba7a0[_0x364777(0x10e)],_0x500d42,webSocketUtils,_0x4b262c),[_0x506877,_0x4b8269,_0x361775,_0x30813b,_0x8b1dc0,_0x476fda]=await _0x3b10f3[_0x364777(0x10f)](createK8sClient,_0x3da368,_0x4b262c[_0x364777(0xc3)]);await _0x3b10f3[_0x364777(0x11b)](scaleDownHubDeployment,_0x4b8269,_0x5ba7a0[_0x364777(0x10e)]),logger[_0x364777(0xcc)](_0x3b10f3[_0x364777(0xf3)]),process[_0x364777(0xdb)](0x0);}_0x3b10f3[_0x364777(0x111)](_0x5b235e[_0x364777(0xc9)],0x191)&&(logger[_0x364777(0xd4)](_0x3b10f3['bVpUE']),await _0x3b10f3['tGkkh'](sendInstrumentationEvent,_0x4b262c,_0x3b10f3['goPLk'],messageTypes[_0x364777(0x10d)],_0x3b10f3['mUzMj'],null,_0x4b262c),process[_0x364777(0xdb)](0x1)),_0x3b10f3[_0x364777(0xc5)](_0x5b235e[_0x364777(0xc9)],0x190)&&(logger[_0x364777(0xd4)](JSON[_0x364777(0xe4)](_0x5b235e['body'])[_0x364777(0xe9)]),await _0x3b10f3[_0x364777(0xf1)](sendInstrumentationEvent,_0x4b262c,_0x3b10f3[_0x364777(0x115)],messageTypes[_0x364777(0x10d)],_0x3b10f3[_0x364777(0x104)],null,_0x4b262c),process['exit'](0x1)),logger['error'](_0x364777(0x122)+JSON[_0x364777(0xe8)](_0x5b235e)),await _0x3b10f3[_0x364777(0xdf)](sendInstrumentationEvent,_0x4b262c,_0x3b10f3['goPLk'],messageTypes['ERROR'],_0x3b10f3[_0x364777(0xf2)],_0x5b235e,_0x4b262c),process[_0x364777(0xdb)](0x1);}catch(_0x330c6a){const _0x31c5b2=_0x364777(0xd7)+_0x330c6a+'\x20\x0a'+JSON[_0x364777(0xe8)](_0x330c6a[_0x364777(0xe3)])+'\x20';logger['error'](_0x31c5b2),process[_0x364777(0xdb)](0x1);}};