const a21_0x532dde=a21_0x5662;(function(_0x5c1323,_0x45cc2e){const _0x385cbc=a21_0x5662,_0x39b574=_0x5c1323();while(!![]){try{const _0x38ddab=-parseInt(_0x385cbc(0x229))/0x1*(-parseInt(_0x385cbc(0x204))/0x2)+parseInt(_0x385cbc(0x20b))/0x3+parseInt(_0x385cbc(0x1e8))/0x4+-parseInt(_0x385cbc(0x1e1))/0x5+parseInt(_0x385cbc(0x1dc))/0x6+parseInt(_0x385cbc(0x218))/0x7+-parseInt(_0x385cbc(0x1d5))/0x8;if(_0x38ddab===_0x45cc2e)break;else _0x39b574['push'](_0x39b574['shift']());}catch(_0x41f00b){_0x39b574['push'](_0x39b574['shift']());}}}(a21_0x569a,0x9f812));function a21_0x5662(_0x37c3ae,_0x36464a){const _0x569ab9=a21_0x569a();return a21_0x5662=function(_0x566221,_0x1a8e40){_0x566221=_0x566221-0x1d4;let _0x454e2a=_0x569ab9[_0x566221];return _0x454e2a;},a21_0x5662(_0x37c3ae,_0x36464a);}function a21_0x569a(){const _0x587292=['addListeners','username','Stop\x20a\x20running\x20Automation\x20grid.','handler','../../cloudproviders/utils','bhxQo','gKsxI','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','INFO','parse','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','199697wyODxG','lJPrM','grid','7218184yrurQh','nkFtl','type','../../config/logger','../../config/constants','bstackAccesskey','body','64926DAAtAO','command','WebSocket','help','info','3684455Zuxyuo','debug','argv','bykIJ','description','ERROR','stop','892592cpovfC','RtVnJ','password','../../utils/webSocketUtils','stringify','boolean','eBFiR','Grid\x20stoppped.','YbaPy','replace','options','tGktN','existsSync','default','name','Skip\x20insecure\x20cert\x20verification.','statusCode','UhmxZ','server-error','init-not-called','LOpCL','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','exit','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','invalid-grid-id','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','connectionTimeout','Adding\x20Websocket\x20listeners','2gIRjkl','Browserstack','clusterRegion','cloudProvider','unauthorised','Stopping\x20grid\x20','BiMxf','3231201yTiDSL','usage','sWNIx','grid-id','brgKf','../../utils/gridComponents','builder','clusterName','gridId','JmRvp','TiwtM','error','../../utils/createk8sClient','5472327rNwSkZ','region','wQWuI','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','readFileSync','LbIHY'];a21_0x569a=function(){return _0x587292;};return a21_0x569a();}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x532dde(0x1d9)),{logger}=require(a21_0x532dde(0x1d8)),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0x532dde(0x210)),{sendInstrumentationEvent}=require('../../utils/instrumentationUtils'),webSocketUtils=require(a21_0x532dde(0x1eb)),{createK8sClient}=require(a21_0x532dde(0x217)),{getCloudProviderObject}=require(a21_0x532dde(0x222));exports[a21_0x532dde(0x1dd)]=a21_0x532dde(0x1d4),exports['desc']=a21_0x532dde(0x220),exports[a21_0x532dde(0x211)]=function(_0x1f604a){const _0x481e2c=a21_0x532dde,_0x1bf91d={};_0x1bf91d['brgKf']=_0x481e2c(0x1ff),_0x1bf91d[_0x481e2c(0x1e4)]='string',_0x1bf91d[_0x481e2c(0x1ee)]=_0x481e2c(0x1f7),_0x1bf91d['BFcqF']=_0x481e2c(0x1ed),_0x1bf91d[_0x481e2c(0x21a)]=_0x481e2c(0x1df);const _0x1e51f7=_0x1bf91d,_0x35aaf7={};_0x35aaf7[_0x481e2c(0x1e5)]=_0x1e51f7[_0x481e2c(0x20f)],_0x35aaf7[_0x481e2c(0x1d7)]=_0x1e51f7[_0x481e2c(0x1e4)];const _0x462343={};_0x462343[_0x481e2c(0x1e5)]=_0x1e51f7['eBFiR'],_0x462343[_0x481e2c(0x1d7)]=_0x1e51f7['BFcqF'],_0x462343[_0x481e2c(0x1f5)]=![];const _0x2fc3e9={};return _0x2fc3e9[_0x481e2c(0x20e)]=_0x35aaf7,_0x2fc3e9['skip-tls-cert-verify']=_0x462343,_0x1f604a[_0x481e2c(0x20c)](HELP_HEADER_MESSAGE[_0x481e2c(0x1e7)])['epilogue'](HELP_FOOTER_MESSAGE)[_0x481e2c(0x1f2)](_0x2fc3e9)[_0x481e2c(0x1df)](_0x1e51f7[_0x481e2c(0x21a)])[_0x481e2c(0x1e3)];},exports[a21_0x532dde(0x221)]=async function(_0x4f5e35){const _0x28e390=a21_0x532dde,_0x193d5e={'BiMxf':_0x28e390(0x201),'LbIHY':function(_0x4614c2){return _0x4614c2();},'TagLM':_0x28e390(0x225),'tGktN':function(_0x146dda,_0x2a94a6,_0x57b583,_0x2b9e76,_0x3e68b1,_0x228911,_0x10cd18){return _0x146dda(_0x2a94a6,_0x57b583,_0x2b9e76,_0x3e68b1,_0x228911,_0x10cd18);},'YbaPy':'stop-grid-called','lJPrM':_0x28e390(0x1fb),'NkVeP':'<UsernamePlaceholder>','bhxQo':'<PasswordPlaceholder>','RtVnJ':_0x28e390(0x203),'bzfvs':function(_0x47b462,_0x591374,_0x4446ca,_0x1de050){return _0x47b462(_0x591374,_0x4446ca,_0x1de050);},'UhmxZ':function(_0x5cbf45,_0x3b6122,_0x3c1095){return _0x5cbf45(_0x3b6122,_0x3c1095);},'nkFtl':_0x28e390(0x1ef),'TiwtM':function(_0x40c730,_0x5785a1){return _0x40c730===_0x5785a1;},'hqmev':_0x28e390(0x21b),'sWNIx':_0x28e390(0x208),'gKsxI':function(_0x32a0ea,_0x2478e0,_0x5ae3fa,_0x5af6df,_0x5e87a4,_0x50256a,_0x511a44){return _0x32a0ea(_0x2478e0,_0x5ae3fa,_0x5af6df,_0x5e87a4,_0x50256a,_0x511a44);},'LOpCL':_0x28e390(0x200),'JmRvp':_0x28e390(0x1fa)};let _0x4d580a;try{!_0x4f5e35[_0x28e390(0x213)]&&(logger[_0x28e390(0x216)](_0x193d5e[_0x28e390(0x20a)]),process['exit'](0x1));!fs[_0x28e390(0x1f4)](_0x193d5e[_0x28e390(0x21d)](getCredentialsPath))&&(logger['error'](_0x193d5e['TagLM']),await _0x193d5e[_0x28e390(0x1f3)](sendInstrumentationEvent,_0x4f5e35,_0x193d5e[_0x28e390(0x1f0)],messageTypes['ERROR'],_0x193d5e[_0x28e390(0x22a)],null,_0x4f5e35),process[_0x28e390(0x1fe)](0x1));logger[_0x28e390(0x1e0)](_0x28e390(0x209)+_0x4f5e35[_0x28e390(0x213)]),await _0x193d5e[_0x28e390(0x1f3)](sendInstrumentationEvent,_0x4f5e35,_0x193d5e[_0x28e390(0x1f0)],messageTypes[_0x28e390(0x226)],null,null,_0x4f5e35);const _0x12a124=JSON[_0x28e390(0x227)](fs[_0x28e390(0x21c)](_0x193d5e[_0x28e390(0x21d)](getCredentialsPath)));global_registry['bstackUsername']=_0x12a124[_0x28e390(0x205)][_0x28e390(0x21f)],global_registry[_0x28e390(0x1da)]=_0x12a124[_0x28e390(0x205)][_0x28e390(0x1ea)];const _0x584e86=WS_ENDPOINT[_0x28e390(0x1f1)](_0x193d5e['NkVeP'],_0x12a124[_0x28e390(0x205)]['username'])[_0x28e390(0x1f1)](_0x193d5e[_0x28e390(0x223)],_0x12a124[_0x28e390(0x205)][_0x28e390(0x1ea)]),_0x17c3bb={};_0x17c3bb[_0x28e390(0x1de)]=ws,_0x17c3bb[_0x28e390(0x202)]=0x36ee80,_0x4d580a=new ReconnectingWebSocket(_0x584e86,[],_0x17c3bb),logger[_0x28e390(0x1e2)](_0x193d5e[_0x28e390(0x1e9)]),webSocketUtils[_0x28e390(0x21e)](_0x4d580a,_0x4f5e35['user'],_0x4f5e35[_0x28e390(0x1ea)]);const [_0x91168e,_0x23b09d]=await _0x193d5e['bzfvs'](getGridDetails,_0x12a124[_0x28e390(0x205)][_0x28e390(0x21f)],_0x12a124[_0x28e390(0x205)][_0x28e390(0x1ea)],_0x4f5e35[_0x28e390(0x213)]);if(_0x23b09d){const _0x5bbb21=_0x23b09d[_0x28e390(0x1e0)];global_registry[_0x28e390(0x207)]=_0x5bbb21[_0x28e390(0x207)],global_registry[_0x28e390(0x206)]=_0x5bbb21[_0x28e390(0x219)],global_registry[_0x28e390(0x212)]=_0x5bbb21['clusterName'];const _0x57782a=await _0x193d5e[_0x28e390(0x1f3)](getCloudProviderObject,_0x5bbb21[_0x28e390(0x207)],_0x5bbb21[_0x28e390(0x212)],_0x5bbb21[_0x28e390(0x1f6)],_0x4d580a,webSocketUtils,_0x4f5e35),[_0x5d9a5c,_0x43495d,_0x34fd60,_0x2532d8,_0x52a11a,_0x3b6651]=await _0x193d5e[_0x28e390(0x1f9)](createK8sClient,_0x57782a,_0x4f5e35['skipTlsCertVerify']);await _0x193d5e['UhmxZ'](scaleDownHubDeployment,_0x43495d,_0x5bbb21[_0x28e390(0x1f6)]),logger[_0x28e390(0x1e0)](_0x193d5e[_0x28e390(0x1d6)]),process[_0x28e390(0x1fe)](0x0);}_0x193d5e[_0x28e390(0x215)](_0x91168e[_0x28e390(0x1f8)],0x191)&&(logger[_0x28e390(0x216)](_0x193d5e['hqmev']),await _0x193d5e[_0x28e390(0x1f3)](sendInstrumentationEvent,_0x4f5e35,_0x193d5e[_0x28e390(0x1f0)],messageTypes[_0x28e390(0x1e6)],_0x193d5e[_0x28e390(0x20d)],null,_0x4f5e35),process[_0x28e390(0x1fe)](0x1)),_0x193d5e[_0x28e390(0x215)](_0x91168e['statusCode'],0x190)&&(logger[_0x28e390(0x216)](JSON[_0x28e390(0x227)](_0x91168e[_0x28e390(0x1db)])['message']),await _0x193d5e[_0x28e390(0x224)](sendInstrumentationEvent,_0x4f5e35,_0x193d5e['YbaPy'],messageTypes[_0x28e390(0x1e6)],_0x193d5e[_0x28e390(0x1fc)],null,_0x4f5e35),process[_0x28e390(0x1fe)](0x1)),logger[_0x28e390(0x216)](_0x28e390(0x1fd)+JSON[_0x28e390(0x1ec)](_0x91168e)),await _0x193d5e['tGktN'](sendInstrumentationEvent,_0x4f5e35,_0x193d5e['YbaPy'],messageTypes[_0x28e390(0x1e6)],_0x193d5e[_0x28e390(0x214)],_0x91168e,_0x4f5e35),process[_0x28e390(0x1fe)](0x1);}catch(_0x832321){const _0x38af4d=_0x28e390(0x228)+_0x832321+'\x20\x0a'+JSON[_0x28e390(0x1ec)](_0x832321['stack'])+'\x20';logger[_0x28e390(0x216)](_0x38af4d),process[_0x28e390(0x1fe)](0x1);}};