const a21_0x1146ca=a21_0x3b44;(function(_0x534ff6,_0x174666){const _0x3e704a=a21_0x3b44,_0x5917cb=_0x534ff6();while(!![]){try{const _0x1371cd=-parseInt(_0x3e704a(0x19b))/0x1+-parseInt(_0x3e704a(0x1a1))/0x2*(parseInt(_0x3e704a(0x17a))/0x3)+parseInt(_0x3e704a(0x15e))/0x4+-parseInt(_0x3e704a(0x189))/0x5+-parseInt(_0x3e704a(0x17b))/0x6+parseInt(_0x3e704a(0x1a6))/0x7*(parseInt(_0x3e704a(0x19f))/0x8)+-parseInt(_0x3e704a(0x1a4))/0x9*(-parseInt(_0x3e704a(0x193))/0xa);if(_0x1371cd===_0x174666)break;else _0x5917cb['push'](_0x5917cb['shift']());}catch(_0x17c37b){_0x5917cb['push'](_0x5917cb['shift']());}}}(a21_0x5ead,0xb41f1));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x1146ca(0x16d)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x1146ca(0x16f)),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require(a21_0x1146ca(0x16a)),{scaleDownHubDeployment}=require(a21_0x1146ca(0x197)),{sendInstrumentationEvent}=require(a21_0x1146ca(0x1ae)),webSocketUtils=require(a21_0x1146ca(0x17f)),{createK8sClient}=require(a21_0x1146ca(0x1b7)),{getCloudProviderObject}=require(a21_0x1146ca(0x1b1));exports[a21_0x1146ca(0x18f)]=a21_0x1146ca(0x160),exports[a21_0x1146ca(0x1ac)]=a21_0x1146ca(0x1a3),exports[a21_0x1146ca(0x161)]=function(_0x3f26d8){const _0x5cc477=a21_0x1146ca,_0x2b970c={};_0x2b970c[_0x5cc477(0x165)]=_0x5cc477(0x180),_0x2b970c['xgISX']='string',_0x2b970c['OfPxQ']=_0x5cc477(0x198),_0x2b970c[_0x5cc477(0x192)]=_0x5cc477(0x15f),_0x2b970c[_0x5cc477(0x164)]=_0x5cc477(0x19d);const _0x174afd=_0x2b970c,_0x20f0c8={};_0x20f0c8[_0x5cc477(0x187)]=_0x174afd[_0x5cc477(0x165)],_0x20f0c8[_0x5cc477(0x191)]=_0x174afd[_0x5cc477(0x195)];const _0xe59234={};_0xe59234[_0x5cc477(0x187)]=_0x174afd['OfPxQ'],_0xe59234[_0x5cc477(0x191)]=_0x174afd[_0x5cc477(0x192)],_0xe59234[_0x5cc477(0x166)]=![];const _0x17f9b4={};return _0x17f9b4[_0x5cc477(0x18e)]=_0x20f0c8,_0x17f9b4[_0x5cc477(0x171)]=_0xe59234,_0x3f26d8[_0x5cc477(0x199)](HELP_HEADER_MESSAGE[_0x5cc477(0x18b)])['epilogue'](HELP_FOOTER_MESSAGE)[_0x5cc477(0x1a0)](_0x17f9b4)[_0x5cc477(0x19d)](_0x174afd['wpcqM'])[_0x5cc477(0x1a7)];},exports[a21_0x1146ca(0x18d)]=async function(_0xf5000b){const _0x2caaf9=a21_0x1146ca,_0x2c67f9={'lihsz':_0x2caaf9(0x16e),'xYzfe':function(_0xec171a){return _0xec171a();},'HCyiY':_0x2caaf9(0x17d),'TrbaP':function(_0x2facb9,_0x572128,_0x2f9a77,_0x5add10,_0x4df0fa,_0x3b9a4a,_0x3b966f){return _0x2facb9(_0x572128,_0x2f9a77,_0x5add10,_0x4df0fa,_0x3b9a4a,_0x3b966f);},'Lopov':_0x2caaf9(0x188),'jbmJz':_0x2caaf9(0x1b6),'zUuKB':function(_0x54d965,_0x1821e3,_0x2b6e95,_0x221d8e,_0x1c10b4,_0x1eb3a6,_0x241bc4){return _0x54d965(_0x1821e3,_0x2b6e95,_0x221d8e,_0x1c10b4,_0x1eb3a6,_0x241bc4);},'mItJn':_0x2caaf9(0x17e),'fjkau':_0x2caaf9(0x1b9),'vEyxF':'Adding\x20Websocket\x20listeners','dKNwn':function(_0x41fc98,_0x33baba,_0x20a050,_0x2a4d91){return _0x41fc98(_0x33baba,_0x20a050,_0x2a4d91);},'HAIIU':function(_0x3c8bf6,_0x10e6dc,_0x2457e6,_0x25eeeb,_0x32fe22,_0x51c2a7,_0x54a4a3){return _0x3c8bf6(_0x10e6dc,_0x2457e6,_0x25eeeb,_0x32fe22,_0x51c2a7,_0x54a4a3);},'dNcyh':function(_0x4ad4f6,_0x15adec,_0x105161){return _0x4ad4f6(_0x15adec,_0x105161);},'IMnga':_0x2caaf9(0x16b),'uVDJd':function(_0x3ab640,_0x87a44){return _0x3ab640===_0x87a44;},'UNOMR':_0x2caaf9(0x1b0),'JYmWy':function(_0x4ed06f,_0x5256fd,_0x4cc2e1,_0x26a434,_0x9105d9,_0x48643d,_0x20b723){return _0x4ed06f(_0x5256fd,_0x4cc2e1,_0x26a434,_0x9105d9,_0x48643d,_0x20b723);},'WBNSI':_0x2caaf9(0x168),'kdgzv':'invalid-grid-id','EPjia':function(_0x158eea,_0x110f5f,_0x5e1875,_0x2419b7,_0x3ac901,_0x1d786c,_0x40be9c){return _0x158eea(_0x110f5f,_0x5e1875,_0x2419b7,_0x3ac901,_0x1d786c,_0x40be9c);},'grbpd':_0x2caaf9(0x19c)};let _0x20d103;try{!_0xf5000b[_0x2caaf9(0x1af)]&&(logger['error'](_0x2c67f9[_0x2caaf9(0x19e)]),process[_0x2caaf9(0x190)](0x1));!fs[_0x2caaf9(0x1bb)](_0x2c67f9[_0x2caaf9(0x1a2)](getCredentialsPath))&&(logger[_0x2caaf9(0x1a5)](_0x2c67f9[_0x2caaf9(0x1ad)]),await _0x2c67f9[_0x2caaf9(0x174)](sendInstrumentationEvent,_0xf5000b,_0x2c67f9[_0x2caaf9(0x1b4)],messageTypes['ERROR'],_0x2c67f9[_0x2caaf9(0x169)],null,_0xf5000b),process[_0x2caaf9(0x190)](0x1));logger[_0x2caaf9(0x177)](_0x2caaf9(0x1b2)+_0xf5000b['gridId']),await _0x2c67f9[_0x2caaf9(0x162)](sendInstrumentationEvent,_0xf5000b,_0x2c67f9[_0x2caaf9(0x1b4)],messageTypes[_0x2caaf9(0x183)],null,null,_0xf5000b);const _0x4c28d0=JSON[_0x2caaf9(0x182)](fs[_0x2caaf9(0x181)](_0x2c67f9['xYzfe'](getCredentialsPath)));global_registry['bstackUsername']=_0x4c28d0[_0x2caaf9(0x176)][_0x2caaf9(0x172)],global_registry['bstackAccesskey']=_0x4c28d0['Browserstack'][_0x2caaf9(0x15d)];const _0x106618=WS_ENDPOINT[_0x2caaf9(0x1ba)](_0x2c67f9[_0x2caaf9(0x1b8)],_0x4c28d0[_0x2caaf9(0x176)]['username'])['replace'](_0x2c67f9[_0x2caaf9(0x194)],_0x4c28d0[_0x2caaf9(0x176)][_0x2caaf9(0x15d)]),_0x10f629={};_0x10f629[_0x2caaf9(0x1ab)]=ws,_0x10f629[_0x2caaf9(0x179)]=0x36ee80,_0x20d103=new ReconnectingWebSocket(_0x106618,[],_0x10f629),logger['debug'](_0x2c67f9['vEyxF']),webSocketUtils['addListeners'](_0x20d103,_0xf5000b['user'],_0xf5000b['password']);const [_0x42c15c,_0x4924bc]=await _0x2c67f9['dKNwn'](getGridDetails,_0x4c28d0['Browserstack'][_0x2caaf9(0x172)],_0x4c28d0[_0x2caaf9(0x176)][_0x2caaf9(0x15d)],_0xf5000b['gridId']);if(_0x4924bc){const _0x41926b=_0x4924bc[_0x2caaf9(0x177)];global_registry[_0x2caaf9(0x173)]=_0x41926b[_0x2caaf9(0x173)],global_registry[_0x2caaf9(0x19a)]=_0x41926b['region'],global_registry[_0x2caaf9(0x18a)]=_0x41926b[_0x2caaf9(0x18a)];const _0x1153a3=await _0x2c67f9[_0x2caaf9(0x186)](getCloudProviderObject,_0x41926b[_0x2caaf9(0x173)],_0x41926b[_0x2caaf9(0x18a)],_0x41926b[_0x2caaf9(0x17c)],_0x20d103,webSocketUtils,_0xf5000b),[_0x3d359d,_0x255c4f,_0x42134e,_0x1b048d,_0x52d986,_0x15bfd4]=await _0x2c67f9[_0x2caaf9(0x1b3)](createK8sClient,_0x1153a3,_0xf5000b[_0x2caaf9(0x163)]);await _0x2c67f9[_0x2caaf9(0x1b3)](scaleDownHubDeployment,_0x255c4f,_0x41926b[_0x2caaf9(0x17c)]),logger['info'](_0x2c67f9[_0x2caaf9(0x16c)]),process['exit'](0x0);}_0x2c67f9[_0x2caaf9(0x1a8)](_0x42c15c[_0x2caaf9(0x185)],0x191)&&(logger['error'](_0x2c67f9[_0x2caaf9(0x1a9)]),await _0x2c67f9[_0x2caaf9(0x196)](sendInstrumentationEvent,_0xf5000b,_0x2c67f9[_0x2caaf9(0x1b4)],messageTypes[_0x2caaf9(0x1aa)],_0x2c67f9[_0x2caaf9(0x1b5)],null,_0xf5000b),process['exit'](0x1)),_0x2c67f9['uVDJd'](_0x42c15c[_0x2caaf9(0x185)],0x190)&&(logger[_0x2caaf9(0x1a5)](JSON[_0x2caaf9(0x182)](_0x42c15c[_0x2caaf9(0x170)])[_0x2caaf9(0x18c)]),await _0x2c67f9['HAIIU'](sendInstrumentationEvent,_0xf5000b,_0x2c67f9[_0x2caaf9(0x1b4)],messageTypes[_0x2caaf9(0x1aa)],_0x2c67f9['kdgzv'],null,_0xf5000b),process[_0x2caaf9(0x190)](0x1)),logger['error'](_0x2caaf9(0x167)+JSON[_0x2caaf9(0x175)](_0x42c15c)),await _0x2c67f9[_0x2caaf9(0x178)](sendInstrumentationEvent,_0xf5000b,_0x2c67f9[_0x2caaf9(0x1b4)],messageTypes['ERROR'],_0x2c67f9['grbpd'],_0x42c15c,_0xf5000b),process[_0x2caaf9(0x190)](0x1);}catch(_0x4d6659){const _0x20249a=_0x2caaf9(0x184)+_0x4d6659+'\x20\x0a'+JSON[_0x2caaf9(0x175)](_0x4d6659['stack'])+'\x20';logger['error'](_0x20249a),process[_0x2caaf9(0x190)](0x1);}};function a21_0x3b44(_0x5584b2,_0x553b7b){const _0x5eadf4=a21_0x5ead();return a21_0x3b44=function(_0x3b440b,_0x20a52e){_0x3b440b=_0x3b440b-0x15d;let _0x4cd797=_0x5eadf4[_0x3b440b];return _0x4cd797;},a21_0x3b44(_0x5584b2,_0x553b7b);}function a21_0x5ead(){const _0x262dce=['unauthorised','jbmJz','../../utils/utilityMethods','Grid\x20stoppped.','IMnga','reconnecting-websocket','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','../../config/constants','body','skip-tls-cert-verify','username','cloudProvider','TrbaP','stringify','Browserstack','info','EPjia','connectionTimeout','45hreFrX','5601492kLdynW','name','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','<UsernamePlaceholder>','../../utils/webSocketUtils','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','readFileSync','parse','INFO','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','statusCode','HAIIU','description','stop-grid-called','1994440lWXuzm','clusterName','stop','message','handler','grid-id','command','exit','type','OWVhP','155840zTeauR','fjkau','xgISX','JYmWy','../../utils/gridComponents','Skip\x20insecure\x20cert\x20verification.','usage','clusterRegion','424930dTKypH','server-error','help','lihsz','8JbRJTO','options','152858zhfRFh','xYzfe','Stop\x20a\x20running\x20Automation\x20grid.','1791CDZCkv','error','682521HLNYfO','argv','uVDJd','UNOMR','ERROR','WebSocket','desc','HCyiY','../../utils/instrumentationUtils','gridId','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','../../cloudproviders/utils','Stopping\x20grid\x20','dNcyh','Lopov','WBNSI','init-not-called','../../utils/createk8sClient','mItJn','<PasswordPlaceholder>','replace','existsSync','password','1771572HBJVFr','boolean','grid','builder','zUuKB','skipTlsCertVerify','wpcqM','XQXMh','default','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20'];a21_0x5ead=function(){return _0x262dce;};return a21_0x5ead();}