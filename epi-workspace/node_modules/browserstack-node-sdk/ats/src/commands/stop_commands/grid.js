const a21_0x345ae4=a21_0x4deb;function a21_0x5685(){const _0x289462=['addListeners','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','Stopping\x20grid\x20','huCZV','grid-id','grid','INFO','../../utils/gridComponents','epilogue','../../cloudproviders/utils','NKALb','Stop\x20a\x20running\x20Automation\x20grid.','../../utils/instrumentationUtils','234899OxfZvw','info','<PasswordPlaceholder>','message','3789010uKgBsM','XaBSk','gridId','argv','cloudProvider','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','desc','default','skipTlsCertVerify','bstackUsername','1834bWHKBh','region','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','stringify','QuhXF','stop-grid-called','unauthorised','Browserstack','clusterName','options','pgwTw','init-not-called','DgzmV','description','invalid-grid-id','connectionTimeout','user','debug','clusterRegion','../../config/constants','skip-tls-cert-verify','name','error','../../utils/webSocketUtils','184onZzVt','readFileSync','12654414NHZPLJ','existsSync','2379TEJaCG','eOQlT','ILztD','joIsS','usage','help','axTCB','<UsernamePlaceholder>','exit','handler','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','fLUlx','password','adYfU','type','statusCode','Skip\x20insecure\x20cert\x20verification.','Grid\x20stoppped.','parse','WebSocket','XuFDG','username','296668sEIPpi','2431080AlzsDz','QxpWa','kaOCw','ERROR','body','../../utils/utilityMethods','99034WARvDb','boolean','WGnAO','HyVrR','replace','../../utils/createk8sClient','XTekT','string'];a21_0x5685=function(){return _0x289462;};return a21_0x5685();}(function(_0x3e0fbf,_0x20a41a){const _0x2614f2=a21_0x4deb,_0xf5c314=_0x3e0fbf();while(!![]){try{const _0x31b84f=parseInt(_0x2614f2(0xe0))/0x1+-parseInt(_0x2614f2(0xa7))/0x2*(parseInt(_0x2614f2(0xc3))/0x3)+parseInt(_0x2614f2(0xd9))/0x4+parseInt(_0x2614f2(0x9d))/0x5+-parseInt(_0x2614f2(0xda))/0x6+parseInt(_0x2614f2(0x99))/0x7*(-parseInt(_0x2614f2(0xbf))/0x8)+parseInt(_0x2614f2(0xc1))/0x9;if(_0x31b84f===_0x20a41a)break;else _0xf5c314['push'](_0xf5c314['shift']());}catch(_0x19f7d4){_0xf5c314['push'](_0xf5c314['shift']());}}}(a21_0x5685,0x69aed));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x345ae4(0xba)),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require(a21_0x345ae4(0xdf)),{scaleDownHubDeployment}=require(a21_0x345ae4(0x93)),{sendInstrumentationEvent}=require(a21_0x345ae4(0x98)),webSocketUtils=require(a21_0x345ae4(0xbe)),{createK8sClient}=require(a21_0x345ae4(0xe5)),{getCloudProviderObject}=require(a21_0x345ae4(0x95));function a21_0x4deb(_0x2a70ab,_0x45e003){const _0x56858c=a21_0x5685();return a21_0x4deb=function(_0x4deb78,_0x498f7d){_0x4deb78=_0x4deb78-0x91;let _0x1ea2ad=_0x56858c[_0x4deb78];return _0x1ea2ad;},a21_0x4deb(_0x2a70ab,_0x45e003);}exports['command']=a21_0x345ae4(0x91),exports[a21_0x345ae4(0xa3)]=a21_0x345ae4(0x97),exports['builder']=function(_0x4c79b4){const _0x1342b5=a21_0x345ae4,_0x3a6eb2={};_0x3a6eb2[_0x1342b5(0xe6)]=_0x1342b5(0xa2),_0x3a6eb2[_0x1342b5(0xc9)]=_0x1342b5(0xe7),_0x3a6eb2[_0x1342b5(0xeb)]=_0x1342b5(0xd3),_0x3a6eb2[_0x1342b5(0xe3)]=_0x1342b5(0xe1),_0x3a6eb2[_0x1342b5(0x9e)]=_0x1342b5(0xc8);const _0x2a0a7a=_0x3a6eb2,_0x1a80ee={};_0x1a80ee[_0x1342b5(0xb4)]=_0x2a0a7a['XTekT'],_0x1a80ee[_0x1342b5(0xd1)]=_0x2a0a7a[_0x1342b5(0xc9)];const _0x57d73e={};_0x57d73e[_0x1342b5(0xb4)]=_0x2a0a7a['huCZV'],_0x57d73e['type']=_0x2a0a7a[_0x1342b5(0xe3)],_0x57d73e[_0x1342b5(0xa4)]=![];const _0x4796d7={};return _0x4796d7[_0x1342b5(0xec)]=_0x1a80ee,_0x4796d7[_0x1342b5(0xbb)]=_0x57d73e,_0x4c79b4[_0x1342b5(0xc7)](HELP_HEADER_MESSAGE['stop'])[_0x1342b5(0x94)](HELP_FOOTER_MESSAGE)[_0x1342b5(0xb0)](_0x4796d7)[_0x1342b5(0xc8)](_0x2a0a7a[_0x1342b5(0x9e)])[_0x1342b5(0xa0)];},exports[a21_0x345ae4(0xcc)]=async function(_0x57ae1c){const _0x24be98=a21_0x345ae4,_0x54b797={'kaOCw':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','ILztD':function(_0x2403fc){return _0x2403fc();},'VDYQI':_0x24be98(0xcd),'NKALb':function(_0x1ad020,_0x5b2682,_0x13f387,_0x4b2e56,_0x59e4eb,_0x5bcdd1,_0x146e01){return _0x1ad020(_0x5b2682,_0x13f387,_0x4b2e56,_0x59e4eb,_0x5bcdd1,_0x146e01);},'XuFDG':_0x24be98(0xac),'QxpWa':_0x24be98(0xb2),'pgwTw':_0x24be98(0xca),'WGnAO':_0x24be98(0x9b),'QuhXF':'Adding\x20Websocket\x20listeners','eOQlT':function(_0x4adc7f,_0x2e741b,_0x13fc32,_0x5da7e3){return _0x4adc7f(_0x2e741b,_0x13fc32,_0x5da7e3);},'Urcfp':function(_0x5bda9d,_0x7238f5,_0x1bb4a1){return _0x5bda9d(_0x7238f5,_0x1bb4a1);},'joIsS':_0x24be98(0xd4),'adYfU':function(_0x1773f0,_0x411dd8){return _0x1773f0===_0x411dd8;},'tQbTC':'Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','KrorJ':_0x24be98(0xad),'fLUlx':function(_0xdd6bb2,_0x20a4bc,_0x56a0f5,_0x3b1e82,_0x15d36d,_0x1f03e9,_0x3aae43){return _0xdd6bb2(_0x20a4bc,_0x56a0f5,_0x3b1e82,_0x15d36d,_0x1f03e9,_0x3aae43);},'DgzmV':_0x24be98(0xb5),'Ociol':'server-error'};let _0x17be88;try{!_0x57ae1c['gridId']&&(logger[_0x24be98(0xbd)](_0x54b797[_0x24be98(0xdc)]),process[_0x24be98(0xcb)](0x1));!fs[_0x24be98(0xc2)](_0x54b797[_0x24be98(0xc5)](getCredentialsPath))&&(logger[_0x24be98(0xbd)](_0x54b797['VDYQI']),await _0x54b797['NKALb'](sendInstrumentationEvent,_0x57ae1c,_0x54b797[_0x24be98(0xd7)],messageTypes['ERROR'],_0x54b797[_0x24be98(0xdb)],null,_0x57ae1c),process['exit'](0x1));logger[_0x24be98(0x9a)](_0x24be98(0xea)+_0x57ae1c[_0x24be98(0x9f)]),await _0x54b797['NKALb'](sendInstrumentationEvent,_0x57ae1c,_0x54b797[_0x24be98(0xd7)],messageTypes[_0x24be98(0x92)],null,null,_0x57ae1c);const _0x8e8517=JSON[_0x24be98(0xd5)](fs[_0x24be98(0xc0)](_0x54b797[_0x24be98(0xc5)](getCredentialsPath)));global_registry[_0x24be98(0xa6)]=_0x8e8517[_0x24be98(0xae)][_0x24be98(0xd8)],global_registry['bstackAccesskey']=_0x8e8517[_0x24be98(0xae)][_0x24be98(0xcf)];const _0x2df5a8=WS_ENDPOINT[_0x24be98(0xe4)](_0x54b797[_0x24be98(0xb1)],_0x8e8517[_0x24be98(0xae)][_0x24be98(0xd8)])['replace'](_0x54b797[_0x24be98(0xe2)],_0x8e8517[_0x24be98(0xae)]['password']),_0x4852be={};_0x4852be[_0x24be98(0xd6)]=ws,_0x4852be[_0x24be98(0xb6)]=0x36ee80,_0x17be88=new ReconnectingWebSocket(_0x2df5a8,[],_0x4852be),logger[_0x24be98(0xb8)](_0x54b797[_0x24be98(0xab)]),webSocketUtils[_0x24be98(0xe8)](_0x17be88,_0x57ae1c[_0x24be98(0xb7)],_0x57ae1c['password']);const [_0x40ccd1,_0x4b632d]=await _0x54b797[_0x24be98(0xc4)](getGridDetails,_0x8e8517['Browserstack']['username'],_0x8e8517[_0x24be98(0xae)][_0x24be98(0xcf)],_0x57ae1c[_0x24be98(0x9f)]);if(_0x4b632d){const _0x4c5c38=_0x4b632d[_0x24be98(0x9a)];global_registry[_0x24be98(0xa1)]=_0x4c5c38[_0x24be98(0xa1)],global_registry[_0x24be98(0xb9)]=_0x4c5c38[_0x24be98(0xa8)],global_registry[_0x24be98(0xaf)]=_0x4c5c38[_0x24be98(0xaf)];const _0x56c709=await _0x54b797[_0x24be98(0x96)](getCloudProviderObject,_0x4c5c38[_0x24be98(0xa1)],_0x4c5c38['clusterName'],_0x4c5c38[_0x24be98(0xbc)],_0x17be88,webSocketUtils,_0x57ae1c),[_0x5eb063,_0x2a6b89,_0x355c59,_0x30f7e1,_0x3c45f2,_0x12ab76]=await _0x54b797['Urcfp'](createK8sClient,_0x56c709,_0x57ae1c[_0x24be98(0xa5)]);await _0x54b797['Urcfp'](scaleDownHubDeployment,_0x2a6b89,_0x4c5c38[_0x24be98(0xbc)]),logger[_0x24be98(0x9a)](_0x54b797[_0x24be98(0xc6)]),process[_0x24be98(0xcb)](0x0);}_0x54b797[_0x24be98(0xd0)](_0x40ccd1[_0x24be98(0xd2)],0x191)&&(logger[_0x24be98(0xbd)](_0x54b797['tQbTC']),await _0x54b797[_0x24be98(0x96)](sendInstrumentationEvent,_0x57ae1c,_0x54b797['XuFDG'],messageTypes[_0x24be98(0xdd)],_0x54b797['KrorJ'],null,_0x57ae1c),process[_0x24be98(0xcb)](0x1)),_0x54b797[_0x24be98(0xd0)](_0x40ccd1[_0x24be98(0xd2)],0x190)&&(logger['error'](JSON[_0x24be98(0xd5)](_0x40ccd1[_0x24be98(0xde)])[_0x24be98(0x9c)]),await _0x54b797[_0x24be98(0xce)](sendInstrumentationEvent,_0x57ae1c,_0x54b797[_0x24be98(0xd7)],messageTypes[_0x24be98(0xdd)],_0x54b797[_0x24be98(0xb3)],null,_0x57ae1c),process[_0x24be98(0xcb)](0x1)),logger[_0x24be98(0xbd)](_0x24be98(0xa9)+JSON[_0x24be98(0xaa)](_0x40ccd1)),await _0x54b797[_0x24be98(0xce)](sendInstrumentationEvent,_0x57ae1c,_0x54b797['XuFDG'],messageTypes[_0x24be98(0xdd)],_0x54b797['Ociol'],_0x40ccd1,_0x57ae1c),process['exit'](0x1);}catch(_0x3d8643){const _0x25ddac=_0x24be98(0xe9)+_0x3d8643+'\x20\x0a'+JSON['stringify'](_0x3d8643['stack'])+'\x20';logger[_0x24be98(0xbd)](_0x25ddac),process[_0x24be98(0xcb)](0x1);}};