const a21_0x9c4b21=a21_0x1a0a;function a21_0x2241(){const _0x40f19a=['Stop\x20a\x20running\x20Automation\x20grid.','stringify','statusCode','replace','jbhoi','lOBeQ','../../utils/instrumentationUtils','existsSync','KLmuL','username','117iNJakW','KUwld','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','WeBqA','parse','Adding\x20Websocket\x20listeners','pofOh','stop-grid-called','<UsernamePlaceholder>','WebSocket','kdTys','BwQgV','751212RNFikL','Grid\x20stoppped.','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','addListeners','region','543545xxFjpE','connectionTimeout','unauthorised','ERROR','string','exit','password','../../config/logger','7098980orXFAK','init-not-called','../../utils/createk8sClient','yKFOm','abEya','Stopping\x20grid\x20','QtxGW','IWEya','29931wdiRte','SCjvy','xeljh','ypFlZ','skip-tls-cert-verify','server-error','../../utils/webSocketUtils','debug','INFO','builder','desc','gridId','handler','9657228QSixwa','EDbrC','clusterRegion','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','xNrvS','readFileSync','CLUrx','body','2453592mgnnie','grid','stack','cloudProvider','message','6166440mmvTSd','skipTlsCertVerify','user','stop','description','CGcvM','dzXEI','tlWxv','boolean','xbdIW','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','type','../../config/constants','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','argv','Skip\x20insecure\x20cert\x20verification.','hrLhV','YGtkc','info','Browserstack','command','106eiVsAM','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','error','name','<PasswordPlaceholder>','help','clusterName','../../cloudproviders/utils'];a21_0x2241=function(){return _0x40f19a;};return a21_0x2241();}function a21_0x1a0a(_0xf25082,_0x1e748e){const _0x2241a0=a21_0x2241();return a21_0x1a0a=function(_0x1a0aff,_0x4c786f){_0x1a0aff=_0x1a0aff-0x8c;let _0x200f3d=_0x2241a0[_0x1a0aff];return _0x200f3d;},a21_0x1a0a(_0xf25082,_0x1e748e);}(function(_0x4d109c,_0x266481){const _0x57094e=a21_0x1a0a,_0x2e28ae=_0x4d109c();while(!![]){try{const _0xa433f=parseInt(_0x57094e(0xe7))/0x1+parseInt(_0x57094e(0xc4))/0x2*(parseInt(_0x57094e(0x95))/0x3)+-parseInt(_0x57094e(0xaf))/0x4+-parseInt(_0x57094e(0x8d))/0x5+parseInt(_0x57094e(0xe2))/0x6+-parseInt(_0x57094e(0xa2))/0x7+-parseInt(_0x57094e(0xaa))/0x8*(-parseInt(_0x57094e(0xd6))/0x9);if(_0xa433f===_0x266481)break;else _0x2e28ae['push'](_0x2e28ae['shift']());}catch(_0x22dc3d){_0x2e28ae['push'](_0x2e28ae['shift']());}}}(a21_0x2241,0xcdf55));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x9c4b21(0xbb)),{logger}=require(a21_0x9c4b21(0x8c)),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require(a21_0x9c4b21(0xd2)),webSocketUtils=require(a21_0x9c4b21(0x9b)),{createK8sClient}=require(a21_0x9c4b21(0x8f)),{getCloudProviderObject}=require(a21_0x9c4b21(0xcb));exports[a21_0x9c4b21(0xc3)]=a21_0x9c4b21(0xab),exports[a21_0x9c4b21(0x9f)]=a21_0x9c4b21(0xcc),exports[a21_0x9c4b21(0x9e)]=function(_0x1a4eaf){const _0x58377c=a21_0x9c4b21,_0x1191db={};_0x1191db[_0x58377c(0xc0)]=_0x58377c(0xc5),_0x1191db[_0x58377c(0xbf)]=_0x58377c(0xeb),_0x1191db[_0x58377c(0x94)]=_0x58377c(0xbe),_0x1191db['xeljh']=_0x58377c(0xb7),_0x1191db[_0x58377c(0xb8)]=_0x58377c(0xc9);const _0x2bc1f3=_0x1191db,_0x110bab={};_0x110bab[_0x58377c(0xb3)]=_0x2bc1f3['YGtkc'],_0x110bab['type']=_0x2bc1f3[_0x58377c(0xbf)];const _0x26e88c={};_0x26e88c['description']=_0x2bc1f3[_0x58377c(0x94)],_0x26e88c[_0x58377c(0xba)]=_0x2bc1f3[_0x58377c(0x97)],_0x26e88c['default']=![];const _0x5b3e6={};return _0x5b3e6['grid-id']=_0x110bab,_0x5b3e6[_0x58377c(0x99)]=_0x26e88c,_0x1a4eaf['usage'](HELP_HEADER_MESSAGE[_0x58377c(0xb2)])['epilogue'](HELP_FOOTER_MESSAGE)['options'](_0x5b3e6)[_0x58377c(0xc9)](_0x2bc1f3[_0x58377c(0xb8)])[_0x58377c(0xbd)];},exports[a21_0x9c4b21(0xa1)]=async function(_0x5b093a){const _0xc079a2=a21_0x9c4b21,_0x66803d={'BYUTr':_0xc079a2(0xd8),'pofOh':function(_0x4880d6){return _0x4880d6();},'CGcvM':_0xc079a2(0xe4),'WeBqA':function(_0xd1a15e,_0x47804f,_0x2a9a03,_0x1f97ba,_0x5d7190,_0x176142,_0x2ebeec){return _0xd1a15e(_0x47804f,_0x2a9a03,_0x1f97ba,_0x5d7190,_0x176142,_0x2ebeec);},'abEya':_0xc079a2(0xdd),'tlWxv':_0xc079a2(0x8e),'BwQgV':function(_0xf7493,_0x23ef7c,_0xf79cce,_0x1233b4,_0x51194e,_0x2904f8,_0x2b5976){return _0xf7493(_0x23ef7c,_0xf79cce,_0x1233b4,_0x51194e,_0x2904f8,_0x2b5976);},'lOBeQ':function(_0x4cb277){return _0x4cb277();},'QtxGW':_0xc079a2(0xde),'kdTys':_0xc079a2(0xc8),'dzXEI':_0xc079a2(0xdb),'KUwld':function(_0x568e52,_0x58a1ac,_0xd859cf,_0x22b8c5){return _0x568e52(_0x58a1ac,_0xd859cf,_0x22b8c5);},'jbhoi':function(_0x524b74,_0x258b2b,_0x14014e){return _0x524b74(_0x258b2b,_0x14014e);},'EDbrC':_0xc079a2(0xe3),'KLmuL':function(_0x1c80d4,_0x4b3b94){return _0x1c80d4===_0x4b3b94;},'ypFlZ':_0xc079a2(0xbc),'yKFOm':function(_0x4f80fb,_0x388fb2,_0x4b0a48,_0x3b8cdf,_0x41b767,_0x2de475,_0x280ebb){return _0x4f80fb(_0x388fb2,_0x4b0a48,_0x3b8cdf,_0x41b767,_0x2de475,_0x280ebb);},'SCjvy':_0xc079a2(0xe9),'CLUrx':'invalid-grid-id','xNrvS':_0xc079a2(0x9a)};let _0x4b9212;try{!_0x5b093a[_0xc079a2(0xa0)]&&(logger['error'](_0x66803d['BYUTr']),process[_0xc079a2(0xec)](0x1));!fs[_0xc079a2(0xd3)](_0x66803d[_0xc079a2(0xdc)](getCredentialsPath))&&(logger[_0xc079a2(0xc6)](_0x66803d[_0xc079a2(0xb4)]),await _0x66803d[_0xc079a2(0xd9)](sendInstrumentationEvent,_0x5b093a,_0x66803d['abEya'],messageTypes['ERROR'],_0x66803d[_0xc079a2(0xb6)],null,_0x5b093a),process[_0xc079a2(0xec)](0x1));logger[_0xc079a2(0xc1)](_0xc079a2(0x92)+_0x5b093a['gridId']),await _0x66803d['BwQgV'](sendInstrumentationEvent,_0x5b093a,_0x66803d['abEya'],messageTypes[_0xc079a2(0x9d)],null,null,_0x5b093a);const _0x1d09fd=JSON[_0xc079a2(0xda)](fs[_0xc079a2(0xa7)](_0x66803d[_0xc079a2(0xd1)](getCredentialsPath)));global_registry['bstackUsername']=_0x1d09fd[_0xc079a2(0xc2)][_0xc079a2(0xd5)],global_registry['bstackAccesskey']=_0x1d09fd[_0xc079a2(0xc2)][_0xc079a2(0xed)];const _0x3c33b5=WS_ENDPOINT['replace'](_0x66803d[_0xc079a2(0x93)],_0x1d09fd['Browserstack'][_0xc079a2(0xd5)])[_0xc079a2(0xcf)](_0x66803d[_0xc079a2(0xe0)],_0x1d09fd['Browserstack'][_0xc079a2(0xed)]),_0x244e07={};_0x244e07[_0xc079a2(0xdf)]=ws,_0x244e07[_0xc079a2(0xe8)]=0x36ee80,_0x4b9212=new ReconnectingWebSocket(_0x3c33b5,[],_0x244e07),logger[_0xc079a2(0x9c)](_0x66803d[_0xc079a2(0xb5)]),webSocketUtils[_0xc079a2(0xe5)](_0x4b9212,_0x5b093a[_0xc079a2(0xb1)],_0x5b093a[_0xc079a2(0xed)]);const [_0x4836cd,_0x45926c]=await _0x66803d[_0xc079a2(0xd7)](getGridDetails,_0x1d09fd[_0xc079a2(0xc2)][_0xc079a2(0xd5)],_0x1d09fd[_0xc079a2(0xc2)][_0xc079a2(0xed)],_0x5b093a['gridId']);if(_0x45926c){const _0xf03fc0=_0x45926c[_0xc079a2(0xc1)];global_registry['cloudProvider']=_0xf03fc0['cloudProvider'],global_registry[_0xc079a2(0xa4)]=_0xf03fc0[_0xc079a2(0xe6)],global_registry[_0xc079a2(0xca)]=_0xf03fc0[_0xc079a2(0xca)];const _0x3ecb65=await _0x66803d['BwQgV'](getCloudProviderObject,_0xf03fc0[_0xc079a2(0xad)],_0xf03fc0['clusterName'],_0xf03fc0[_0xc079a2(0xc7)],_0x4b9212,webSocketUtils,_0x5b093a),[_0x181c17,_0x4df068,_0x348e01,_0x502622,_0x1b3d2c,_0x5ed352]=await _0x66803d[_0xc079a2(0xd0)](createK8sClient,_0x3ecb65,_0x5b093a[_0xc079a2(0xb0)]);await _0x66803d[_0xc079a2(0xd0)](scaleDownHubDeployment,_0x4df068,_0xf03fc0[_0xc079a2(0xc7)]),logger[_0xc079a2(0xc1)](_0x66803d[_0xc079a2(0xa3)]),process['exit'](0x0);}_0x66803d[_0xc079a2(0xd4)](_0x4836cd[_0xc079a2(0xce)],0x191)&&(logger['error'](_0x66803d[_0xc079a2(0x98)]),await _0x66803d[_0xc079a2(0x90)](sendInstrumentationEvent,_0x5b093a,_0x66803d['abEya'],messageTypes[_0xc079a2(0xea)],_0x66803d[_0xc079a2(0x96)],null,_0x5b093a),process['exit'](0x1)),_0x66803d[_0xc079a2(0xd4)](_0x4836cd[_0xc079a2(0xce)],0x190)&&(logger[_0xc079a2(0xc6)](JSON[_0xc079a2(0xda)](_0x4836cd[_0xc079a2(0xa9)])[_0xc079a2(0xae)]),await _0x66803d[_0xc079a2(0x90)](sendInstrumentationEvent,_0x5b093a,_0x66803d[_0xc079a2(0x91)],messageTypes['ERROR'],_0x66803d[_0xc079a2(0xa8)],null,_0x5b093a),process[_0xc079a2(0xec)](0x1)),logger[_0xc079a2(0xc6)](_0xc079a2(0xa5)+JSON[_0xc079a2(0xcd)](_0x4836cd)),await _0x66803d[_0xc079a2(0xe1)](sendInstrumentationEvent,_0x5b093a,_0x66803d[_0xc079a2(0x91)],messageTypes[_0xc079a2(0xea)],_0x66803d[_0xc079a2(0xa6)],_0x4836cd,_0x5b093a),process['exit'](0x1);}catch(_0x4d15d4){const _0x14d8d5=_0xc079a2(0xb9)+_0x4d15d4+'\x20\x0a'+JSON[_0xc079a2(0xcd)](_0x4d15d4[_0xc079a2(0xac)])+'\x20';logger['error'](_0x14d8d5),process[_0xc079a2(0xec)](0x1);}};