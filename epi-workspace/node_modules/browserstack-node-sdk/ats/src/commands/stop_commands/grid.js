const a21_0x7f086b=a21_0x5b42;(function(_0x13cc2f,_0x32e586){const _0x339a34=a21_0x5b42,_0x54f654=_0x13cc2f();while(!![]){try{const _0x108c92=parseInt(_0x339a34(0x1e6))/0x1+-parseInt(_0x339a34(0x1db))/0x2+-parseInt(_0x339a34(0x1a2))/0x3+parseInt(_0x339a34(0x1aa))/0x4*(parseInt(_0x339a34(0x195))/0x5)+parseInt(_0x339a34(0x1cb))/0x6+parseInt(_0x339a34(0x196))/0x7*(-parseInt(_0x339a34(0x1d0))/0x8)+-parseInt(_0x339a34(0x1be))/0x9*(-parseInt(_0x339a34(0x1b9))/0xa);if(_0x108c92===_0x32e586)break;else _0x54f654['push'](_0x54f654['shift']());}catch(_0x42623d){_0x54f654['push'](_0x54f654['shift']());}}}(a21_0x54aa,0xa23af));function a21_0x5b42(_0x6ea7cc,_0x8698f9){const _0x54aa53=a21_0x54aa();return a21_0x5b42=function(_0x5b4258,_0x2f4965){_0x5b4258=_0x5b4258-0x195;let _0x211701=_0x54aa53[_0x5b4258];return _0x211701;},a21_0x5b42(_0x6ea7cc,_0x8698f9);}function a21_0x54aa(){const _0x239e61=['../../utils/webSocketUtils','clusterName','wraNm','bnxQa','5619304lGvDxG','AdOAH','uTcJu','../../cloudproviders/utils','type','help','Stop\x20a\x20running\x20Automation\x20grid.','../../utils/createk8sClient','default','argv','server-error','1558554KaPScy','../../config/constants','password','replace','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','Stopping\x20grid\x20','message','RMjND','stack','Skip\x20insecure\x20cert\x20verification.','options','146775GAZcdF','desc','5225EcnEhG','7DoFBto','boolean','noElD','reconnecting-websocket','VdloB','kOuDY','Ocqmb','unauthorised','<PasswordPlaceholder>','../../utils/utilityMethods','ucxrV','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','2783424nOWOwX','clusterRegion','debug','../../utils/instrumentationUtils','user','UgDxl','body','GLQVb','3176TLtkDL','bstackUsername','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','username','exit','description','Browserstack','bstackAccesskey','Ggkgg','command','CbVEU','WebSocket','init-not-called','mbzqH','gridId','144770ZcXFJG','grid-id','tkDyo','error','statusCode','945htXpXf','name','ERROR','connectionTimeout','wyMjO','../../utils/gridComponents','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','kOOky','cloudProvider','existsSync','parse','<UsernamePlaceholder>','bucNO','3464418MbROOt'];a21_0x54aa=function(){return _0x239e61;};return a21_0x54aa();}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x7f086b(0x199)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x7f086b(0x1dc)),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require(a21_0x7f086b(0x19f)),{scaleDownHubDeployment}=require(a21_0x7f086b(0x1c3)),{sendInstrumentationEvent}=require(a21_0x7f086b(0x1a5)),webSocketUtils=require(a21_0x7f086b(0x1cc)),{createK8sClient}=require(a21_0x7f086b(0x1d7)),{getCloudProviderObject}=require(a21_0x7f086b(0x1d3));exports[a21_0x7f086b(0x1b3)]='grid',exports[a21_0x7f086b(0x1e7)]=a21_0x7f086b(0x1d6),exports['builder']=function(_0x34f80e){const _0x324e6e=a21_0x7f086b,_0x4ab722={};_0x4ab722[_0x324e6e(0x1a9)]=_0x324e6e(0x1ac),_0x4ab722['Ggkgg']='string',_0x4ab722[_0x324e6e(0x1ce)]=_0x324e6e(0x1e4),_0x4ab722[_0x324e6e(0x19c)]=_0x324e6e(0x197),_0x4ab722[_0x324e6e(0x1bb)]=_0x324e6e(0x1d5);const _0xacf454=_0x4ab722,_0x4b1973={};_0x4b1973[_0x324e6e(0x1af)]=_0xacf454['GLQVb'],_0x4b1973[_0x324e6e(0x1d4)]=_0xacf454[_0x324e6e(0x1b2)];const _0x11e909={};_0x11e909['description']=_0xacf454[_0x324e6e(0x1ce)],_0x11e909[_0x324e6e(0x1d4)]=_0xacf454[_0x324e6e(0x19c)],_0x11e909[_0x324e6e(0x1d8)]=![];const _0x4e33a2={};return _0x4e33a2[_0x324e6e(0x1ba)]=_0x4b1973,_0x4e33a2['skip-tls-cert-verify']=_0x11e909,_0x34f80e['usage'](HELP_HEADER_MESSAGE['stop'])['epilogue'](HELP_FOOTER_MESSAGE)[_0x324e6e(0x1e5)](_0x4e33a2)[_0x324e6e(0x1d5)](_0xacf454[_0x324e6e(0x1bb)])[_0x324e6e(0x1d9)];},exports['handler']=async function(_0x1ba2ef){const _0x27e2ce=a21_0x7f086b,_0x312dab={'UgDxl':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','bmvYX':function(_0x4a75ac){return _0x4a75ac();},'dlKQu':_0x27e2ce(0x1c4),'VdloB':function(_0x2e0321,_0x3c935b,_0xaa6273,_0x4514a3,_0x5b0277,_0x19ed11,_0x3b6399){return _0x2e0321(_0x3c935b,_0xaa6273,_0x4514a3,_0x5b0277,_0x19ed11,_0x3b6399);},'kOuDY':'stop-grid-called','gYcEh':_0x27e2ce(0x1b6),'noElD':function(_0x597430){return _0x597430();},'kOOky':_0x27e2ce(0x1c9),'XJpIY':_0x27e2ce(0x19e),'bnxQa':'Adding\x20Websocket\x20listeners','JeAft':function(_0x52db9b,_0x54d712,_0x468b21,_0x597328){return _0x52db9b(_0x54d712,_0x468b21,_0x597328);},'mbzqH':function(_0x530a8b,_0x122bb8,_0x4a5bfb,_0x2658ed,_0x59dd79,_0xe73d1d,_0x35d81c){return _0x530a8b(_0x122bb8,_0x4a5bfb,_0x2658ed,_0x59dd79,_0xe73d1d,_0x35d81c);},'WWwHF':function(_0x4df6cb,_0x4acae8,_0x1f9f62){return _0x4df6cb(_0x4acae8,_0x1f9f62);},'RMjND':function(_0x517974,_0x49b81b,_0xb59345){return _0x517974(_0x49b81b,_0xb59345);},'wyMjO':'Grid\x20stoppped.','CHsGN':function(_0x1dba3f,_0x383d84){return _0x1dba3f===_0x383d84;},'pEJXQ':'Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','uTcJu':_0x27e2ce(0x19d),'CbVEU':function(_0x38db6a,_0xca2e14){return _0x38db6a===_0xca2e14;},'ucxrV':function(_0x50a672,_0x5ba469,_0x19fdaf,_0x57e249,_0x3b1917,_0x41d047,_0x5051a9){return _0x50a672(_0x5ba469,_0x19fdaf,_0x57e249,_0x3b1917,_0x41d047,_0x5051a9);},'AdOAH':'invalid-grid-id','bucNO':_0x27e2ce(0x1da)};let _0x14ee37;try{!_0x1ba2ef[_0x27e2ce(0x1b8)]&&(logger[_0x27e2ce(0x1bc)](_0x312dab[_0x27e2ce(0x1a7)]),process['exit'](0x1));!fs[_0x27e2ce(0x1c7)](_0x312dab['bmvYX'](getCredentialsPath))&&(logger[_0x27e2ce(0x1bc)](_0x312dab['dlKQu']),await _0x312dab[_0x27e2ce(0x19a)](sendInstrumentationEvent,_0x1ba2ef,_0x312dab[_0x27e2ce(0x19b)],messageTypes[_0x27e2ce(0x1c0)],_0x312dab['gYcEh'],null,_0x1ba2ef),process[_0x27e2ce(0x1ae)](0x1));logger['info'](_0x27e2ce(0x1e0)+_0x1ba2ef[_0x27e2ce(0x1b8)]),await _0x312dab[_0x27e2ce(0x19a)](sendInstrumentationEvent,_0x1ba2ef,_0x312dab['kOuDY'],messageTypes['INFO'],null,null,_0x1ba2ef);const _0x49364a=JSON[_0x27e2ce(0x1c8)](fs['readFileSync'](_0x312dab[_0x27e2ce(0x198)](getCredentialsPath)));global_registry[_0x27e2ce(0x1ab)]=_0x49364a[_0x27e2ce(0x1b0)][_0x27e2ce(0x1ad)],global_registry[_0x27e2ce(0x1b1)]=_0x49364a[_0x27e2ce(0x1b0)]['password'];const _0x24ae4c=WS_ENDPOINT[_0x27e2ce(0x1de)](_0x312dab[_0x27e2ce(0x1c5)],_0x49364a[_0x27e2ce(0x1b0)][_0x27e2ce(0x1ad)])[_0x27e2ce(0x1de)](_0x312dab['XJpIY'],_0x49364a['Browserstack'][_0x27e2ce(0x1dd)]),_0x46095a={};_0x46095a[_0x27e2ce(0x1b5)]=ws,_0x46095a[_0x27e2ce(0x1c1)]=0x36ee80,_0x14ee37=new ReconnectingWebSocket(_0x24ae4c,[],_0x46095a),logger[_0x27e2ce(0x1a4)](_0x312dab[_0x27e2ce(0x1cf)]),webSocketUtils['addListeners'](_0x14ee37,_0x1ba2ef[_0x27e2ce(0x1a6)],_0x1ba2ef[_0x27e2ce(0x1dd)]);const [_0x36e273,_0x474b78]=await _0x312dab['JeAft'](getGridDetails,_0x49364a[_0x27e2ce(0x1b0)][_0x27e2ce(0x1ad)],_0x49364a['Browserstack'][_0x27e2ce(0x1dd)],_0x1ba2ef[_0x27e2ce(0x1b8)]);if(_0x474b78){const _0x5eaa39=_0x474b78['info'];global_registry[_0x27e2ce(0x1c6)]=_0x5eaa39['cloudProvider'],global_registry[_0x27e2ce(0x1a3)]=_0x5eaa39['region'],global_registry[_0x27e2ce(0x1cd)]=_0x5eaa39[_0x27e2ce(0x1cd)];const _0xab2f3c=await _0x312dab[_0x27e2ce(0x1b7)](getCloudProviderObject,_0x5eaa39[_0x27e2ce(0x1c6)],_0x5eaa39[_0x27e2ce(0x1cd)],_0x5eaa39[_0x27e2ce(0x1bf)],_0x14ee37,webSocketUtils,_0x1ba2ef),[_0x3e6bf9,_0x1baa6b,_0x26efc0,_0x217ddb,_0x23eea7,_0x36e367]=await _0x312dab['WWwHF'](createK8sClient,_0xab2f3c,_0x1ba2ef['skipTlsCertVerify']);await _0x312dab[_0x27e2ce(0x1e2)](scaleDownHubDeployment,_0x1baa6b,_0x5eaa39[_0x27e2ce(0x1bf)]),logger['info'](_0x312dab[_0x27e2ce(0x1c2)]),process[_0x27e2ce(0x1ae)](0x0);}_0x312dab['CHsGN'](_0x36e273[_0x27e2ce(0x1bd)],0x191)&&(logger[_0x27e2ce(0x1bc)](_0x312dab['pEJXQ']),await _0x312dab['mbzqH'](sendInstrumentationEvent,_0x1ba2ef,_0x312dab[_0x27e2ce(0x19b)],messageTypes['ERROR'],_0x312dab[_0x27e2ce(0x1d2)],null,_0x1ba2ef),process[_0x27e2ce(0x1ae)](0x1)),_0x312dab[_0x27e2ce(0x1b4)](_0x36e273['statusCode'],0x190)&&(logger[_0x27e2ce(0x1bc)](JSON['parse'](_0x36e273[_0x27e2ce(0x1a8)])[_0x27e2ce(0x1e1)]),await _0x312dab[_0x27e2ce(0x1a0)](sendInstrumentationEvent,_0x1ba2ef,_0x312dab['kOuDY'],messageTypes[_0x27e2ce(0x1c0)],_0x312dab[_0x27e2ce(0x1d1)],null,_0x1ba2ef),process[_0x27e2ce(0x1ae)](0x1)),logger['error'](_0x27e2ce(0x1a1)+JSON['stringify'](_0x36e273)),await _0x312dab[_0x27e2ce(0x1a0)](sendInstrumentationEvent,_0x1ba2ef,_0x312dab['kOuDY'],messageTypes[_0x27e2ce(0x1c0)],_0x312dab[_0x27e2ce(0x1ca)],_0x36e273,_0x1ba2ef),process[_0x27e2ce(0x1ae)](0x1);}catch(_0x2d9690){const _0x3a722b=_0x27e2ce(0x1df)+_0x2d9690+'\x20\x0a'+JSON['stringify'](_0x2d9690[_0x27e2ce(0x1e3)])+'\x20';logger['error'](_0x3a722b),process[_0x27e2ce(0x1ae)](0x1);}};