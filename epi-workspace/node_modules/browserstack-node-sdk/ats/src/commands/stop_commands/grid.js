const a21_0x4fc4a2=a21_0x1eb7;(function(_0x3fbfb3,_0x4ded20){const _0x87bd7d=a21_0x1eb7,_0x23949e=_0x3fbfb3();while(!![]){try{const _0x5098af=parseInt(_0x87bd7d(0x21a))/0x1+-parseInt(_0x87bd7d(0x22e))/0x2*(parseInt(_0x87bd7d(0x228))/0x3)+-parseInt(_0x87bd7d(0x1f8))/0x4*(-parseInt(_0x87bd7d(0x22d))/0x5)+-parseInt(_0x87bd7d(0x1ff))/0x6*(-parseInt(_0x87bd7d(0x1e3))/0x7)+-parseInt(_0x87bd7d(0x220))/0x8+parseInt(_0x87bd7d(0x20d))/0x9*(parseInt(_0x87bd7d(0x233))/0xa)+parseInt(_0x87bd7d(0x227))/0xb*(-parseInt(_0x87bd7d(0x1f5))/0xc);if(_0x5098af===_0x4ded20)break;else _0x23949e['push'](_0x23949e['shift']());}catch(_0x396bf2){_0x23949e['push'](_0x23949e['shift']());}}}(a21_0x4add,0x8f0f9));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x4fc4a2(0x1e8)),{logger}=require(a21_0x4fc4a2(0x1e6)),{getCredentialsPath,getGridDetails}=require(a21_0x4fc4a2(0x1fa)),{scaleDownHubDeployment}=require(a21_0x4fc4a2(0x205)),{sendInstrumentationEvent}=require(a21_0x4fc4a2(0x1f9)),webSocketUtils=require(a21_0x4fc4a2(0x221)),{createK8sClient}=require(a21_0x4fc4a2(0x222)),{getCloudProviderObject}=require(a21_0x4fc4a2(0x1df));function a21_0x1eb7(_0x5ae62a,_0x2b1d32){const _0x4add8a=a21_0x4add();return a21_0x1eb7=function(_0x1eb708,_0x18c715){_0x1eb708=_0x1eb708-0x1d3;let _0x4a99ba=_0x4add8a[_0x1eb708];return _0x4a99ba;},a21_0x1eb7(_0x5ae62a,_0x2b1d32);}function a21_0x4add(){const _0x4bd789=['argv','qnegP','Browserstack','bstackUsername','clusterRegion','username','1370232nraYdj','stop','debug','76012XntsuW','../../utils/instrumentationUtils','../../utils/utilityMethods','jUAsr','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','ERROR','addListeners','3420234eZpfCx','handler','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','stop-grid-called','statusCode','replace','../../utils/gridComponents','options','Stopping\x20grid\x20','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','AVMaS','info','KfLpz','INFO','9RkygqZ','name','twWFP','Adding\x20Websocket\x20listeners','default','grid-id','OOpzL','Grid\x20stoppped.','ceDhg','LfNou','QCBCh','parse','password','86570NMsrjN','<PasswordPlaceholder>','invalid-grid-id','CRbYG','server-error','error','8812944JVHkFK','../../utils/webSocketUtils','../../utils/createk8sClient','boolean','stack','bstackAccesskey','eGshm','22FrGQps','114dOrUDm','stringify','gridId','Skip\x20insecure\x20cert\x20verification.','type','75vvaPLI','9052tXUOfZ','skipTlsCertVerify','DCzlo','desc','WebSocket','11463010aJAiZf','MrKxR','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','user','epilogue','help','builder','message','unauthorised','string','exit','Stop\x20a\x20running\x20Automation\x20grid.','wLVAh','../../cloudproviders/utils','HrccJ','cloudProvider','region','7HqwzRr','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','riLTs','../../config/logger','jfWvi','../../config/constants','xLMyq','cJLUS','QekXs','tpfof','gTxzx','clusterName'];a21_0x4add=function(){return _0x4bd789;};return a21_0x4add();}exports['command']='grid',exports[a21_0x4fc4a2(0x231)]=a21_0x4fc4a2(0x1dd),exports[a21_0x4fc4a2(0x1d8)]=function(_0x33802b){const _0x1a88ec=a21_0x4fc4a2,_0xcb254={};_0xcb254[_0x1a88ec(0x1e5)]=_0x1a88ec(0x201),_0xcb254['ceDhg']=_0x1a88ec(0x1db),_0xcb254[_0x1a88ec(0x1de)]=_0x1a88ec(0x22b),_0xcb254['jYVme']=_0x1a88ec(0x223),_0xcb254[_0x1a88ec(0x216)]='help';const _0x264da7=_0xcb254,_0x1095de={};_0x1095de['description']=_0x264da7[_0x1a88ec(0x1e5)],_0x1095de[_0x1a88ec(0x22c)]=_0x264da7[_0x1a88ec(0x215)];const _0x66dad8={};_0x66dad8['description']=_0x264da7[_0x1a88ec(0x1de)],_0x66dad8[_0x1a88ec(0x22c)]=_0x264da7['jYVme'],_0x66dad8[_0x1a88ec(0x211)]=![];const _0x2d141f={};return _0x2d141f[_0x1a88ec(0x212)]=_0x1095de,_0x2d141f['skip-tls-cert-verify']=_0x66dad8,_0x33802b['usage'](HELP_HEADER_MESSAGE[_0x1a88ec(0x1f6)])[_0x1a88ec(0x1d6)](HELP_FOOTER_MESSAGE)[_0x1a88ec(0x206)](_0x2d141f)[_0x1a88ec(0x1d7)](_0x264da7[_0x1a88ec(0x216)])[_0x1a88ec(0x1ef)];},exports[a21_0x4fc4a2(0x200)]=async function(_0x145c3a){const _0x5b097b=a21_0x4fc4a2,_0x17d802={'MrKxR':_0x5b097b(0x1e4),'twWFP':function(_0x485dd0){return _0x485dd0();},'VCUCp':_0x5b097b(0x208),'jfWvi':function(_0x2cd8ad,_0x5af099,_0x4c6454,_0x30bb3c,_0x2ec28a,_0x474a71,_0x3ebb0c){return _0x2cd8ad(_0x5af099,_0x4c6454,_0x30bb3c,_0x2ec28a,_0x474a71,_0x3ebb0c);},'gTxzx':_0x5b097b(0x202),'AVMaS':'init-not-called','QCBCh':'<UsernamePlaceholder>','HrccJ':_0x5b097b(0x21b),'qnegP':_0x5b097b(0x210),'axCOs':function(_0x16850b,_0x1256b5,_0x3915d1,_0x2fb1cd){return _0x16850b(_0x1256b5,_0x3915d1,_0x2fb1cd);},'eGshm':function(_0x15e822,_0x4305bd,_0x5b6965,_0x146f0e,_0x2052b1,_0x43c4bf,_0x10ef5b){return _0x15e822(_0x4305bd,_0x5b6965,_0x146f0e,_0x2052b1,_0x43c4bf,_0x10ef5b);},'tpfof':function(_0x227cc2,_0x3ab510,_0x333b38){return _0x227cc2(_0x3ab510,_0x333b38);},'KfLpz':_0x5b097b(0x214),'DCzlo':function(_0x185615,_0x112d6f){return _0x185615===_0x112d6f;},'cJLUS':_0x5b097b(0x1d4),'xLMyq':_0x5b097b(0x1da),'jUAsr':function(_0x54f524,_0x9392fd){return _0x54f524===_0x9392fd;},'OOpzL':_0x5b097b(0x21c),'CRbYG':function(_0x1a5cfc,_0x93738b,_0x13aba9,_0x476b3d,_0x318825,_0x4b5fa8,_0x127ecd){return _0x1a5cfc(_0x93738b,_0x13aba9,_0x476b3d,_0x318825,_0x4b5fa8,_0x127ecd);},'QekXs':_0x5b097b(0x21e)};let _0x404ac1;try{!_0x145c3a[_0x5b097b(0x22a)]&&(logger[_0x5b097b(0x21f)](_0x17d802[_0x5b097b(0x1d3)]),process[_0x5b097b(0x1dc)](0x1));!fs['existsSync'](_0x17d802['twWFP'](getCredentialsPath))&&(logger[_0x5b097b(0x21f)](_0x17d802['VCUCp']),await _0x17d802[_0x5b097b(0x1e7)](sendInstrumentationEvent,_0x145c3a,_0x17d802[_0x5b097b(0x1ed)],messageTypes[_0x5b097b(0x1fd)],_0x17d802[_0x5b097b(0x209)],null,_0x145c3a),process[_0x5b097b(0x1dc)](0x1));logger[_0x5b097b(0x20a)](_0x5b097b(0x207)+_0x145c3a[_0x5b097b(0x22a)]),await _0x17d802[_0x5b097b(0x1e7)](sendInstrumentationEvent,_0x145c3a,_0x17d802[_0x5b097b(0x1ed)],messageTypes[_0x5b097b(0x20c)],null,null,_0x145c3a);const _0xc40152=JSON[_0x5b097b(0x218)](fs['readFileSync'](_0x17d802[_0x5b097b(0x20f)](getCredentialsPath)));global_registry[_0x5b097b(0x1f2)]=_0xc40152[_0x5b097b(0x1f1)][_0x5b097b(0x1f4)],global_registry[_0x5b097b(0x225)]=_0xc40152[_0x5b097b(0x1f1)][_0x5b097b(0x219)];const _0xc1253=WS_ENDPOINT[_0x5b097b(0x204)](_0x17d802[_0x5b097b(0x217)],_0xc40152['Browserstack'][_0x5b097b(0x1f4)])[_0x5b097b(0x204)](_0x17d802[_0x5b097b(0x1e0)],_0xc40152['Browserstack']['password']),_0x1ed5eb={};_0x1ed5eb[_0x5b097b(0x232)]=ws,_0x1ed5eb['connectionTimeout']=0x36ee80,_0x404ac1=new ReconnectingWebSocket(_0xc1253,[],_0x1ed5eb),logger[_0x5b097b(0x1f7)](_0x17d802[_0x5b097b(0x1f0)]),webSocketUtils[_0x5b097b(0x1fe)](_0x404ac1,_0x145c3a[_0x5b097b(0x1d5)],_0x145c3a[_0x5b097b(0x219)]);const [_0x52bb8d,_0x819daf]=await _0x17d802['axCOs'](getGridDetails,_0xc40152[_0x5b097b(0x1f1)]['username'],_0xc40152[_0x5b097b(0x1f1)]['password'],_0x145c3a['gridId']);if(_0x819daf){const _0x3b2afe=_0x819daf['info'];global_registry[_0x5b097b(0x1e1)]=_0x3b2afe[_0x5b097b(0x1e1)],global_registry[_0x5b097b(0x1f3)]=_0x3b2afe[_0x5b097b(0x1e2)],global_registry['clusterName']=_0x3b2afe[_0x5b097b(0x1ee)];const _0x2c4e65=await _0x17d802[_0x5b097b(0x226)](getCloudProviderObject,_0x3b2afe[_0x5b097b(0x1e1)],_0x3b2afe['clusterName'],_0x3b2afe[_0x5b097b(0x20e)],_0x404ac1,webSocketUtils,_0x145c3a),[_0xdba648,_0x2e122a,_0x1b984e,_0x3af31e,_0x4cc1ab,_0x146f7d]=await _0x17d802[_0x5b097b(0x1ec)](createK8sClient,_0x2c4e65,_0x145c3a[_0x5b097b(0x22f)]);await _0x17d802[_0x5b097b(0x1ec)](scaleDownHubDeployment,_0x2e122a,_0x3b2afe['name']),logger[_0x5b097b(0x20a)](_0x17d802[_0x5b097b(0x20b)]),process['exit'](0x0);}_0x17d802[_0x5b097b(0x230)](_0x52bb8d[_0x5b097b(0x203)],0x191)&&(logger[_0x5b097b(0x21f)](_0x17d802[_0x5b097b(0x1ea)]),await _0x17d802[_0x5b097b(0x226)](sendInstrumentationEvent,_0x145c3a,_0x17d802[_0x5b097b(0x1ed)],messageTypes['ERROR'],_0x17d802[_0x5b097b(0x1e9)],null,_0x145c3a),process[_0x5b097b(0x1dc)](0x1)),_0x17d802[_0x5b097b(0x1fb)](_0x52bb8d['statusCode'],0x190)&&(logger[_0x5b097b(0x21f)](JSON[_0x5b097b(0x218)](_0x52bb8d['body'])[_0x5b097b(0x1d9)]),await _0x17d802[_0x5b097b(0x226)](sendInstrumentationEvent,_0x145c3a,_0x17d802['gTxzx'],messageTypes[_0x5b097b(0x1fd)],_0x17d802[_0x5b097b(0x213)],null,_0x145c3a),process[_0x5b097b(0x1dc)](0x1)),logger[_0x5b097b(0x21f)]('Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20'+JSON[_0x5b097b(0x229)](_0x52bb8d)),await _0x17d802[_0x5b097b(0x21d)](sendInstrumentationEvent,_0x145c3a,_0x17d802[_0x5b097b(0x1ed)],messageTypes[_0x5b097b(0x1fd)],_0x17d802[_0x5b097b(0x1eb)],_0x52bb8d,_0x145c3a),process[_0x5b097b(0x1dc)](0x1);}catch(_0x2e0da0){const _0x598b5f=_0x5b097b(0x1fc)+_0x2e0da0+'\x20\x0a'+JSON[_0x5b097b(0x229)](_0x2e0da0[_0x5b097b(0x224)])+'\x20';logger['error'](_0x598b5f),process[_0x5b097b(0x1dc)](0x1);}};