const a21_0x2e51fa=a21_0x42b9;function a21_0x6576(){const _0x5efab7=['11WDWWwo','qqYJA','mRBQA','zTXRH','vgdVI','../../utils/instrumentationUtils','AOmHa','45LGZqUh','username','ERROR','bstackAccesskey','bstackUsername','20419BeCTLz','stringify','UlfNS','../../config/logger','mypbZ','region','init-not-called','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','xCGmB','630184QmrUGu','gridId','Nztys','desc','skip-tls-cert-verify','name','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','boolean','help','1245lcABHZ','<UsernamePlaceholder>','3803090hUqdFN','handler','mzRZv','JNCpl','body','cloudProvider','invalid-grid-id','password','../../utils/createk8sClient','42qftJlX','LOjap','1978500ujvEnq','5956iZjCdu','530487rlfmNZ','epilogue','addListeners','exit','error','ZkjHs','usage','<PasswordPlaceholder>','INFO','argv','WebSocket','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','debug','grid','Adding\x20Websocket\x20listeners','string','Grid\x20stoppped.','existsSync','BsHMS','38WUIufu','HmTRV','wzEke','command','skipTlsCertVerify','geFJL','server-error','message','parse','XOoVq','../../utils/webSocketUtils','clusterName','wddky','statusCode','../../config/constants','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','Browserstack','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','IUKIC','user','type','11794uPpMpq','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','Stop\x20a\x20running\x20Automation\x20grid.','info','options','replace','description','stop'];a21_0x6576=function(){return _0x5efab7;};return a21_0x6576();}(function(_0x3d7e7c,_0x3517f5){const _0x472027=a21_0x42b9,_0x56882d=_0x3d7e7c();while(!![]){try{const _0x5867f0=-parseInt(_0x472027(0x107))/0x1*(-parseInt(_0x472027(0xf2))/0x2)+-parseInt(_0x472027(0x13c))/0x3+parseInt(_0x472027(0x13b))/0x4*(-parseInt(_0x472027(0x12d))/0x5)+-parseInt(_0x472027(0x138))/0x6*(parseInt(_0x472027(0x11b))/0x7)+parseInt(_0x472027(0x124))/0x8*(parseInt(_0x472027(0x116))/0x9)+parseInt(_0x472027(0x12f))/0xa*(parseInt(_0x472027(0x10f))/0xb)+-parseInt(_0x472027(0x13a))/0xc;if(_0x5867f0===_0x3517f5)break;else _0x56882d['push'](_0x56882d['shift']());}catch(_0x4c4652){_0x56882d['push'](_0x56882d['shift']());}}}(a21_0x6576,0x40ca0));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require('reconnecting-websocket'),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x2e51fa(0x100)),{logger}=require(a21_0x2e51fa(0x11e)),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require(a21_0x2e51fa(0x114)),webSocketUtils=require(a21_0x2e51fa(0xfc)),{createK8sClient}=require(a21_0x2e51fa(0x137)),{getCloudProviderObject}=require('../../cloudproviders/utils');function a21_0x42b9(_0x5c2905,_0x422719){const _0x657637=a21_0x6576();return a21_0x42b9=function(_0x42b976,_0x433129){_0x42b976=_0x42b976-0xe7;let _0x36936a=_0x657637[_0x42b976];return _0x36936a;},a21_0x42b9(_0x5c2905,_0x422719);}exports[a21_0x2e51fa(0xf5)]=a21_0x2e51fa(0xec),exports[a21_0x2e51fa(0x127)]=a21_0x2e51fa(0x109),exports['builder']=function(_0xc499c3){const _0x68d110=a21_0x2e51fa,_0x312dee={};_0x312dee['SIACB']=_0x68d110(0xea),_0x312dee[_0x68d110(0xfe)]=_0x68d110(0xee),_0x312dee[_0x68d110(0x11d)]='Skip\x20insecure\x20cert\x20verification.',_0x312dee[_0x68d110(0x131)]=_0x68d110(0x12b),_0x312dee['BsHMS']='help';const _0x5214de=_0x312dee,_0x3a900f={};_0x3a900f['description']=_0x5214de['SIACB'],_0x3a900f[_0x68d110(0x106)]=_0x5214de[_0x68d110(0xfe)];const _0x47ad25={};_0x47ad25[_0x68d110(0x10d)]=_0x5214de[_0x68d110(0x11d)],_0x47ad25['type']=_0x5214de[_0x68d110(0x131)],_0x47ad25['default']=![];const _0x74652d={};return _0x74652d['grid-id']=_0x3a900f,_0x74652d[_0x68d110(0x128)]=_0x47ad25,_0xc499c3[_0x68d110(0x142)](HELP_HEADER_MESSAGE[_0x68d110(0x10e)])[_0x68d110(0x13d)](HELP_FOOTER_MESSAGE)[_0x68d110(0x10b)](_0x74652d)[_0x68d110(0x12c)](_0x5214de[_0x68d110(0xf1)])[_0x68d110(0xe8)];},exports[a21_0x2e51fa(0x130)]=async function(_0x19688e){const _0x318071=a21_0x2e51fa,_0x283a82={'Nztys':_0x318071(0x101),'zTXRH':function(_0xe26794){return _0xe26794();},'LOjap':_0x318071(0x108),'vgdVI':function(_0x2d5004,_0x5b9c41,_0x447ef0,_0xb49e80,_0x9bf237,_0x31d496,_0x10798f){return _0x2d5004(_0x5b9c41,_0x447ef0,_0xb49e80,_0x9bf237,_0x31d496,_0x10798f);},'geFJL':'stop-grid-called','HmTRV':_0x318071(0x121),'IogTi':function(_0x109174,_0x52e36a,_0x12f001,_0x3f9f3e,_0x239932,_0x108c43,_0x5b3a14){return _0x109174(_0x52e36a,_0x12f001,_0x3f9f3e,_0x239932,_0x108c43,_0x5b3a14);},'ZkjHs':function(_0x5740cf){return _0x5740cf();},'mRBQA':_0x318071(0x12e),'XOoVq':_0x318071(0x143),'gyQNR':_0x318071(0xed),'zBAzm':function(_0x15decb,_0x374f37,_0x57c2a9,_0x520076){return _0x15decb(_0x374f37,_0x57c2a9,_0x520076);},'qqYJA':function(_0x4d1925,_0x502005,_0x123583){return _0x4d1925(_0x502005,_0x123583);},'IUKIC':function(_0xa2bf70,_0x4c641d,_0x50560a){return _0xa2bf70(_0x4c641d,_0x50560a);},'gMBCU':_0x318071(0xef),'mypbZ':function(_0x321525,_0x2e0dd7){return _0x321525===_0x2e0dd7;},'wzEke':_0x318071(0x12a),'AOmHa':function(_0x390dd5,_0x35a233,_0x51875c,_0x55a57c,_0xdd90e0,_0x68985,_0x5df307){return _0x390dd5(_0x35a233,_0x51875c,_0x55a57c,_0xdd90e0,_0x68985,_0x5df307);},'xCGmB':'unauthorised','JNCpl':function(_0x46600e,_0x25fa80){return _0x46600e===_0x25fa80;},'DWhqZ':_0x318071(0x135),'ojprx':function(_0x624e0d,_0xc8dbd7,_0x23c88e,_0x59c253,_0x7e380c,_0x2dcf3a,_0x897847){return _0x624e0d(_0xc8dbd7,_0x23c88e,_0x59c253,_0x7e380c,_0x2dcf3a,_0x897847);},'zFQDL':_0x318071(0xf8)};let _0x2171cc;try{!_0x19688e[_0x318071(0x125)]&&(logger[_0x318071(0x140)](_0x283a82[_0x318071(0x126)]),process[_0x318071(0x13f)](0x1));!fs[_0x318071(0xf0)](_0x283a82[_0x318071(0x112)](getCredentialsPath))&&(logger[_0x318071(0x140)](_0x283a82[_0x318071(0x139)]),await _0x283a82[_0x318071(0x113)](sendInstrumentationEvent,_0x19688e,_0x283a82['geFJL'],messageTypes[_0x318071(0x118)],_0x283a82[_0x318071(0xf3)],null,_0x19688e),process['exit'](0x1));logger[_0x318071(0x10a)]('Stopping\x20grid\x20'+_0x19688e[_0x318071(0x125)]),await _0x283a82['IogTi'](sendInstrumentationEvent,_0x19688e,_0x283a82[_0x318071(0xf7)],messageTypes[_0x318071(0xe7)],null,null,_0x19688e);const _0x569048=JSON[_0x318071(0xfa)](fs['readFileSync'](_0x283a82[_0x318071(0x141)](getCredentialsPath)));global_registry[_0x318071(0x11a)]=_0x569048[_0x318071(0x102)]['username'],global_registry[_0x318071(0x119)]=_0x569048[_0x318071(0x102)]['password'];const _0x3a21ab=WS_ENDPOINT['replace'](_0x283a82[_0x318071(0x111)],_0x569048['Browserstack'][_0x318071(0x117)])[_0x318071(0x10c)](_0x283a82[_0x318071(0xfb)],_0x569048[_0x318071(0x102)][_0x318071(0x136)]),_0x23baaa={};_0x23baaa[_0x318071(0xe9)]=ws,_0x23baaa['connectionTimeout']=0x36ee80,_0x2171cc=new ReconnectingWebSocket(_0x3a21ab,[],_0x23baaa),logger[_0x318071(0xeb)](_0x283a82['gyQNR']),webSocketUtils[_0x318071(0x13e)](_0x2171cc,_0x19688e[_0x318071(0x105)],_0x19688e[_0x318071(0x136)]);const [_0x23496a,_0xe6e9d]=await _0x283a82['zBAzm'](getGridDetails,_0x569048[_0x318071(0x102)][_0x318071(0x117)],_0x569048['Browserstack'][_0x318071(0x136)],_0x19688e['gridId']);if(_0xe6e9d){const _0x1909dc=_0xe6e9d['info'];global_registry[_0x318071(0x134)]=_0x1909dc[_0x318071(0x134)],global_registry['clusterRegion']=_0x1909dc[_0x318071(0x120)],global_registry['clusterName']=_0x1909dc[_0x318071(0xfd)];const _0x2a66b1=await _0x283a82[_0x318071(0x113)](getCloudProviderObject,_0x1909dc[_0x318071(0x134)],_0x1909dc[_0x318071(0xfd)],_0x1909dc[_0x318071(0x129)],_0x2171cc,webSocketUtils,_0x19688e),[_0x5c0ad1,_0xe966bc,_0x2d128c,_0x51b502,_0x28de4f,_0x4ba006]=await _0x283a82[_0x318071(0x110)](createK8sClient,_0x2a66b1,_0x19688e[_0x318071(0xf6)]);await _0x283a82[_0x318071(0x104)](scaleDownHubDeployment,_0xe966bc,_0x1909dc[_0x318071(0x129)]),logger[_0x318071(0x10a)](_0x283a82['gMBCU']),process[_0x318071(0x13f)](0x0);}_0x283a82[_0x318071(0x11f)](_0x23496a[_0x318071(0xff)],0x191)&&(logger[_0x318071(0x140)](_0x283a82[_0x318071(0xf4)]),await _0x283a82[_0x318071(0x115)](sendInstrumentationEvent,_0x19688e,_0x283a82[_0x318071(0xf7)],messageTypes[_0x318071(0x118)],_0x283a82[_0x318071(0x123)],null,_0x19688e),process['exit'](0x1)),_0x283a82[_0x318071(0x132)](_0x23496a[_0x318071(0xff)],0x190)&&(logger['error'](JSON[_0x318071(0xfa)](_0x23496a[_0x318071(0x133)])[_0x318071(0xf9)]),await _0x283a82[_0x318071(0x113)](sendInstrumentationEvent,_0x19688e,_0x283a82[_0x318071(0xf7)],messageTypes[_0x318071(0x118)],_0x283a82['DWhqZ'],null,_0x19688e),process[_0x318071(0x13f)](0x1)),logger[_0x318071(0x140)](_0x318071(0x122)+JSON[_0x318071(0x11c)](_0x23496a)),await _0x283a82['ojprx'](sendInstrumentationEvent,_0x19688e,_0x283a82[_0x318071(0xf7)],messageTypes[_0x318071(0x118)],_0x283a82['zFQDL'],_0x23496a,_0x19688e),process[_0x318071(0x13f)](0x1);}catch(_0x1fd9bd){const _0x36a27d=_0x318071(0x103)+_0x1fd9bd+'\x20\x0a'+JSON[_0x318071(0x11c)](_0x1fd9bd['stack'])+'\x20';logger[_0x318071(0x140)](_0x36a27d),process['exit'](0x1);}};