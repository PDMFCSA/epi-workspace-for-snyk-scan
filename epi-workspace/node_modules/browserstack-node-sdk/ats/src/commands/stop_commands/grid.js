const a21_0x4d4175=a21_0x2f3c;(function(_0xf43eb1,_0x30c4ef){const _0x1e0105=a21_0x2f3c,_0x33b933=_0xf43eb1();while(!![]){try{const _0x374bd3=-parseInt(_0x1e0105(0x19c))/0x1*(-parseInt(_0x1e0105(0x17e))/0x2)+parseInt(_0x1e0105(0x19e))/0x3*(parseInt(_0x1e0105(0x1b7))/0x4)+parseInt(_0x1e0105(0x187))/0x5+parseInt(_0x1e0105(0x1c9))/0x6*(parseInt(_0x1e0105(0x1a4))/0x7)+-parseInt(_0x1e0105(0x1b2))/0x8+-parseInt(_0x1e0105(0x1ba))/0x9*(parseInt(_0x1e0105(0x1c8))/0xa)+-parseInt(_0x1e0105(0x1b4))/0xb*(parseInt(_0x1e0105(0x1c2))/0xc);if(_0x374bd3===_0x30c4ef)break;else _0x33b933['push'](_0x33b933['shift']());}catch(_0x40fad2){_0x33b933['push'](_0x33b933['shift']());}}}(a21_0x2556,0x73331));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x4d4175(0x1ca)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x4d4175(0x1ce)),{logger}=require(a21_0x4d4175(0x1cd)),{getCredentialsPath,getGridDetails}=require(a21_0x4d4175(0x18c)),{scaleDownHubDeployment}=require(a21_0x4d4175(0x19b)),{sendInstrumentationEvent}=require(a21_0x4d4175(0x1cc)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x4d4175(0x190)),{getCloudProviderObject}=require('../../cloudproviders/utils');exports[a21_0x4d4175(0x1a9)]='grid',exports['desc']=a21_0x4d4175(0x19a),exports[a21_0x4d4175(0x1a5)]=function(_0x54c0a3){const _0x3f238c=a21_0x4d4175,_0x24bfe0={};_0x24bfe0[_0x3f238c(0x177)]=_0x3f238c(0x18b),_0x24bfe0[_0x3f238c(0x189)]=_0x3f238c(0x18e),_0x24bfe0[_0x3f238c(0x181)]=_0x3f238c(0x1ac),_0x24bfe0[_0x3f238c(0x1c6)]='boolean',_0x24bfe0[_0x3f238c(0x191)]='help';const _0x16e276=_0x24bfe0,_0x237a78={};_0x237a78[_0x3f238c(0x185)]=_0x16e276[_0x3f238c(0x177)],_0x237a78[_0x3f238c(0x1ad)]=_0x16e276[_0x3f238c(0x189)];const _0x11f1f8={};_0x11f1f8[_0x3f238c(0x185)]=_0x16e276[_0x3f238c(0x181)],_0x11f1f8[_0x3f238c(0x1ad)]=_0x16e276['dVSBF'],_0x11f1f8[_0x3f238c(0x1c5)]=![];const _0x1c0c1a={};return _0x1c0c1a[_0x3f238c(0x186)]=_0x237a78,_0x1c0c1a['skip-tls-cert-verify']=_0x11f1f8,_0x54c0a3[_0x3f238c(0x1c0)](HELP_HEADER_MESSAGE[_0x3f238c(0x1cb)])[_0x3f238c(0x1bb)](HELP_FOOTER_MESSAGE)[_0x3f238c(0x179)](_0x1c0c1a)['help'](_0x16e276['WhSkT'])[_0x3f238c(0x1d4)];},exports[a21_0x4d4175(0x188)]=async function(_0x3557e2){const _0x3daa56=a21_0x4d4175,_0x186a52={'daGeQ':_0x3daa56(0x18f),'wlZfs':function(_0x58b2ba){return _0x58b2ba();},'eJMlu':_0x3daa56(0x193),'VLQLe':function(_0x4d0a9e,_0x558009,_0x3c2749,_0x3aaa4e,_0x580fbb,_0x130e17,_0x4f6cb4){return _0x4d0a9e(_0x558009,_0x3c2749,_0x3aaa4e,_0x580fbb,_0x130e17,_0x4f6cb4);},'KGxEs':_0x3daa56(0x1a1),'dUkfF':'init-not-called','lUZnp':function(_0x1dd4af,_0x175b7f,_0x18f24d,_0xcf6e9e,_0x527e50,_0x1c9ba3,_0xcb45a2){return _0x1dd4af(_0x175b7f,_0x18f24d,_0xcf6e9e,_0x527e50,_0x1c9ba3,_0xcb45a2);},'wxfAv':function(_0x202683){return _0x202683();},'KTvJV':_0x3daa56(0x195),'SpCGJ':_0x3daa56(0x17b),'ndqvl':_0x3daa56(0x1c1),'TpqLD':function(_0x2c188b,_0x1f6ca5,_0xe0e9d1,_0x27847b){return _0x2c188b(_0x1f6ca5,_0xe0e9d1,_0x27847b);},'iNbpF':function(_0x1fa5b4,_0x52794b,_0x1831c7,_0x273379,_0x107891,_0x32bccf,_0x40ed5c){return _0x1fa5b4(_0x52794b,_0x1831c7,_0x273379,_0x107891,_0x32bccf,_0x40ed5c);},'LAFtA':function(_0x33c796,_0x1edad2,_0xa097bb){return _0x33c796(_0x1edad2,_0xa097bb);},'tMOLG':'Grid\x20stoppped.','WZeUT':function(_0x10f856,_0xc3e49){return _0x10f856===_0xc3e49;},'jXiCa':'Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','KyXUC':function(_0x17a8a0,_0x31fd77,_0x15c737,_0x5826dd,_0x1796a4,_0x5a8fd4,_0x2a90e7){return _0x17a8a0(_0x31fd77,_0x15c737,_0x5826dd,_0x1796a4,_0x5a8fd4,_0x2a90e7);},'KQjnn':'unauthorised','sZiFn':function(_0x5c06b6,_0x1c7ea1){return _0x5c06b6===_0x1c7ea1;},'TiDXR':_0x3daa56(0x1a6),'SssIy':'server-error'};let _0x10435a;try{!_0x3557e2['gridId']&&(logger[_0x3daa56(0x1c4)](_0x186a52[_0x3daa56(0x184)]),process[_0x3daa56(0x1aa)](0x1));!fs[_0x3daa56(0x1c7)](_0x186a52[_0x3daa56(0x17f)](getCredentialsPath))&&(logger[_0x3daa56(0x1c4)](_0x186a52[_0x3daa56(0x1a3)]),await _0x186a52['VLQLe'](sendInstrumentationEvent,_0x3557e2,_0x186a52[_0x3daa56(0x1d2)],messageTypes[_0x3daa56(0x198)],_0x186a52[_0x3daa56(0x1ab)],null,_0x3557e2),process[_0x3daa56(0x1aa)](0x1));logger[_0x3daa56(0x1d6)]('Stopping\x20grid\x20'+_0x3557e2[_0x3daa56(0x192)]),await _0x186a52[_0x3daa56(0x178)](sendInstrumentationEvent,_0x3557e2,_0x186a52['KGxEs'],messageTypes[_0x3daa56(0x1bd)],null,null,_0x3557e2);const _0x4d4139=JSON[_0x3daa56(0x1d5)](fs[_0x3daa56(0x1b8)](_0x186a52[_0x3daa56(0x1be)](getCredentialsPath)));global_registry[_0x3daa56(0x1bf)]=_0x4d4139[_0x3daa56(0x194)][_0x3daa56(0x1d7)],global_registry[_0x3daa56(0x1b0)]=_0x4d4139['Browserstack']['password'];const _0x4c422f=WS_ENDPOINT[_0x3daa56(0x182)](_0x186a52[_0x3daa56(0x180)],_0x4d4139[_0x3daa56(0x194)][_0x3daa56(0x1d7)])[_0x3daa56(0x182)](_0x186a52['SpCGJ'],_0x4d4139[_0x3daa56(0x194)]['password']),_0x10435e={};_0x10435e[_0x3daa56(0x183)]=ws,_0x10435e[_0x3daa56(0x19d)]=0x36ee80,_0x10435a=new ReconnectingWebSocket(_0x4c422f,[],_0x10435e),logger[_0x3daa56(0x1b6)](_0x186a52[_0x3daa56(0x1a0)]),webSocketUtils['addListeners'](_0x10435a,_0x3557e2[_0x3daa56(0x1d3)],_0x3557e2[_0x3daa56(0x1b1)]);const [_0x239018,_0x32e0b2]=await _0x186a52[_0x3daa56(0x196)](getGridDetails,_0x4d4139[_0x3daa56(0x194)][_0x3daa56(0x1d7)],_0x4d4139[_0x3daa56(0x194)][_0x3daa56(0x1b1)],_0x3557e2[_0x3daa56(0x192)]);if(_0x32e0b2){const _0x50a866=_0x32e0b2[_0x3daa56(0x1d6)];global_registry[_0x3daa56(0x1d1)]=_0x50a866[_0x3daa56(0x1d1)],global_registry[_0x3daa56(0x1b9)]=_0x50a866['region'],global_registry[_0x3daa56(0x1bc)]=_0x50a866[_0x3daa56(0x1bc)];const _0x183c3f=await _0x186a52['iNbpF'](getCloudProviderObject,_0x50a866[_0x3daa56(0x1d1)],_0x50a866[_0x3daa56(0x1bc)],_0x50a866[_0x3daa56(0x1a8)],_0x10435a,webSocketUtils,_0x3557e2),[_0x1883dc,_0x336459,_0x2081fb,_0x18f4ca,_0x14a9bb,_0x3b619c]=await _0x186a52[_0x3daa56(0x1ae)](createK8sClient,_0x183c3f,_0x3557e2[_0x3daa56(0x1c3)]);await _0x186a52[_0x3daa56(0x1ae)](scaleDownHubDeployment,_0x336459,_0x50a866[_0x3daa56(0x1a8)]),logger[_0x3daa56(0x1d6)](_0x186a52[_0x3daa56(0x17a)]),process[_0x3daa56(0x1aa)](0x0);}_0x186a52[_0x3daa56(0x17c)](_0x239018['statusCode'],0x191)&&(logger[_0x3daa56(0x1c4)](_0x186a52[_0x3daa56(0x199)]),await _0x186a52[_0x3daa56(0x18a)](sendInstrumentationEvent,_0x3557e2,_0x186a52[_0x3daa56(0x1d2)],messageTypes[_0x3daa56(0x198)],_0x186a52['KQjnn'],null,_0x3557e2),process[_0x3daa56(0x1aa)](0x1)),_0x186a52[_0x3daa56(0x197)](_0x239018[_0x3daa56(0x18d)],0x190)&&(logger[_0x3daa56(0x1c4)](JSON['parse'](_0x239018[_0x3daa56(0x1cf)])[_0x3daa56(0x1b3)]),await _0x186a52[_0x3daa56(0x19f)](sendInstrumentationEvent,_0x3557e2,_0x186a52[_0x3daa56(0x1d2)],messageTypes[_0x3daa56(0x198)],_0x186a52[_0x3daa56(0x1a7)],null,_0x3557e2),process[_0x3daa56(0x1aa)](0x1)),logger[_0x3daa56(0x1c4)](_0x3daa56(0x17d)+JSON[_0x3daa56(0x1d0)](_0x239018)),await _0x186a52['KyXUC'](sendInstrumentationEvent,_0x3557e2,_0x186a52[_0x3daa56(0x1d2)],messageTypes[_0x3daa56(0x198)],_0x186a52[_0x3daa56(0x1af)],_0x239018,_0x3557e2),process['exit'](0x1);}catch(_0x4837f4){const _0x299f2c=_0x3daa56(0x1a2)+_0x4837f4+'\x20\x0a'+JSON['stringify'](_0x4837f4[_0x3daa56(0x1b5)])+'\x20';logger[_0x3daa56(0x1c4)](_0x299f2c),process[_0x3daa56(0x1aa)](0x1);}};function a21_0x2f3c(_0x237e5d,_0x349cec){const _0x255605=a21_0x2556();return a21_0x2f3c=function(_0x2f3cfb,_0x2956a2){_0x2f3cfb=_0x2f3cfb-0x177;let _0x24bf48=_0x255605[_0x2f3cfb];return _0x24bf48;},a21_0x2f3c(_0x237e5d,_0x349cec);}function a21_0x2556(){const _0xe48ceb=['handler','JmaVM','KyXUC','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','../../utils/utilityMethods','statusCode','string','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','../../utils/createk8sClient','WhSkT','gridId','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','Browserstack','<UsernamePlaceholder>','TpqLD','sZiFn','ERROR','jXiCa','Stop\x20a\x20running\x20Automation\x20grid.','../../utils/gridComponents','1nHaOFa','connectionTimeout','1552029sDwnAs','VLQLe','ndqvl','stop-grid-called','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','eJMlu','2046457IxHuyR','builder','invalid-grid-id','TiDXR','name','command','exit','dUkfF','Skip\x20insecure\x20cert\x20verification.','type','LAFtA','SssIy','bstackAccesskey','password','6841280WSTWGn','message','4008521KQsKvG','stack','debug','4txpoPA','readFileSync','clusterRegion','23139LnZynA','epilogue','clusterName','INFO','wxfAv','bstackUsername','usage','Adding\x20Websocket\x20listeners','36jaXmhy','skipTlsCertVerify','error','default','dVSBF','existsSync','1020VXZFfu','18kaZhSy','reconnecting-websocket','stop','../../utils/instrumentationUtils','../../config/logger','../../config/constants','body','stringify','cloudProvider','KGxEs','user','argv','parse','info','username','PvVyO','lUZnp','options','tMOLG','<PasswordPlaceholder>','WZeUT','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','1651154MvTHrI','wlZfs','KTvJV','BerlF','replace','WebSocket','daGeQ','description','grid-id','2312595VDGmZm'];a21_0x2556=function(){return _0xe48ceb;};return a21_0x2556();}