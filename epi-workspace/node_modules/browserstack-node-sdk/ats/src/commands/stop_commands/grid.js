const a21_0x5e0a6e=a21_0x4a8f;(function(_0x16dada,_0x55474b){const _0xbf1c68=a21_0x4a8f,_0x2843b9=_0x16dada();while(!![]){try{const _0x33a2b7=-parseInt(_0xbf1c68(0xec))/0x1*(-parseInt(_0xbf1c68(0xf5))/0x2)+parseInt(_0xbf1c68(0xf4))/0x3+-parseInt(_0xbf1c68(0xd4))/0x4+-parseInt(_0xbf1c68(0xdd))/0x5*(parseInt(_0xbf1c68(0xc4))/0x6)+parseInt(_0xbf1c68(0xee))/0x7*(parseInt(_0xbf1c68(0xca))/0x8)+-parseInt(_0xbf1c68(0xf0))/0x9*(parseInt(_0xbf1c68(0xcc))/0xa)+parseInt(_0xbf1c68(0xcf))/0xb;if(_0x33a2b7===_0x55474b)break;else _0x2843b9['push'](_0x2843b9['shift']());}catch(_0x165a19){_0x2843b9['push'](_0x2843b9['shift']());}}}(a21_0x293c,0x98595));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x5e0a6e(0xf3)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x5e0a6e(0xa2)),{logger}=require(a21_0x5e0a6e(0xc9)),{getCredentialsPath,getGridDetails}=require(a21_0x5e0a6e(0xed)),{scaleDownHubDeployment}=require(a21_0x5e0a6e(0xb5)),{sendInstrumentationEvent}=require(a21_0x5e0a6e(0xd3)),webSocketUtils=require(a21_0x5e0a6e(0xc8)),{createK8sClient}=require(a21_0x5e0a6e(0xe4)),{getCloudProviderObject}=require(a21_0x5e0a6e(0xd5));function a21_0x293c(){const _0x382422=['4TcJlRY','OofsA','fkaiw','grid','stop','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','GkWhi','UPEDV','../../config/constants','mRmOZ','error','Browserstack','stringify','body','description','region','skipTlsCertVerify','pAYAL','cloudProvider','Skip\x20insecure\x20cert\x20verification.','message','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','giZrq','JPOqA','addListeners','INFO','grid-id','../../utils/gridComponents','BOewC','HpvaH','help','debug','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','nJunA','clusterName','password','user','DqOeM','username','stack','parse','epilogue','6bgciXg','usage','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','boolean','../../utils/webSocketUtils','../../config/logger','152sjElBT','argv','6610GIHWlW','zyNtp','gridId','26209722AKjKfx','init-not-called','ERROR','command','../../utils/instrumentationUtils','4952352AUqKBn','../../cloudproviders/utils','handler','clusterRegion','bstackAccesskey','XKVPn','existsSync','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','info','5472330WXSPBr','Stop\x20a\x20running\x20Automation\x20grid.','statusCode','azmUQ','AFeIt','qMLii','Adding\x20Websocket\x20listeners','../../utils/createk8sClient','fDgyd','WebSocket','exit','bstackUsername','name','default','HdDXg','288049JdRZQS','../../utils/utilityMethods','68047psvOTX','EnsAF','16749IhbUHf','replace','type','reconnecting-websocket','3129591bmtoOX'];a21_0x293c=function(){return _0x382422;};return a21_0x293c();}function a21_0x4a8f(_0x1c1c2f,_0x27bfb2){const _0x293c46=a21_0x293c();return a21_0x4a8f=function(_0x4a8fb1,_0x3f217d){_0x4a8fb1=_0x4a8fb1-0xa1;let _0x8c8e3f=_0x293c46[_0x4a8fb1];return _0x8c8e3f;},a21_0x4a8f(_0x1c1c2f,_0x27bfb2);}exports[a21_0x5e0a6e(0xd2)]=a21_0x5e0a6e(0xf8),exports['desc']=a21_0x5e0a6e(0xde),exports['builder']=function(_0x19630a){const _0x42625d=a21_0x5e0a6e,_0xe0eafa={};_0xe0eafa[_0x42625d(0xd9)]=_0x42625d(0xba),_0xe0eafa[_0x42625d(0xf6)]='string',_0xe0eafa[_0x42625d(0xb0)]=_0x42625d(0xad),_0xe0eafa[_0x42625d(0xe5)]=_0x42625d(0xc7),_0xe0eafa[_0x42625d(0xb1)]=_0x42625d(0xb8);const _0x4f30a5=_0xe0eafa,_0x57c5d9={};_0x57c5d9[_0x42625d(0xa8)]=_0x4f30a5[_0x42625d(0xd9)],_0x57c5d9[_0x42625d(0xf2)]=_0x4f30a5[_0x42625d(0xf6)];const _0x118c28={};_0x118c28[_0x42625d(0xa8)]=_0x4f30a5[_0x42625d(0xb0)],_0x118c28[_0x42625d(0xf2)]=_0x4f30a5[_0x42625d(0xe5)],_0x118c28[_0x42625d(0xea)]=![];const _0x2195df={};return _0x2195df[_0x42625d(0xb4)]=_0x57c5d9,_0x2195df['skip-tls-cert-verify']=_0x118c28,_0x19630a[_0x42625d(0xc5)](HELP_HEADER_MESSAGE[_0x42625d(0xf9)])[_0x42625d(0xc3)](HELP_FOOTER_MESSAGE)['options'](_0x2195df)[_0x42625d(0xb8)](_0x4f30a5['JPOqA'])[_0x42625d(0xcb)];},exports[a21_0x5e0a6e(0xd6)]=async function(_0x4f2eed){const _0xe2ecfb=a21_0x5e0a6e,_0x100413={'gyaWm':_0xe2ecfb(0xaf),'AFeIt':function(_0x3e424d){return _0x3e424d();},'EnsAF':_0xe2ecfb(0xfa),'azmUQ':function(_0x478f41,_0x491229,_0x319b7d,_0x359c7f,_0x5c7fde,_0x9f87b1,_0x39d9dd){return _0x478f41(_0x491229,_0x319b7d,_0x359c7f,_0x5c7fde,_0x9f87b1,_0x39d9dd);},'UPEDV':'stop-grid-called','nJunA':_0xe2ecfb(0xd0),'HdDXg':'<UsernamePlaceholder>','jLJSl':'<PasswordPlaceholder>','FIwuT':_0xe2ecfb(0xe3),'pAYAL':function(_0x340d9b,_0x561221,_0x2f0508,_0xafc542){return _0x340d9b(_0x561221,_0x2f0508,_0xafc542);},'GkWhi':function(_0x3bb257,_0xe034f6,_0x7b5e41,_0xd29c51,_0x39508b,_0x19362f,_0xaa96bf){return _0x3bb257(_0xe034f6,_0x7b5e41,_0xd29c51,_0x39508b,_0x19362f,_0xaa96bf);},'DqOeM':function(_0x1ae6a8,_0x1f227b,_0x5bb09d){return _0x1ae6a8(_0x1f227b,_0x5bb09d);},'HpvaH':'Grid\x20stoppped.','fkaiw':function(_0x426204,_0x46baee){return _0x426204===_0x46baee;},'BOewC':'Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','VxdwP':'unauthorised','qMLii':function(_0x4b8209,_0x449022){return _0x4b8209===_0x449022;},'mRmOZ':'invalid-grid-id','zyNtp':'server-error'};let _0x4f407e;try{!_0x4f2eed[_0xe2ecfb(0xce)]&&(logger[_0xe2ecfb(0xa4)](_0x100413['gyaWm']),process[_0xe2ecfb(0xe7)](0x1));!fs[_0xe2ecfb(0xda)](_0x100413[_0xe2ecfb(0xe1)](getCredentialsPath))&&(logger[_0xe2ecfb(0xa4)](_0x100413[_0xe2ecfb(0xef)]),await _0x100413[_0xe2ecfb(0xe0)](sendInstrumentationEvent,_0x4f2eed,_0x100413[_0xe2ecfb(0xa1)],messageTypes[_0xe2ecfb(0xd1)],_0x100413[_0xe2ecfb(0xbb)],null,_0x4f2eed),process[_0xe2ecfb(0xe7)](0x1));logger[_0xe2ecfb(0xdc)]('Stopping\x20grid\x20'+_0x4f2eed[_0xe2ecfb(0xce)]),await _0x100413[_0xe2ecfb(0xe0)](sendInstrumentationEvent,_0x4f2eed,_0x100413['UPEDV'],messageTypes[_0xe2ecfb(0xb3)],null,null,_0x4f2eed);const _0x7a3eda=JSON['parse'](fs['readFileSync'](_0x100413[_0xe2ecfb(0xe1)](getCredentialsPath)));global_registry[_0xe2ecfb(0xe8)]=_0x7a3eda[_0xe2ecfb(0xa5)][_0xe2ecfb(0xc0)],global_registry[_0xe2ecfb(0xd8)]=_0x7a3eda[_0xe2ecfb(0xa5)][_0xe2ecfb(0xbd)];const _0x335bed=WS_ENDPOINT['replace'](_0x100413[_0xe2ecfb(0xeb)],_0x7a3eda[_0xe2ecfb(0xa5)][_0xe2ecfb(0xc0)])[_0xe2ecfb(0xf1)](_0x100413['jLJSl'],_0x7a3eda[_0xe2ecfb(0xa5)][_0xe2ecfb(0xbd)]),_0x5d52fc={};_0x5d52fc[_0xe2ecfb(0xe6)]=ws,_0x5d52fc['connectionTimeout']=0x36ee80,_0x4f407e=new ReconnectingWebSocket(_0x335bed,[],_0x5d52fc),logger[_0xe2ecfb(0xb9)](_0x100413['FIwuT']),webSocketUtils[_0xe2ecfb(0xb2)](_0x4f407e,_0x4f2eed[_0xe2ecfb(0xbe)],_0x4f2eed[_0xe2ecfb(0xbd)]);const [_0x2d99f9,_0x53abc3]=await _0x100413[_0xe2ecfb(0xab)](getGridDetails,_0x7a3eda['Browserstack'][_0xe2ecfb(0xc0)],_0x7a3eda[_0xe2ecfb(0xa5)][_0xe2ecfb(0xbd)],_0x4f2eed[_0xe2ecfb(0xce)]);if(_0x53abc3){const _0x49ed07=_0x53abc3[_0xe2ecfb(0xdc)];global_registry[_0xe2ecfb(0xac)]=_0x49ed07[_0xe2ecfb(0xac)],global_registry[_0xe2ecfb(0xd7)]=_0x49ed07[_0xe2ecfb(0xa9)],global_registry[_0xe2ecfb(0xbc)]=_0x49ed07[_0xe2ecfb(0xbc)];const _0x19e2c4=await _0x100413['GkWhi'](getCloudProviderObject,_0x49ed07['cloudProvider'],_0x49ed07[_0xe2ecfb(0xbc)],_0x49ed07[_0xe2ecfb(0xe9)],_0x4f407e,webSocketUtils,_0x4f2eed),[_0x2a52ab,_0x2c785e,_0x1e5f05,_0x5c0b02,_0x317055,_0x3bdaba]=await _0x100413[_0xe2ecfb(0xbf)](createK8sClient,_0x19e2c4,_0x4f2eed[_0xe2ecfb(0xaa)]);await _0x100413['DqOeM'](scaleDownHubDeployment,_0x2c785e,_0x49ed07['name']),logger[_0xe2ecfb(0xdc)](_0x100413[_0xe2ecfb(0xb7)]),process[_0xe2ecfb(0xe7)](0x0);}_0x100413[_0xe2ecfb(0xf7)](_0x2d99f9['statusCode'],0x191)&&(logger[_0xe2ecfb(0xa4)](_0x100413[_0xe2ecfb(0xb6)]),await _0x100413[_0xe2ecfb(0xe0)](sendInstrumentationEvent,_0x4f2eed,_0x100413[_0xe2ecfb(0xa1)],messageTypes['ERROR'],_0x100413['VxdwP'],null,_0x4f2eed),process[_0xe2ecfb(0xe7)](0x1)),_0x100413[_0xe2ecfb(0xe2)](_0x2d99f9[_0xe2ecfb(0xdf)],0x190)&&(logger[_0xe2ecfb(0xa4)](JSON[_0xe2ecfb(0xc2)](_0x2d99f9[_0xe2ecfb(0xa7)])[_0xe2ecfb(0xae)]),await _0x100413[_0xe2ecfb(0xfb)](sendInstrumentationEvent,_0x4f2eed,_0x100413[_0xe2ecfb(0xa1)],messageTypes[_0xe2ecfb(0xd1)],_0x100413[_0xe2ecfb(0xa3)],null,_0x4f2eed),process['exit'](0x1)),logger['error'](_0xe2ecfb(0xdb)+JSON[_0xe2ecfb(0xa6)](_0x2d99f9)),await _0x100413[_0xe2ecfb(0xfb)](sendInstrumentationEvent,_0x4f2eed,_0x100413[_0xe2ecfb(0xa1)],messageTypes[_0xe2ecfb(0xd1)],_0x100413[_0xe2ecfb(0xcd)],_0x2d99f9,_0x4f2eed),process['exit'](0x1);}catch(_0x1153bf){const _0x25b683=_0xe2ecfb(0xc6)+_0x1153bf+'\x20\x0a'+JSON[_0xe2ecfb(0xa6)](_0x1153bf[_0xe2ecfb(0xc1)])+'\x20';logger[_0xe2ecfb(0xa4)](_0x25b683),process[_0xe2ecfb(0xe7)](0x1);}};