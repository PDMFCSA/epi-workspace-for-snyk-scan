const a21_0xc61ed5=a21_0x500e;function a21_0xb170(){const _0x227844=['debug','init-not-called','../../config/constants','reconnecting-websocket','stack','command','2902824XncjwF','user','cloudProvider','bstackUsername','ceCLX','12951FsKWfN','hZKLt','parse','BCnNP','1921398BulnyU','LMnoj','skip-tls-cert-verify','OCDbV','etuPb','username','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','body','../../utils/instrumentationUtils','info','ImtUZ','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','string','omjJz','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','CSzpw','statusCode','../../config/logger','pvVPi','cXzzx','4824bLfKpC','8wLxOJk','unauthorised','70UIYtGY','Skip\x20insecure\x20cert\x20verification.','ERROR','qbzkP','fVjwA','WebSocket','clusterName','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','server-error','mUuTU','epilogue','fbmwG','wQHDg','stop-grid-called','../../cloudproviders/utils','grid','stop','usage','Stop\x20a\x20running\x20Automation\x20grid.','boolean','password','stringify','7809865sfoJep','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','gridId','<UsernamePlaceholder>','269008ZQcTXy','default','Grid\x20stoppped.','options','exit','jixKu','INFO','wcCNw','existsSync','248123yyHKtj','dilEI','13073370aCdbgQ','type','error','name','XffGw','uxJaD','grid-id','Adding\x20Websocket\x20listeners','builder','readFileSync','description','tyvTP','Browserstack','message','bstackAccesskey'];a21_0xb170=function(){return _0x227844;};return a21_0xb170();}(function(_0x23ef8a,_0x24db40){const _0x259543=a21_0x500e,_0x2bd863=_0x23ef8a();while(!![]){try{const _0x33ce04=-parseInt(_0x259543(0x209))/0x1*(-parseInt(_0x259543(0x1e4))/0x2)+-parseInt(_0x259543(0x1cf))/0x3+parseInt(_0x259543(0x200))/0x4*(-parseInt(_0x259543(0x1e6))/0x5)+parseInt(_0x259543(0x1c6))/0x6+parseInt(_0x259543(0x1fc))/0x7+parseInt(_0x259543(0x1e3))/0x8*(parseInt(_0x259543(0x1cb))/0x9)+-parseInt(_0x259543(0x20b))/0xa;if(_0x33ce04===_0x24db40)break;else _0x2bd863['push'](_0x2bd863['shift']());}catch(_0x3f04a3){_0x2bd863['push'](_0x2bd863['shift']());}}}(a21_0xb170,0x8b409));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0xc61ed5(0x1c3)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0xc61ed5(0x1c2)),{logger}=require(a21_0xc61ed5(0x1e0)),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require(a21_0xc61ed5(0x1d7)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require('../../utils/createk8sClient'),{getCloudProviderObject}=require(a21_0xc61ed5(0x1f4));function a21_0x500e(_0x36876e,_0x1be498){const _0xb1707d=a21_0xb170();return a21_0x500e=function(_0x500e50,_0x242020){_0x500e50=_0x500e50-0x1bf;let _0x40b7e5=_0xb1707d[_0x500e50];return _0x40b7e5;},a21_0x500e(_0x36876e,_0x1be498);}exports[a21_0xc61ed5(0x1c5)]=a21_0xc61ed5(0x1f5),exports['desc']=a21_0xc61ed5(0x1f8),exports[a21_0xc61ed5(0x213)]=function(_0x120a7d){const _0x360a5d=a21_0xc61ed5,_0x55cbee={};_0x55cbee['GAnsa']='Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.',_0x55cbee[_0x360a5d(0x1ca)]=_0x360a5d(0x1db),_0x55cbee[_0x360a5d(0x1cc)]=_0x360a5d(0x1e7),_0x55cbee['dilEI']=_0x360a5d(0x1f9),_0x55cbee[_0x360a5d(0x1d0)]='help';const _0x382b86=_0x55cbee,_0x5416d8={};_0x5416d8[_0x360a5d(0x215)]=_0x382b86['GAnsa'],_0x5416d8[_0x360a5d(0x20c)]=_0x382b86['ceCLX'];const _0x13d205={};_0x13d205['description']=_0x382b86[_0x360a5d(0x1cc)],_0x13d205[_0x360a5d(0x20c)]=_0x382b86[_0x360a5d(0x20a)],_0x13d205[_0x360a5d(0x201)]=![];const _0x1fdbea={};return _0x1fdbea[_0x360a5d(0x211)]=_0x5416d8,_0x1fdbea[_0x360a5d(0x1d1)]=_0x13d205,_0x120a7d[_0x360a5d(0x1f7)](HELP_HEADER_MESSAGE[_0x360a5d(0x1f6)])[_0x360a5d(0x1f0)](HELP_FOOTER_MESSAGE)[_0x360a5d(0x203)](_0x1fdbea)['help'](_0x382b86[_0x360a5d(0x1d0)])['argv'];},exports['handler']=async function(_0x5956aa){const _0x2f0ff0=a21_0xc61ed5,_0x4ebbd2={'etuPb':_0x2f0ff0(0x1ed),'omjJz':function(_0x127a99){return _0x127a99();},'ImtUZ':_0x2f0ff0(0x1dd),'cXzzx':function(_0x725b33,_0x383478,_0x5dc79b,_0x32d7f7,_0x14b4f2,_0xed5b3d,_0x374fa8){return _0x725b33(_0x383478,_0x5dc79b,_0x32d7f7,_0x14b4f2,_0xed5b3d,_0x374fa8);},'CSzpw':_0x2f0ff0(0x1f3),'qbzkP':_0x2f0ff0(0x1c1),'TGbMd':_0x2f0ff0(0x1ff),'wcCNw':'<PasswordPlaceholder>','fVjwA':_0x2f0ff0(0x212),'uxJaD':function(_0x50410b,_0x508135,_0x1472e0,_0x4bee2e){return _0x50410b(_0x508135,_0x1472e0,_0x4bee2e);},'tyvTP':function(_0x58b8d3,_0x219519,_0x16191a,_0x5517cb,_0xea0370,_0x483486,_0x5793c5){return _0x58b8d3(_0x219519,_0x16191a,_0x5517cb,_0xea0370,_0x483486,_0x5793c5);},'mUuTU':function(_0x51aaec,_0x39042e,_0x4a49e4){return _0x51aaec(_0x39042e,_0x4a49e4);},'XffGw':_0x2f0ff0(0x202),'pvVPi':function(_0x50e612,_0x4b0f64){return _0x50e612===_0x4b0f64;},'jixKu':_0x2f0ff0(0x1da),'wQHDg':_0x2f0ff0(0x1e5),'oRdgL':function(_0x5d80b5,_0x413a83){return _0x5d80b5===_0x413a83;},'fbmwG':'invalid-grid-id','OCDbV':function(_0x4ec2f3,_0x42717a,_0x3df99f,_0xb6288c,_0x179fcd,_0x9bcccd,_0x574b35){return _0x4ec2f3(_0x42717a,_0x3df99f,_0xb6288c,_0x179fcd,_0x9bcccd,_0x574b35);},'BCnNP':_0x2f0ff0(0x1ee)};let _0x4eab18;try{!_0x5956aa[_0x2f0ff0(0x1fe)]&&(logger[_0x2f0ff0(0x20d)](_0x4ebbd2[_0x2f0ff0(0x1d3)]),process[_0x2f0ff0(0x204)](0x1));!fs[_0x2f0ff0(0x208)](_0x4ebbd2[_0x2f0ff0(0x1dc)](getCredentialsPath))&&(logger['error'](_0x4ebbd2[_0x2f0ff0(0x1d9)]),await _0x4ebbd2[_0x2f0ff0(0x1e2)](sendInstrumentationEvent,_0x5956aa,_0x4ebbd2['CSzpw'],messageTypes['ERROR'],_0x4ebbd2[_0x2f0ff0(0x1e9)],null,_0x5956aa),process[_0x2f0ff0(0x204)](0x1));logger[_0x2f0ff0(0x1d8)]('Stopping\x20grid\x20'+_0x5956aa[_0x2f0ff0(0x1fe)]),await _0x4ebbd2[_0x2f0ff0(0x1e2)](sendInstrumentationEvent,_0x5956aa,_0x4ebbd2[_0x2f0ff0(0x1de)],messageTypes[_0x2f0ff0(0x206)],null,null,_0x5956aa);const _0x6ea7b=JSON[_0x2f0ff0(0x1cd)](fs[_0x2f0ff0(0x214)](_0x4ebbd2[_0x2f0ff0(0x1dc)](getCredentialsPath)));global_registry[_0x2f0ff0(0x1c9)]=_0x6ea7b['Browserstack'][_0x2f0ff0(0x1d4)],global_registry[_0x2f0ff0(0x1bf)]=_0x6ea7b['Browserstack'][_0x2f0ff0(0x1fa)];const _0x54ff87=WS_ENDPOINT['replace'](_0x4ebbd2['TGbMd'],_0x6ea7b[_0x2f0ff0(0x217)][_0x2f0ff0(0x1d4)])['replace'](_0x4ebbd2[_0x2f0ff0(0x207)],_0x6ea7b[_0x2f0ff0(0x217)][_0x2f0ff0(0x1fa)]),_0x5141a6={};_0x5141a6[_0x2f0ff0(0x1eb)]=ws,_0x5141a6['connectionTimeout']=0x36ee80,_0x4eab18=new ReconnectingWebSocket(_0x54ff87,[],_0x5141a6),logger[_0x2f0ff0(0x1c0)](_0x4ebbd2[_0x2f0ff0(0x1ea)]),webSocketUtils['addListeners'](_0x4eab18,_0x5956aa[_0x2f0ff0(0x1c7)],_0x5956aa[_0x2f0ff0(0x1fa)]);const [_0x42dc0b,_0x3943c9]=await _0x4ebbd2[_0x2f0ff0(0x210)](getGridDetails,_0x6ea7b['Browserstack'][_0x2f0ff0(0x1d4)],_0x6ea7b[_0x2f0ff0(0x217)][_0x2f0ff0(0x1fa)],_0x5956aa['gridId']);if(_0x3943c9){const _0x5b98c6=_0x3943c9[_0x2f0ff0(0x1d8)];global_registry[_0x2f0ff0(0x1c8)]=_0x5b98c6[_0x2f0ff0(0x1c8)],global_registry['clusterRegion']=_0x5b98c6['region'],global_registry[_0x2f0ff0(0x1ec)]=_0x5b98c6['clusterName'];const _0x1e902f=await _0x4ebbd2[_0x2f0ff0(0x216)](getCloudProviderObject,_0x5b98c6[_0x2f0ff0(0x1c8)],_0x5b98c6[_0x2f0ff0(0x1ec)],_0x5b98c6[_0x2f0ff0(0x20e)],_0x4eab18,webSocketUtils,_0x5956aa),[_0x265a6f,_0x47e08e,_0x366de0,_0x256e91,_0x5a9c67,_0xac3a74]=await _0x4ebbd2[_0x2f0ff0(0x1ef)](createK8sClient,_0x1e902f,_0x5956aa['skipTlsCertVerify']);await _0x4ebbd2['mUuTU'](scaleDownHubDeployment,_0x47e08e,_0x5b98c6[_0x2f0ff0(0x20e)]),logger['info'](_0x4ebbd2[_0x2f0ff0(0x20f)]),process[_0x2f0ff0(0x204)](0x0);}_0x4ebbd2[_0x2f0ff0(0x1e1)](_0x42dc0b[_0x2f0ff0(0x1df)],0x191)&&(logger['error'](_0x4ebbd2[_0x2f0ff0(0x205)]),await _0x4ebbd2[_0x2f0ff0(0x1e2)](sendInstrumentationEvent,_0x5956aa,_0x4ebbd2[_0x2f0ff0(0x1de)],messageTypes[_0x2f0ff0(0x1e8)],_0x4ebbd2[_0x2f0ff0(0x1f2)],null,_0x5956aa),process['exit'](0x1)),_0x4ebbd2['oRdgL'](_0x42dc0b[_0x2f0ff0(0x1df)],0x190)&&(logger['error'](JSON[_0x2f0ff0(0x1cd)](_0x42dc0b[_0x2f0ff0(0x1d6)])[_0x2f0ff0(0x218)]),await _0x4ebbd2[_0x2f0ff0(0x1e2)](sendInstrumentationEvent,_0x5956aa,_0x4ebbd2[_0x2f0ff0(0x1de)],messageTypes[_0x2f0ff0(0x1e8)],_0x4ebbd2[_0x2f0ff0(0x1f1)],null,_0x5956aa),process[_0x2f0ff0(0x204)](0x1)),logger['error'](_0x2f0ff0(0x1fd)+JSON[_0x2f0ff0(0x1fb)](_0x42dc0b)),await _0x4ebbd2[_0x2f0ff0(0x1d2)](sendInstrumentationEvent,_0x5956aa,_0x4ebbd2['CSzpw'],messageTypes[_0x2f0ff0(0x1e8)],_0x4ebbd2[_0x2f0ff0(0x1ce)],_0x42dc0b,_0x5956aa),process[_0x2f0ff0(0x204)](0x1);}catch(_0x27a03c){const _0x279db4=_0x2f0ff0(0x1d5)+_0x27a03c+'\x20\x0a'+JSON['stringify'](_0x27a03c[_0x2f0ff0(0x1c4)])+'\x20';logger[_0x2f0ff0(0x20d)](_0x279db4),process['exit'](0x1);}};