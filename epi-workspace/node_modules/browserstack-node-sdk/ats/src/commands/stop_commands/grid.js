const a21_0x40d87d=a21_0x1007;function a21_0x398e(){const _0x596252=['<PasswordPlaceholder>','ERROR','../../config/logger','3647124bxbblA','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','epilogue','invalid-grid-id','nXQLv','../../utils/gridComponents','grid-id','686885xbbRXG','skipTlsCertVerify','../../utils/instrumentationUtils','LwHOp','YyLDh','connectionTimeout','WebSocket','stack','command','ncGIW','../../config/constants','boolean','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','init-not-called','Adding\x20Websocket\x20listeners','string','AvxnF','JxhiN','type','36213OzIDXU','help','clusterName','gridId','region','1103893nKpIIm','unauthorised','password','argv','QkeJv','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','RSFFo','cloudProvider','name','user','error','JSkcV','scNtO','XpOwE','existsSync','info','12lbBhYj','Stop\x20a\x20running\x20Automation\x20grid.','statusCode','reconnecting-websocket','1287304gBkYsH','<UsernamePlaceholder>','description','readFileSync','MEfaD','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','skip-tls-cert-verify','stop','username','body','txEhl','../../utils/createk8sClient','AMoOI','hwbLH','bstackUsername','21337376oVzXhU','usage','kgeBS','desc','../../utils/webSocketUtils','options','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','myUlG','exit','default','Browserstack','3620199MYxJWy','handler','DvdPQ','message','bstackAccesskey','MWcCU'];a21_0x398e=function(){return _0x596252;};return a21_0x398e();}(function(_0x2c738a,_0x2903df){const _0x59dff5=a21_0x1007,_0x401509=_0x2c738a();while(!![]){try{const _0x379683=-parseInt(_0x59dff5(0x90))/0x1+parseInt(_0x59dff5(0xa9))/0x2+-parseInt(_0x59dff5(0xc3))/0x3+-parseInt(_0x59dff5(0x76))/0x4+parseInt(_0x59dff5(0x7d))/0x5+parseInt(_0x59dff5(0xa5))/0x6*(-parseInt(_0x59dff5(0x95))/0x7)+parseInt(_0x59dff5(0xb8))/0x8;if(_0x379683===_0x2903df)break;else _0x401509['push'](_0x401509['shift']());}catch(_0x305195){_0x401509['push'](_0x401509['shift']());}}}(a21_0x398e,0xeec9c));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x40d87d(0xa8)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x40d87d(0x87)),{logger}=require(a21_0x40d87d(0x75)),{getCredentialsPath,getGridDetails}=require('../../utils/utilityMethods'),{scaleDownHubDeployment}=require(a21_0x40d87d(0x7b)),{sendInstrumentationEvent}=require(a21_0x40d87d(0x7f)),webSocketUtils=require(a21_0x40d87d(0xbc)),{createK8sClient}=require(a21_0x40d87d(0xb4)),{getCloudProviderObject}=require('../../cloudproviders/utils');function a21_0x1007(_0x10a980,_0x2a6aa0){const _0x398e19=a21_0x398e();return a21_0x1007=function(_0x100775,_0x5eb099){_0x100775=_0x100775-0x75;let _0x403444=_0x398e19[_0x100775];return _0x403444;},a21_0x1007(_0x10a980,_0x2a6aa0);}exports[a21_0x40d87d(0x85)]='grid',exports[a21_0x40d87d(0xbb)]=a21_0x40d87d(0xa6),exports['builder']=function(_0x1523f8){const _0x404826=a21_0x40d87d,_0x1b98ba={};_0x1b98ba[_0x404826(0x8e)]=_0x404826(0xae),_0x1b98ba[_0x404826(0xa2)]=_0x404826(0x8c),_0x1b98ba[_0x404826(0x9b)]='Skip\x20insecure\x20cert\x20verification.',_0x1b98ba[_0x404826(0xb5)]=_0x404826(0x88),_0x1b98ba['tudoa']=_0x404826(0x91);const _0x3220d0=_0x1b98ba,_0x4cddaa={};_0x4cddaa[_0x404826(0xab)]=_0x3220d0['JxhiN'],_0x4cddaa[_0x404826(0x8f)]=_0x3220d0['XpOwE'];const _0x3aa181={};_0x3aa181['description']=_0x3220d0[_0x404826(0x9b)],_0x3aa181[_0x404826(0x8f)]=_0x3220d0[_0x404826(0xb5)],_0x3aa181[_0x404826(0xc1)]=![];const _0x535797={};return _0x535797[_0x404826(0x7c)]=_0x4cddaa,_0x535797[_0x404826(0xaf)]=_0x3aa181,_0x1523f8[_0x404826(0xb9)](HELP_HEADER_MESSAGE[_0x404826(0xb0)])[_0x404826(0x78)](HELP_FOOTER_MESSAGE)[_0x404826(0xbd)](_0x535797)['help'](_0x3220d0['tudoa'])[_0x404826(0x98)];},exports[a21_0x40d87d(0xc4)]=async function(_0x4bcdab){const _0x1398ff=a21_0x40d87d,_0x1eb35d={'YyLDh':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','kDheu':function(_0xf01e23){return _0xf01e23();},'TAwPk':_0x1398ff(0xbe),'kgeBS':function(_0x2b623b,_0x16a0d1,_0x9a1bf5,_0xf576ee,_0xab0f9f,_0x4787c0,_0x3b1989){return _0x2b623b(_0x16a0d1,_0x9a1bf5,_0xf576ee,_0xab0f9f,_0x4787c0,_0x3b1989);},'nXQLv':'stop-grid-called','JSkcV':_0x1398ff(0x8a),'hwbLH':function(_0x5e5a0b,_0x59890e,_0x2b0842,_0x215742,_0x2091e3,_0x44c1d6,_0x2f97c4){return _0x5e5a0b(_0x59890e,_0x2b0842,_0x215742,_0x2091e3,_0x44c1d6,_0x2f97c4);},'cVXGp':function(_0x26ceb9){return _0x26ceb9();},'uwmke':_0x1398ff(0xaa),'scNtO':_0x1398ff(0xc9),'DvdPQ':_0x1398ff(0x8b),'hZEcA':function(_0x3d9dff,_0x39e829,_0x5c6729,_0x288fe1){return _0x3d9dff(_0x39e829,_0x5c6729,_0x288fe1);},'AvxnF':function(_0x17bca8,_0x3fb7d1,_0x2e244f){return _0x17bca8(_0x3fb7d1,_0x2e244f);},'myUlG':function(_0xf17430,_0x371be0,_0x13d67b){return _0xf17430(_0x371be0,_0x13d67b);},'MWcCU':'Grid\x20stoppped.','LwHOp':function(_0x1e90ca,_0x536248){return _0x1e90ca===_0x536248;},'MEfaD':_0x1398ff(0x89),'txEhl':_0x1398ff(0x96),'liuPb':function(_0x2586e8,_0x22bda9){return _0x2586e8===_0x22bda9;},'QkeJv':_0x1398ff(0x79),'ncGIW':'server-error'};let _0x5a0570;try{!_0x4bcdab[_0x1398ff(0x93)]&&(logger[_0x1398ff(0x9f)](_0x1eb35d[_0x1398ff(0x81)]),process[_0x1398ff(0xc0)](0x1));!fs[_0x1398ff(0xa3)](_0x1eb35d['kDheu'](getCredentialsPath))&&(logger[_0x1398ff(0x9f)](_0x1eb35d['TAwPk']),await _0x1eb35d['kgeBS'](sendInstrumentationEvent,_0x4bcdab,_0x1eb35d['nXQLv'],messageTypes[_0x1398ff(0xca)],_0x1eb35d[_0x1398ff(0xa0)],null,_0x4bcdab),process[_0x1398ff(0xc0)](0x1));logger[_0x1398ff(0xa4)]('Stopping\x20grid\x20'+_0x4bcdab[_0x1398ff(0x93)]),await _0x1eb35d[_0x1398ff(0xb6)](sendInstrumentationEvent,_0x4bcdab,_0x1eb35d['nXQLv'],messageTypes['INFO'],null,null,_0x4bcdab);const _0x39cdc7=JSON['parse'](fs[_0x1398ff(0xac)](_0x1eb35d['cVXGp'](getCredentialsPath)));global_registry[_0x1398ff(0xb7)]=_0x39cdc7[_0x1398ff(0xc2)]['username'],global_registry[_0x1398ff(0xc7)]=_0x39cdc7['Browserstack'][_0x1398ff(0x97)];const _0xec67e4=WS_ENDPOINT['replace'](_0x1eb35d['uwmke'],_0x39cdc7[_0x1398ff(0xc2)][_0x1398ff(0xb1)])['replace'](_0x1eb35d[_0x1398ff(0xa1)],_0x39cdc7[_0x1398ff(0xc2)][_0x1398ff(0x97)]),_0x1ca27e={};_0x1ca27e[_0x1398ff(0x83)]=ws,_0x1ca27e[_0x1398ff(0x82)]=0x36ee80,_0x5a0570=new ReconnectingWebSocket(_0xec67e4,[],_0x1ca27e),logger['debug'](_0x1eb35d[_0x1398ff(0xc5)]),webSocketUtils['addListeners'](_0x5a0570,_0x4bcdab[_0x1398ff(0x9e)],_0x4bcdab['password']);const [_0x1a0fec,_0x406906]=await _0x1eb35d['hZEcA'](getGridDetails,_0x39cdc7['Browserstack'][_0x1398ff(0xb1)],_0x39cdc7[_0x1398ff(0xc2)][_0x1398ff(0x97)],_0x4bcdab[_0x1398ff(0x93)]);if(_0x406906){const _0xdb9db=_0x406906['info'];global_registry[_0x1398ff(0x9c)]=_0xdb9db[_0x1398ff(0x9c)],global_registry['clusterRegion']=_0xdb9db[_0x1398ff(0x94)],global_registry[_0x1398ff(0x92)]=_0xdb9db[_0x1398ff(0x92)];const _0x5eb537=await _0x1eb35d['kgeBS'](getCloudProviderObject,_0xdb9db['cloudProvider'],_0xdb9db['clusterName'],_0xdb9db[_0x1398ff(0x9d)],_0x5a0570,webSocketUtils,_0x4bcdab),[_0x2c4c11,_0x2a3c07,_0x2a07ed,_0xaa2aa7,_0x1eb8c6,_0x16f405]=await _0x1eb35d[_0x1398ff(0x8d)](createK8sClient,_0x5eb537,_0x4bcdab[_0x1398ff(0x7e)]);await _0x1eb35d[_0x1398ff(0xbf)](scaleDownHubDeployment,_0x2a3c07,_0xdb9db[_0x1398ff(0x9d)]),logger['info'](_0x1eb35d[_0x1398ff(0xc8)]),process[_0x1398ff(0xc0)](0x0);}_0x1eb35d[_0x1398ff(0x80)](_0x1a0fec[_0x1398ff(0xa7)],0x191)&&(logger[_0x1398ff(0x9f)](_0x1eb35d[_0x1398ff(0xad)]),await _0x1eb35d[_0x1398ff(0xba)](sendInstrumentationEvent,_0x4bcdab,_0x1eb35d[_0x1398ff(0x7a)],messageTypes[_0x1398ff(0xca)],_0x1eb35d[_0x1398ff(0xb3)],null,_0x4bcdab),process[_0x1398ff(0xc0)](0x1)),_0x1eb35d['liuPb'](_0x1a0fec[_0x1398ff(0xa7)],0x190)&&(logger[_0x1398ff(0x9f)](JSON['parse'](_0x1a0fec[_0x1398ff(0xb2)])[_0x1398ff(0xc6)]),await _0x1eb35d[_0x1398ff(0xb6)](sendInstrumentationEvent,_0x4bcdab,_0x1eb35d['nXQLv'],messageTypes[_0x1398ff(0xca)],_0x1eb35d[_0x1398ff(0x99)],null,_0x4bcdab),process[_0x1398ff(0xc0)](0x1)),logger['error'](_0x1398ff(0x9a)+JSON['stringify'](_0x1a0fec)),await _0x1eb35d[_0x1398ff(0xba)](sendInstrumentationEvent,_0x4bcdab,_0x1eb35d[_0x1398ff(0x7a)],messageTypes[_0x1398ff(0xca)],_0x1eb35d[_0x1398ff(0x86)],_0x1a0fec,_0x4bcdab),process[_0x1398ff(0xc0)](0x1);}catch(_0x1f9023){const _0x5c33a5=_0x1398ff(0x77)+_0x1f9023+'\x20\x0a'+JSON['stringify'](_0x1f9023[_0x1398ff(0x84)])+'\x20';logger[_0x1398ff(0x9f)](_0x5c33a5),process[_0x1398ff(0xc0)](0x1);}};