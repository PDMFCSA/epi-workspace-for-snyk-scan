const a21_0x27f1b1=a21_0x2cc6;(function(_0x45424c,_0x2ed8bc){const _0x11794d=a21_0x2cc6,_0x3b637d=_0x45424c();while(!![]){try{const _0x31952c=-parseInt(_0x11794d(0x13e))/0x1+-parseInt(_0x11794d(0x13c))/0x2*(parseInt(_0x11794d(0x15f))/0x3)+-parseInt(_0x11794d(0x132))/0x4*(-parseInt(_0x11794d(0x192))/0x5)+parseInt(_0x11794d(0x188))/0x6*(-parseInt(_0x11794d(0x151))/0x7)+parseInt(_0x11794d(0x154))/0x8*(parseInt(_0x11794d(0x167))/0x9)+-parseInt(_0x11794d(0x190))/0xa+-parseInt(_0x11794d(0x133))/0xb*(-parseInt(_0x11794d(0x134))/0xc);if(_0x31952c===_0x2ed8bc)break;else _0x3b637d['push'](_0x3b637d['shift']());}catch(_0x34b1c8){_0x3b637d['push'](_0x3b637d['shift']());}}}(a21_0x473d,0x7e8be));function a21_0x473d(){const _0x408758=['name','IHmdp','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','clusterName','region','../../config/logger','skip-tls-cert-verify','unauthorised','elRMU','grid-id','JYmWi','message','argv','boolean','Skip\x20insecure\x20cert\x20verification.','body','24JoVpcV','wJeQN','FunkH','Grid\x20stoppped.','desc','readFileSync','../../config/constants','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','7765070mIKAAL','ERROR','30050PIcxnS','invalid-grid-id','username','dqzej','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','command','108gbXMtK','253wIIbfi','918024JfCZjb','ibKSE','INFO','password','kNkBY','info','ONTQD','epilogue','2TJCmTf','Stop\x20a\x20running\x20Automation\x20grid.','134191qlnPAG','addListeners','default','ZUymg','Browserstack','../../utils/instrumentationUtils','haQol','description','ivVBw','KEovz','jeAUZ','bstackAccesskey','nCpPR','server-error','connectionTimeout','jjcFU','usage','skGEZ','WebSocket','1652357MLpRRL','options','frgeE','1214264xcMHoO','../../cloudproviders/utils','init-not-called','../../utils/gridComponents','error','Stopping\x20grid\x20','cwrzD','type','SwSvS','../../utils/createk8sClient','grid','11787kJoTpG','skipTlsCertVerify','user','parse','AHcNd','exit','replace','cloudProvider','27cRBlnu','<PasswordPlaceholder>','KmZfs','stringify','../../utils/utilityMethods','bstackUsername','handler','stop-grid-called','gridId','hVuXN','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','mpMgn','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','DgNDc','reconnecting-websocket','help','statusCode'];a21_0x473d=function(){return _0x408758;};return a21_0x473d();}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x27f1b1(0x175)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x27f1b1(0x18e)),{logger}=require(a21_0x27f1b1(0x17d)),{getCredentialsPath,getGridDetails}=require(a21_0x27f1b1(0x16b)),{scaleDownHubDeployment}=require(a21_0x27f1b1(0x157)),{sendInstrumentationEvent}=require(a21_0x27f1b1(0x143)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x27f1b1(0x15d)),{getCloudProviderObject}=require(a21_0x27f1b1(0x155));function a21_0x2cc6(_0x575f2e,_0x16b9a1){const _0x473d96=a21_0x473d();return a21_0x2cc6=function(_0x2cc6d9,_0x5934ac){_0x2cc6d9=_0x2cc6d9-0x132;let _0x5ed11b=_0x473d96[_0x2cc6d9];return _0x5ed11b;},a21_0x2cc6(_0x575f2e,_0x16b9a1);}exports[a21_0x27f1b1(0x197)]=a21_0x27f1b1(0x15e),exports[a21_0x27f1b1(0x18c)]=a21_0x27f1b1(0x13d),exports['builder']=function(_0x5b44a5){const _0x4ffe61=a21_0x27f1b1,_0x724f24={};_0x724f24[_0x4ffe61(0x146)]=_0x4ffe61(0x171),_0x724f24[_0x4ffe61(0x195)]='string',_0x724f24['haQol']=_0x4ffe61(0x186),_0x724f24[_0x4ffe61(0x189)]=_0x4ffe61(0x185),_0x724f24[_0x4ffe61(0x14f)]=_0x4ffe61(0x176);const _0x1d144e=_0x724f24,_0x52201c={};_0x52201c['description']=_0x1d144e['ivVBw'],_0x52201c[_0x4ffe61(0x15b)]=_0x1d144e['dqzej'];const _0x12b638={};_0x12b638[_0x4ffe61(0x145)]=_0x1d144e[_0x4ffe61(0x144)],_0x12b638[_0x4ffe61(0x15b)]=_0x1d144e[_0x4ffe61(0x189)],_0x12b638[_0x4ffe61(0x140)]=![];const _0x17ec7c={};return _0x17ec7c[_0x4ffe61(0x181)]=_0x52201c,_0x17ec7c[_0x4ffe61(0x17e)]=_0x12b638,_0x5b44a5[_0x4ffe61(0x14e)](HELP_HEADER_MESSAGE['stop'])[_0x4ffe61(0x13b)](HELP_FOOTER_MESSAGE)[_0x4ffe61(0x152)](_0x17ec7c)[_0x4ffe61(0x176)](_0x1d144e[_0x4ffe61(0x14f)])[_0x4ffe61(0x184)];},exports[a21_0x27f1b1(0x16d)]=async function(_0x2f1841){const _0x5b0bcb=a21_0x27f1b1,_0x46d28e={'JYmWi':_0x5b0bcb(0x17a),'elRMU':function(_0x36b46d){return _0x36b46d();},'nCpPR':_0x5b0bcb(0x173),'jeAUZ':function(_0xe963f3,_0x4d6b70,_0x31ab35,_0x1adcf7,_0x43459d,_0x565260,_0x4501eb){return _0xe963f3(_0x4d6b70,_0x31ab35,_0x1adcf7,_0x43459d,_0x565260,_0x4501eb);},'SwSvS':_0x5b0bcb(0x16e),'mpMgn':_0x5b0bcb(0x156),'kNkBY':function(_0x2fbbea){return _0x2fbbea();},'DgNDc':'<UsernamePlaceholder>','jjcFU':_0x5b0bcb(0x168),'KmZfs':'Adding\x20Websocket\x20listeners','cwrzD':function(_0x247b24,_0x33d6e7,_0x1fab89,_0xfe2837){return _0x247b24(_0x33d6e7,_0x1fab89,_0xfe2837);},'FunkH':function(_0x189223,_0x544e96,_0x4bee47){return _0x189223(_0x544e96,_0x4bee47);},'IHmdp':function(_0xb5b3bb,_0x18eca9,_0x16c40e){return _0xb5b3bb(_0x18eca9,_0x16c40e);},'ZUymg':_0x5b0bcb(0x18b),'hVuXN':function(_0xf065ce,_0x5d3872){return _0xf065ce===_0x5d3872;},'ibKSE':_0x5b0bcb(0x196),'KEovz':function(_0x52976e,_0x2a2307,_0x44b321,_0x1a2be9,_0xa75a9b,_0x40fe05,_0x1937e1){return _0x52976e(_0x2a2307,_0x44b321,_0x1a2be9,_0xa75a9b,_0x40fe05,_0x1937e1);},'ONTQD':_0x5b0bcb(0x17f),'AHcNd':function(_0x20e17f,_0x490830){return _0x20e17f===_0x490830;},'WtUoy':_0x5b0bcb(0x193),'frgeE':_0x5b0bcb(0x14b)};let _0x23d51e;try{!_0x2f1841[_0x5b0bcb(0x16f)]&&(logger['error'](_0x46d28e[_0x5b0bcb(0x182)]),process[_0x5b0bcb(0x164)](0x1));!fs['existsSync'](_0x46d28e[_0x5b0bcb(0x180)](getCredentialsPath))&&(logger[_0x5b0bcb(0x158)](_0x46d28e[_0x5b0bcb(0x14a)]),await _0x46d28e[_0x5b0bcb(0x148)](sendInstrumentationEvent,_0x2f1841,_0x46d28e[_0x5b0bcb(0x15c)],messageTypes[_0x5b0bcb(0x191)],_0x46d28e[_0x5b0bcb(0x172)],null,_0x2f1841),process['exit'](0x1));logger[_0x5b0bcb(0x139)](_0x5b0bcb(0x159)+_0x2f1841['gridId']),await _0x46d28e[_0x5b0bcb(0x148)](sendInstrumentationEvent,_0x2f1841,_0x46d28e[_0x5b0bcb(0x15c)],messageTypes[_0x5b0bcb(0x136)],null,null,_0x2f1841);const _0x198cab=JSON[_0x5b0bcb(0x162)](fs[_0x5b0bcb(0x18d)](_0x46d28e[_0x5b0bcb(0x138)](getCredentialsPath)));global_registry[_0x5b0bcb(0x16c)]=_0x198cab[_0x5b0bcb(0x142)]['username'],global_registry[_0x5b0bcb(0x149)]=_0x198cab['Browserstack'][_0x5b0bcb(0x137)];const _0x2e099e=WS_ENDPOINT[_0x5b0bcb(0x165)](_0x46d28e[_0x5b0bcb(0x174)],_0x198cab[_0x5b0bcb(0x142)][_0x5b0bcb(0x194)])[_0x5b0bcb(0x165)](_0x46d28e[_0x5b0bcb(0x14d)],_0x198cab[_0x5b0bcb(0x142)][_0x5b0bcb(0x137)]),_0x5bbf85={};_0x5bbf85[_0x5b0bcb(0x150)]=ws,_0x5bbf85[_0x5b0bcb(0x14c)]=0x36ee80,_0x23d51e=new ReconnectingWebSocket(_0x2e099e,[],_0x5bbf85),logger['debug'](_0x46d28e[_0x5b0bcb(0x169)]),webSocketUtils[_0x5b0bcb(0x13f)](_0x23d51e,_0x2f1841[_0x5b0bcb(0x161)],_0x2f1841['password']);const [_0x1e7179,_0x687584]=await _0x46d28e[_0x5b0bcb(0x15a)](getGridDetails,_0x198cab[_0x5b0bcb(0x142)]['username'],_0x198cab[_0x5b0bcb(0x142)][_0x5b0bcb(0x137)],_0x2f1841[_0x5b0bcb(0x16f)]);if(_0x687584){const _0x1cef3c=_0x687584[_0x5b0bcb(0x139)];global_registry[_0x5b0bcb(0x166)]=_0x1cef3c[_0x5b0bcb(0x166)],global_registry['clusterRegion']=_0x1cef3c[_0x5b0bcb(0x17c)],global_registry['clusterName']=_0x1cef3c['clusterName'];const _0x2a5ab3=await _0x46d28e[_0x5b0bcb(0x148)](getCloudProviderObject,_0x1cef3c['cloudProvider'],_0x1cef3c[_0x5b0bcb(0x17b)],_0x1cef3c[_0x5b0bcb(0x178)],_0x23d51e,webSocketUtils,_0x2f1841),[_0x445ae0,_0x406ce5,_0x396fdd,_0x2bbe85,_0x1892d1,_0x7c2906]=await _0x46d28e[_0x5b0bcb(0x18a)](createK8sClient,_0x2a5ab3,_0x2f1841[_0x5b0bcb(0x160)]);await _0x46d28e[_0x5b0bcb(0x179)](scaleDownHubDeployment,_0x406ce5,_0x1cef3c[_0x5b0bcb(0x178)]),logger[_0x5b0bcb(0x139)](_0x46d28e[_0x5b0bcb(0x141)]),process[_0x5b0bcb(0x164)](0x0);}_0x46d28e[_0x5b0bcb(0x170)](_0x1e7179[_0x5b0bcb(0x177)],0x191)&&(logger[_0x5b0bcb(0x158)](_0x46d28e[_0x5b0bcb(0x135)]),await _0x46d28e[_0x5b0bcb(0x147)](sendInstrumentationEvent,_0x2f1841,_0x46d28e[_0x5b0bcb(0x15c)],messageTypes['ERROR'],_0x46d28e[_0x5b0bcb(0x13a)],null,_0x2f1841),process['exit'](0x1)),_0x46d28e[_0x5b0bcb(0x163)](_0x1e7179[_0x5b0bcb(0x177)],0x190)&&(logger[_0x5b0bcb(0x158)](JSON[_0x5b0bcb(0x162)](_0x1e7179[_0x5b0bcb(0x187)])[_0x5b0bcb(0x183)]),await _0x46d28e['jeAUZ'](sendInstrumentationEvent,_0x2f1841,_0x46d28e[_0x5b0bcb(0x15c)],messageTypes[_0x5b0bcb(0x191)],_0x46d28e['WtUoy'],null,_0x2f1841),process[_0x5b0bcb(0x164)](0x1)),logger[_0x5b0bcb(0x158)](_0x5b0bcb(0x18f)+JSON['stringify'](_0x1e7179)),await _0x46d28e[_0x5b0bcb(0x147)](sendInstrumentationEvent,_0x2f1841,_0x46d28e[_0x5b0bcb(0x15c)],messageTypes[_0x5b0bcb(0x191)],_0x46d28e[_0x5b0bcb(0x153)],_0x1e7179,_0x2f1841),process[_0x5b0bcb(0x164)](0x1);}catch(_0x3c30b4){const _0x2c0cb5='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x3c30b4+'\x20\x0a'+JSON[_0x5b0bcb(0x16a)](_0x3c30b4['stack'])+'\x20';logger[_0x5b0bcb(0x158)](_0x2c0cb5),process['exit'](0x1);}};