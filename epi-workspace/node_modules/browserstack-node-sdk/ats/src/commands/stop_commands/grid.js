const a21_0x16d6b8=a21_0x488e;function a21_0x9a97(){const _0x4e06b9=['jVYJO','223544zERlCA','replace','parse','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','skipTlsCertVerify','existsSync','error','options','cloudProvider','skip-tls-cert-verify','Stopping\x20grid\x20','GiILi','string','VonyX','Adding\x20Websocket\x20listeners','../../utils/utilityMethods','clusterName','grid','init-not-called','ERROR','471079vKRfiE','gridId','sJrFB','15YRJpZa','clusterRegion','username','Grid\x20stoppped.','<UsernamePlaceholder>','statusCode','DXDOk','description','stringify','invalid-grid-id','debug','JaZhr','Skip\x20insecure\x20cert\x20verification.','pYqaO','teeUC','default','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','9540720Zgkjhq','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','EmqJx','reconnecting-websocket','../../config/constants','152898uIDZgw','exit','1201268NFpQQE','body','AvBzp','ULnpS','info','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','user','rtTxW','kUWAy','argv','WebSocket','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','dQgvG','handler','qmbro','bstackUsername','name','command','<PasswordPlaceholder>','server-error','usage','grid-id','stack','builder','help','hPtPm','jUumQ','178520vbyxJE','../../utils/gridComponents','type','iEAqc','desc','3nQuAyl','INFO','../../utils/createk8sClient','readFileSync','442182IavOVl','password','../../utils/instrumentationUtils','Browserstack','../../cloudproviders/utils','36bfTVku','stop-grid-called'];a21_0x9a97=function(){return _0x4e06b9;};return a21_0x9a97();}(function(_0x4703ef,_0x3151e0){const _0x1aabc1=a21_0x488e,_0x50c7a5=_0x4703ef();while(!![]){try{const _0x217fa1=-parseInt(_0x1aabc1(0xaf))/0x1+parseInt(_0x1aabc1(0xed))/0x2*(parseInt(_0x1aabc1(0xb4))/0x3)+-parseInt(_0x1aabc1(0xef))/0x4+parseInt(_0x1aabc1(0xd7))/0x5*(-parseInt(_0x1aabc1(0xb8))/0x6)+-parseInt(_0x1aabc1(0xd4))/0x7+-parseInt(_0x1aabc1(0xc0))/0x8*(parseInt(_0x1aabc1(0xbd))/0x9)+parseInt(_0x1aabc1(0xe8))/0xa;if(_0x217fa1===_0x3151e0)break;else _0x50c7a5['push'](_0x50c7a5['shift']());}catch(_0x1beda9){_0x50c7a5['push'](_0x50c7a5['shift']());}}}(a21_0x9a97,0x24fe4));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x16d6b8(0xeb)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x16d6b8(0xec)),{logger}=require('../../config/logger'),{getCredentialsPath,getGridDetails}=require(a21_0x16d6b8(0xcf)),{scaleDownHubDeployment}=require(a21_0x16d6b8(0xb0)),{sendInstrumentationEvent}=require(a21_0x16d6b8(0xba)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x16d6b8(0xb6)),{getCloudProviderObject}=require(a21_0x16d6b8(0xbc));function a21_0x488e(_0xe31723,_0x5c9388){const _0x9a9707=a21_0x9a97();return a21_0x488e=function(_0x488e3e,_0x2a19e8){_0x488e3e=_0x488e3e-0x9f;let _0x6d050d=_0x9a9707[_0x488e3e];return _0x6d050d;},a21_0x488e(_0xe31723,_0x5c9388);}exports[a21_0x16d6b8(0xa5)]=a21_0x16d6b8(0xd1),exports[a21_0x16d6b8(0xb3)]='Stop\x20a\x20running\x20Automation\x20grid.',exports[a21_0x16d6b8(0xab)]=function(_0x5d6c34){const _0x5a40a7=a21_0x16d6b8,_0xda36ea={};_0xda36ea[_0x5a40a7(0xf2)]=_0x5a40a7(0x9f),_0xda36ea[_0x5a40a7(0xa0)]=_0x5a40a7(0xcc),_0xda36ea[_0x5a40a7(0xad)]=_0x5a40a7(0xe3),_0xda36ea['rtTxW']='boolean',_0xda36ea[_0x5a40a7(0xe2)]='help';const _0x16ee9d=_0xda36ea,_0x429124={};_0x429124[_0x5a40a7(0xde)]=_0x16ee9d['ULnpS'],_0x429124[_0x5a40a7(0xb1)]=_0x16ee9d[_0x5a40a7(0xa0)];const _0x87d45d={};_0x87d45d['description']=_0x16ee9d[_0x5a40a7(0xad)],_0x87d45d[_0x5a40a7(0xb1)]=_0x16ee9d[_0x5a40a7(0xf6)],_0x87d45d[_0x5a40a7(0xe6)]=![];const _0x11c640={};return _0x11c640[_0x5a40a7(0xa9)]=_0x429124,_0x11c640[_0x5a40a7(0xc9)]=_0x87d45d,_0x5d6c34[_0x5a40a7(0xa8)](HELP_HEADER_MESSAGE['stop'])['epilogue'](HELP_FOOTER_MESSAGE)[_0x5a40a7(0xc7)](_0x11c640)[_0x5a40a7(0xac)](_0x16ee9d[_0x5a40a7(0xe2)])[_0x5a40a7(0xf8)];},exports[a21_0x16d6b8(0xa1)]=async function(_0x2b6e59){const _0x4f1329=a21_0x16d6b8,_0x185083={'qmbro':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','fKMxq':function(_0x4d87fa){return _0x4d87fa();},'pYqaO':_0x4f1329(0xf4),'uQiMt':function(_0x17cc37,_0x53e001,_0xe7b338,_0x19c95c,_0x398125,_0x37a533,_0x93e03a){return _0x17cc37(_0x53e001,_0xe7b338,_0x19c95c,_0x398125,_0x37a533,_0x93e03a);},'jUumQ':_0x4f1329(0xbe),'sJrFB':_0x4f1329(0xd2),'GiILi':function(_0xfa8819,_0x5ba3cb,_0xb98e76,_0x67326a,_0x1f0161,_0xc5de0a,_0x203b69){return _0xfa8819(_0x5ba3cb,_0xb98e76,_0x67326a,_0x1f0161,_0xc5de0a,_0x203b69);},'irzNC':_0x4f1329(0xdb),'AUzJV':_0x4f1329(0xa6),'LFUaW':_0x4f1329(0xce),'AvBzp':function(_0x420d46,_0x25bba4,_0x1fbc60,_0x2afe99){return _0x420d46(_0x25bba4,_0x1fbc60,_0x2afe99);},'jVYJO':function(_0x3a5148,_0x1b42d9,_0x503e2f){return _0x3a5148(_0x1b42d9,_0x503e2f);},'kUWAy':_0x4f1329(0xda),'iEAqc':function(_0x41cd4d,_0x4c052e){return _0x41cd4d===_0x4c052e;},'PEfus':_0x4f1329(0xc3),'KrgUI':function(_0x4d21c0,_0x51e7d9,_0xf60905,_0x449cfc,_0x591485,_0x1ba455,_0x157747){return _0x4d21c0(_0x51e7d9,_0xf60905,_0x449cfc,_0x591485,_0x1ba455,_0x157747);},'VonyX':'unauthorised','EmqJx':_0x4f1329(0xe0),'teeUC':function(_0x4342d5,_0x434ace,_0x32529e,_0x2fe21e,_0x1f806a,_0x526fc9,_0x1273ad){return _0x4342d5(_0x434ace,_0x32529e,_0x2fe21e,_0x1f806a,_0x526fc9,_0x1273ad);},'DXDOk':_0x4f1329(0xa7)};let _0x1ed276;try{!_0x2b6e59[_0x4f1329(0xd5)]&&(logger[_0x4f1329(0xc6)](_0x185083[_0x4f1329(0xa2)]),process[_0x4f1329(0xee)](0x1));!fs[_0x4f1329(0xc5)](_0x185083['fKMxq'](getCredentialsPath))&&(logger[_0x4f1329(0xc6)](_0x185083[_0x4f1329(0xe4)]),await _0x185083['uQiMt'](sendInstrumentationEvent,_0x2b6e59,_0x185083[_0x4f1329(0xae)],messageTypes[_0x4f1329(0xd3)],_0x185083[_0x4f1329(0xd6)],null,_0x2b6e59),process[_0x4f1329(0xee)](0x1));logger[_0x4f1329(0xf3)](_0x4f1329(0xca)+_0x2b6e59[_0x4f1329(0xd5)]),await _0x185083[_0x4f1329(0xcb)](sendInstrumentationEvent,_0x2b6e59,_0x185083[_0x4f1329(0xae)],messageTypes[_0x4f1329(0xb5)],null,null,_0x2b6e59);const _0x40e922=JSON[_0x4f1329(0xc2)](fs[_0x4f1329(0xb7)](_0x185083['fKMxq'](getCredentialsPath)));global_registry[_0x4f1329(0xa3)]=_0x40e922[_0x4f1329(0xbb)][_0x4f1329(0xd9)],global_registry['bstackAccesskey']=_0x40e922['Browserstack'][_0x4f1329(0xb9)];const _0x4f7da5=WS_ENDPOINT[_0x4f1329(0xc1)](_0x185083['irzNC'],_0x40e922[_0x4f1329(0xbb)]['username'])[_0x4f1329(0xc1)](_0x185083['AUzJV'],_0x40e922[_0x4f1329(0xbb)][_0x4f1329(0xb9)]),_0x279574={};_0x279574[_0x4f1329(0xf9)]=ws,_0x279574['connectionTimeout']=0x36ee80,_0x1ed276=new ReconnectingWebSocket(_0x4f7da5,[],_0x279574),logger[_0x4f1329(0xe1)](_0x185083['LFUaW']),webSocketUtils['addListeners'](_0x1ed276,_0x2b6e59[_0x4f1329(0xf5)],_0x2b6e59[_0x4f1329(0xb9)]);const [_0x400174,_0xa3c6d6]=await _0x185083[_0x4f1329(0xf1)](getGridDetails,_0x40e922['Browserstack'][_0x4f1329(0xd9)],_0x40e922[_0x4f1329(0xbb)][_0x4f1329(0xb9)],_0x2b6e59[_0x4f1329(0xd5)]);if(_0xa3c6d6){const _0x3547a0=_0xa3c6d6['info'];global_registry[_0x4f1329(0xc8)]=_0x3547a0[_0x4f1329(0xc8)],global_registry[_0x4f1329(0xd8)]=_0x3547a0['region'],global_registry[_0x4f1329(0xd0)]=_0x3547a0['clusterName'];const _0x465c5e=await _0x185083['uQiMt'](getCloudProviderObject,_0x3547a0[_0x4f1329(0xc8)],_0x3547a0[_0x4f1329(0xd0)],_0x3547a0[_0x4f1329(0xa4)],_0x1ed276,webSocketUtils,_0x2b6e59),[_0x1bb006,_0x21a2fb,_0x3b1e47,_0x18ee80,_0x38898a,_0x4b719f]=await _0x185083[_0x4f1329(0xbf)](createK8sClient,_0x465c5e,_0x2b6e59[_0x4f1329(0xc4)]);await _0x185083[_0x4f1329(0xbf)](scaleDownHubDeployment,_0x21a2fb,_0x3547a0['name']),logger[_0x4f1329(0xf3)](_0x185083[_0x4f1329(0xf7)]),process[_0x4f1329(0xee)](0x0);}_0x185083[_0x4f1329(0xb2)](_0x400174[_0x4f1329(0xdc)],0x191)&&(logger['error'](_0x185083['PEfus']),await _0x185083['KrgUI'](sendInstrumentationEvent,_0x2b6e59,_0x185083[_0x4f1329(0xae)],messageTypes[_0x4f1329(0xd3)],_0x185083[_0x4f1329(0xcd)],null,_0x2b6e59),process[_0x4f1329(0xee)](0x1)),_0x185083[_0x4f1329(0xb2)](_0x400174[_0x4f1329(0xdc)],0x190)&&(logger[_0x4f1329(0xc6)](JSON[_0x4f1329(0xc2)](_0x400174[_0x4f1329(0xf0)])['message']),await _0x185083[_0x4f1329(0xcb)](sendInstrumentationEvent,_0x2b6e59,_0x185083[_0x4f1329(0xae)],messageTypes[_0x4f1329(0xd3)],_0x185083[_0x4f1329(0xea)],null,_0x2b6e59),process['exit'](0x1)),logger['error'](_0x4f1329(0xe9)+JSON[_0x4f1329(0xdf)](_0x400174)),await _0x185083[_0x4f1329(0xe5)](sendInstrumentationEvent,_0x2b6e59,_0x185083['jUumQ'],messageTypes[_0x4f1329(0xd3)],_0x185083[_0x4f1329(0xdd)],_0x400174,_0x2b6e59),process[_0x4f1329(0xee)](0x1);}catch(_0x42c06f){const _0x2432ff=_0x4f1329(0xe7)+_0x42c06f+'\x20\x0a'+JSON[_0x4f1329(0xdf)](_0x42c06f[_0x4f1329(0xaa)])+'\x20';logger['error'](_0x2432ff),process[_0x4f1329(0xee)](0x1);}};