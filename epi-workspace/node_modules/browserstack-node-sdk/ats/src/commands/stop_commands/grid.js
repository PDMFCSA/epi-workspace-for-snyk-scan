const a21_0x53c08e=a21_0x2b91;(function(_0x465326,_0x39c591){const _0x9717f3=a21_0x2b91,_0x4f349b=_0x465326();while(!![]){try{const _0x27105b=-parseInt(_0x9717f3(0xbb))/0x1*(-parseInt(_0x9717f3(0xb0))/0x2)+parseInt(_0x9717f3(0xf6))/0x3+-parseInt(_0x9717f3(0xec))/0x4+parseInt(_0x9717f3(0xc6))/0x5+-parseInt(_0x9717f3(0xcd))/0x6*(parseInt(_0x9717f3(0xea))/0x7)+parseInt(_0x9717f3(0xb8))/0x8+-parseInt(_0x9717f3(0xb4))/0x9;if(_0x27105b===_0x39c591)break;else _0x4f349b['push'](_0x4f349b['shift']());}catch(_0x4ac6ae){_0x4f349b['push'](_0x4f349b['shift']());}}}(a21_0x239a,0xcb094));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x53c08e(0xd0)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require('../../config/constants'),{logger}=require(a21_0x53c08e(0xcf)),{getCredentialsPath,getGridDetails}=require(a21_0x53c08e(0xc3)),{scaleDownHubDeployment}=require(a21_0x53c08e(0xf5)),{sendInstrumentationEvent}=require(a21_0x53c08e(0xb5)),webSocketUtils=require('../../utils/webSocketUtils'),{createK8sClient}=require(a21_0x53c08e(0xf8)),{getCloudProviderObject}=require(a21_0x53c08e(0xe4));exports[a21_0x53c08e(0xf7)]=a21_0x53c08e(0xb6),exports[a21_0x53c08e(0xdf)]=a21_0x53c08e(0xd4),exports[a21_0x53c08e(0xe1)]=function(_0x4b9a89){const _0x38828e=a21_0x53c08e,_0x7e836c={};_0x7e836c[_0x38828e(0xad)]=_0x38828e(0xb9),_0x7e836c['nAsvL']='string',_0x7e836c[_0x38828e(0xd9)]='Skip\x20insecure\x20cert\x20verification.',_0x7e836c[_0x38828e(0xc2)]=_0x38828e(0xc1),_0x7e836c['KeSbL']='help';const _0x3266b0=_0x7e836c,_0x46508e={};_0x46508e[_0x38828e(0xd1)]=_0x3266b0[_0x38828e(0xad)],_0x46508e['type']=_0x3266b0[_0x38828e(0xaa)];const _0x59ae17={};_0x59ae17[_0x38828e(0xd1)]=_0x3266b0[_0x38828e(0xd9)],_0x59ae17[_0x38828e(0xeb)]=_0x3266b0['OyuHR'],_0x59ae17[_0x38828e(0xd2)]=![];const _0x3b73d8={};return _0x3b73d8['grid-id']=_0x46508e,_0x3b73d8[_0x38828e(0xc8)]=_0x59ae17,_0x4b9a89[_0x38828e(0xbd)](HELP_HEADER_MESSAGE[_0x38828e(0xe9)])[_0x38828e(0xda)](HELP_FOOTER_MESSAGE)['options'](_0x3b73d8)[_0x38828e(0xb2)](_0x3266b0[_0x38828e(0xbc)])[_0x38828e(0xdc)];},exports[a21_0x53c08e(0xfc)]=async function(_0x6f64d6){const _0x2d9203=a21_0x53c08e,_0x4fde5f={'qzUYz':_0x2d9203(0xcc),'DdYMR':function(_0x220cc0){return _0x220cc0();},'ApEIQ':'Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','fLlnL':function(_0x499f00,_0x118dc6,_0x2e1f51,_0x1f4176,_0x2855af,_0x749e9,_0xf9529a){return _0x499f00(_0x118dc6,_0x2e1f51,_0x1f4176,_0x2855af,_0x749e9,_0xf9529a);},'DNkqi':_0x2d9203(0xfe),'HzwyG':_0x2d9203(0xf4),'kbqFK':function(_0x130844){return _0x130844();},'ePgRW':_0x2d9203(0xff),'cfTzG':_0x2d9203(0xd7),'bzcRI':_0x2d9203(0xc5),'dZLfc':function(_0x3e2813,_0x331b43,_0x1eca74,_0x2951cc){return _0x3e2813(_0x331b43,_0x1eca74,_0x2951cc);},'sEbrA':function(_0x428f91,_0x2018f1,_0x5d017c,_0x78ecca,_0x31b36d,_0x161261,_0x46eebe){return _0x428f91(_0x2018f1,_0x5d017c,_0x78ecca,_0x31b36d,_0x161261,_0x46eebe);},'NZAhw':function(_0x11e5c6,_0x28d42b,_0x980ae9){return _0x11e5c6(_0x28d42b,_0x980ae9);},'bgXeZ':function(_0x4c5bae,_0x6da17d,_0x5b7015){return _0x4c5bae(_0x6da17d,_0x5b7015);},'bPvWd':_0x2d9203(0xaf),'TxEfc':function(_0x40483a,_0x109252){return _0x40483a===_0x109252;},'jpyxx':'Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','qLyaP':function(_0x588d82,_0x10768e,_0x4eca2a,_0x201f5f,_0x2aecd5,_0x3ba6d9,_0x1cfa49){return _0x588d82(_0x10768e,_0x4eca2a,_0x201f5f,_0x2aecd5,_0x3ba6d9,_0x1cfa49);},'ntNBf':'unauthorised','ojoMu':function(_0x54174c,_0x38f927){return _0x54174c===_0x38f927;},'pbQIq':_0x2d9203(0xac),'OOFxE':_0x2d9203(0xf1)};let _0x441f23;try{!_0x6f64d6['gridId']&&(logger[_0x2d9203(0xbe)](_0x4fde5f[_0x2d9203(0xfd)]),process[_0x2d9203(0xf0)](0x1));!fs['existsSync'](_0x4fde5f[_0x2d9203(0xc7)](getCredentialsPath))&&(logger[_0x2d9203(0xbe)](_0x4fde5f[_0x2d9203(0xbf)]),await _0x4fde5f['fLlnL'](sendInstrumentationEvent,_0x6f64d6,_0x4fde5f['DNkqi'],messageTypes[_0x2d9203(0xe7)],_0x4fde5f['HzwyG'],null,_0x6f64d6),process[_0x2d9203(0xf0)](0x1));logger[_0x2d9203(0xf2)](_0x2d9203(0xc0)+_0x6f64d6[_0x2d9203(0xd5)]),await _0x4fde5f[_0x2d9203(0xde)](sendInstrumentationEvent,_0x6f64d6,_0x4fde5f[_0x2d9203(0xa7)],messageTypes[_0x2d9203(0xae)],null,null,_0x6f64d6);const _0x5648b4=JSON['parse'](fs['readFileSync'](_0x4fde5f[_0x2d9203(0xd6)](getCredentialsPath)));global_registry[_0x2d9203(0xe0)]=_0x5648b4[_0x2d9203(0xb1)]['username'],global_registry[_0x2d9203(0xf9)]=_0x5648b4[_0x2d9203(0xb1)][_0x2d9203(0xcb)];const _0x60baa5=WS_ENDPOINT['replace'](_0x4fde5f[_0x2d9203(0xee)],_0x5648b4[_0x2d9203(0xb1)]['username'])[_0x2d9203(0xef)](_0x4fde5f['cfTzG'],_0x5648b4[_0x2d9203(0xb1)][_0x2d9203(0xcb)]),_0x1b31b0={};_0x1b31b0[_0x2d9203(0xf3)]=ws,_0x1b31b0['connectionTimeout']=0x36ee80,_0x441f23=new ReconnectingWebSocket(_0x60baa5,[],_0x1b31b0),logger['debug'](_0x4fde5f[_0x2d9203(0xdd)]),webSocketUtils[_0x2d9203(0xd3)](_0x441f23,_0x6f64d6[_0x2d9203(0xce)],_0x6f64d6[_0x2d9203(0xcb)]);const [_0xd19690,_0x2b5bbb]=await _0x4fde5f['dZLfc'](getGridDetails,_0x5648b4[_0x2d9203(0xb1)][_0x2d9203(0xe2)],_0x5648b4[_0x2d9203(0xb1)][_0x2d9203(0xcb)],_0x6f64d6[_0x2d9203(0xd5)]);if(_0x2b5bbb){const _0x99118c=_0x2b5bbb[_0x2d9203(0xf2)];global_registry[_0x2d9203(0xb7)]=_0x99118c[_0x2d9203(0xb7)],global_registry[_0x2d9203(0xfa)]=_0x99118c[_0x2d9203(0xab)],global_registry[_0x2d9203(0xed)]=_0x99118c[_0x2d9203(0xed)];const _0x2817c2=await _0x4fde5f[_0x2d9203(0xba)](getCloudProviderObject,_0x99118c[_0x2d9203(0xb7)],_0x99118c['clusterName'],_0x99118c['name'],_0x441f23,webSocketUtils,_0x6f64d6),[_0xf39445,_0x429072,_0x319b62,_0x5a132d,_0x525ef1,_0x2e4d22]=await _0x4fde5f[_0x2d9203(0xe6)](createK8sClient,_0x2817c2,_0x6f64d6[_0x2d9203(0xe8)]);await _0x4fde5f[_0x2d9203(0xc4)](scaleDownHubDeployment,_0x429072,_0x99118c['name']),logger[_0x2d9203(0xf2)](_0x4fde5f[_0x2d9203(0xb3)]),process['exit'](0x0);}_0x4fde5f[_0x2d9203(0xe5)](_0xd19690['statusCode'],0x191)&&(logger['error'](_0x4fde5f[_0x2d9203(0xd8)]),await _0x4fde5f['qLyaP'](sendInstrumentationEvent,_0x6f64d6,_0x4fde5f[_0x2d9203(0xa7)],messageTypes[_0x2d9203(0xe7)],_0x4fde5f[_0x2d9203(0xdb)],null,_0x6f64d6),process[_0x2d9203(0xf0)](0x1)),_0x4fde5f[_0x2d9203(0xfb)](_0xd19690[_0x2d9203(0x100)],0x190)&&(logger['error'](JSON['parse'](_0xd19690[_0x2d9203(0xa8)])[_0x2d9203(0xe3)]),await _0x4fde5f['qLyaP'](sendInstrumentationEvent,_0x6f64d6,_0x4fde5f[_0x2d9203(0xa7)],messageTypes[_0x2d9203(0xe7)],_0x4fde5f[_0x2d9203(0xca)],null,_0x6f64d6),process[_0x2d9203(0xf0)](0x1)),logger[_0x2d9203(0xbe)](_0x2d9203(0xa9)+JSON['stringify'](_0xd19690)),await _0x4fde5f[_0x2d9203(0xde)](sendInstrumentationEvent,_0x6f64d6,_0x4fde5f[_0x2d9203(0xa7)],messageTypes[_0x2d9203(0xe7)],_0x4fde5f[_0x2d9203(0xc9)],_0xd19690,_0x6f64d6),process[_0x2d9203(0xf0)](0x1);}catch(_0x223172){const _0xa7aff0='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x223172+'\x20\x0a'+JSON['stringify'](_0x223172['stack'])+'\x20';logger[_0x2d9203(0xbe)](_0xa7aff0),process['exit'](0x1);}};function a21_0x2b91(_0x3c6471,_0x353bdd){const _0x239a8f=a21_0x239a();return a21_0x2b91=function(_0x2b918a,_0x1df73b){_0x2b918a=_0x2b918a-0xa7;let _0x42d44d=_0x239a8f[_0x2b918a];return _0x42d44d;},a21_0x2b91(_0x3c6471,_0x353bdd);}function a21_0x239a(){const _0x5061f2=['7446030ApCuUr','DdYMR','skip-tls-cert-verify','OOFxE','pbQIq','password','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','282WmuXJd','user','../../config/logger','reconnecting-websocket','description','default','addListeners','Stop\x20a\x20running\x20Automation\x20grid.','gridId','kbqFK','<PasswordPlaceholder>','jpyxx','nvjCC','epilogue','ntNBf','argv','bzcRI','fLlnL','desc','bstackUsername','builder','username','message','../../cloudproviders/utils','TxEfc','NZAhw','ERROR','skipTlsCertVerify','stop','87878eSeDaJ','type','854084xWxZjZ','clusterName','ePgRW','replace','exit','server-error','info','WebSocket','init-not-called','../../utils/gridComponents','2471913aQIXFh','command','../../utils/createk8sClient','bstackAccesskey','clusterRegion','ojoMu','handler','qzUYz','stop-grid-called','<UsernamePlaceholder>','statusCode','DNkqi','body','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','nAsvL','region','invalid-grid-id','rNkol','INFO','Grid\x20stoppped.','32fRWDzV','Browserstack','help','bPvWd','18488493heVmBw','../../utils/instrumentationUtils','grid','cloudProvider','1240504pQZhvy','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','sEbrA','76327BWeRwZ','KeSbL','usage','error','ApEIQ','Stopping\x20grid\x20','boolean','OyuHR','../../utils/utilityMethods','bgXeZ','Adding\x20Websocket\x20listeners'];a21_0x239a=function(){return _0x5061f2;};return a21_0x239a();}