const a21_0x304a8a=a21_0x4e7d;(function(_0x112958,_0x446ab3){const _0x439c2b=a21_0x4e7d,_0x2f38a5=_0x112958();while(!![]){try{const _0x5b2548=parseInt(_0x439c2b(0xcc))/0x1*(-parseInt(_0x439c2b(0xd9))/0x2)+parseInt(_0x439c2b(0x93))/0x3+-parseInt(_0x439c2b(0xc3))/0x4*(parseInt(_0x439c2b(0xad))/0x5)+-parseInt(_0x439c2b(0xb5))/0x6*(parseInt(_0x439c2b(0xca))/0x7)+parseInt(_0x439c2b(0xbd))/0x8+parseInt(_0x439c2b(0x99))/0x9*(parseInt(_0x439c2b(0xb0))/0xa)+-parseInt(_0x439c2b(0xd5))/0xb;if(_0x5b2548===_0x446ab3)break;else _0x2f38a5['push'](_0x2f38a5['shift']());}catch(_0xec03e9){_0x2f38a5['push'](_0x2f38a5['shift']());}}}(a21_0x426c,0x5ff52));function a21_0x4e7d(_0x3dab9a,_0x500f5a){const _0x426c98=a21_0x426c();return a21_0x4e7d=function(_0x4e7dea,_0x1884ba){_0x4e7dea=_0x4e7dea-0x93;let _0x37e25a=_0x426c98[_0x4e7dea];return _0x37e25a;},a21_0x4e7d(_0x3dab9a,_0x500f5a);}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a21_0x304a8a(0xa6)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a21_0x304a8a(0xaa)),{logger}=require(a21_0x304a8a(0xde)),{getCredentialsPath,getGridDetails}=require(a21_0x304a8a(0xba)),{scaleDownHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require(a21_0x304a8a(0xb2)),webSocketUtils=require(a21_0x304a8a(0x9b)),{createK8sClient}=require(a21_0x304a8a(0xcf)),{getCloudProviderObject}=require(a21_0x304a8a(0xc9));exports['command']='grid',exports[a21_0x304a8a(0xaf)]=a21_0x304a8a(0xc1),exports[a21_0x304a8a(0xa4)]=function(_0x13c5db){const _0x5666af=a21_0x304a8a,_0x468a4a={};_0x468a4a[_0x5666af(0xdb)]=_0x5666af(0xc7),_0x468a4a[_0x5666af(0xb1)]=_0x5666af(0xa2),_0x468a4a[_0x5666af(0xbf)]=_0x5666af(0xa8),_0x468a4a[_0x5666af(0xd1)]=_0x5666af(0xd6),_0x468a4a['jUzzn']='help';const _0x22b3ff=_0x468a4a,_0x554049={};_0x554049[_0x5666af(0xab)]=_0x22b3ff['ybsVV'],_0x554049['type']=_0x22b3ff[_0x5666af(0xb1)];const _0x592288={};_0x592288[_0x5666af(0xab)]=_0x22b3ff[_0x5666af(0xbf)],_0x592288[_0x5666af(0x9f)]=_0x22b3ff[_0x5666af(0xd1)],_0x592288[_0x5666af(0xd3)]=![];const _0x79b3fd={};return _0x79b3fd[_0x5666af(0x96)]=_0x554049,_0x79b3fd[_0x5666af(0xc4)]=_0x592288,_0x13c5db[_0x5666af(0xe3)](HELP_HEADER_MESSAGE[_0x5666af(0xcb)])[_0x5666af(0x9d)](HELP_FOOTER_MESSAGE)['options'](_0x79b3fd)[_0x5666af(0xa7)](_0x22b3ff[_0x5666af(0xa5)])[_0x5666af(0x9a)];},exports[a21_0x304a8a(0xe7)]=async function(_0x23b96f){const _0x2c31cd=a21_0x304a8a,_0x38cf58={'pcqSW':'Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','PTioq':function(_0x332aee){return _0x332aee();},'WADIg':_0x2c31cd(0xa1),'MPTIX':function(_0x211cf7,_0x52244b,_0x2b01c4,_0x3519dd,_0x3b6be,_0x369a39,_0x31c4ff){return _0x211cf7(_0x52244b,_0x2b01c4,_0x3519dd,_0x3b6be,_0x369a39,_0x31c4ff);},'FpAuS':_0x2c31cd(0xae),'oXYrU':_0x2c31cd(0xa0),'MHhPQ':function(_0x34609a,_0x4e05de,_0x45cf82,_0x2590c3,_0x5ccaac,_0x11700b,_0x299ab2){return _0x34609a(_0x4e05de,_0x45cf82,_0x2590c3,_0x5ccaac,_0x11700b,_0x299ab2);},'cSrkk':_0x2c31cd(0xcd),'EVWCJ':_0x2c31cd(0xed),'UCGYj':_0x2c31cd(0xb8),'SyVGY':function(_0xcd61ed,_0x6e80ef,_0x5d6c50,_0x530925){return _0xcd61ed(_0x6e80ef,_0x5d6c50,_0x530925);},'Cliji':function(_0x2ff447,_0x5af3b7,_0x471907,_0x24258f,_0x4ef748,_0x39245d,_0x3607c9){return _0x2ff447(_0x5af3b7,_0x471907,_0x24258f,_0x4ef748,_0x39245d,_0x3607c9);},'JPcMu':function(_0x338e06,_0x5aafd6,_0x4b6942){return _0x338e06(_0x5aafd6,_0x4b6942);},'tJbsl':function(_0x1b3896,_0x3a41f4,_0x19e14d){return _0x1b3896(_0x3a41f4,_0x19e14d);},'EZwGo':_0x2c31cd(0xc8),'uMyBr':function(_0x19c803,_0x166814){return _0x19c803===_0x166814;},'ibdio':'Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','PjGnf':_0x2c31cd(0xc2),'xdzng':function(_0x10b741,_0x2218a7){return _0x10b741===_0x2218a7;},'NHJYk':function(_0xafbf55,_0x4ff83c,_0x1918c2,_0x89cbea,_0x44c690,_0x4ad814,_0x4fe70a){return _0xafbf55(_0x4ff83c,_0x1918c2,_0x89cbea,_0x44c690,_0x4ad814,_0x4fe70a);},'jbGkS':_0x2c31cd(0xbe),'CaGfk':_0x2c31cd(0xda)};let _0x13a105;try{!_0x23b96f[_0x2c31cd(0xb6)]&&(logger['error'](_0x38cf58[_0x2c31cd(0xc0)]),process['exit'](0x1));!fs['existsSync'](_0x38cf58[_0x2c31cd(0xdd)](getCredentialsPath))&&(logger[_0x2c31cd(0xea)](_0x38cf58['WADIg']),await _0x38cf58['MPTIX'](sendInstrumentationEvent,_0x23b96f,_0x38cf58[_0x2c31cd(0xc5)],messageTypes[_0x2c31cd(0xb3)],_0x38cf58[_0x2c31cd(0x94)],null,_0x23b96f),process['exit'](0x1));logger[_0x2c31cd(0xa3)](_0x2c31cd(0xac)+_0x23b96f[_0x2c31cd(0xb6)]),await _0x38cf58[_0x2c31cd(0xe1)](sendInstrumentationEvent,_0x23b96f,_0x38cf58[_0x2c31cd(0xc5)],messageTypes[_0x2c31cd(0xb7)],null,null,_0x23b96f);const _0x514302=JSON[_0x2c31cd(0x98)](fs[_0x2c31cd(0x9c)](_0x38cf58[_0x2c31cd(0xdd)](getCredentialsPath)));global_registry[_0x2c31cd(0xe2)]=_0x514302[_0x2c31cd(0xe6)][_0x2c31cd(0xbb)],global_registry[_0x2c31cd(0xb9)]=_0x514302[_0x2c31cd(0xe6)][_0x2c31cd(0xd7)];const _0x3dd738=WS_ENDPOINT[_0x2c31cd(0x97)](_0x38cf58['cSrkk'],_0x514302[_0x2c31cd(0xe6)]['username'])[_0x2c31cd(0x97)](_0x38cf58[_0x2c31cd(0xc6)],_0x514302['Browserstack']['password']),_0x390f10={};_0x390f10['WebSocket']=ws,_0x390f10[_0x2c31cd(0x95)]=0x36ee80,_0x13a105=new ReconnectingWebSocket(_0x3dd738,[],_0x390f10),logger['debug'](_0x38cf58[_0x2c31cd(0xe5)]),webSocketUtils['addListeners'](_0x13a105,_0x23b96f[_0x2c31cd(0xec)],_0x23b96f[_0x2c31cd(0xd7)]);const [_0x1122fb,_0xdc88a0]=await _0x38cf58['SyVGY'](getGridDetails,_0x514302['Browserstack'][_0x2c31cd(0xbb)],_0x514302[_0x2c31cd(0xe6)][_0x2c31cd(0xd7)],_0x23b96f[_0x2c31cd(0xb6)]);if(_0xdc88a0){const _0x56d026=_0xdc88a0[_0x2c31cd(0xa3)];global_registry[_0x2c31cd(0xd8)]=_0x56d026[_0x2c31cd(0xd8)],global_registry['clusterRegion']=_0x56d026[_0x2c31cd(0xd0)],global_registry[_0x2c31cd(0xdf)]=_0x56d026[_0x2c31cd(0xdf)];const _0x15205c=await _0x38cf58['Cliji'](getCloudProviderObject,_0x56d026[_0x2c31cd(0xd8)],_0x56d026[_0x2c31cd(0xdf)],_0x56d026[_0x2c31cd(0xbc)],_0x13a105,webSocketUtils,_0x23b96f),[_0x5d0b37,_0x53e78a,_0x146500,_0x34abcd,_0x277398,_0x482851]=await _0x38cf58[_0x2c31cd(0xeb)](createK8sClient,_0x15205c,_0x23b96f['skipTlsCertVerify']);await _0x38cf58['tJbsl'](scaleDownHubDeployment,_0x53e78a,_0x56d026['name']),logger[_0x2c31cd(0xa3)](_0x38cf58['EZwGo']),process[_0x2c31cd(0x9e)](0x0);}_0x38cf58['uMyBr'](_0x1122fb[_0x2c31cd(0xe0)],0x191)&&(logger['error'](_0x38cf58[_0x2c31cd(0xa9)]),await _0x38cf58[_0x2c31cd(0xe1)](sendInstrumentationEvent,_0x23b96f,_0x38cf58[_0x2c31cd(0xc5)],messageTypes[_0x2c31cd(0xb3)],_0x38cf58[_0x2c31cd(0xe8)],null,_0x23b96f),process[_0x2c31cd(0x9e)](0x1)),_0x38cf58['xdzng'](_0x1122fb[_0x2c31cd(0xe0)],0x190)&&(logger['error'](JSON[_0x2c31cd(0x98)](_0x1122fb[_0x2c31cd(0xb4)])[_0x2c31cd(0xe9)]),await _0x38cf58[_0x2c31cd(0xdc)](sendInstrumentationEvent,_0x23b96f,_0x38cf58[_0x2c31cd(0xc5)],messageTypes[_0x2c31cd(0xb3)],_0x38cf58[_0x2c31cd(0xce)],null,_0x23b96f),process['exit'](0x1)),logger[_0x2c31cd(0xea)](_0x2c31cd(0xe4)+JSON[_0x2c31cd(0xd4)](_0x1122fb)),await _0x38cf58[_0x2c31cd(0xdc)](sendInstrumentationEvent,_0x23b96f,_0x38cf58[_0x2c31cd(0xc5)],messageTypes[_0x2c31cd(0xb3)],_0x38cf58[_0x2c31cd(0xd2)],_0x1122fb,_0x23b96f),process[_0x2c31cd(0x9e)](0x1);}catch(_0x47dadb){const _0x577129='Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20'+_0x47dadb+'\x20\x0a'+JSON['stringify'](_0x47dadb['stack'])+'\x20';logger[_0x2c31cd(0xea)](_0x577129),process['exit'](0x1);}};function a21_0x426c(){const _0x580682=['cloudProvider','1592BoHlVq','server-error','ybsVV','NHJYk','PTioq','../../config/logger','clusterName','statusCode','MHhPQ','bstackUsername','usage','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','UCGYj','Browserstack','handler','PjGnf','message','error','JPcMu','user','<PasswordPlaceholder>','2110932VukFDK','oXYrU','connectionTimeout','grid-id','replace','parse','9ZBVBSp','argv','../../utils/webSocketUtils','readFileSync','epilogue','exit','type','init-not-called','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','string','info','builder','jUzzn','reconnecting-websocket','help','Skip\x20insecure\x20cert\x20verification.','ibdio','../../config/constants','description','Stopping\x20grid\x20','55455mDoWwH','stop-grid-called','desc','7582130jkLqIM','ZWupa','../../utils/instrumentationUtils','ERROR','body','106626wiIcCu','gridId','INFO','Adding\x20Websocket\x20listeners','bstackAccesskey','../../utils/utilityMethods','username','name','608056kTJksx','invalid-grid-id','XzYTZ','pcqSW','Stop\x20a\x20running\x20Automation\x20grid.','unauthorised','148DUqNWX','skip-tls-cert-verify','FpAuS','EVWCJ','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','Grid\x20stoppped.','../../cloudproviders/utils','182HqBKmk','stop','134ksBkBZ','<UsernamePlaceholder>','jbGkS','../../utils/createk8sClient','region','TazTP','CaGfk','default','stringify','1823195NHkQhw','boolean','password'];a21_0x426c=function(){return _0x580682;};return a21_0x426c();}