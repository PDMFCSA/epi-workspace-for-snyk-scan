const a19_0x16fa20=a19_0x196f;(function(_0x5b7108,_0x1277e6){const _0x5c197b=a19_0x196f,_0x37e3f0=_0x5b7108();while(!![]){try{const _0x561e29=-parseInt(_0x5c197b(0x1b0))/0x1*(parseInt(_0x5c197b(0x18a))/0x2)+parseInt(_0x5c197b(0x18e))/0x3*(-parseInt(_0x5c197b(0x164))/0x4)+-parseInt(_0x5c197b(0x185))/0x5+-parseInt(_0x5c197b(0x17d))/0x6*(parseInt(_0x5c197b(0x163))/0x7)+parseInt(_0x5c197b(0x187))/0x8+-parseInt(_0x5c197b(0x186))/0x9+parseInt(_0x5c197b(0x197))/0xa;if(_0x561e29===_0x1277e6)break;else _0x37e3f0['push'](_0x37e3f0['shift']());}catch(_0x231682){_0x37e3f0['push'](_0x37e3f0['shift']());}}}(a19_0x2ba9,0x8b02d));function a19_0x196f(_0x18db26,_0x5391f5){const _0x2ba9f9=a19_0x2ba9();return a19_0x196f=function(_0x196f51,_0x4fd032){_0x196f51=_0x196f51-0x160;let _0x23b4d5=_0x2ba9f9[_0x196f51];return _0x23b4d5;},a19_0x196f(_0x18db26,_0x5391f5);}const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a19_0x16fa20(0x17c)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a19_0x16fa20(0x16b)),{logger}=require(a19_0x16fa20(0x1b1)),{getCredentialsPath,getGridDetails}=require(a19_0x16fa20(0x167)),{scaleUpHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require('../../utils/instrumentationUtils'),webSocketUtils=require(a19_0x16fa20(0x190)),{createK8sClient}=require(a19_0x16fa20(0x169)),{getCloudProviderObject}=require(a19_0x16fa20(0x173));function a19_0x2ba9(){const _0x425dbf=['SEPOw','WhVRL','34625530qPMkAE','sNPVi','desc','Adding\x20Websocket\x20listeners','grid-id','server-error','<PasswordPlaceholder>','rUDSp','exit','info','stack','default','hZBXb','KZJMa','Skip\x20insecure\x20cert\x20verification.','password','ERROR','Start\x20an\x20existing\x20Automation\x20grid.','clusterRegion','existsSync','region','options','uoyEo','epilogue','riEVw','351751cQLCfa','../../config/logger','parse','replace','addListeners','ujNiv','Psgmq','readFileSync','Unable\x20to\x20start\x20the\x20Grid!\x20Error:\x20','name','body','INFO','builder','start-grid-called','3983vSpbMV','18884ZmSAvP','skip-tls-cert-verify','jMMgv','../../utils/utilityMethods','boolean','../../utils/createk8sClient','clusterName','../../config/constants','Browserstack','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','message','usage','WebSocket','type','invalid-grid-id','../../cloudproviders/utils','init-not-called','AvzJs','description','command','erSXm','bFgqS','Starting\x20grid\x20','username','reconnecting-websocket','3414JzfOtQ','Pass\x20the\x20ID\x20of\x20the\x20existing\x20Automation\x20grid\x20you\x20want\x20to\x20start.','ftGhg','error','xfEOS','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!','grid','otFlJ','3386090pGIYYq','8413191XQDicL','3369752GhpczB','Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','cloudProvider','4OebKui','string','statusCode','argv','429IYrXyD','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20start','../../utils/webSocketUtils','HnpnM','<UsernamePlaceholder>','stringify','help'];a19_0x2ba9=function(){return _0x425dbf;};return a19_0x2ba9();}exports[a19_0x16fa20(0x177)]=a19_0x16fa20(0x183),exports[a19_0x16fa20(0x199)]=a19_0x16fa20(0x1a8),exports[a19_0x16fa20(0x161)]=function(_0x19851a){const _0x578346=a19_0x16fa20,_0x2c53df={};_0x2c53df[_0x578346(0x196)]=_0x578346(0x17e),_0x2c53df['KZJMa']=_0x578346(0x18b),_0x2c53df[_0x578346(0x1b6)]=_0x578346(0x1a5),_0x2c53df['Svmkn']=_0x578346(0x168),_0x2c53df[_0x578346(0x195)]='help';const _0x8c8811=_0x2c53df,_0x9e4fee={};_0x9e4fee[_0x578346(0x176)]=_0x8c8811['WhVRL'],_0x9e4fee[_0x578346(0x171)]=_0x8c8811[_0x578346(0x1a4)];const _0x84ce0e={};_0x84ce0e[_0x578346(0x176)]=_0x8c8811[_0x578346(0x1b6)],_0x84ce0e['type']=_0x8c8811['Svmkn'],_0x84ce0e[_0x578346(0x1a2)]=![];const _0x1dd813={};return _0x1dd813[_0x578346(0x19b)]=_0x9e4fee,_0x1dd813[_0x578346(0x165)]=_0x84ce0e,_0x19851a[_0x578346(0x16f)](HELP_HEADER_MESSAGE['start'])[_0x578346(0x1ae)](HELP_FOOTER_MESSAGE)[_0x578346(0x1ac)](_0x1dd813)[_0x578346(0x194)](_0x8c8811[_0x578346(0x195)])[_0x578346(0x18d)];},exports['handler']=async function(_0x9d394d){const _0xe96d9a=a19_0x16fa20,_0x5de8c8={'hZBXb':_0xe96d9a(0x18f),'ujNiv':function(_0x3bbabb){return _0x3bbabb();},'oZjrR':_0xe96d9a(0x188),'lsXbv':function(_0x40b95d,_0x418d6b,_0x4ae082,_0x539635,_0xeb863b,_0x52098d,_0x4cc18f){return _0x40b95d(_0x418d6b,_0x4ae082,_0x539635,_0xeb863b,_0x52098d,_0x4cc18f);},'sNPVi':_0xe96d9a(0x162),'ftGhg':_0xe96d9a(0x174),'erSXm':function(_0xda54fb,_0x473805,_0x362475,_0x758856,_0x5de8d0,_0x5cbd02,_0x59d5bf){return _0xda54fb(_0x473805,_0x362475,_0x758856,_0x5de8d0,_0x5cbd02,_0x59d5bf);},'bFgqS':function(_0x347319){return _0x347319();},'Jyzvg':_0xe96d9a(0x192),'rUDSp':_0xe96d9a(0x19d),'kMvAr':_0xe96d9a(0x19a),'xfEOS':function(_0x4b2e6e,_0xc730a0,_0x2975b5,_0xe6b0a8){return _0x4b2e6e(_0xc730a0,_0x2975b5,_0xe6b0a8);},'AvzJs':function(_0x5b5495,_0x41f3ce,_0x50c7d3){return _0x5b5495(_0x41f3ce,_0x50c7d3);},'otFlJ':'Grid\x20started','YQsWn':function(_0x5a6343,_0x97faf6){return _0x5a6343===_0x97faf6;},'rZabv':_0xe96d9a(0x182),'OOHfW':function(_0x37a897,_0x101a46,_0x11501b,_0x24813d,_0x643dd0,_0x53dbdd,_0x1d9afe){return _0x37a897(_0x101a46,_0x11501b,_0x24813d,_0x643dd0,_0x53dbdd,_0x1d9afe);},'riEVw':'unauthorised','HnpnM':function(_0x4513d3,_0x3b3a8d){return _0x4513d3===_0x3b3a8d;},'uoyEo':_0xe96d9a(0x172),'jMMgv':function(_0x3ea056,_0x49c773,_0x453709,_0x3eac6d,_0x465594,_0x293b99,_0x403b30){return _0x3ea056(_0x49c773,_0x453709,_0x3eac6d,_0x465594,_0x293b99,_0x403b30);},'wThhl':_0xe96d9a(0x19c)};let _0x62b281;try{!_0x9d394d['gridId']&&(logger[_0xe96d9a(0x180)](_0x5de8c8[_0xe96d9a(0x1a3)]),process[_0xe96d9a(0x19f)](0x1));!fs[_0xe96d9a(0x1aa)](_0x5de8c8[_0xe96d9a(0x1b5)](getCredentialsPath))&&(logger[_0xe96d9a(0x180)](_0x5de8c8['oZjrR']),await _0x5de8c8['lsXbv'](sendInstrumentationEvent,_0x9d394d,_0x5de8c8[_0xe96d9a(0x198)],messageTypes[_0xe96d9a(0x1a7)],_0x5de8c8[_0xe96d9a(0x17f)],null,_0x9d394d),process[_0xe96d9a(0x19f)](0x1));logger[_0xe96d9a(0x1a0)](_0xe96d9a(0x17a)+_0x9d394d['gridId']),await _0x5de8c8[_0xe96d9a(0x178)](sendInstrumentationEvent,_0x9d394d,_0x5de8c8[_0xe96d9a(0x198)],messageTypes[_0xe96d9a(0x160)],null,null,_0x9d394d);const _0x4e67f4=JSON[_0xe96d9a(0x1b2)](fs[_0xe96d9a(0x1b7)](_0x5de8c8[_0xe96d9a(0x179)](getCredentialsPath)));global_registry['bstackUsername']=_0x4e67f4[_0xe96d9a(0x16c)][_0xe96d9a(0x17b)],global_registry['bstackAccesskey']=_0x4e67f4[_0xe96d9a(0x16c)][_0xe96d9a(0x1a6)];const _0x3fb28d=WS_ENDPOINT[_0xe96d9a(0x1b3)](_0x5de8c8['Jyzvg'],_0x4e67f4[_0xe96d9a(0x16c)]['username'])['replace'](_0x5de8c8[_0xe96d9a(0x19e)],_0x4e67f4[_0xe96d9a(0x16c)][_0xe96d9a(0x1a6)]),_0x246ef5={};_0x246ef5[_0xe96d9a(0x170)]=ws,_0x246ef5['connectionTimeout']=0x36ee80,_0x62b281=new ReconnectingWebSocket(_0x3fb28d,[],_0x246ef5),logger['debug'](_0x5de8c8['kMvAr']),webSocketUtils[_0xe96d9a(0x1b4)](_0x62b281,_0x9d394d['user'],_0x9d394d[_0xe96d9a(0x1a6)]);const [_0x1fcaf0,_0x4eb778]=await _0x5de8c8[_0xe96d9a(0x181)](getGridDetails,_0x4e67f4[_0xe96d9a(0x16c)]['username'],_0x4e67f4[_0xe96d9a(0x16c)][_0xe96d9a(0x1a6)],_0x9d394d['gridId']);if(_0x4eb778){const _0x5e4d16=_0x4eb778[_0xe96d9a(0x1a0)];global_registry[_0xe96d9a(0x189)]=_0x5e4d16[_0xe96d9a(0x189)],global_registry[_0xe96d9a(0x1a9)]=_0x5e4d16[_0xe96d9a(0x1ab)],global_registry['clusterName']=_0x5e4d16[_0xe96d9a(0x16a)];const _0x45ade0=await _0x5de8c8[_0xe96d9a(0x178)](getCloudProviderObject,_0x5e4d16[_0xe96d9a(0x189)],_0x5e4d16['clusterName'],_0x5e4d16[_0xe96d9a(0x1b9)],_0x62b281,webSocketUtils,_0x9d394d),[_0x51e6e1,_0x5293e8,_0x259bcb,_0x35f559,_0x32b4ea,_0x336664]=await _0x5de8c8['AvzJs'](createK8sClient,_0x45ade0,_0x9d394d['skipTlsCertVerify']);await _0x5de8c8[_0xe96d9a(0x175)](scaleUpHubDeployment,_0x5293e8,_0x5e4d16[_0xe96d9a(0x1b9)]),logger[_0xe96d9a(0x1a0)](_0x5de8c8[_0xe96d9a(0x184)]),process[_0xe96d9a(0x19f)](0x0);}_0x5de8c8['YQsWn'](_0x1fcaf0[_0xe96d9a(0x18c)],0x191)&&(logger[_0xe96d9a(0x180)](_0x5de8c8['rZabv']),await _0x5de8c8['OOHfW'](sendInstrumentationEvent,_0x9d394d,_0x5de8c8[_0xe96d9a(0x198)],messageTypes[_0xe96d9a(0x1a7)],_0x5de8c8[_0xe96d9a(0x1af)],null,_0x9d394d),process['exit'](0x1)),_0x5de8c8[_0xe96d9a(0x191)](_0x1fcaf0[_0xe96d9a(0x18c)],0x190)&&(logger[_0xe96d9a(0x180)](JSON[_0xe96d9a(0x1b2)](_0x1fcaf0[_0xe96d9a(0x1ba)])[_0xe96d9a(0x16e)]),await _0x5de8c8[_0xe96d9a(0x178)](sendInstrumentationEvent,_0x9d394d,_0x5de8c8['sNPVi'],messageTypes['ERROR'],_0x5de8c8[_0xe96d9a(0x1ad)],null,_0x9d394d),process[_0xe96d9a(0x19f)](0x1)),logger[_0xe96d9a(0x180)](_0xe96d9a(0x16d)+JSON[_0xe96d9a(0x193)](_0x1fcaf0)),await _0x5de8c8[_0xe96d9a(0x166)](sendInstrumentationEvent,_0x9d394d,_0x5de8c8[_0xe96d9a(0x198)],messageTypes['ERROR'],_0x5de8c8['wThhl'],_0x1fcaf0,_0x9d394d),process['exit'](0x1);}catch(_0x12a23c){const _0x7c4fff=_0xe96d9a(0x1b8)+_0x12a23c+'\x20\x0a'+JSON[_0xe96d9a(0x193)](_0x12a23c[_0xe96d9a(0x1a1)])+'\x20';logger[_0xe96d9a(0x180)](_0x7c4fff),process['exit'](0x1);}};