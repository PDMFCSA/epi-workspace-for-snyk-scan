const a28_0x447163=a28_0x372b;(function(_0x1a2b0b,_0x5ce603){const _0x2cec40=a28_0x372b,_0x183588=_0x1a2b0b();while(!![]){try{const _0x4720a4=parseInt(_0x2cec40(0xc2))/0x1+-parseInt(_0x2cec40(0xf2))/0x2*(-parseInt(_0x2cec40(0xcb))/0x3)+parseInt(_0x2cec40(0xf4))/0x4*(-parseInt(_0x2cec40(0xbd))/0x5)+-parseInt(_0x2cec40(0xd8))/0x6*(parseInt(_0x2cec40(0xf6))/0x7)+parseInt(_0x2cec40(0xbb))/0x8+-parseInt(_0x2cec40(0xd1))/0x9*(parseInt(_0x2cec40(0xde))/0xa)+parseInt(_0x2cec40(0xda))/0xb;if(_0x4720a4===_0x5ce603)break;else _0x183588['push'](_0x183588['shift']());}catch(_0x5f1c0e){_0x183588['push'](_0x183588['shift']());}}}(a28_0x1d66,0x33ed2));function a28_0x372b(_0x5d738c,_0x5ece35){const _0x1d662e=a28_0x1d66();return a28_0x372b=function(_0x372be7,_0x2839f2){_0x372be7=_0x372be7-0xbb;let _0x5c2958=_0x1d662e[_0x372be7];return _0x5c2958;},a28_0x372b(_0x5d738c,_0x5ece35);}const fs=require('fs'),path=require(a28_0x447163(0xf1)),Promise=require('bluebird'),yaml=require(a28_0x447163(0xbe)),{CLOUDFORMATION_SCHEMA}=require(a28_0x447163(0xe6)),AWS=require(a28_0x447163(0xe2))[a28_0x447163(0xe4)],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require('../config/logger');Promise[a28_0x447163(0xbc)](fs);function a28_0x1d66(){const _0x5db268=['toString','1329643SaCiAH','createStack','CFTemplates','push','2417288KqqMsW','promisifyAll','5vGMBfL','js-yaml','split','utf-8','ClusterOIDCURL','181507wTzmhN','Value','2010-05-15','HFOJm','schema','lMVOO','Capabilities','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','://','669gLxmWW','BIqER','OnFailure','Resources','DELETE','mpFKR','81gnlFGS','WSyhe','GtxfB','waitFor','hub-ha.yaml','TemplateBody','uJVVs','6TINtTY','valueOf','278091fGZpGE','Properties','Tags','OgcTw','920hmoGeB','StackId','load','join','./AWSUtils','StackName','awsObj','promise','js-yaml-cloudformation-schema','createHubHaStack','info','ZXjgs','oxxzC','HLFvz','readFileAsync','browserstack:creationDate','VpcId','Parameters','stringify','path','738DUGuSn','getOidcUrl','751076MVXABH'];a28_0x1d66=function(){return _0x5db268;};return a28_0x1d66();}const addTags=async(_0x23f0cb,_0x1a6172)=>{const _0x379c9e=a28_0x447163;for(const _0x4bdc61 in _0x23f0cb['Resources']){_0x23f0cb[_0x379c9e(0xce)][_0x4bdc61][_0x379c9e(0xdb)]&&_0x23f0cb[_0x379c9e(0xce)][_0x4bdc61][_0x379c9e(0xdb)][_0x379c9e(0xdc)]&&_0x23f0cb[_0x379c9e(0xce)][_0x4bdc61][_0x379c9e(0xdb)][_0x379c9e(0xdc)]['push'](..._0x1a6172);}};exports[a28_0x447163(0xe7)]=async(_0x463687,_0x5474b9=null)=>{const _0x193f90=a28_0x447163,_0x2e6be7={'OgcTw':'browserstack:cluster','mpFKR':_0x193f90(0xed),'iDfcH':_0x193f90(0xc4),'oxxzC':_0x193f90(0xf8),'HLFvz':_0x193f90(0xd5),'HFOJm':_0x193f90(0xc0),'ZXjgs':function(_0x263530,_0x432639,_0x45a369){return _0x263530(_0x432639,_0x45a369);},'qjQhi':_0x193f90(0xca),'lMVOO':_0x193f90(0xcf),'Pwqep':_0x193f90(0xee),'aPDFE':'BaseResourceName','GtxfB':_0x193f90(0xc1),'uJVVs':'CAPABILITY_NAMED_IAM','BIqER':_0x193f90(0xc9),'WSyhe':'stackCreateComplete'},_0x200d25=COMMON_HST_TAGS,_0x4e8b9d={};_0x4e8b9d['Key']=_0x2e6be7[_0x193f90(0xdd)],_0x4e8b9d[_0x193f90(0xc3)]=_0x463687,_0x200d25['push'](_0x4e8b9d),_0x200d25[_0x193f90(0xf9)]({'Key':_0x2e6be7[_0x193f90(0xd0)],'Value':new Date()[_0x193f90(0xd9)]()[_0x193f90(0xf5)]()});const _0x50aa3b={};_0x50aa3b['apiVersion']=_0x2e6be7['iDfcH'];const _0x17d95f=new AWS['CloudFormation'](_0x50aa3b),_0x477a79=await fs[_0x193f90(0xec)](path[_0x193f90(0xe1)](__dirname,'..',_0x2e6be7[_0x193f90(0xea)],_0x2e6be7[_0x193f90(0xeb)]),_0x2e6be7[_0x193f90(0xc5)]),_0x12f621={};_0x12f621[_0x193f90(0xc6)]=CLOUDFORMATION_SCHEMA;const _0x5ea18e=yaml[_0x193f90(0xe0)](_0x477a79,_0x12f621);await _0x2e6be7[_0x193f90(0xe9)](addTags,_0x5ea18e,_0x200d25);const _0x19e9b3=JSON[_0x193f90(0xf0)](_0x5ea18e);let _0xc58388=await AWSUtils[_0x193f90(0xf3)](_0x463687);_0xc58388=_0xc58388[_0x193f90(0xbf)](_0x2e6be7['qjQhi'])[0x1];const _0x90fe77={};_0x90fe77[_0x193f90(0xe3)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x463687+'-cf',_0x90fe77[_0x193f90(0xcd)]=_0x2e6be7[_0x193f90(0xc7)],_0x90fe77[_0x193f90(0xd6)]=_0x19e9b3,_0x90fe77[_0x193f90(0xef)]=[{'ParameterKey':_0x2e6be7['Pwqep'],'ParameterValue':_0x5474b9},{'ParameterKey':_0x2e6be7['aPDFE'],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x463687},{'ParameterKey':_0x2e6be7[_0x193f90(0xd3)],'ParameterValue':_0xc58388}],_0x90fe77[_0x193f90(0xc8)]=[_0x2e6be7[_0x193f90(0xd7)]],_0x90fe77[_0x193f90(0xdc)]=_0x200d25;const _0x40ba79=_0x90fe77,_0x21b1ee=await _0x17d95f[_0x193f90(0xf7)](_0x40ba79)[_0x193f90(0xe5)]();logger[_0x193f90(0xe8)](_0x2e6be7[_0x193f90(0xcc)]);const _0x218891={};return _0x218891[_0x193f90(0xe3)]=_0x21b1ee[_0x193f90(0xdf)],_0x17d95f[_0x193f90(0xd4)](_0x2e6be7[_0x193f90(0xd2)],_0x218891)[_0x193f90(0xe5)]();};