const a28_0x21ed91=a28_0xbc2b;(function(_0x396cab,_0x1e1419){const _0x18f4c0=a28_0xbc2b,_0x37725c=_0x396cab();while(!![]){try{const _0x2cfca5=-parseInt(_0x18f4c0(0xdf))/0x1*(parseInt(_0x18f4c0(0xc0))/0x2)+parseInt(_0x18f4c0(0xd6))/0x3*(parseInt(_0x18f4c0(0xb4))/0x4)+parseInt(_0x18f4c0(0xbe))/0x5+-parseInt(_0x18f4c0(0xbd))/0x6*(-parseInt(_0x18f4c0(0xdd))/0x7)+parseInt(_0x18f4c0(0xee))/0x8*(parseInt(_0x18f4c0(0xda))/0x9)+-parseInt(_0x18f4c0(0xd2))/0xa+parseInt(_0x18f4c0(0xd8))/0xb*(parseInt(_0x18f4c0(0xca))/0xc);if(_0x2cfca5===_0x1e1419)break;else _0x37725c['push'](_0x37725c['shift']());}catch(_0x8df2e5){_0x37725c['push'](_0x37725c['shift']());}}}(a28_0x5d44,0x6fa7b));const fs=require('fs'),path=require(a28_0x21ed91(0xba)),Promise=require(a28_0x21ed91(0xd9)),yaml=require(a28_0x21ed91(0xcb)),{CLOUDFORMATION_SCHEMA}=require(a28_0x21ed91(0xbf)),AWS=require(a28_0x21ed91(0xea))['awsObj'],AWSUtils=require(a28_0x21ed91(0xea)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x21ed91(0xb8)),{logger}=require('../config/logger');Promise[a28_0x21ed91(0xc6)](fs);function a28_0xbc2b(_0x53fd05,_0x354481){const _0x5d443a=a28_0x5d44();return a28_0xbc2b=function(_0xbc2be1,_0x8e01fb){_0xbc2be1=_0xbc2be1-0xb3;let _0x5ca53b=_0x5d443a[_0xbc2be1];return _0x5ca53b;},a28_0xbc2b(_0x53fd05,_0x354481);}function a28_0x5d44(){const _0x539342=['DtFbB','Tags','UexRN','2379750oNwAkJ','VCQQC','StackId','apiVersion','378OkQMxs','load','11MmBHvO','bluebird','9gZaRYE','createHubHaStack','hub-ha.yaml','7agHPlx','TemplateBody','10MeRxEy','Resources','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','Properties','VpcId','oliSG','NcnQA','push','promise','StackName','stackCreateComplete','./AWSUtils','vSFrh','waitFor','getOidcUrl','5716616CNbhlw','toString','browserstack:cluster','valueOf','ClusterOIDCURL','12148xGWxVi','schema','Key','Capabilities','../config/constants','GoAJV','path','-cf','browserstack:creationDate','512868OEInLU','1543280pmYiWO','js-yaml-cloudformation-schema','177790pqTDui','ERjho','join','stringify','GQNei','BaseResourceName','promisifyAll','eDGHS','DELETE','OnFailure','1114692yJPWNi','js-yaml','info','createStack','CAPABILITY_NAMED_IAM'];a28_0x5d44=function(){return _0x539342;};return a28_0x5d44();}const addTags=async(_0x1aed4f,_0x4f9f16)=>{const _0x8bd811=a28_0x21ed91;for(const _0xfaadaa in _0x1aed4f['Resources']){_0x1aed4f['Resources'][_0xfaadaa]['Properties']&&_0x1aed4f[_0x8bd811(0xe0)][_0xfaadaa][_0x8bd811(0xe2)]['Tags']&&_0x1aed4f[_0x8bd811(0xe0)][_0xfaadaa][_0x8bd811(0xe2)][_0x8bd811(0xd0)][_0x8bd811(0xe6)](..._0x4f9f16);}};exports[a28_0x21ed91(0xdb)]=async(_0x2bb0b4,_0x16947b=null)=>{const _0x1aa07c=a28_0x21ed91,_0x470d8b={'UexRN':_0x1aa07c(0xf0),'jrnwA':_0x1aa07c(0xbc),'xrzgh':'2010-05-15','GQNei':'CFTemplates','DtFbB':_0x1aa07c(0xdc),'GoAJV':'utf-8','ERjho':function(_0x48bd66,_0x5975fd,_0x3dffc5){return _0x48bd66(_0x5975fd,_0x3dffc5);},'VCQQC':'://','exmnl':_0x1aa07c(0xc8),'eDGHS':_0x1aa07c(0xe3),'oliSG':_0x1aa07c(0xc5),'MyopS':_0x1aa07c(0xb3),'moFUA':_0x1aa07c(0xce),'NcnQA':_0x1aa07c(0xe1),'vSFrh':_0x1aa07c(0xe9)},_0x3426d4=COMMON_HST_TAGS,_0x9a36e3={};_0x9a36e3[_0x1aa07c(0xb6)]=_0x470d8b[_0x1aa07c(0xd1)],_0x9a36e3['Value']=_0x2bb0b4,_0x3426d4['push'](_0x9a36e3),_0x3426d4[_0x1aa07c(0xe6)]({'Key':_0x470d8b['jrnwA'],'Value':new Date()[_0x1aa07c(0xf1)]()[_0x1aa07c(0xef)]()});const _0x3fa724={};_0x3fa724[_0x1aa07c(0xd5)]=_0x470d8b['xrzgh'];const _0x18fa7e=new AWS['CloudFormation'](_0x3fa724),_0x2c5810=await fs['readFileAsync'](path[_0x1aa07c(0xc2)](__dirname,'..',_0x470d8b[_0x1aa07c(0xc4)],_0x470d8b[_0x1aa07c(0xcf)]),_0x470d8b[_0x1aa07c(0xb9)]),_0x37d0d3={};_0x37d0d3[_0x1aa07c(0xb5)]=CLOUDFORMATION_SCHEMA;const _0x322758=yaml[_0x1aa07c(0xd7)](_0x2c5810,_0x37d0d3);await _0x470d8b[_0x1aa07c(0xc1)](addTags,_0x322758,_0x3426d4);const _0x27d56f=JSON[_0x1aa07c(0xc3)](_0x322758);let _0x54acff=await AWSUtils[_0x1aa07c(0xed)](_0x2bb0b4);_0x54acff=_0x54acff['split'](_0x470d8b[_0x1aa07c(0xd3)])[0x1];const _0x115ab0={};_0x115ab0[_0x1aa07c(0xe8)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x2bb0b4+_0x1aa07c(0xbb),_0x115ab0[_0x1aa07c(0xc9)]=_0x470d8b['exmnl'],_0x115ab0[_0x1aa07c(0xde)]=_0x27d56f,_0x115ab0['Parameters']=[{'ParameterKey':_0x470d8b[_0x1aa07c(0xc7)],'ParameterValue':_0x16947b},{'ParameterKey':_0x470d8b[_0x1aa07c(0xe4)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x2bb0b4},{'ParameterKey':_0x470d8b['MyopS'],'ParameterValue':_0x54acff}],_0x115ab0[_0x1aa07c(0xb7)]=[_0x470d8b['moFUA']],_0x115ab0['Tags']=_0x3426d4;const _0x2188a7=_0x115ab0,_0x5e9aa7=await _0x18fa7e[_0x1aa07c(0xcd)](_0x2188a7)['promise']();logger[_0x1aa07c(0xcc)](_0x470d8b[_0x1aa07c(0xe5)]);const _0x581a0c={};return _0x581a0c[_0x1aa07c(0xe8)]=_0x5e9aa7[_0x1aa07c(0xd4)],_0x18fa7e[_0x1aa07c(0xec)](_0x470d8b[_0x1aa07c(0xeb)],_0x581a0c)[_0x1aa07c(0xe7)]();};