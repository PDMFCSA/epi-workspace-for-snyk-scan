const a28_0x39434e=a28_0xa3cf;(function(_0x54db44,_0x1a66e4){const _0xb70314=a28_0xa3cf,_0x2ae1bc=_0x54db44();while(!![]){try{const _0x217539=parseInt(_0xb70314(0x210))/0x1+parseInt(_0xb70314(0x224))/0x2+-parseInt(_0xb70314(0x20a))/0x3*(-parseInt(_0xb70314(0x22a))/0x4)+-parseInt(_0xb70314(0x222))/0x5*(parseInt(_0xb70314(0x21b))/0x6)+parseInt(_0xb70314(0x1ef))/0x7*(-parseInt(_0xb70314(0x219))/0x8)+parseInt(_0xb70314(0x20e))/0x9*(parseInt(_0xb70314(0x226))/0xa)+parseInt(_0xb70314(0x1f6))/0xb;if(_0x217539===_0x1a66e4)break;else _0x2ae1bc['push'](_0x2ae1bc['shift']());}catch(_0x16020e){_0x2ae1bc['push'](_0x2ae1bc['shift']());}}}(a28_0x43be,0x5b90e));const fs=require('fs'),path=require(a28_0x39434e(0x20f)),Promise=require(a28_0x39434e(0x1f4)),yaml=require(a28_0x39434e(0x1f3)),{CLOUDFORMATION_SCHEMA}=require(a28_0x39434e(0x207)),AWS=require(a28_0x39434e(0x1f1))['awsObj'],AWSUtils=require(a28_0x39434e(0x1f1)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require('../config/logger');Promise['promisifyAll'](fs);const addTags=async(_0x4904fa,_0x4a2caa)=>{const _0x1df443=a28_0x39434e;for(const _0x24e40c in _0x4904fa[_0x1df443(0x21c)]){_0x4904fa[_0x1df443(0x21c)][_0x24e40c][_0x1df443(0x1fd)]&&_0x4904fa['Resources'][_0x24e40c][_0x1df443(0x1fd)][_0x1df443(0x1fe)]&&_0x4904fa[_0x1df443(0x21c)][_0x24e40c][_0x1df443(0x1fd)][_0x1df443(0x1fe)]['push'](..._0x4a2caa);}};exports[a28_0x39434e(0x204)]=async(_0x22524e,_0x10c3bb=null)=>{const _0x246b17=a28_0x39434e,_0x444536={'snKaK':'browserstack:cluster','ZBmpd':_0x246b17(0x203),'XwJwJ':_0x246b17(0x211),'KNdhw':_0x246b17(0x206),'VUpzH':_0x246b17(0x220),'oOxIO':_0x246b17(0x212),'eEjYn':function(_0x3c9cd6,_0x534f1a,_0x1d52f1){return _0x3c9cd6(_0x534f1a,_0x1d52f1);},'JDguv':_0x246b17(0x215),'LIooJ':_0x246b17(0x209),'VHMJI':_0x246b17(0x21e),'QCCCb':_0x246b17(0x200),'NhvNa':'ClusterOIDCURL','ziFeh':_0x246b17(0x20c),'xONpL':'Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','HRUMn':_0x246b17(0x21d)},_0x344730=COMMON_HST_TAGS,_0x2ac8e3={};_0x2ac8e3['Key']=_0x444536[_0x246b17(0x217)],_0x2ac8e3['Value']=_0x22524e,_0x344730[_0x246b17(0x1f9)](_0x2ac8e3),_0x344730[_0x246b17(0x1f9)]({'Key':_0x444536['ZBmpd'],'Value':new Date()[_0x246b17(0x1fc)]()[_0x246b17(0x229)]()});const _0x24e646={};_0x24e646['apiVersion']=_0x444536[_0x246b17(0x228)];const _0x4b00d3=new AWS[(_0x246b17(0x213))](_0x24e646),_0x16b140=await fs[_0x246b17(0x1f0)](path[_0x246b17(0x1f2)](__dirname,'..',_0x444536[_0x246b17(0x221)],_0x444536[_0x246b17(0x202)]),_0x444536['oOxIO']),_0x4c7ad3={};_0x4c7ad3[_0x246b17(0x1ff)]=CLOUDFORMATION_SCHEMA;const _0x2158fb=yaml[_0x246b17(0x227)](_0x16b140,_0x4c7ad3);await _0x444536['eEjYn'](addTags,_0x2158fb,_0x344730);const _0x2c6310=JSON['stringify'](_0x2158fb);let _0x463308=await AWSUtils[_0x246b17(0x223)](_0x22524e);_0x463308=_0x463308[_0x246b17(0x216)](_0x444536[_0x246b17(0x218)])[0x1];const _0x22f724={};_0x22f724[_0x246b17(0x21f)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x22524e+_0x246b17(0x1f8),_0x22f724[_0x246b17(0x1ee)]=_0x444536[_0x246b17(0x205)],_0x22f724[_0x246b17(0x214)]=_0x2c6310,_0x22f724[_0x246b17(0x1f7)]=[{'ParameterKey':_0x444536[_0x246b17(0x1ed)],'ParameterValue':_0x10c3bb},{'ParameterKey':_0x444536[_0x246b17(0x20b)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x22524e},{'ParameterKey':_0x444536['NhvNa'],'ParameterValue':_0x463308}],_0x22f724['Capabilities']=[_0x444536[_0x246b17(0x1fa)]],_0x22f724[_0x246b17(0x1fe)]=_0x344730;const _0x4027b2=_0x22f724,_0x13658f=await _0x4b00d3[_0x246b17(0x201)](_0x4027b2)[_0x246b17(0x1fb)]();logger[_0x246b17(0x20d)](_0x444536[_0x246b17(0x1f5)]);const _0x19424e={};return _0x19424e[_0x246b17(0x21f)]=_0x13658f[_0x246b17(0x208)],_0x4b00d3[_0x246b17(0x21a)](_0x444536[_0x246b17(0x225)],_0x19424e)[_0x246b17(0x1fb)]();};function a28_0xa3cf(_0x14f68a,_0x5e7e12){const _0x43be4e=a28_0x43be();return a28_0xa3cf=function(_0xa3cf4c,_0x732311){_0xa3cf4c=_0xa3cf4c-0x1ed;let _0x510ce7=_0x43be4e[_0xa3cf4c];return _0x510ce7;},a28_0xa3cf(_0x14f68a,_0x5e7e12);}function a28_0x43be(){const _0x161520=['OnFailure','3977904OUCamV','readFileAsync','./AWSUtils','join','js-yaml','bluebird','xONpL','1856558cjTyUT','Parameters','-cf','push','ziFeh','promise','valueOf','Properties','Tags','schema','BaseResourceName','createStack','VUpzH','browserstack:creationDate','createHubHaStack','LIooJ','CFTemplates','js-yaml-cloudformation-schema','StackId','DELETE','1566fXkuBq','QCCCb','CAPABILITY_NAMED_IAM','info','45IIoiPh','path','185890pcoLSV','2010-05-15','utf-8','CloudFormation','TemplateBody','://','split','snKaK','JDguv','8GDCpMY','waitFor','78YqNdXw','Resources','stackCreateComplete','VpcId','StackName','hub-ha.yaml','KNdhw','25325XrCiDe','getOidcUrl','253376MABESp','HRUMn','152570zHJAFP','load','XwJwJ','toString','3460Tbobof','VHMJI'];a28_0x43be=function(){return _0x161520;};return a28_0x43be();}