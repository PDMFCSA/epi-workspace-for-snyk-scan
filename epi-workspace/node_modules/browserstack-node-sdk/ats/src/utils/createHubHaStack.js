const a28_0x183411=a28_0x4cb3;function a28_0x5201(){const _0x321e1e=['146mKcWqZ','Capabilities','zanvM','promise','xAesE','createHubHaStack','2010-05-15','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','VpcId','fTgMp','://','10552mxLqdk','bluebird','NNaxm','../config/logger','./AWSUtils','BztkA','gDoaY','load','Properties','split','ziLCE','-cf','600260luXDrH','13690575OPcLNv','CAPABILITY_NAMED_IAM','valueOf','browserstack:creationDate','join','77DdyuAa','browserstack:cluster','aKbAt','path','24XqYwCb','wImIa','Tags','CFTemplates','utf-8','push','Parameters','js-yaml-cloudformation-schema','22136CEPgFK','Key','apiVersion','3418218PKuEyX','CloudFormation','BaseResourceName','pTnTj','../config/constants','StackName','info','TemplateBody','promisifyAll','46282490LwsQOI','Resources','js-yaml','schema','6305070uzwsFT','readFileAsync','hub-ha.yaml','dboLr','toString'];a28_0x5201=function(){return _0x321e1e;};return a28_0x5201();}(function(_0x166ac1,_0x75fc02){const _0x401c06=a28_0x4cb3,_0x29d1f8=_0x166ac1();while(!![]){try{const _0x19f605=-parseInt(_0x401c06(0x139))/0x1*(parseInt(_0x401c06(0x110))/0x2)+parseInt(_0x401c06(0x131))/0x3*(parseInt(_0x401c06(0x127))/0x4)+-parseInt(_0x401c06(0x10b))/0x5+-parseInt(_0x401c06(0x13c))/0x6+-parseInt(_0x401c06(0x12d))/0x7*(-parseInt(_0x401c06(0x11b))/0x8)+-parseInt(_0x401c06(0x128))/0x9+parseInt(_0x401c06(0x107))/0xa;if(_0x19f605===_0x75fc02)break;else _0x29d1f8['push'](_0x29d1f8['shift']());}catch(_0xe6e8bb){_0x29d1f8['push'](_0x29d1f8['shift']());}}}(a28_0x5201,0xd5bc2));const fs=require('fs'),path=require(a28_0x183411(0x130)),Promise=require(a28_0x183411(0x11c)),yaml=require(a28_0x183411(0x109)),{CLOUDFORMATION_SCHEMA}=require(a28_0x183411(0x138)),AWS=require(a28_0x183411(0x11f))['awsObj'],AWSUtils=require(a28_0x183411(0x11f)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x183411(0x140)),{logger}=require(a28_0x183411(0x11e));Promise[a28_0x183411(0x106)](fs);const addTags=async(_0x4f72f7,_0x20779c)=>{const _0x300b06=a28_0x183411;for(const _0xf916f6 in _0x4f72f7['Resources']){_0x4f72f7[_0x300b06(0x108)][_0xf916f6]['Properties']&&_0x4f72f7['Resources'][_0xf916f6][_0x300b06(0x123)]['Tags']&&_0x4f72f7[_0x300b06(0x108)][_0xf916f6][_0x300b06(0x123)]['Tags'][_0x300b06(0x136)](..._0x20779c);}};function a28_0x4cb3(_0x2b1071,_0x4ad799){const _0x520113=a28_0x5201();return a28_0x4cb3=function(_0x4cb34e,_0xae41cb){_0x4cb34e=_0x4cb34e-0x103;let _0x33c170=_0x520113[_0x4cb34e];return _0x33c170;},a28_0x4cb3(_0x2b1071,_0x4ad799);}exports[a28_0x183411(0x115)]=async(_0x268155,_0x11ad17=null)=>{const _0x5670dc=a28_0x183411,_0x567695={'gDoaY':_0x5670dc(0x12e),'pTnTj':_0x5670dc(0x12b),'Irazx':_0x5670dc(0x116),'BztkA':_0x5670dc(0x134),'zanvM':_0x5670dc(0x10d),'wImIa':_0x5670dc(0x135),'MerQU':function(_0x50347d,_0x305e8f,_0x43951a){return _0x50347d(_0x305e8f,_0x43951a);},'aKbAt':_0x5670dc(0x11a),'vMGtW':'DELETE','fTgMp':_0x5670dc(0x118),'xAesE':_0x5670dc(0x13e),'ziLCE':'ClusterOIDCURL','NNaxm':_0x5670dc(0x129),'dboLr':_0x5670dc(0x117),'UnXIh':'stackCreateComplete'},_0xbe1291=COMMON_HST_TAGS,_0xd4660d={};_0xd4660d[_0x5670dc(0x13a)]=_0x567695[_0x5670dc(0x121)],_0xd4660d['Value']=_0x268155,_0xbe1291['push'](_0xd4660d),_0xbe1291[_0x5670dc(0x136)]({'Key':_0x567695[_0x5670dc(0x13f)],'Value':new Date()[_0x5670dc(0x12a)]()[_0x5670dc(0x10f)]()});const _0x5e7bae={};_0x5e7bae[_0x5670dc(0x13b)]=_0x567695['Irazx'];const _0xfe9f40=new AWS[(_0x5670dc(0x13d))](_0x5e7bae),_0x5e6992=await fs[_0x5670dc(0x10c)](path[_0x5670dc(0x12c)](__dirname,'..',_0x567695[_0x5670dc(0x120)],_0x567695[_0x5670dc(0x112)]),_0x567695[_0x5670dc(0x132)]),_0x316748={};_0x316748[_0x5670dc(0x10a)]=CLOUDFORMATION_SCHEMA;const _0x43ac7f=yaml[_0x5670dc(0x122)](_0x5e6992,_0x316748);await _0x567695['MerQU'](addTags,_0x43ac7f,_0xbe1291);const _0x25db2c=JSON['stringify'](_0x43ac7f);let _0x3cd47e=await AWSUtils['getOidcUrl'](_0x268155);_0x3cd47e=_0x3cd47e[_0x5670dc(0x124)](_0x567695[_0x5670dc(0x12f)])[0x1];const _0x1c4e49={};_0x1c4e49[_0x5670dc(0x103)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x268155+_0x5670dc(0x126),_0x1c4e49['OnFailure']=_0x567695['vMGtW'],_0x1c4e49[_0x5670dc(0x105)]=_0x25db2c,_0x1c4e49[_0x5670dc(0x137)]=[{'ParameterKey':_0x567695[_0x5670dc(0x119)],'ParameterValue':_0x11ad17},{'ParameterKey':_0x567695[_0x5670dc(0x114)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x268155},{'ParameterKey':_0x567695[_0x5670dc(0x125)],'ParameterValue':_0x3cd47e}],_0x1c4e49[_0x5670dc(0x111)]=[_0x567695[_0x5670dc(0x11d)]],_0x1c4e49[_0x5670dc(0x133)]=_0xbe1291;const _0xae2db9=_0x1c4e49,_0x1fafd0=await _0xfe9f40['createStack'](_0xae2db9)[_0x5670dc(0x113)]();logger[_0x5670dc(0x104)](_0x567695[_0x5670dc(0x10e)]);const _0x5a6226={};return _0x5a6226[_0x5670dc(0x103)]=_0x1fafd0['StackId'],_0xfe9f40['waitFor'](_0x567695['UnXIh'],_0x5a6226)[_0x5670dc(0x113)]();};