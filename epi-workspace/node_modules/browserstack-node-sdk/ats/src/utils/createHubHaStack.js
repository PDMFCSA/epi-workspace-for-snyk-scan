const a28_0x3eecc8=a28_0x33e6;(function(_0x210b04,_0x1fb52c){const _0x4491e0=a28_0x33e6,_0x3ff6b4=_0x210b04();while(!![]){try{const _0x425591=-parseInt(_0x4491e0(0x13f))/0x1+parseInt(_0x4491e0(0x13a))/0x2+parseInt(_0x4491e0(0x15d))/0x3*(-parseInt(_0x4491e0(0x15f))/0x4)+parseInt(_0x4491e0(0x149))/0x5*(-parseInt(_0x4491e0(0x167))/0x6)+-parseInt(_0x4491e0(0x144))/0x7+-parseInt(_0x4491e0(0x143))/0x8+parseInt(_0x4491e0(0x13e))/0x9*(parseInt(_0x4491e0(0x173))/0xa);if(_0x425591===_0x1fb52c)break;else _0x3ff6b4['push'](_0x3ff6b4['shift']());}catch(_0x52d60d){_0x3ff6b4['push'](_0x3ff6b4['shift']());}}}(a28_0x3ddd,0xb20f3));const fs=require('fs'),path=require('path'),Promise=require(a28_0x3eecc8(0x138)),yaml=require(a28_0x3eecc8(0x172)),{CLOUDFORMATION_SCHEMA}=require(a28_0x3eecc8(0x169)),AWS=require(a28_0x3eecc8(0x14f))[a28_0x3eecc8(0x15c)],AWSUtils=require(a28_0x3eecc8(0x14f)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require(a28_0x3eecc8(0x16c));Promise[a28_0x3eecc8(0x137)](fs);const addTags=async(_0x37f662,_0x45b248)=>{const _0x4bf8f2=a28_0x3eecc8;for(const _0x46567d in _0x37f662[_0x4bf8f2(0x140)]){_0x37f662['Resources'][_0x46567d]['Properties']&&_0x37f662[_0x4bf8f2(0x140)][_0x46567d][_0x4bf8f2(0x16f)][_0x4bf8f2(0x14d)]&&_0x37f662[_0x4bf8f2(0x140)][_0x46567d][_0x4bf8f2(0x16f)]['Tags'][_0x4bf8f2(0x158)](..._0x45b248);}};function a28_0x33e6(_0x14b5b7,_0x3b5e3e){const _0x3dddb4=a28_0x3ddd();return a28_0x33e6=function(_0x33e6e0,_0x10dde8){_0x33e6e0=_0x33e6e0-0x137;let _0xbd699b=_0x3dddb4[_0x33e6e0];return _0xbd699b;},a28_0x33e6(_0x14b5b7,_0x3b5e3e);}function a28_0x3ddd(){const _0x3a1d06=['4113dyCKvA','506019KBHSGb','Resources','MXvFP','stackCreateComplete','8698864bORRNV','7154252cuhxuo','wxXyN','DELETE','CloudFormation','SRgIU','370unIuwh','ClusterOIDCURL','StackName','LhZfc','Tags','cuIub','./AWSUtils','pMcOo','promise','dwcGZ','DMRGb','browserstack:creationDate','SRquf','utf-8','split','push','2010-05-15','load','info','awsObj','15627JmqhxA','toString','56PURivY','IXITm','stringify','valueOf','StackId','CFTemplates','Value','createHubHaStack','15474ZsmKMA','Parameters','js-yaml-cloudformation-schema','CAPABILITY_NAMED_IAM','VpcId','../config/logger','browserstack:cluster','waitFor','Properties','VBrYF','ditoN','js-yaml','50650CYbRBJ','promisifyAll','bluebird','Capabilities','2587622YDdcOA','hub-ha.yaml','BaseResourceName','OnFailure'];a28_0x3ddd=function(){return _0x3a1d06;};return a28_0x3ddd();}exports[a28_0x3eecc8(0x166)]=async(_0x2b5862,_0x4420b1=null)=>{const _0x16cfeb=a28_0x3eecc8,_0xb5ac5={'MXvFP':_0x16cfeb(0x16d),'wxXyN':_0x16cfeb(0x154),'IXITm':_0x16cfeb(0x159),'SRquf':_0x16cfeb(0x164),'pFPsQ':_0x16cfeb(0x13b),'LhZfc':_0x16cfeb(0x156),'pMcOo':function(_0x4fe10e,_0x31a233,_0x557309){return _0x4fe10e(_0x31a233,_0x557309);},'cmZJl':'://','ditoN':_0x16cfeb(0x146),'dwcGZ':_0x16cfeb(0x16b),'VBrYF':_0x16cfeb(0x13c),'IJTKM':_0x16cfeb(0x14a),'cuIub':_0x16cfeb(0x16a),'SRgIU':'Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','DMRGb':_0x16cfeb(0x142)},_0x4d35ad=COMMON_HST_TAGS,_0x50e1cf={};_0x50e1cf['Key']=_0xb5ac5[_0x16cfeb(0x141)],_0x50e1cf[_0x16cfeb(0x165)]=_0x2b5862,_0x4d35ad[_0x16cfeb(0x158)](_0x50e1cf),_0x4d35ad['push']({'Key':_0xb5ac5[_0x16cfeb(0x145)],'Value':new Date()[_0x16cfeb(0x162)]()[_0x16cfeb(0x15e)]()});const _0x1c711f={};_0x1c711f['apiVersion']=_0xb5ac5[_0x16cfeb(0x160)];const _0x4fbf7a=new AWS[(_0x16cfeb(0x147))](_0x1c711f),_0x15e328=await fs['readFileAsync'](path['join'](__dirname,'..',_0xb5ac5[_0x16cfeb(0x155)],_0xb5ac5['pFPsQ']),_0xb5ac5[_0x16cfeb(0x14c)]),_0x279bd6={};_0x279bd6['schema']=CLOUDFORMATION_SCHEMA;const _0x2730b0=yaml[_0x16cfeb(0x15a)](_0x15e328,_0x279bd6);await _0xb5ac5[_0x16cfeb(0x150)](addTags,_0x2730b0,_0x4d35ad);const _0x30aaae=JSON[_0x16cfeb(0x161)](_0x2730b0);let _0x57f323=await AWSUtils['getOidcUrl'](_0x2b5862);_0x57f323=_0x57f323[_0x16cfeb(0x157)](_0xb5ac5['cmZJl'])[0x1];const _0x47a7ca={};_0x47a7ca['StackName']=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x2b5862+'-cf',_0x47a7ca[_0x16cfeb(0x13d)]=_0xb5ac5[_0x16cfeb(0x171)],_0x47a7ca['TemplateBody']=_0x30aaae,_0x47a7ca[_0x16cfeb(0x168)]=[{'ParameterKey':_0xb5ac5[_0x16cfeb(0x152)],'ParameterValue':_0x4420b1},{'ParameterKey':_0xb5ac5[_0x16cfeb(0x170)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x2b5862},{'ParameterKey':_0xb5ac5['IJTKM'],'ParameterValue':_0x57f323}],_0x47a7ca[_0x16cfeb(0x139)]=[_0xb5ac5[_0x16cfeb(0x14e)]],_0x47a7ca[_0x16cfeb(0x14d)]=_0x4d35ad;const _0x2c7df9=_0x47a7ca,_0x42c896=await _0x4fbf7a['createStack'](_0x2c7df9)[_0x16cfeb(0x151)]();logger[_0x16cfeb(0x15b)](_0xb5ac5[_0x16cfeb(0x148)]);const _0x27db70={};return _0x27db70[_0x16cfeb(0x14b)]=_0x42c896[_0x16cfeb(0x163)],_0x4fbf7a[_0x16cfeb(0x16e)](_0xb5ac5[_0x16cfeb(0x153)],_0x27db70)[_0x16cfeb(0x151)]();};