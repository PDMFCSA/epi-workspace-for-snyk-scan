const a28_0x4ce7e7=a28_0x5e32;function a28_0x5e32(_0x191ac9,_0x30f615){const _0x5a42ed=a28_0x5a42();return a28_0x5e32=function(_0x5e32ae,_0x5a7d56){_0x5e32ae=_0x5e32ae-0xf4;let _0x490fc9=_0x5a42ed[_0x5e32ae];return _0x490fc9;},a28_0x5e32(_0x191ac9,_0x30f615);}(function(_0x4f1735,_0x80b4e0){const _0x44612f=a28_0x5e32,_0x4a06b7=_0x4f1735();while(!![]){try{const _0x5dd031=-parseInt(_0x44612f(0x124))/0x1+parseInt(_0x44612f(0xfb))/0x2*(-parseInt(_0x44612f(0x102))/0x3)+-parseInt(_0x44612f(0x106))/0x4*(-parseInt(_0x44612f(0xfe))/0x5)+-parseInt(_0x44612f(0x12d))/0x6+-parseInt(_0x44612f(0x114))/0x7*(-parseInt(_0x44612f(0x10d))/0x8)+parseInt(_0x44612f(0x110))/0x9+parseInt(_0x44612f(0x120))/0xa;if(_0x5dd031===_0x80b4e0)break;else _0x4a06b7['push'](_0x4a06b7['shift']());}catch(_0x192ae0){_0x4a06b7['push'](_0x4a06b7['shift']());}}}(a28_0x5a42,0x6de7a));const fs=require('fs'),path=require(a28_0x4ce7e7(0x127)),Promise=require('bluebird'),yaml=require(a28_0x4ce7e7(0x109)),{CLOUDFORMATION_SCHEMA}=require(a28_0x4ce7e7(0xf9)),AWS=require(a28_0x4ce7e7(0x122))[a28_0x4ce7e7(0x130)],AWSUtils=require(a28_0x4ce7e7(0x122)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x4ce7e7(0x12b)),{logger}=require(a28_0x4ce7e7(0x10c));Promise[a28_0x4ce7e7(0x10b)](fs);const addTags=async(_0x18c386,_0x2cb233)=>{const _0x35f6e7=a28_0x4ce7e7;for(const _0x1f6245 in _0x18c386[_0x35f6e7(0x12c)]){_0x18c386[_0x35f6e7(0x12c)][_0x1f6245]['Properties']&&_0x18c386['Resources'][_0x1f6245][_0x35f6e7(0x126)]['Tags']&&_0x18c386['Resources'][_0x1f6245][_0x35f6e7(0x126)][_0x35f6e7(0x125)][_0x35f6e7(0x101)](..._0x2cb233);}};function a28_0x5a42(){const _0x1c8372=['515dTmoFR','BaseResourceName','Key','push','3uqAuKC','TemplateBody','nzzIO','info','30956KpWvmz','utf-8','toString','js-yaml','YsTLX','promisifyAll','../config/logger','8vMSQFI','AQQTJ','QVOiP','3406383OKFIrz','stackCreateComplete','createStack','CosEj','1139768Alfghn','hub-ha.yaml','browserstack:cluster','load','fOVIo','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','ryyRc','Unpny','split','join','POdUG','CloudFormation','6526980jKdljg','Parameters','./AWSUtils','Capabilities','885892lHcLNK','Tags','Properties','path','XrEYt','-cf','VpcId','../config/constants','Resources','756270WkfUVa','waitFor','readFileAsync','awsObj','valueOf','promise','ClusterOIDCURL','qsXwV','Value','StackName','js-yaml-cloudformation-schema','schema','1058038CvPYjI','CAPABILITY_NAMED_IAM','getOidcUrl'];a28_0x5a42=function(){return _0x1c8372;};return a28_0x5a42();}exports['createHubHaStack']=async(_0x3c6b44,_0x58fb56=null)=>{const _0x28f074=a28_0x4ce7e7,_0x4a4336={'mNRfE':_0x28f074(0x116),'CosEj':'browserstack:creationDate','Unpny':'2010-05-15','ryyRc':'CFTemplates','fOVIo':_0x28f074(0x115),'iWElC':_0x28f074(0x107),'tnpfk':function(_0x25eea2,_0x12d77d,_0x1d8038){return _0x25eea2(_0x12d77d,_0x1d8038);},'XrEYt':'://','QVOiP':'DELETE','ONPxT':_0x28f074(0x12a),'AQQTJ':_0x28f074(0xff),'YsTLX':_0x28f074(0xf5),'POdUG':_0x28f074(0xfc),'nzzIO':_0x28f074(0x119),'qsXwV':_0x28f074(0x111)},_0x2fe5ec=COMMON_HST_TAGS,_0x331eb9={};_0x331eb9[_0x28f074(0x100)]=_0x4a4336['mNRfE'],_0x331eb9[_0x28f074(0xf7)]=_0x3c6b44,_0x2fe5ec[_0x28f074(0x101)](_0x331eb9),_0x2fe5ec[_0x28f074(0x101)]({'Key':_0x4a4336[_0x28f074(0x113)],'Value':new Date()[_0x28f074(0x131)]()[_0x28f074(0x108)]()});const _0x5565d0={};_0x5565d0['apiVersion']=_0x4a4336[_0x28f074(0x11b)];const _0x5a6d97=new AWS[(_0x28f074(0x11f))](_0x5565d0),_0x1fcb28=await fs[_0x28f074(0x12f)](path[_0x28f074(0x11d)](__dirname,'..',_0x4a4336[_0x28f074(0x11a)],_0x4a4336[_0x28f074(0x118)]),_0x4a4336['iWElC']),_0x269f50={};_0x269f50[_0x28f074(0xfa)]=CLOUDFORMATION_SCHEMA;const _0x85a6b5=yaml[_0x28f074(0x117)](_0x1fcb28,_0x269f50);await _0x4a4336['tnpfk'](addTags,_0x85a6b5,_0x2fe5ec);const _0x818d33=JSON['stringify'](_0x85a6b5);let _0x1b9e83=await AWSUtils[_0x28f074(0xfd)](_0x3c6b44);_0x1b9e83=_0x1b9e83[_0x28f074(0x11c)](_0x4a4336[_0x28f074(0x128)])[0x1];const _0x379dcd={};_0x379dcd['StackName']=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x3c6b44+_0x28f074(0x129),_0x379dcd['OnFailure']=_0x4a4336[_0x28f074(0x10f)],_0x379dcd[_0x28f074(0x103)]=_0x818d33,_0x379dcd[_0x28f074(0x121)]=[{'ParameterKey':_0x4a4336['ONPxT'],'ParameterValue':_0x58fb56},{'ParameterKey':_0x4a4336[_0x28f074(0x10e)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x3c6b44},{'ParameterKey':_0x4a4336[_0x28f074(0x10a)],'ParameterValue':_0x1b9e83}],_0x379dcd[_0x28f074(0x123)]=[_0x4a4336[_0x28f074(0x11e)]],_0x379dcd[_0x28f074(0x125)]=_0x2fe5ec;const _0x1b495c=_0x379dcd,_0x3cb1a1=await _0x5a6d97[_0x28f074(0x112)](_0x1b495c)[_0x28f074(0xf4)]();logger[_0x28f074(0x105)](_0x4a4336[_0x28f074(0x104)]);const _0x31be46={};return _0x31be46[_0x28f074(0xf8)]=_0x3cb1a1['StackId'],_0x5a6d97[_0x28f074(0x12e)](_0x4a4336[_0x28f074(0xf6)],_0x31be46)[_0x28f074(0xf4)]();};