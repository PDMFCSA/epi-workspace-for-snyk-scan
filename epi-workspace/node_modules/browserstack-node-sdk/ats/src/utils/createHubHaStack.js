const a28_0x1a79a3=a28_0x24a6;(function(_0x3b08e5,_0x1a43d2){const _0x562964=a28_0x24a6,_0x10948b=_0x3b08e5();while(!![]){try{const _0x54ca6b=-parseInt(_0x562964(0x1f6))/0x1*(parseInt(_0x562964(0x201))/0x2)+parseInt(_0x562964(0x21b))/0x3+-parseInt(_0x562964(0x21f))/0x4*(-parseInt(_0x562964(0x211))/0x5)+-parseInt(_0x562964(0x218))/0x6+-parseInt(_0x562964(0x1f9))/0x7+-parseInt(_0x562964(0x20c))/0x8*(parseInt(_0x562964(0x204))/0x9)+parseInt(_0x562964(0x20e))/0xa;if(_0x54ca6b===_0x1a43d2)break;else _0x10948b['push'](_0x10948b['shift']());}catch(_0x49dc85){_0x10948b['push'](_0x10948b['shift']());}}}(a28_0x2937,0x893e8));const fs=require('fs'),path=require('path'),Promise=require(a28_0x1a79a3(0x20a)),yaml=require(a28_0x1a79a3(0x215)),{CLOUDFORMATION_SCHEMA}=require(a28_0x1a79a3(0x209)),AWS=require(a28_0x1a79a3(0x200))[a28_0x1a79a3(0x213)],AWSUtils=require(a28_0x1a79a3(0x200)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require(a28_0x1a79a3(0x1ee));function a28_0x24a6(_0x50a282,_0x34dd1c){const _0x29372c=a28_0x2937();return a28_0x24a6=function(_0x24a6e3,_0x146bc1){_0x24a6e3=_0x24a6e3-0x1ec;let _0x137a85=_0x29372c[_0x24a6e3];return _0x137a85;},a28_0x24a6(_0x50a282,_0x34dd1c);}Promise['promisifyAll'](fs);function a28_0x2937(){const _0x4cda5e=['Tags','3203036XDhksc','push','2010-05-15','nqXpw','readFileAsync','fBKTY','Properties','oOrYM','StackName','browserstack:creationDate','apiVersion','XUuiv','../config/logger','OnFailure','CFTemplates','Key','://','browserstack:cluster','MJFec','tNsve','482761wsrIOI','utf-8','StackId','3710210EdmmhX','DELETE','tjpNI','EJCrc','stringify','toString','UUGKZ','./AWSUtils','2GjnAsN','cwVKz','Resources','18qkwRrC','Capabilities','lqvOE','promise','hub-ha.yaml','js-yaml-cloudformation-schema','bluebird','waitFor','1816392IFEkuh','-cf','17592400OGRjqE','Value','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','5cGFPTY','Parameters','awsObj','fwyib','js-yaml','schema','BaseResourceName','5532768fPojMW','createHubHaStack','VpcId','1173510LTDgVj','cNonv','stackCreateComplete'];a28_0x2937=function(){return _0x4cda5e;};return a28_0x2937();}const addTags=async(_0x15f128,_0x3dd736)=>{const _0x16d517=a28_0x1a79a3;for(const _0x5d8e9a in _0x15f128['Resources']){_0x15f128['Resources'][_0x5d8e9a][_0x16d517(0x225)]&&_0x15f128['Resources'][_0x5d8e9a][_0x16d517(0x225)]['Tags']&&_0x15f128[_0x16d517(0x203)][_0x5d8e9a][_0x16d517(0x225)][_0x16d517(0x21e)][_0x16d517(0x220)](..._0x3dd736);}};exports[a28_0x1a79a3(0x219)]=async(_0x1ad919,_0x234dbd=null)=>{const _0xdd6e00=a28_0x1a79a3,_0x1a8697={'cNonv':_0xdd6e00(0x1f3),'MJFec':_0xdd6e00(0x228),'lqvOE':_0xdd6e00(0x221),'tjpNI':_0xdd6e00(0x1f0),'YoIlV':_0xdd6e00(0x208),'fwyib':_0xdd6e00(0x1f7),'nqXpw':function(_0x25be96,_0x276e11,_0x4f5adc){return _0x25be96(_0x276e11,_0x4f5adc);},'tNsve':_0xdd6e00(0x1f2),'oOrYM':_0xdd6e00(0x1fa),'XUuiv':_0xdd6e00(0x21a),'ufHZv':_0xdd6e00(0x217),'UUGKZ':'ClusterOIDCURL','fBKTY':'CAPABILITY_NAMED_IAM','cwVKz':_0xdd6e00(0x210),'EJCrc':_0xdd6e00(0x21d)},_0x3cb939=COMMON_HST_TAGS,_0x17db55={};_0x17db55[_0xdd6e00(0x1f1)]=_0x1a8697[_0xdd6e00(0x21c)],_0x17db55[_0xdd6e00(0x20f)]=_0x1ad919,_0x3cb939[_0xdd6e00(0x220)](_0x17db55),_0x3cb939[_0xdd6e00(0x220)]({'Key':_0x1a8697[_0xdd6e00(0x1f4)],'Value':new Date()['valueOf']()[_0xdd6e00(0x1fe)]()});const _0x403120={};_0x403120[_0xdd6e00(0x1ec)]=_0x1a8697[_0xdd6e00(0x206)];const _0x57308c=new AWS['CloudFormation'](_0x403120),_0x47a528=await fs[_0xdd6e00(0x223)](path['join'](__dirname,'..',_0x1a8697[_0xdd6e00(0x1fb)],_0x1a8697['YoIlV']),_0x1a8697[_0xdd6e00(0x214)]),_0x59c78={};_0x59c78[_0xdd6e00(0x216)]=CLOUDFORMATION_SCHEMA;const _0x243966=yaml['load'](_0x47a528,_0x59c78);await _0x1a8697[_0xdd6e00(0x222)](addTags,_0x243966,_0x3cb939);const _0x48b44a=JSON[_0xdd6e00(0x1fd)](_0x243966);let _0x16abc1=await AWSUtils['getOidcUrl'](_0x1ad919);_0x16abc1=_0x16abc1['split'](_0x1a8697[_0xdd6e00(0x1f5)])[0x1];const _0x53aa09={};_0x53aa09[_0xdd6e00(0x227)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x1ad919+_0xdd6e00(0x20d),_0x53aa09[_0xdd6e00(0x1ef)]=_0x1a8697[_0xdd6e00(0x226)],_0x53aa09['TemplateBody']=_0x48b44a,_0x53aa09[_0xdd6e00(0x212)]=[{'ParameterKey':_0x1a8697[_0xdd6e00(0x1ed)],'ParameterValue':_0x234dbd},{'ParameterKey':_0x1a8697['ufHZv'],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x1ad919},{'ParameterKey':_0x1a8697[_0xdd6e00(0x1ff)],'ParameterValue':_0x16abc1}],_0x53aa09[_0xdd6e00(0x205)]=[_0x1a8697[_0xdd6e00(0x224)]],_0x53aa09[_0xdd6e00(0x21e)]=_0x3cb939;const _0x3cc5b6=_0x53aa09,_0x3d7df4=await _0x57308c['createStack'](_0x3cc5b6)[_0xdd6e00(0x207)]();logger['info'](_0x1a8697[_0xdd6e00(0x202)]);const _0x5e7999={};return _0x5e7999[_0xdd6e00(0x227)]=_0x3d7df4[_0xdd6e00(0x1f8)],_0x57308c[_0xdd6e00(0x20b)](_0x1a8697[_0xdd6e00(0x1fc)],_0x5e7999)[_0xdd6e00(0x207)]();};