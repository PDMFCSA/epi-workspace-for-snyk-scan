const a28_0x52289e=a28_0x5734;(function(_0x4ac550,_0x182e72){const _0x5baf3b=a28_0x5734,_0x1caf38=_0x4ac550();while(!![]){try{const _0x27fc0d=parseInt(_0x5baf3b(0x148))/0x1*(-parseInt(_0x5baf3b(0x16a))/0x2)+parseInt(_0x5baf3b(0x147))/0x3*(-parseInt(_0x5baf3b(0x156))/0x4)+-parseInt(_0x5baf3b(0x146))/0x5+-parseInt(_0x5baf3b(0x167))/0x6*(parseInt(_0x5baf3b(0x15d))/0x7)+-parseInt(_0x5baf3b(0x165))/0x8*(-parseInt(_0x5baf3b(0x175))/0x9)+parseInt(_0x5baf3b(0x158))/0xa+parseInt(_0x5baf3b(0x164))/0xb;if(_0x27fc0d===_0x182e72)break;else _0x1caf38['push'](_0x1caf38['shift']());}catch(_0x40e2e5){_0x1caf38['push'](_0x1caf38['shift']());}}}(a28_0x4168,0x87f43));const fs=require('fs'),path=require(a28_0x52289e(0x16d)),Promise=require(a28_0x52289e(0x168)),yaml=require('js-yaml'),{CLOUDFORMATION_SCHEMA}=require(a28_0x52289e(0x155)),AWS=require('./AWSUtils')[a28_0x52289e(0x151)],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x52289e(0x14d)),{logger}=require(a28_0x52289e(0x153));Promise['promisifyAll'](fs);function a28_0x5734(_0x516583,_0xd237c6){const _0x41683d=a28_0x4168();return a28_0x5734=function(_0x57349b,_0x131e98){_0x57349b=_0x57349b-0x141;let _0x58f143=_0x41683d[_0x57349b];return _0x58f143;},a28_0x5734(_0x516583,_0xd237c6);}const addTags=async(_0x4c5188,_0x5aff1a)=>{const _0x28e387=a28_0x52289e;for(const _0x4feab0 in _0x4c5188[_0x28e387(0x17a)]){_0x4c5188[_0x28e387(0x17a)][_0x4feab0][_0x28e387(0x163)]&&_0x4c5188[_0x28e387(0x17a)][_0x4feab0][_0x28e387(0x163)][_0x28e387(0x15e)]&&_0x4c5188[_0x28e387(0x17a)][_0x4feab0]['Properties']['Tags'][_0x28e387(0x170)](..._0x5aff1a);}};function a28_0x4168(){const _0x3c5ade=['StackId','45ZPhFZL','-cf','VpcId','waitFor','Capabilities','Resources','djOaI','promise','split','Qmmly','TemplateBody','2471090vMYwyx','15yrabUa','1LGApOH','getOidcUrl','Parameters','ClusterOIDCURL','StackName','../config/constants','DtxAt','utf-8','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','awsObj','createStack','../config/logger','VxQiu','js-yaml-cloudformation-schema','532040XOtcvb','apiVersion','410620yJWRyr','Value','DELETE','Key','browserstack:creationDate','6839AhcMrM','Tags','toString','hub-ha.yaml','CAPABILITY_NAMED_IAM','BaseResourceName','Properties','25425642yNTAoV','184656wBPjGY','SQPuM','3966JSNUvf','bluebird','qSCHy','211924veetpi','://','FAOmh','path','join','stringify','push','readFileAsync','stackCreateComplete','bhgyC'];a28_0x4168=function(){return _0x3c5ade;};return a28_0x4168();}exports['createHubHaStack']=async(_0x81d234,_0x5236b4=null)=>{const _0x3e1e60=a28_0x52289e,_0x8fa077={'djOaI':'browserstack:cluster','eLPMN':_0x3e1e60(0x15c),'DtxAt':'2010-05-15','CkghE':'CFTemplates','xTpJU':_0x3e1e60(0x160),'kYHNB':_0x3e1e60(0x14f),'Qmmly':function(_0xf769bb,_0x20f272,_0x456d45){return _0xf769bb(_0x20f272,_0x456d45);},'FHWZE':_0x3e1e60(0x16b),'VxQiu':_0x3e1e60(0x15a),'SZtVB':_0x3e1e60(0x177),'bhgyC':_0x3e1e60(0x162),'SQPuM':_0x3e1e60(0x14b),'vOsTg':_0x3e1e60(0x161),'FAOmh':_0x3e1e60(0x150),'qSCHy':_0x3e1e60(0x172)},_0x4a4998=COMMON_HST_TAGS,_0x81961e={};_0x81961e[_0x3e1e60(0x15b)]=_0x8fa077[_0x3e1e60(0x141)],_0x81961e[_0x3e1e60(0x159)]=_0x81d234,_0x4a4998['push'](_0x81961e),_0x4a4998[_0x3e1e60(0x170)]({'Key':_0x8fa077['eLPMN'],'Value':new Date()['valueOf']()[_0x3e1e60(0x15f)]()});const _0x831587={};_0x831587[_0x3e1e60(0x157)]=_0x8fa077[_0x3e1e60(0x14e)];const _0xe1ce24=new AWS['CloudFormation'](_0x831587),_0x317fc0=await fs[_0x3e1e60(0x171)](path[_0x3e1e60(0x16e)](__dirname,'..',_0x8fa077['CkghE'],_0x8fa077['xTpJU']),_0x8fa077['kYHNB']),_0x456674={};_0x456674['schema']=CLOUDFORMATION_SCHEMA;const _0x52604d=yaml['load'](_0x317fc0,_0x456674);await _0x8fa077[_0x3e1e60(0x144)](addTags,_0x52604d,_0x4a4998);const _0x50a97b=JSON[_0x3e1e60(0x16f)](_0x52604d);let _0x321174=await AWSUtils[_0x3e1e60(0x149)](_0x81d234);_0x321174=_0x321174[_0x3e1e60(0x143)](_0x8fa077['FHWZE'])[0x1];const _0x1d3fe9={};_0x1d3fe9[_0x3e1e60(0x14c)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x81d234+_0x3e1e60(0x176),_0x1d3fe9['OnFailure']=_0x8fa077[_0x3e1e60(0x154)],_0x1d3fe9[_0x3e1e60(0x145)]=_0x50a97b,_0x1d3fe9[_0x3e1e60(0x14a)]=[{'ParameterKey':_0x8fa077['SZtVB'],'ParameterValue':_0x5236b4},{'ParameterKey':_0x8fa077[_0x3e1e60(0x173)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x81d234},{'ParameterKey':_0x8fa077[_0x3e1e60(0x166)],'ParameterValue':_0x321174}],_0x1d3fe9[_0x3e1e60(0x179)]=[_0x8fa077['vOsTg']],_0x1d3fe9[_0x3e1e60(0x15e)]=_0x4a4998;const _0x57bbb7=_0x1d3fe9,_0x5cafec=await _0xe1ce24[_0x3e1e60(0x152)](_0x57bbb7)[_0x3e1e60(0x142)]();logger['info'](_0x8fa077[_0x3e1e60(0x16c)]);const _0x3b2c83={};return _0x3b2c83[_0x3e1e60(0x14c)]=_0x5cafec[_0x3e1e60(0x174)],_0xe1ce24[_0x3e1e60(0x178)](_0x8fa077[_0x3e1e60(0x169)],_0x3b2c83)['promise']();};