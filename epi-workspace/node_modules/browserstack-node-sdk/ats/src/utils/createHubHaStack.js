const a28_0x4c9d53=a28_0x14c9;(function(_0x4a6a45,_0x3358f1){const _0x367890=a28_0x14c9,_0x37f69c=_0x4a6a45();while(!![]){try{const _0x21148e=parseInt(_0x367890(0x1ba))/0x1*(-parseInt(_0x367890(0x18e))/0x2)+-parseInt(_0x367890(0x1b6))/0x3+-parseInt(_0x367890(0x194))/0x4*(-parseInt(_0x367890(0x1c8))/0x5)+-parseInt(_0x367890(0x1c4))/0x6+-parseInt(_0x367890(0x19d))/0x7*(parseInt(_0x367890(0x1c6))/0x8)+-parseInt(_0x367890(0x19f))/0x9*(parseInt(_0x367890(0x1b3))/0xa)+parseInt(_0x367890(0x1b1))/0xb;if(_0x21148e===_0x3358f1)break;else _0x37f69c['push'](_0x37f69c['shift']());}catch(_0x1d984a){_0x37f69c['push'](_0x37f69c['shift']());}}}(a28_0x4da1,0x95132));const fs=require('fs'),path=require(a28_0x4c9d53(0x1b5)),Promise=require(a28_0x4c9d53(0x1b8)),yaml=require('js-yaml'),{CLOUDFORMATION_SCHEMA}=require(a28_0x4c9d53(0x1a3)),AWS=require(a28_0x4c9d53(0x1bb))[a28_0x4c9d53(0x1b0)],AWSUtils=require(a28_0x4c9d53(0x1bb)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require(a28_0x4c9d53(0x19b));Promise['promisifyAll'](fs);function a28_0x4da1(){const _0x26726b=['split','createStack','Tags','Resources','ZdZHG','DnDNW','StackName','VpcId','OnFailure','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','CloudFormation','hDnea','awsObj','32714660subfwV','NVsrV','108390EcPKDs','://','path','2084622esMdLm','aPChv','bluebird','valueOf','1YgwvNe','./AWSUtils','toString','DELETE','RSjME','getOidcUrl','Properties','load','Parameters','StackId','6142554EwoaMz','join','48NoqDYQ','Value','5UNybFy','waitFor','PulzS','apiVersion','1251542xiBzkN','utf-8','WdaaL','promise','browserstack:creationDate','CFTemplates','845848JKOoGj','CSpcS','push','TemplateBody','schema','ECcFq','ZfvGg','../config/logger','stackCreateComplete','91889rsGgWm','2010-05-15','126JMGWoW','Key','ALdtf','info','js-yaml-cloudformation-schema'];a28_0x4da1=function(){return _0x26726b;};return a28_0x4da1();}function a28_0x14c9(_0x36b24a,_0x1de147){const _0x4da159=a28_0x4da1();return a28_0x14c9=function(_0x14c918,_0x117928){_0x14c918=_0x14c918-0x18c;let _0x37599b=_0x4da159[_0x14c918];return _0x37599b;},a28_0x14c9(_0x36b24a,_0x1de147);}const addTags=async(_0x2fd90c,_0x4e5a17)=>{const _0x29dbf3=a28_0x4c9d53;for(const _0x4e4c6f in _0x2fd90c['Resources']){_0x2fd90c[_0x29dbf3(0x1a7)][_0x4e4c6f]['Properties']&&_0x2fd90c[_0x29dbf3(0x1a7)][_0x4e4c6f][_0x29dbf3(0x1c0)][_0x29dbf3(0x1a6)]&&_0x2fd90c[_0x29dbf3(0x1a7)][_0x4e4c6f][_0x29dbf3(0x1c0)]['Tags']['push'](..._0x4e5a17);}};exports['createHubHaStack']=async(_0x474df3,_0x13d745=null)=>{const _0xdb6733=a28_0x4c9d53,_0x4ce5ec={'ZfvGg':'browserstack:cluster','NVsrV':_0xdb6733(0x192),'WdaaL':_0xdb6733(0x19e),'CSpcS':_0xdb6733(0x193),'RSjME':'hub-ha.yaml','mDugN':_0xdb6733(0x18f),'aPChv':function(_0xd75a63,_0x1b99e6,_0xbec308){return _0xd75a63(_0x1b99e6,_0xbec308);},'ECcFq':_0xdb6733(0x1b4),'PulzS':_0xdb6733(0x1bd),'hDnea':_0xdb6733(0x1ab),'XMYcf':'BaseResourceName','ALdtf':'ClusterOIDCURL','DnDNW':'CAPABILITY_NAMED_IAM','ZdZHG':_0xdb6733(0x1ad),'nqxoq':_0xdb6733(0x19c)},_0x106e9b=COMMON_HST_TAGS,_0x154a77={};_0x154a77[_0xdb6733(0x1a0)]=_0x4ce5ec[_0xdb6733(0x19a)],_0x154a77[_0xdb6733(0x1c7)]=_0x474df3,_0x106e9b['push'](_0x154a77),_0x106e9b[_0xdb6733(0x196)]({'Key':_0x4ce5ec[_0xdb6733(0x1b2)],'Value':new Date()[_0xdb6733(0x1b9)]()[_0xdb6733(0x1bc)]()});const _0x1413b0={};_0x1413b0[_0xdb6733(0x18d)]=_0x4ce5ec[_0xdb6733(0x190)];const _0x7822bd=new AWS[(_0xdb6733(0x1ae))](_0x1413b0),_0x31723e=await fs['readFileAsync'](path[_0xdb6733(0x1c5)](__dirname,'..',_0x4ce5ec[_0xdb6733(0x195)],_0x4ce5ec[_0xdb6733(0x1be)]),_0x4ce5ec['mDugN']),_0x74a91d={};_0x74a91d[_0xdb6733(0x198)]=CLOUDFORMATION_SCHEMA;const _0x9add0f=yaml[_0xdb6733(0x1c1)](_0x31723e,_0x74a91d);await _0x4ce5ec[_0xdb6733(0x1b7)](addTags,_0x9add0f,_0x106e9b);const _0x52f82a=JSON['stringify'](_0x9add0f);let _0x195244=await AWSUtils[_0xdb6733(0x1bf)](_0x474df3);_0x195244=_0x195244[_0xdb6733(0x1a4)](_0x4ce5ec[_0xdb6733(0x199)])[0x1];const _0x39409a={};_0x39409a['StackName']=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x474df3+'-cf',_0x39409a[_0xdb6733(0x1ac)]=_0x4ce5ec[_0xdb6733(0x18c)],_0x39409a[_0xdb6733(0x197)]=_0x52f82a,_0x39409a[_0xdb6733(0x1c2)]=[{'ParameterKey':_0x4ce5ec[_0xdb6733(0x1af)],'ParameterValue':_0x13d745},{'ParameterKey':_0x4ce5ec['XMYcf'],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x474df3},{'ParameterKey':_0x4ce5ec[_0xdb6733(0x1a1)],'ParameterValue':_0x195244}],_0x39409a['Capabilities']=[_0x4ce5ec[_0xdb6733(0x1a9)]],_0x39409a[_0xdb6733(0x1a6)]=_0x106e9b;const _0x423a87=_0x39409a,_0x378c1a=await _0x7822bd[_0xdb6733(0x1a5)](_0x423a87)[_0xdb6733(0x191)]();logger[_0xdb6733(0x1a2)](_0x4ce5ec[_0xdb6733(0x1a8)]);const _0x1ca883={};return _0x1ca883[_0xdb6733(0x1aa)]=_0x378c1a[_0xdb6733(0x1c3)],_0x7822bd[_0xdb6733(0x1c9)](_0x4ce5ec['nqxoq'],_0x1ca883)[_0xdb6733(0x191)]();};