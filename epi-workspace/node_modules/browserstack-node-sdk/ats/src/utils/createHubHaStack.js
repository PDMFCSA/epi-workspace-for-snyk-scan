const a28_0x31989c=a28_0x2648;(function(_0x38f99c,_0x318f0a){const _0x43887f=a28_0x2648,_0x5c1515=_0x38f99c();while(!![]){try{const _0x1a5e90=parseInt(_0x43887f(0x195))/0x1+parseInt(_0x43887f(0x1a0))/0x2*(-parseInt(_0x43887f(0x173))/0x3)+parseInt(_0x43887f(0x19b))/0x4*(parseInt(_0x43887f(0x189))/0x5)+-parseInt(_0x43887f(0x168))/0x6+parseInt(_0x43887f(0x185))/0x7+-parseInt(_0x43887f(0x18e))/0x8*(parseInt(_0x43887f(0x19a))/0x9)+parseInt(_0x43887f(0x187))/0xa;if(_0x1a5e90===_0x318f0a)break;else _0x5c1515['push'](_0x5c1515['shift']());}catch(_0x320da0){_0x5c1515['push'](_0x5c1515['shift']());}}}(a28_0x3da3,0xdd801));function a28_0x2648(_0x14eaac,_0x1b83a4){const _0x3da316=a28_0x3da3();return a28_0x2648=function(_0x264845,_0x4fe183){_0x264845=_0x264845-0x165;let _0xa341d7=_0x3da316[_0x264845];return _0xa341d7;},a28_0x2648(_0x14eaac,_0x1b83a4);}const fs=require('fs'),path=require(a28_0x31989c(0x17c)),Promise=require('bluebird'),yaml=require('js-yaml'),{CLOUDFORMATION_SCHEMA}=require(a28_0x31989c(0x174)),AWS=require(a28_0x31989c(0x170))[a28_0x31989c(0x18c)],AWSUtils=require(a28_0x31989c(0x170)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require('../config/logger');Promise[a28_0x31989c(0x19c)](fs);function a28_0x3da3(){const _0x14e3d4=['info','split','2010-05-15','EqFAZ','StackName','BaseResourceName','VpcId','./AWSUtils','createHubHaStack','BFvFn','725139MNaEhz','js-yaml-cloudformation-schema','Properties','TemplateBody','DELETE','promise','Key','wZBzs','ETfEI','path','-cf','push','Capabilities','schema','OnFailure','join','Tags','load','3868739iXzZxE','readFileAsync','19711490WuFUlg','QlLTK','2415IlMzdb','CloudFormation','stackCreateComplete','awsObj','ViXbK','9688WyyICH','CAPABILITY_NAMED_IAM','browserstack:creationDate','createStack','xLcUK','valueOf','Resources','703869pimpnW','AShgv','bXOhU','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','CFTemplates','13059oWzEWM','8452hICoKh','promisifyAll','toString','apiVersion','DYfAT','2GzZYlW','ywOIq','hub-ha.yaml','MJMQM','browserstack:cluster','8052810xuIyth'];a28_0x3da3=function(){return _0x14e3d4;};return a28_0x3da3();}const addTags=async(_0xf4d61f,_0x4cf0bd)=>{const _0x2e76e9=a28_0x31989c;for(const _0x361a3c in _0xf4d61f[_0x2e76e9(0x194)]){_0xf4d61f[_0x2e76e9(0x194)][_0x361a3c][_0x2e76e9(0x175)]&&_0xf4d61f['Resources'][_0x361a3c]['Properties'][_0x2e76e9(0x183)]&&_0xf4d61f['Resources'][_0x361a3c][_0x2e76e9(0x175)][_0x2e76e9(0x183)][_0x2e76e9(0x17e)](..._0x4cf0bd);}};exports[a28_0x31989c(0x171)]=async(_0x3d97b5,_0x4c7ee7=null)=>{const _0x5e80a5=a28_0x31989c,_0x159889={'DYfAT':_0x5e80a5(0x167),'BFvFn':_0x5e80a5(0x190),'YkCAd':_0x5e80a5(0x16b),'xLcUK':_0x5e80a5(0x199),'yIOUx':_0x5e80a5(0x165),'wZBzs':'utf-8','mBpOK':function(_0x2a0158,_0x504a97,_0x22e64b){return _0x2a0158(_0x504a97,_0x22e64b);},'EqFAZ':'://','QlLTK':_0x5e80a5(0x177),'bXOhU':_0x5e80a5(0x16f),'AShgv':_0x5e80a5(0x16e),'ywOIq':'ClusterOIDCURL','MJMQM':_0x5e80a5(0x18f),'ETfEI':_0x5e80a5(0x198),'ViXbK':_0x5e80a5(0x18b)},_0x262853=COMMON_HST_TAGS,_0x565174={};_0x565174[_0x5e80a5(0x179)]=_0x159889[_0x5e80a5(0x19f)],_0x565174['Value']=_0x3d97b5,_0x262853['push'](_0x565174),_0x262853['push']({'Key':_0x159889[_0x5e80a5(0x172)],'Value':new Date()[_0x5e80a5(0x193)]()[_0x5e80a5(0x19d)]()});const _0x56d64b={};_0x56d64b[_0x5e80a5(0x19e)]=_0x159889['YkCAd'];const _0x2d2ab7=new AWS[(_0x5e80a5(0x18a))](_0x56d64b),_0x11b13f=await fs[_0x5e80a5(0x186)](path[_0x5e80a5(0x182)](__dirname,'..',_0x159889[_0x5e80a5(0x192)],_0x159889['yIOUx']),_0x159889[_0x5e80a5(0x17a)]),_0x14cc69={};_0x14cc69[_0x5e80a5(0x180)]=CLOUDFORMATION_SCHEMA;const _0x116f81=yaml[_0x5e80a5(0x184)](_0x11b13f,_0x14cc69);await _0x159889['mBpOK'](addTags,_0x116f81,_0x262853);const _0x30a2c0=JSON['stringify'](_0x116f81);let _0x811070=await AWSUtils['getOidcUrl'](_0x3d97b5);_0x811070=_0x811070[_0x5e80a5(0x16a)](_0x159889[_0x5e80a5(0x16c)])[0x1];const _0x4f711d={};_0x4f711d[_0x5e80a5(0x16d)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x3d97b5+_0x5e80a5(0x17d),_0x4f711d[_0x5e80a5(0x181)]=_0x159889[_0x5e80a5(0x188)],_0x4f711d[_0x5e80a5(0x176)]=_0x30a2c0,_0x4f711d['Parameters']=[{'ParameterKey':_0x159889[_0x5e80a5(0x197)],'ParameterValue':_0x4c7ee7},{'ParameterKey':_0x159889[_0x5e80a5(0x196)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x3d97b5},{'ParameterKey':_0x159889[_0x5e80a5(0x1a1)],'ParameterValue':_0x811070}],_0x4f711d[_0x5e80a5(0x17f)]=[_0x159889[_0x5e80a5(0x166)]],_0x4f711d[_0x5e80a5(0x183)]=_0x262853;const _0xc7f9fe=_0x4f711d,_0xc3e235=await _0x2d2ab7[_0x5e80a5(0x191)](_0xc7f9fe)[_0x5e80a5(0x178)]();logger[_0x5e80a5(0x169)](_0x159889[_0x5e80a5(0x17b)]);const _0x3e24ef={};return _0x3e24ef[_0x5e80a5(0x16d)]=_0xc3e235['StackId'],_0x2d2ab7['waitFor'](_0x159889[_0x5e80a5(0x18d)],_0x3e24ef)[_0x5e80a5(0x178)]();};