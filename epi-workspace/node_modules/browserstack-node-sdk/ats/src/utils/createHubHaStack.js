function a28_0x3711(_0x222d4f,_0x62d5d1){const _0x4e70ce=a28_0x4e70();return a28_0x3711=function(_0x371170,_0x6b7620){_0x371170=_0x371170-0x129;let _0x54b4fe=_0x4e70ce[_0x371170];return _0x54b4fe;},a28_0x3711(_0x222d4f,_0x62d5d1);}const a28_0x46d44a=a28_0x3711;(function(_0x1cd98f,_0x4d3a5f){const _0x3032d3=a28_0x3711,_0x38a635=_0x1cd98f();while(!![]){try{const _0x9bad08=parseInt(_0x3032d3(0x15c))/0x1+parseInt(_0x3032d3(0x145))/0x2+parseInt(_0x3032d3(0x13e))/0x3+parseInt(_0x3032d3(0x136))/0x4*(-parseInt(_0x3032d3(0x146))/0x5)+parseInt(_0x3032d3(0x134))/0x6*(-parseInt(_0x3032d3(0x15f))/0x7)+-parseInt(_0x3032d3(0x12f))/0x8+-parseInt(_0x3032d3(0x12a))/0x9*(-parseInt(_0x3032d3(0x130))/0xa);if(_0x9bad08===_0x4d3a5f)break;else _0x38a635['push'](_0x38a635['shift']());}catch(_0x45cf12){_0x38a635['push'](_0x38a635['shift']());}}}(a28_0x4e70,0xb3789));const fs=require('fs'),path=require('path'),Promise=require('bluebird'),yaml=require(a28_0x46d44a(0x160)),{CLOUDFORMATION_SCHEMA}=require(a28_0x46d44a(0x162)),AWS=require(a28_0x46d44a(0x14c))[a28_0x46d44a(0x137)],AWSUtils=require(a28_0x46d44a(0x14c)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require(a28_0x46d44a(0x13b));function a28_0x4e70(){const _0x5cce1a=['HATbM','CFTemplates','StackId','utf-8','browserstack:creationDate','BaseResourceName','1391996OsOCxL','25FyyLSI','Parameters','waitFor','createHubHaStack','reJzA','jmEYl','./AWSUtils','Tags','StackName','getOidcUrl','Resources','ClusterOIDCURL','TemplateBody','browserstack:cluster','info','Key','push','CAPABILITY_NAMED_IAM','TNiPU','gfLPw','yDoRo','load','1419121OyLVWf','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','EGWFZ','7SUQdlX','js-yaml','VpcId','js-yaml-cloudformation-schema','RnZbJ','split','stackCreateComplete','CloudFormation','Capabilities','9IvteJp','OnFailure','DELETE','promise','TqQeQ','8705504lkflvM','3089670UnSvlI','LYrFP','-cf','Value','7921572AftPjg','xokZi','458152HOueCB','awsObj','stringify','Yjrhc','schema','../config/logger','apiVersion','join','3876501jaxPmB'];a28_0x4e70=function(){return _0x5cce1a;};return a28_0x4e70();}Promise['promisifyAll'](fs);const addTags=async(_0x2f3f58,_0x54be2a)=>{const _0x3d3b0b=a28_0x46d44a;for(const _0x185a85 in _0x2f3f58[_0x3d3b0b(0x150)]){_0x2f3f58[_0x3d3b0b(0x150)][_0x185a85]['Properties']&&_0x2f3f58['Resources'][_0x185a85]['Properties'][_0x3d3b0b(0x14d)]&&_0x2f3f58[_0x3d3b0b(0x150)][_0x185a85]['Properties'][_0x3d3b0b(0x14d)][_0x3d3b0b(0x156)](..._0x54be2a);}};exports[a28_0x46d44a(0x149)]=async(_0xc57a3b,_0x42ed89=null)=>{const _0x1f79bf=a28_0x46d44a,_0x53802e={'reJzA':_0x1f79bf(0x153),'gfLPw':_0x1f79bf(0x143),'LYrFP':'2010-05-15','Ryfhh':_0x1f79bf(0x140),'deDgy':'hub-ha.yaml','Yjrhc':_0x1f79bf(0x142),'xHCVp':function(_0x1e19fa,_0x6950a8,_0x697b82){return _0x1e19fa(_0x6950a8,_0x697b82);},'HATbM':'://','jmEYl':_0x1f79bf(0x12c),'EGWFZ':_0x1f79bf(0x161),'yDoRo':_0x1f79bf(0x144),'TNiPU':_0x1f79bf(0x151),'xokZi':_0x1f79bf(0x157),'TqQeQ':_0x1f79bf(0x15d),'RnZbJ':_0x1f79bf(0x165)},_0x3e8ac1=COMMON_HST_TAGS,_0x4a1dde={};_0x4a1dde[_0x1f79bf(0x155)]=_0x53802e[_0x1f79bf(0x14a)],_0x4a1dde[_0x1f79bf(0x133)]=_0xc57a3b,_0x3e8ac1[_0x1f79bf(0x156)](_0x4a1dde),_0x3e8ac1[_0x1f79bf(0x156)]({'Key':_0x53802e[_0x1f79bf(0x159)],'Value':new Date()['valueOf']()['toString']()});const _0x39c7b5={};_0x39c7b5[_0x1f79bf(0x13c)]=_0x53802e[_0x1f79bf(0x131)];const _0x224738=new AWS[(_0x1f79bf(0x166))](_0x39c7b5),_0x5cea3f=await fs['readFileAsync'](path[_0x1f79bf(0x13d)](__dirname,'..',_0x53802e['Ryfhh'],_0x53802e['deDgy']),_0x53802e[_0x1f79bf(0x139)]),_0x26aeaf={};_0x26aeaf[_0x1f79bf(0x13a)]=CLOUDFORMATION_SCHEMA;const _0x31ffbf=yaml[_0x1f79bf(0x15b)](_0x5cea3f,_0x26aeaf);await _0x53802e['xHCVp'](addTags,_0x31ffbf,_0x3e8ac1);const _0x8e0e59=JSON[_0x1f79bf(0x138)](_0x31ffbf);let _0x26e405=await AWSUtils[_0x1f79bf(0x14f)](_0xc57a3b);_0x26e405=_0x26e405[_0x1f79bf(0x164)](_0x53802e[_0x1f79bf(0x13f)])[0x1];const _0x5ca99b={};_0x5ca99b[_0x1f79bf(0x14e)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0xc57a3b+_0x1f79bf(0x132),_0x5ca99b[_0x1f79bf(0x12b)]=_0x53802e[_0x1f79bf(0x14b)],_0x5ca99b[_0x1f79bf(0x152)]=_0x8e0e59,_0x5ca99b[_0x1f79bf(0x147)]=[{'ParameterKey':_0x53802e[_0x1f79bf(0x15e)],'ParameterValue':_0x42ed89},{'ParameterKey':_0x53802e[_0x1f79bf(0x15a)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0xc57a3b},{'ParameterKey':_0x53802e[_0x1f79bf(0x158)],'ParameterValue':_0x26e405}],_0x5ca99b[_0x1f79bf(0x129)]=[_0x53802e[_0x1f79bf(0x135)]],_0x5ca99b[_0x1f79bf(0x14d)]=_0x3e8ac1;const _0x333bdc=_0x5ca99b,_0xa1142a=await _0x224738['createStack'](_0x333bdc)[_0x1f79bf(0x12d)]();logger[_0x1f79bf(0x154)](_0x53802e[_0x1f79bf(0x12e)]);const _0x5a8352={};return _0x5a8352[_0x1f79bf(0x14e)]=_0xa1142a[_0x1f79bf(0x141)],_0x224738[_0x1f79bf(0x148)](_0x53802e[_0x1f79bf(0x163)],_0x5a8352)['promise']();};