const a28_0x13fac5=a28_0x4377;(function(_0x54fc34,_0x487b78){const _0x59b72b=a28_0x4377,_0x253f58=_0x54fc34();while(!![]){try{const _0x25888b=parseInt(_0x59b72b(0x71))/0x1+-parseInt(_0x59b72b(0x8e))/0x2*(parseInt(_0x59b72b(0x93))/0x3)+parseInt(_0x59b72b(0x6f))/0x4+parseInt(_0x59b72b(0x87))/0x5+-parseInt(_0x59b72b(0x95))/0x6+parseInt(_0x59b72b(0x7a))/0x7+-parseInt(_0x59b72b(0x9c))/0x8*(parseInt(_0x59b72b(0x72))/0x9);if(_0x25888b===_0x487b78)break;else _0x253f58['push'](_0x253f58['shift']());}catch(_0x200757){_0x253f58['push'](_0x253f58['shift']());}}}(a28_0xc36b,0x9cfba));const fs=require('fs'),path=require(a28_0x13fac5(0x8a)),Promise=require(a28_0x13fac5(0x82)),yaml=require(a28_0x13fac5(0x7d)),{CLOUDFORMATION_SCHEMA}=require(a28_0x13fac5(0x7b)),AWS=require(a28_0x13fac5(0x6b))[a28_0x13fac5(0x9d)],AWSUtils=require(a28_0x13fac5(0x6b)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require('../config/logger');Promise['promisifyAll'](fs);const addTags=async(_0x5a6f0c,_0x5e8498)=>{const _0x53ff32=a28_0x13fac5;for(const _0x3468c9 in _0x5a6f0c[_0x53ff32(0x97)]){_0x5a6f0c[_0x53ff32(0x97)][_0x3468c9]['Properties']&&_0x5a6f0c[_0x53ff32(0x97)][_0x3468c9][_0x53ff32(0x6e)][_0x53ff32(0x8b)]&&_0x5a6f0c[_0x53ff32(0x97)][_0x3468c9][_0x53ff32(0x6e)][_0x53ff32(0x8b)][_0x53ff32(0x79)](..._0x5e8498);}};function a28_0x4377(_0xa08bf,_0x1e915b){const _0xc36b1d=a28_0xc36b();return a28_0x4377=function(_0x43774c,_0x4edfaf){_0x43774c=_0x43774c-0x67;let _0x483e96=_0xc36b1d[_0x43774c];return _0x483e96;},a28_0x4377(_0xa08bf,_0x1e915b);}function a28_0xc36b(){const _0x1d3e24=['hub-ha.yaml','ClusterOIDCURL','valueOf','202677tmYekP','OnFailure','3358746AyxkVT','CFTemplates','Resources','sylZs','promise','BaseResourceName','hVpdq','254696tFbFuf','awsObj','hsOhD','Key','load','VjMuY','createHubHaStack','DELETE','browserstack:creationDate','dAEJx','://','./AWSUtils','join','wGGws','Properties','4878988CuhtnJ','VpcId','153565dpUUOZ','567PjSMId','info','createStack','StackName','browserstack:cluster','waitFor','gJuNI','push','7734622iALOcl','js-yaml-cloudformation-schema','AkUva','js-yaml','utf-8','CAPABILITY_NAMED_IAM','TemplateBody','2010-05-15','bluebird','apiVersion','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','Capabilities','stringify','5340305vIWgLU','xKYqv','readFileAsync','path','Tags','Parameters','BqoQQ','10ojsdrd','-cf'];a28_0xc36b=function(){return _0x1d3e24;};return a28_0xc36b();}exports[a28_0x13fac5(0xa2)]=async(_0x1fdd78,_0x1f0050=null)=>{const _0x1ccf36=a28_0x13fac5,_0x4ed02b={'sylZs':_0x1ccf36(0x76),'ybWLN':_0x1ccf36(0x68),'wGGws':_0x1ccf36(0x81),'gJuNI':_0x1ccf36(0x96),'hVpdq':_0x1ccf36(0x90),'AkUva':_0x1ccf36(0x7e),'AZQcE':function(_0x3bd2be,_0x4501c3,_0x19a69d){return _0x3bd2be(_0x4501c3,_0x19a69d);},'dAEJx':_0x1ccf36(0x6a),'BqoQQ':_0x1ccf36(0x67),'eopiX':_0x1ccf36(0x70),'GTgUa':_0x1ccf36(0x9a),'hsOhD':_0x1ccf36(0x91),'xKYqv':_0x1ccf36(0x7f),'VjMuY':_0x1ccf36(0x84),'dShco':'stackCreateComplete'},_0x1da996=COMMON_HST_TAGS,_0x5ab0a5={};_0x5ab0a5[_0x1ccf36(0x9f)]=_0x4ed02b[_0x1ccf36(0x98)],_0x5ab0a5['Value']=_0x1fdd78,_0x1da996[_0x1ccf36(0x79)](_0x5ab0a5),_0x1da996[_0x1ccf36(0x79)]({'Key':_0x4ed02b['ybWLN'],'Value':new Date()[_0x1ccf36(0x92)]()['toString']()});const _0x286074={};_0x286074[_0x1ccf36(0x83)]=_0x4ed02b[_0x1ccf36(0x6d)];const _0xab8b96=new AWS['CloudFormation'](_0x286074),_0x3eb477=await fs[_0x1ccf36(0x89)](path[_0x1ccf36(0x6c)](__dirname,'..',_0x4ed02b[_0x1ccf36(0x78)],_0x4ed02b[_0x1ccf36(0x9b)]),_0x4ed02b[_0x1ccf36(0x7c)]),_0xebecef={};_0xebecef['schema']=CLOUDFORMATION_SCHEMA;const _0x2612b5=yaml[_0x1ccf36(0xa0)](_0x3eb477,_0xebecef);await _0x4ed02b['AZQcE'](addTags,_0x2612b5,_0x1da996);const _0x5d9f9e=JSON[_0x1ccf36(0x86)](_0x2612b5);let _0x297824=await AWSUtils['getOidcUrl'](_0x1fdd78);_0x297824=_0x297824['split'](_0x4ed02b[_0x1ccf36(0x69)])[0x1];const _0x4c5930={};_0x4c5930[_0x1ccf36(0x75)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x1fdd78+_0x1ccf36(0x8f),_0x4c5930[_0x1ccf36(0x94)]=_0x4ed02b[_0x1ccf36(0x8d)],_0x4c5930[_0x1ccf36(0x80)]=_0x5d9f9e,_0x4c5930[_0x1ccf36(0x8c)]=[{'ParameterKey':_0x4ed02b['eopiX'],'ParameterValue':_0x1f0050},{'ParameterKey':_0x4ed02b['GTgUa'],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x1fdd78},{'ParameterKey':_0x4ed02b[_0x1ccf36(0x9e)],'ParameterValue':_0x297824}],_0x4c5930[_0x1ccf36(0x85)]=[_0x4ed02b[_0x1ccf36(0x88)]],_0x4c5930[_0x1ccf36(0x8b)]=_0x1da996;const _0x166d15=_0x4c5930,_0x371af8=await _0xab8b96[_0x1ccf36(0x74)](_0x166d15)[_0x1ccf36(0x99)]();logger[_0x1ccf36(0x73)](_0x4ed02b[_0x1ccf36(0xa1)]);const _0x55bf33={};return _0x55bf33['StackName']=_0x371af8['StackId'],_0xab8b96[_0x1ccf36(0x77)](_0x4ed02b['dShco'],_0x55bf33)[_0x1ccf36(0x99)]();};