const a28_0x2f6fb9=a28_0x22de;(function(_0x1b9fb4,_0x2dea83){const _0x2ec6cb=a28_0x22de,_0x338fce=_0x1b9fb4();while(!![]){try{const _0x571410=-parseInt(_0x2ec6cb(0xd8))/0x1*(parseInt(_0x2ec6cb(0xdf))/0x2)+-parseInt(_0x2ec6cb(0xd6))/0x3*(parseInt(_0x2ec6cb(0xe0))/0x4)+parseInt(_0x2ec6cb(0xdb))/0x5*(-parseInt(_0x2ec6cb(0xcf))/0x6)+parseInt(_0x2ec6cb(0xf7))/0x7*(parseInt(_0x2ec6cb(0xce))/0x8)+-parseInt(_0x2ec6cb(0xe2))/0x9+-parseInt(_0x2ec6cb(0xe1))/0xa*(parseInt(_0x2ec6cb(0xea))/0xb)+parseInt(_0x2ec6cb(0xf9))/0xc*(parseInt(_0x2ec6cb(0xd7))/0xd);if(_0x571410===_0x2dea83)break;else _0x338fce['push'](_0x338fce['shift']());}catch(_0x487930){_0x338fce['push'](_0x338fce['shift']());}}}(a28_0x6349,0x21a5a));const fs=require('fs'),path=require('path'),Promise=require(a28_0x2f6fb9(0xe3)),yaml=require('js-yaml'),{CLOUDFORMATION_SCHEMA}=require(a28_0x2f6fb9(0xe5)),AWS=require(a28_0x2f6fb9(0xfc))[a28_0x2f6fb9(0xfd)],AWSUtils=require(a28_0x2f6fb9(0xfc)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x2f6fb9(0xe7)),{logger}=require('../config/logger');function a28_0x6349(){const _0x1954f3=['HFIxB','kVDWT','10VIKccB','664vkBGMG','10EsHdJm','1226178aoVvyM','bluebird','-cf','js-yaml-cloudformation-schema','kwyfp','../config/constants','join','load','2303983IPilfD','ZCDfn','CAPABILITY_NAMED_IAM','split','lEaAx','getOidcUrl','schema','Tags','toString','://','PhaAo','2010-05-15','Rnaia','41769iZDgty','CloudFormation','4389936Axezgl','esxdJ','MxDSv','./AWSUtils','awsObj','Resources','Value','Capabilities','DELETE','MzJbY','createHubHaStack','Key','StackName','valueOf','hub-ha.yaml','stackCreateComplete','push','VpcId','CFTemplates','TemplateBody','stringify','promise','UBYGN','Parameters','pLONV','32NBBFxS','6KcOyos','WqTqs','ClusterOIDCURL','promisifyAll','waitFor','QESuR','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','2571IXJoSb','39XXrXXd','44614KyRmMK','apiVersion','Properties','1362535SGngpK','createStack'];a28_0x6349=function(){return _0x1954f3;};return a28_0x6349();}Promise[a28_0x2f6fb9(0xd2)](fs);function a28_0x22de(_0x2198ec,_0x5588f4){const _0x6349c2=a28_0x6349();return a28_0x22de=function(_0x22de1e,_0x5e641d){_0x22de1e=_0x22de1e-0xc2;let _0x4693a0=_0x6349c2[_0x22de1e];return _0x4693a0;},a28_0x22de(_0x2198ec,_0x5588f4);}const addTags=async(_0x4e01f9,_0xac41d5)=>{const _0x2a7d12=a28_0x2f6fb9;for(const _0x10c613 in _0x4e01f9['Resources']){_0x4e01f9[_0x2a7d12(0xfe)][_0x10c613][_0x2a7d12(0xda)]&&_0x4e01f9[_0x2a7d12(0xfe)][_0x10c613][_0x2a7d12(0xda)][_0x2a7d12(0xf1)]&&_0x4e01f9[_0x2a7d12(0xfe)][_0x10c613][_0x2a7d12(0xda)][_0x2a7d12(0xf1)][_0x2a7d12(0xc5)](..._0xac41d5);}};exports[a28_0x2f6fb9(0x103)]=async(_0x17a7de,_0x477b85=null)=>{const _0x51a496=a28_0x2f6fb9,_0x5f4ecc={'UBYGN':'browserstack:cluster','MzJbY':'browserstack:creationDate','wzPEM':_0x51a496(0xf5),'PhaAo':_0x51a496(0xc7),'MxDSv':_0x51a496(0xc3),'ZCDfn':'utf-8','esxdJ':function(_0x3a696c,_0x580875,_0x459f6c){return _0x3a696c(_0x580875,_0x459f6c);},'WqTqs':_0x51a496(0xf3),'QESuR':_0x51a496(0x101),'pLONV':_0x51a496(0xc6),'lEaAx':'BaseResourceName','HFIxB':_0x51a496(0xd1),'kVDWT':_0x51a496(0xec),'Rnaia':_0x51a496(0xd5),'kwyfp':_0x51a496(0xc4)},_0x5e3771=COMMON_HST_TAGS,_0x4f859b={};_0x4f859b[_0x51a496(0x104)]=_0x5f4ecc[_0x51a496(0xcb)],_0x4f859b[_0x51a496(0xff)]=_0x17a7de,_0x5e3771[_0x51a496(0xc5)](_0x4f859b),_0x5e3771[_0x51a496(0xc5)]({'Key':_0x5f4ecc[_0x51a496(0x102)],'Value':new Date()[_0x51a496(0xc2)]()[_0x51a496(0xf2)]()});const _0x3c9a04={};_0x3c9a04[_0x51a496(0xd9)]=_0x5f4ecc['wzPEM'];const _0x101919=new AWS[(_0x51a496(0xf8))](_0x3c9a04),_0x335842=await fs['readFileAsync'](path[_0x51a496(0xe8)](__dirname,'..',_0x5f4ecc[_0x51a496(0xf4)],_0x5f4ecc[_0x51a496(0xfb)]),_0x5f4ecc[_0x51a496(0xeb)]),_0x510712={};_0x510712[_0x51a496(0xf0)]=CLOUDFORMATION_SCHEMA;const _0x5c0cab=yaml[_0x51a496(0xe9)](_0x335842,_0x510712);await _0x5f4ecc[_0x51a496(0xfa)](addTags,_0x5c0cab,_0x5e3771);const _0x1f17f0=JSON[_0x51a496(0xc9)](_0x5c0cab);let _0x487cc1=await AWSUtils[_0x51a496(0xef)](_0x17a7de);_0x487cc1=_0x487cc1[_0x51a496(0xed)](_0x5f4ecc[_0x51a496(0xd0)])[0x1];const _0x40a575={};_0x40a575['StackName']=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x17a7de+_0x51a496(0xe4),_0x40a575['OnFailure']=_0x5f4ecc[_0x51a496(0xd4)],_0x40a575[_0x51a496(0xc8)]=_0x1f17f0,_0x40a575[_0x51a496(0xcc)]=[{'ParameterKey':_0x5f4ecc[_0x51a496(0xcd)],'ParameterValue':_0x477b85},{'ParameterKey':_0x5f4ecc[_0x51a496(0xee)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x17a7de},{'ParameterKey':_0x5f4ecc[_0x51a496(0xdd)],'ParameterValue':_0x487cc1}],_0x40a575[_0x51a496(0x100)]=[_0x5f4ecc[_0x51a496(0xde)]],_0x40a575[_0x51a496(0xf1)]=_0x5e3771;const _0x57a668=_0x40a575,_0x1db4ae=await _0x101919[_0x51a496(0xdc)](_0x57a668)[_0x51a496(0xca)]();logger['info'](_0x5f4ecc[_0x51a496(0xf6)]);const _0x40c728={};return _0x40c728[_0x51a496(0x105)]=_0x1db4ae['StackId'],_0x101919[_0x51a496(0xd3)](_0x5f4ecc[_0x51a496(0xe6)],_0x40c728)[_0x51a496(0xca)]();};