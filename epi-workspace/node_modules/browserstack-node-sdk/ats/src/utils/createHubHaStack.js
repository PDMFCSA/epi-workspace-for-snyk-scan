const a28_0x59bee5=a28_0x5f2b;(function(_0x4b756d,_0x3b9ead){const _0x2f4863=a28_0x5f2b,_0x246ebb=_0x4b756d();while(!![]){try{const _0x51d489=parseInt(_0x2f4863(0xf3))/0x1+-parseInt(_0x2f4863(0xf1))/0x2*(-parseInt(_0x2f4863(0xea))/0x3)+parseInt(_0x2f4863(0xfb))/0x4+-parseInt(_0x2f4863(0xd4))/0x5*(parseInt(_0x2f4863(0xf9))/0x6)+parseInt(_0x2f4863(0xec))/0x7+parseInt(_0x2f4863(0xef))/0x8*(-parseInt(_0x2f4863(0xfc))/0x9)+-parseInt(_0x2f4863(0xd5))/0xa;if(_0x51d489===_0x3b9ead)break;else _0x246ebb['push'](_0x246ebb['shift']());}catch(_0x7cf0f0){_0x246ebb['push'](_0x246ebb['shift']());}}}(a28_0x30f4,0xd4b67));const fs=require('fs'),path=require(a28_0x59bee5(0xf5)),Promise=require(a28_0x59bee5(0xde)),yaml=require('js-yaml'),{CLOUDFORMATION_SCHEMA}=require('js-yaml-cloudformation-schema'),AWS=require(a28_0x59bee5(0xd8))['awsObj'],AWSUtils=require(a28_0x59bee5(0xd8)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x59bee5(0xe6)),{logger}=require(a28_0x59bee5(0xf2));Promise[a28_0x59bee5(0xfa)](fs);function a28_0x5f2b(_0xd8dfe3,_0x52922f){const _0x30f43b=a28_0x30f4();return a28_0x5f2b=function(_0x5f2bdc,_0x3c757a){_0x5f2bdc=_0x5f2bdc-0xd3;let _0xfe73e0=_0x30f43b[_0x5f2bdc];return _0xfe73e0;},a28_0x5f2b(_0xd8dfe3,_0x52922f);}function a28_0x30f4(){const _0x4cb7a5=['valueOf','LLaDS','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','Tags','readFileAsync','stackCreateComplete','://','685195GIejyC','24292170VPlGWT','dkGkU','Key','./AWSUtils','utf-8','getOidcUrl','ApEvg','cBUDD','Value','bluebird','2010-05-15','CloudFormation','info','vGybZ','stringify','VpcId','Resources','../config/constants','Properties','StackId','browserstack:creationDate','1050843MnKJxa','promise','9755683GypQwR','toString','TemplateBody','2928HYMBNn','GBJQq','4VNjWBQ','../config/logger','1504619gOpdeM','apiVersion','path','ClusterOIDCURL','join','StackName','24bWptGC','promisifyAll','4686992BbvIEY','22671WgpWsh','hub-ha.yaml','TsNtu','push','browserstack:cluster','DELETE','split','gCAET','CFTemplates','bGucd','load','OnFailure'];a28_0x30f4=function(){return _0x4cb7a5;};return a28_0x30f4();}const addTags=async(_0x582853,_0x1fcfa4)=>{const _0x596495=a28_0x59bee5;for(const _0xa08a77 in _0x582853[_0x596495(0xe5)]){_0x582853['Resources'][_0xa08a77][_0x596495(0xe7)]&&_0x582853[_0x596495(0xe5)][_0xa08a77][_0x596495(0xe7)][_0x596495(0x10b)]&&_0x582853[_0x596495(0xe5)][_0xa08a77][_0x596495(0xe7)][_0x596495(0x10b)][_0x596495(0xff)](..._0x1fcfa4);}};exports['createHubHaStack']=async(_0x31f77b,_0x1162c5=null)=>{const _0x166d00=a28_0x59bee5,_0x2a5004={'EslBd':_0x166d00(0x100),'dkGkU':_0x166d00(0xe9),'ApEvg':_0x166d00(0xdf),'cBUDD':_0x166d00(0x104),'TsNtu':_0x166d00(0xfd),'ulYBQ':_0x166d00(0xd9),'gCAET':function(_0x2c39a5,_0x371c1b,_0x4cc56a){return _0x2c39a5(_0x371c1b,_0x4cc56a);},'GBJQq':_0x166d00(0xd3),'vGybZ':_0x166d00(0x101),'BRxmA':_0x166d00(0xe4),'AkVHt':'BaseResourceName','ddarh':_0x166d00(0xf6),'LLaDS':'CAPABILITY_NAMED_IAM','siYWf':_0x166d00(0x10a),'bGucd':_0x166d00(0x10d)},_0x255035=COMMON_HST_TAGS,_0x4769d3={};_0x4769d3[_0x166d00(0xd7)]=_0x2a5004['EslBd'],_0x4769d3[_0x166d00(0xdd)]=_0x31f77b,_0x255035[_0x166d00(0xff)](_0x4769d3),_0x255035[_0x166d00(0xff)]({'Key':_0x2a5004[_0x166d00(0xd6)],'Value':new Date()[_0x166d00(0x108)]()[_0x166d00(0xed)]()});const _0x184f45={};_0x184f45[_0x166d00(0xf4)]=_0x2a5004[_0x166d00(0xdb)];const _0x3e4a63=new AWS[(_0x166d00(0xe0))](_0x184f45),_0xfa9a95=await fs[_0x166d00(0x10c)](path[_0x166d00(0xf7)](__dirname,'..',_0x2a5004[_0x166d00(0xdc)],_0x2a5004[_0x166d00(0xfe)]),_0x2a5004['ulYBQ']),_0x17f136={};_0x17f136['schema']=CLOUDFORMATION_SCHEMA;const _0x510aab=yaml[_0x166d00(0x106)](_0xfa9a95,_0x17f136);await _0x2a5004[_0x166d00(0x103)](addTags,_0x510aab,_0x255035);const _0x3a1652=JSON[_0x166d00(0xe3)](_0x510aab);let _0x1e39d9=await AWSUtils[_0x166d00(0xda)](_0x31f77b);_0x1e39d9=_0x1e39d9[_0x166d00(0x102)](_0x2a5004[_0x166d00(0xf0)])[0x1];const _0xf2dc7d={};_0xf2dc7d[_0x166d00(0xf8)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x31f77b+'-cf',_0xf2dc7d[_0x166d00(0x107)]=_0x2a5004[_0x166d00(0xe2)],_0xf2dc7d[_0x166d00(0xee)]=_0x3a1652,_0xf2dc7d['Parameters']=[{'ParameterKey':_0x2a5004['BRxmA'],'ParameterValue':_0x1162c5},{'ParameterKey':_0x2a5004['AkVHt'],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x31f77b},{'ParameterKey':_0x2a5004['ddarh'],'ParameterValue':_0x1e39d9}],_0xf2dc7d['Capabilities']=[_0x2a5004[_0x166d00(0x109)]],_0xf2dc7d[_0x166d00(0x10b)]=_0x255035;const _0x165de2=_0xf2dc7d,_0xe85889=await _0x3e4a63['createStack'](_0x165de2)[_0x166d00(0xeb)]();logger[_0x166d00(0xe1)](_0x2a5004['siYWf']);const _0x4b0cd4={};return _0x4b0cd4[_0x166d00(0xf8)]=_0xe85889[_0x166d00(0xe8)],_0x3e4a63['waitFor'](_0x2a5004[_0x166d00(0x105)],_0x4b0cd4)['promise']();};