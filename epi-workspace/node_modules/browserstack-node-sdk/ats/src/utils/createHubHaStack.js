const a28_0x4e486c=a28_0x585a;(function(_0x39c142,_0x404592){const _0x55fd5b=a28_0x585a,_0x215d4d=_0x39c142();while(!![]){try{const _0x1c7f8d=parseInt(_0x55fd5b(0x117))/0x1*(-parseInt(_0x55fd5b(0xfc))/0x2)+-parseInt(_0x55fd5b(0x122))/0x3+parseInt(_0x55fd5b(0x101))/0x4+parseInt(_0x55fd5b(0x10f))/0x5+-parseInt(_0x55fd5b(0x11e))/0x6+-parseInt(_0x55fd5b(0x111))/0x7*(parseInt(_0x55fd5b(0x108))/0x8)+parseInt(_0x55fd5b(0x123))/0x9*(parseInt(_0x55fd5b(0x10c))/0xa);if(_0x1c7f8d===_0x404592)break;else _0x215d4d['push'](_0x215d4d['shift']());}catch(_0xc9209f){_0x215d4d['push'](_0x215d4d['shift']());}}}(a28_0x1160,0x71cf7));const fs=require('fs'),path=require('path'),Promise=require(a28_0x4e486c(0x105)),yaml=require(a28_0x4e486c(0x12d)),{CLOUDFORMATION_SCHEMA}=require('js-yaml-cloudformation-schema'),AWS=require(a28_0x4e486c(0xf7))[a28_0x4e486c(0xf8)],AWSUtils=require(a28_0x4e486c(0xf7)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x4e486c(0x127)),{logger}=require('../config/logger');function a28_0x585a(_0x82b27f,_0x8f405e){const _0x11602e=a28_0x1160();return a28_0x585a=function(_0x585ac1,_0x44aa33){_0x585ac1=_0x585ac1-0xf4;let _0x27428a=_0x11602e[_0x585ac1];return _0x27428a;},a28_0x585a(_0x82b27f,_0x8f405e);}function a28_0x1160(){const _0x5b0ad7=['Resources','PjIeM','rhVbt','./AWSUtils','awsObj','toString','waitFor','CFTemplates','2dqdosK','Properties','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','DELETE','BaseResourceName','2992636SlcQzG','load','VpcId','push','bluebird','lMxtZ','promise','8UrxBqH','schema','-cf','2010-05-15','10VnSiZp','join','EaYIQ','1367635EItiTh','Parameters','5916197rIltXs','://','DgJpA','cAPvd','readFileAsync','promisifyAll','248161QINQLM','stringify','loJCl','Tags','YgCgg','StackId','valueOf','4528218uDxWMY','StackName','createHubHaStack','hub-ha.yaml','1528059VBhQiT','16216821fxDkZC','split','ClusterOIDCURL','CloudFormation','../config/constants','lfqnZ','VzWDd','YrXoC','stackCreateComplete','browserstack:cluster','js-yaml','getOidcUrl','apiVersion','createStack','TemplateBody','OnFailure','IfcsA'];a28_0x1160=function(){return _0x5b0ad7;};return a28_0x1160();}Promise[a28_0x4e486c(0x116)](fs);const addTags=async(_0x414c8e,_0x3ed9f3)=>{const _0xfef6d6=a28_0x4e486c;for(const _0x2f5131 in _0x414c8e['Resources']){_0x414c8e['Resources'][_0x2f5131]['Properties']&&_0x414c8e[_0xfef6d6(0xf4)][_0x2f5131][_0xfef6d6(0xfd)][_0xfef6d6(0x11a)]&&_0x414c8e[_0xfef6d6(0xf4)][_0x2f5131]['Properties'][_0xfef6d6(0x11a)][_0xfef6d6(0x104)](..._0x3ed9f3);}};exports[a28_0x4e486c(0x120)]=async(_0x3458ca,_0x4f1cc8=null)=>{const _0x77382f=a28_0x4e486c,_0x54c552={'YgCgg':_0x77382f(0x12c),'VzWDd':'browserstack:creationDate','qUqoy':_0x77382f(0x10b),'rhVbt':_0x77382f(0xfb),'loJCl':_0x77382f(0x121),'lfqnZ':'utf-8','rRqqq':function(_0x245db4,_0x4853d7,_0x50fff7){return _0x245db4(_0x4853d7,_0x50fff7);},'DgJpA':_0x77382f(0x112),'eYvfd':_0x77382f(0xff),'PjIeM':_0x77382f(0x103),'YrXoC':_0x77382f(0x100),'cAPvd':_0x77382f(0x125),'lMxtZ':'CAPABILITY_NAMED_IAM','IfcsA':_0x77382f(0xfe),'EaYIQ':_0x77382f(0x12b)},_0x648b3=COMMON_HST_TAGS,_0xfc15a5={};_0xfc15a5['Key']=_0x54c552[_0x77382f(0x11b)],_0xfc15a5['Value']=_0x3458ca,_0x648b3[_0x77382f(0x104)](_0xfc15a5),_0x648b3[_0x77382f(0x104)]({'Key':_0x54c552[_0x77382f(0x129)],'Value':new Date()[_0x77382f(0x11d)]()[_0x77382f(0xf9)]()});const _0x28e4b2={};_0x28e4b2[_0x77382f(0x12f)]=_0x54c552['qUqoy'];const _0x345df6=new AWS[(_0x77382f(0x126))](_0x28e4b2),_0x569ab5=await fs[_0x77382f(0x115)](path[_0x77382f(0x10d)](__dirname,'..',_0x54c552[_0x77382f(0xf6)],_0x54c552[_0x77382f(0x119)]),_0x54c552[_0x77382f(0x128)]),_0x48a1be={};_0x48a1be[_0x77382f(0x109)]=CLOUDFORMATION_SCHEMA;const _0x379804=yaml[_0x77382f(0x102)](_0x569ab5,_0x48a1be);await _0x54c552['rRqqq'](addTags,_0x379804,_0x648b3);const _0x399df0=JSON[_0x77382f(0x118)](_0x379804);let _0x365913=await AWSUtils[_0x77382f(0x12e)](_0x3458ca);_0x365913=_0x365913[_0x77382f(0x124)](_0x54c552[_0x77382f(0x113)])[0x1];const _0x1237f6={};_0x1237f6[_0x77382f(0x11f)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x3458ca+_0x77382f(0x10a),_0x1237f6[_0x77382f(0x132)]=_0x54c552['eYvfd'],_0x1237f6[_0x77382f(0x131)]=_0x399df0,_0x1237f6[_0x77382f(0x110)]=[{'ParameterKey':_0x54c552[_0x77382f(0xf5)],'ParameterValue':_0x4f1cc8},{'ParameterKey':_0x54c552[_0x77382f(0x12a)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x3458ca},{'ParameterKey':_0x54c552[_0x77382f(0x114)],'ParameterValue':_0x365913}],_0x1237f6['Capabilities']=[_0x54c552[_0x77382f(0x106)]],_0x1237f6[_0x77382f(0x11a)]=_0x648b3;const _0x185d97=_0x1237f6,_0x242ffe=await _0x345df6[_0x77382f(0x130)](_0x185d97)[_0x77382f(0x107)]();logger['info'](_0x54c552[_0x77382f(0x133)]);const _0x545676={};return _0x545676[_0x77382f(0x11f)]=_0x242ffe[_0x77382f(0x11c)],_0x345df6[_0x77382f(0xfa)](_0x54c552[_0x77382f(0x10e)],_0x545676)[_0x77382f(0x107)]();};