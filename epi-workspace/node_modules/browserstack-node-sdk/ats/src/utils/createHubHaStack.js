const a28_0x526153=a28_0x1ef7;(function(_0x253c35,_0x49b788){const _0x32a86b=a28_0x1ef7,_0xb2fd43=_0x253c35();while(!![]){try{const _0x490935=-parseInt(_0x32a86b(0x1da))/0x1*(parseInt(_0x32a86b(0x1db))/0x2)+-parseInt(_0x32a86b(0x1d7))/0x3+parseInt(_0x32a86b(0x1c2))/0x4*(-parseInt(_0x32a86b(0x1f1))/0x5)+parseInt(_0x32a86b(0x1e0))/0x6+parseInt(_0x32a86b(0x1cd))/0x7*(parseInt(_0x32a86b(0x1e2))/0x8)+-parseInt(_0x32a86b(0x1ed))/0x9+parseInt(_0x32a86b(0x1f5))/0xa;if(_0x490935===_0x49b788)break;else _0xb2fd43['push'](_0xb2fd43['shift']());}catch(_0x17594d){_0xb2fd43['push'](_0xb2fd43['shift']());}}}(a28_0x4e0f,0xe84b8));const fs=require('fs'),path=require('path'),Promise=require('bluebird'),yaml=require(a28_0x526153(0x1d9)),{CLOUDFORMATION_SCHEMA}=require(a28_0x526153(0x1d3)),AWS=require('./AWSUtils')[a28_0x526153(0x1f6)],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x526153(0x1be)),{logger}=require('../config/logger');function a28_0x1ef7(_0x1c0f9d,_0x29d523){const _0x4e0f81=a28_0x4e0f();return a28_0x1ef7=function(_0x1ef773,_0x136e8b){_0x1ef773=_0x1ef773-0x1be;let _0x1c9317=_0x4e0f81[_0x1ef773];return _0x1c9317;},a28_0x1ef7(_0x1c0f9d,_0x29d523);}Promise[a28_0x526153(0x1e9)](fs);const addTags=async(_0x37c70f,_0x32115d)=>{const _0x2405aa=a28_0x526153;for(const _0x2e1647 in _0x37c70f[_0x2405aa(0x1e5)]){_0x37c70f[_0x2405aa(0x1e5)][_0x2e1647][_0x2405aa(0x1ef)]&&_0x37c70f['Resources'][_0x2e1647][_0x2405aa(0x1ef)][_0x2405aa(0x1c4)]&&_0x37c70f[_0x2405aa(0x1e5)][_0x2e1647][_0x2405aa(0x1ef)][_0x2405aa(0x1c4)][_0x2405aa(0x1e8)](..._0x32115d);}};function a28_0x4e0f(){const _0x16f18a=['js-yaml-cloudformation-schema','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','ttcQX','OUUKn','2936604jwHniT','stringify','js-yaml','1748339TjhGlB','2ytCkVi','promise','tOWFC','Value','rgNem','1527684xTdqOS','info','589056XsvCNA','load','Key','Resources','stackCreateComplete','nKUhs','push','promisifyAll','toString','BaseResourceName','apiVersion','5427783rwhzqM','TemplateBody','Properties','hloxy','35wbQVPX','psbPO','valueOf','readFileAsync','43328990mRNpSR','awsObj','../config/constants','UUTDa','schema','split','469236HvVJtr','browserstack:cluster','Tags','OnFailure','CFTemplates','WYrkY','utf-8','createStack','lBeBd','ClusterOIDCURL','PcYkd','49dxYcvv','hub-ha.yaml','createHubHaStack','DELETE','StackId','ikxKE'];a28_0x4e0f=function(){return _0x16f18a;};return a28_0x4e0f();}exports[a28_0x526153(0x1cf)]=async(_0xc838de,_0x176685=null)=>{const _0x207e1c=a28_0x526153,_0x1a4979={'psbPO':_0x207e1c(0x1c3),'OUUKn':'browserstack:creationDate','hloxy':'2010-05-15','YWkxw':_0x207e1c(0x1c6),'nKUhs':_0x207e1c(0x1ce),'ikxKE':_0x207e1c(0x1c8),'rgNem':function(_0x2fc8b6,_0x573633,_0x34f063){return _0x2fc8b6(_0x573633,_0x34f063);},'UUTDa':'://','WYrkY':_0x207e1c(0x1d0),'ttcQX':'VpcId','lBeBd':_0x207e1c(0x1eb),'PcYkd':_0x207e1c(0x1cb),'Xmzlo':'CAPABILITY_NAMED_IAM','tOWFC':_0x207e1c(0x1d4),'JMgxO':_0x207e1c(0x1e6)},_0x48ad81=COMMON_HST_TAGS,_0x5d56bf={};_0x5d56bf[_0x207e1c(0x1e4)]=_0x1a4979[_0x207e1c(0x1f2)],_0x5d56bf[_0x207e1c(0x1de)]=_0xc838de,_0x48ad81['push'](_0x5d56bf),_0x48ad81[_0x207e1c(0x1e8)]({'Key':_0x1a4979[_0x207e1c(0x1d6)],'Value':new Date()[_0x207e1c(0x1f3)]()[_0x207e1c(0x1ea)]()});const _0x536fe2={};_0x536fe2[_0x207e1c(0x1ec)]=_0x1a4979[_0x207e1c(0x1f0)];const _0x25641a=new AWS['CloudFormation'](_0x536fe2),_0x15b41e=await fs[_0x207e1c(0x1f4)](path['join'](__dirname,'..',_0x1a4979['YWkxw'],_0x1a4979[_0x207e1c(0x1e7)]),_0x1a4979[_0x207e1c(0x1d2)]),_0x19b322={};_0x19b322[_0x207e1c(0x1c0)]=CLOUDFORMATION_SCHEMA;const _0x113363=yaml[_0x207e1c(0x1e3)](_0x15b41e,_0x19b322);await _0x1a4979[_0x207e1c(0x1df)](addTags,_0x113363,_0x48ad81);const _0x2b3ae6=JSON[_0x207e1c(0x1d8)](_0x113363);let _0x35d1c4=await AWSUtils['getOidcUrl'](_0xc838de);_0x35d1c4=_0x35d1c4[_0x207e1c(0x1c1)](_0x1a4979[_0x207e1c(0x1bf)])[0x1];const _0x37d651={};_0x37d651['StackName']=CLUSTER_HUB_HA_STACK_NAME+'-'+_0xc838de+'-cf',_0x37d651[_0x207e1c(0x1c5)]=_0x1a4979[_0x207e1c(0x1c7)],_0x37d651[_0x207e1c(0x1ee)]=_0x2b3ae6,_0x37d651['Parameters']=[{'ParameterKey':_0x1a4979[_0x207e1c(0x1d5)],'ParameterValue':_0x176685},{'ParameterKey':_0x1a4979[_0x207e1c(0x1ca)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0xc838de},{'ParameterKey':_0x1a4979[_0x207e1c(0x1cc)],'ParameterValue':_0x35d1c4}],_0x37d651['Capabilities']=[_0x1a4979['Xmzlo']],_0x37d651[_0x207e1c(0x1c4)]=_0x48ad81;const _0x12f90c=_0x37d651,_0x13c69b=await _0x25641a[_0x207e1c(0x1c9)](_0x12f90c)[_0x207e1c(0x1dc)]();logger[_0x207e1c(0x1e1)](_0x1a4979[_0x207e1c(0x1dd)]);const _0x41cc69={};return _0x41cc69['StackName']=_0x13c69b[_0x207e1c(0x1d1)],_0x25641a['waitFor'](_0x1a4979['JMgxO'],_0x41cc69)[_0x207e1c(0x1dc)]();};