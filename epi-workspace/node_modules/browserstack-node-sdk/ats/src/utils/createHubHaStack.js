const a28_0x399f03=a28_0x48d3;(function(_0x18890f,_0x32b7ef){const _0x5eb185=a28_0x48d3,_0xb2d226=_0x18890f();while(!![]){try{const _0x4fd62f=-parseInt(_0x5eb185(0xe9))/0x1*(parseInt(_0x5eb185(0xcd))/0x2)+-parseInt(_0x5eb185(0xee))/0x3+parseInt(_0x5eb185(0xe0))/0x4+parseInt(_0x5eb185(0xd2))/0x5*(-parseInt(_0x5eb185(0xda))/0x6)+parseInt(_0x5eb185(0xe5))/0x7*(parseInt(_0x5eb185(0xc3))/0x8)+parseInt(_0x5eb185(0xdb))/0x9+parseInt(_0x5eb185(0xbc))/0xa;if(_0x4fd62f===_0x32b7ef)break;else _0xb2d226['push'](_0xb2d226['shift']());}catch(_0x4daba8){_0xb2d226['push'](_0xb2d226['shift']());}}}(a28_0xdd24,0x973e2));const fs=require('fs'),path=require(a28_0x399f03(0xca)),Promise=require('bluebird'),yaml=require('js-yaml'),{CLOUDFORMATION_SCHEMA}=require(a28_0x399f03(0xd0)),AWS=require(a28_0x399f03(0xd7))['awsObj'],AWSUtils=require(a28_0x399f03(0xd7)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require(a28_0x399f03(0xbe));function a28_0x48d3(_0x17ed45,_0x14ced2){const _0xdd2462=a28_0xdd24();return a28_0x48d3=function(_0x48d3c5,_0x19c34d){_0x48d3c5=_0x48d3c5-0xba;let _0x1dd003=_0xdd2462[_0x48d3c5];return _0x1dd003;},a28_0x48d3(_0x17ed45,_0x14ced2);}Promise[a28_0x399f03(0xdf)](fs);const addTags=async(_0x44d584,_0x1b6a5b)=>{const _0x560314=a28_0x399f03;for(const _0x389a87 in _0x44d584['Resources']){_0x44d584[_0x560314(0xdd)][_0x389a87][_0x560314(0xc7)]&&_0x44d584[_0x560314(0xdd)][_0x389a87]['Properties'][_0x560314(0xe8)]&&_0x44d584[_0x560314(0xdd)][_0x389a87][_0x560314(0xc7)][_0x560314(0xe8)]['push'](..._0x1b6a5b);}};function a28_0xdd24(){const _0x9f2452=['tZqJy','StackName','-cf','qqEXO','34202SlikVe','CloudFormation','bxFQN','Tags','3YSoEwk','promise','stackCreateComplete','TemplateBody','join','1367424YcbazY','BaseResourceName','wDecl','ClusterOIDCURL','nEvSr','schema','CFTemplates','Parameters','zAxvh','7894640PeYcDk','Capabilities','../config/logger','valueOf','aREHN','DELETE','push','1576BsROqA','Value','JMyrx','load','Properties','CAPABILITY_NAMED_IAM','createHubHaStack','path','browserstack:creationDate','waitFor','718498oYmiPm','vTpPv','2010-05-15','js-yaml-cloudformation-schema','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','5MTtmik','KDOJj','VpcId','getOidcUrl','split','./AWSUtils','utf-8','mOgRt','4750476oFUDGR','1435482ILBVMI','StackId','Resources','MXQgj','promisifyAll','4133148ALRCKI'];a28_0xdd24=function(){return _0x9f2452;};return a28_0xdd24();}exports[a28_0x399f03(0xc9)]=async(_0x445e32,_0x2bef7b=null)=>{const _0x439a03=a28_0x399f03,_0x7cb71a={'tZqJy':'browserstack:cluster','ojeVw':_0x439a03(0xcb),'zAxvh':_0x439a03(0xcf),'qqEXO':_0x439a03(0xf4),'aREHN':'hub-ha.yaml','bxFQN':_0x439a03(0xd8),'ysSTn':function(_0x4cf5d6,_0x103e15,_0x36e58c){return _0x4cf5d6(_0x103e15,_0x36e58c);},'nEvSr':'://','wDecl':_0x439a03(0xc1),'JMyrx':_0x439a03(0xd4),'KDOJj':_0x439a03(0xef),'mOgRt':_0x439a03(0xf1),'wgrcQ':_0x439a03(0xc8),'MXQgj':_0x439a03(0xd1),'vTpPv':_0x439a03(0xeb)},_0x574336=COMMON_HST_TAGS,_0x5a7cb1={};_0x5a7cb1['Key']=_0x7cb71a[_0x439a03(0xe1)],_0x5a7cb1[_0x439a03(0xc4)]=_0x445e32,_0x574336['push'](_0x5a7cb1),_0x574336[_0x439a03(0xc2)]({'Key':_0x7cb71a['ojeVw'],'Value':new Date()[_0x439a03(0xbf)]()['toString']()});const _0x335df7={};_0x335df7['apiVersion']=_0x7cb71a[_0x439a03(0xbb)];const _0xa3c980=new AWS[(_0x439a03(0xe6))](_0x335df7),_0x22acdb=await fs['readFileAsync'](path[_0x439a03(0xed)](__dirname,'..',_0x7cb71a[_0x439a03(0xe4)],_0x7cb71a[_0x439a03(0xc0)]),_0x7cb71a[_0x439a03(0xe7)]),_0x52d83f={};_0x52d83f[_0x439a03(0xf3)]=CLOUDFORMATION_SCHEMA;const _0x5990db=yaml[_0x439a03(0xc6)](_0x22acdb,_0x52d83f);await _0x7cb71a['ysSTn'](addTags,_0x5990db,_0x574336);const _0x317869=JSON['stringify'](_0x5990db);let _0x3c5524=await AWSUtils[_0x439a03(0xd5)](_0x445e32);_0x3c5524=_0x3c5524[_0x439a03(0xd6)](_0x7cb71a[_0x439a03(0xf2)])[0x1];const _0x44d63b={};_0x44d63b[_0x439a03(0xe2)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x445e32+_0x439a03(0xe3),_0x44d63b['OnFailure']=_0x7cb71a[_0x439a03(0xf0)],_0x44d63b[_0x439a03(0xec)]=_0x317869,_0x44d63b[_0x439a03(0xba)]=[{'ParameterKey':_0x7cb71a[_0x439a03(0xc5)],'ParameterValue':_0x2bef7b},{'ParameterKey':_0x7cb71a[_0x439a03(0xd3)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x445e32},{'ParameterKey':_0x7cb71a[_0x439a03(0xd9)],'ParameterValue':_0x3c5524}],_0x44d63b[_0x439a03(0xbd)]=[_0x7cb71a['wgrcQ']],_0x44d63b[_0x439a03(0xe8)]=_0x574336;const _0x134c4c=_0x44d63b,_0x1504e3=await _0xa3c980['createStack'](_0x134c4c)[_0x439a03(0xea)]();logger['info'](_0x7cb71a[_0x439a03(0xde)]);const _0xdc7c11={};return _0xdc7c11['StackName']=_0x1504e3[_0x439a03(0xdc)],_0xa3c980[_0x439a03(0xcc)](_0x7cb71a[_0x439a03(0xce)],_0xdc7c11)[_0x439a03(0xea)]();};