const a28_0x3cf50d=a28_0x1cd7;(function(_0x1f4967,_0x3995cb){const _0x1dd78f=a28_0x1cd7,_0x55af03=_0x1f4967();while(!![]){try{const _0x645178=parseInt(_0x1dd78f(0xcc))/0x1*(-parseInt(_0x1dd78f(0xc1))/0x2)+-parseInt(_0x1dd78f(0xb6))/0x3+parseInt(_0x1dd78f(0xc9))/0x4*(parseInt(_0x1dd78f(0xb7))/0x5)+parseInt(_0x1dd78f(0xd5))/0x6+parseInt(_0x1dd78f(0xd6))/0x7*(parseInt(_0x1dd78f(0xa8))/0x8)+parseInt(_0x1dd78f(0xc7))/0x9*(parseInt(_0x1dd78f(0xbc))/0xa)+-parseInt(_0x1dd78f(0xb2))/0xb;if(_0x645178===_0x3995cb)break;else _0x55af03['push'](_0x55af03['shift']());}catch(_0x61dfd5){_0x55af03['push'](_0x55af03['shift']());}}}(a28_0xf32c,0xc1595));const fs=require('fs'),path=require('path'),Promise=require(a28_0x3cf50d(0xaa)),yaml=require(a28_0x3cf50d(0xca)),{CLOUDFORMATION_SCHEMA}=require(a28_0x3cf50d(0xa4)),AWS=require(a28_0x3cf50d(0xb3))[a28_0x3cf50d(0xd2)],AWSUtils=require(a28_0x3cf50d(0xb3)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x3cf50d(0xab)),{logger}=require(a28_0x3cf50d(0xc5));Promise[a28_0x3cf50d(0xad)](fs);function a28_0xf32c(){const _0x32831f=['lvvsS','stringify','ClusterOIDCURL','join','awsObj','CAPABILITY_NAMED_IAM','Properties','7975860vPxwIA','28XktGeB','HsMdw','createStack','toString','Capabilities','info','apiVersion','Key','vYApH','js-yaml-cloudformation-schema','browserstack:cluster','-cf','lGvci','2006344jyGLXZ','promise','bluebird','../config/constants','XwrPh','promisifyAll','createHubHaStack','OnFailure','Resources','browserstack:creationDate','12456037IEeTZa','./AWSUtils','://','load','3995961GqLTqA','101055hygxOb','VpcId','push','2010-05-15','StackName','841270uGOcCV','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','sycIX','eyrfl','FYBTG','75332GQplXB','BaseResourceName','oRurJ','stackCreateComplete','../config/logger','split','135BslfZR','CeiOn','112hyRTzo','js-yaml','waitFor','24GstLmg','KbxyV'];a28_0xf32c=function(){return _0x32831f;};return a28_0xf32c();}function a28_0x1cd7(_0x2f1e3f,_0x267d22){const _0xf32cf8=a28_0xf32c();return a28_0x1cd7=function(_0x1cd79d,_0x5806e8){_0x1cd79d=_0x1cd79d-0x9e;let _0xe28474=_0xf32cf8[_0x1cd79d];return _0xe28474;},a28_0x1cd7(_0x2f1e3f,_0x267d22);}const addTags=async(_0x36020e,_0x462cad)=>{const _0x35dab2=a28_0x3cf50d;for(const _0x56fa02 in _0x36020e[_0x35dab2(0xb0)]){_0x36020e[_0x35dab2(0xb0)][_0x56fa02][_0x35dab2(0xd4)]&&_0x36020e[_0x35dab2(0xb0)][_0x56fa02][_0x35dab2(0xd4)]['Tags']&&_0x36020e[_0x35dab2(0xb0)][_0x56fa02][_0x35dab2(0xd4)]['Tags'][_0x35dab2(0xb9)](..._0x462cad);}};exports[a28_0x3cf50d(0xae)]=async(_0x552d70,_0x3551c6=null)=>{const _0x5eedf0=a28_0x3cf50d,_0x25048b={'CeiOn':_0x5eedf0(0xa5),'oRurJ':_0x5eedf0(0xb1),'wGMVp':_0x5eedf0(0xba),'sycIX':'CFTemplates','ySZPW':'hub-ha.yaml','HsMdw':'utf-8','eyrfl':function(_0x1cee7b,_0x227b55,_0x1ca188){return _0x1cee7b(_0x227b55,_0x1ca188);},'KbxyV':_0x5eedf0(0xb4),'ELAXl':'DELETE','lGvci':_0x5eedf0(0xb8),'FYBTG':_0x5eedf0(0xc2),'XwrPh':_0x5eedf0(0xd0),'HWZTq':_0x5eedf0(0xd3),'vYApH':_0x5eedf0(0xbd),'lvvsS':_0x5eedf0(0xc4)},_0x10ab7a=COMMON_HST_TAGS,_0x5eb3df={};_0x5eb3df[_0x5eedf0(0xa2)]=_0x25048b[_0x5eedf0(0xc8)],_0x5eb3df['Value']=_0x552d70,_0x10ab7a[_0x5eedf0(0xb9)](_0x5eb3df),_0x10ab7a[_0x5eedf0(0xb9)]({'Key':_0x25048b[_0x5eedf0(0xc3)],'Value':new Date()['valueOf']()[_0x5eedf0(0x9e)]()});const _0xe9112={};_0xe9112[_0x5eedf0(0xa1)]=_0x25048b['wGMVp'];const _0xb6ce27=new AWS['CloudFormation'](_0xe9112),_0x32f18c=await fs['readFileAsync'](path[_0x5eedf0(0xd1)](__dirname,'..',_0x25048b[_0x5eedf0(0xbe)],_0x25048b['ySZPW']),_0x25048b[_0x5eedf0(0xd7)]),_0x4b5555={};_0x4b5555['schema']=CLOUDFORMATION_SCHEMA;const _0x3019f2=yaml[_0x5eedf0(0xb5)](_0x32f18c,_0x4b5555);await _0x25048b[_0x5eedf0(0xbf)](addTags,_0x3019f2,_0x10ab7a);const _0x13d1f4=JSON[_0x5eedf0(0xcf)](_0x3019f2);let _0x3b2231=await AWSUtils['getOidcUrl'](_0x552d70);_0x3b2231=_0x3b2231[_0x5eedf0(0xc6)](_0x25048b[_0x5eedf0(0xcd)])[0x1];const _0x166b85={};_0x166b85['StackName']=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x552d70+_0x5eedf0(0xa6),_0x166b85[_0x5eedf0(0xaf)]=_0x25048b['ELAXl'],_0x166b85['TemplateBody']=_0x13d1f4,_0x166b85['Parameters']=[{'ParameterKey':_0x25048b[_0x5eedf0(0xa7)],'ParameterValue':_0x3551c6},{'ParameterKey':_0x25048b[_0x5eedf0(0xc0)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x552d70},{'ParameterKey':_0x25048b[_0x5eedf0(0xac)],'ParameterValue':_0x3b2231}],_0x166b85[_0x5eedf0(0x9f)]=[_0x25048b['HWZTq']],_0x166b85['Tags']=_0x10ab7a;const _0x5657a2=_0x166b85,_0x4f99ac=await _0xb6ce27[_0x5eedf0(0xd8)](_0x5657a2)[_0x5eedf0(0xa9)]();logger[_0x5eedf0(0xa0)](_0x25048b[_0x5eedf0(0xa3)]);const _0x1309ee={};return _0x1309ee[_0x5eedf0(0xbb)]=_0x4f99ac['StackId'],_0xb6ce27[_0x5eedf0(0xcb)](_0x25048b[_0x5eedf0(0xce)],_0x1309ee)[_0x5eedf0(0xa9)]();};