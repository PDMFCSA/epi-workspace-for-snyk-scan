const a28_0x506a4c=a28_0x5039;(function(_0x175173,_0x3e84a0){const _0x3247d1=a28_0x5039,_0xfc8ca9=_0x175173();while(!![]){try{const _0x1bb9d2=-parseInt(_0x3247d1(0x77))/0x1*(parseInt(_0x3247d1(0x88))/0x2)+-parseInt(_0x3247d1(0x92))/0x3*(parseInt(_0x3247d1(0x74))/0x4)+-parseInt(_0x3247d1(0x97))/0x5*(parseInt(_0x3247d1(0x7e))/0x6)+parseInt(_0x3247d1(0x99))/0x7*(-parseInt(_0x3247d1(0x85))/0x8)+-parseInt(_0x3247d1(0xa1))/0x9+-parseInt(_0x3247d1(0x6e))/0xa*(parseInt(_0x3247d1(0x9a))/0xb)+parseInt(_0x3247d1(0x76))/0xc;if(_0x1bb9d2===_0x3e84a0)break;else _0xfc8ca9['push'](_0xfc8ca9['shift']());}catch(_0x5944ad){_0xfc8ca9['push'](_0xfc8ca9['shift']());}}}(a28_0x542c,0xf111d));const fs=require('fs'),path=require(a28_0x506a4c(0x68)),Promise=require(a28_0x506a4c(0x94)),yaml=require(a28_0x506a4c(0x65)),{CLOUDFORMATION_SCHEMA}=require('js-yaml-cloudformation-schema'),AWS=require(a28_0x506a4c(0x6c))[a28_0x506a4c(0x9f)],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x506a4c(0x8c)),{logger}=require('../config/logger');Promise[a28_0x506a4c(0x75)](fs);const addTags=async(_0x5d6370,_0x193307)=>{const _0x38e699=a28_0x506a4c;for(const _0x4c22e4 in _0x5d6370['Resources']){_0x5d6370['Resources'][_0x4c22e4][_0x38e699(0x9c)]&&_0x5d6370['Resources'][_0x4c22e4][_0x38e699(0x9c)][_0x38e699(0x80)]&&_0x5d6370[_0x38e699(0xa5)][_0x4c22e4][_0x38e699(0x9c)][_0x38e699(0x80)][_0x38e699(0x69)](..._0x193307);}};function a28_0x5039(_0x2f7d6c,_0x4b97b5){const _0x542cab=a28_0x542c();return a28_0x5039=function(_0x5039ef,_0x3cfadb){_0x5039ef=_0x5039ef-0x65;let _0x3d69dc=_0x542cab[_0x5039ef];return _0x3d69dc;},a28_0x5039(_0x2f7d6c,_0x4b97b5);}exports[a28_0x506a4c(0x90)]=async(_0x69f267,_0x4a75a0=null)=>{const _0x38fa8d=a28_0x506a4c,_0x4edc77={'xmjLO':'browserstack:cluster','fKGjf':_0x38fa8d(0x93),'hIvNv':_0x38fa8d(0x6b),'FjVaS':_0x38fa8d(0x8f),'zUwtG':_0x38fa8d(0x7c),'LNHiN':_0x38fa8d(0x87),'WbwkQ':function(_0x4b5748,_0x19a05,_0x59c322){return _0x4b5748(_0x19a05,_0x59c322);},'UrMTA':_0x38fa8d(0x7a),'OOOEC':_0x38fa8d(0x8d),'XAzoG':_0x38fa8d(0x81),'NpXua':_0x38fa8d(0x7f),'NoNSk':'ClusterOIDCURL','BSaAN':_0x38fa8d(0x98),'kmoSc':_0x38fa8d(0x72),'NhVRE':_0x38fa8d(0xa3)},_0x1fc882=COMMON_HST_TAGS,_0x4e62c2={};_0x4e62c2['Key']=_0x4edc77[_0x38fa8d(0x91)],_0x4e62c2[_0x38fa8d(0x96)]=_0x69f267,_0x1fc882['push'](_0x4e62c2),_0x1fc882[_0x38fa8d(0x69)]({'Key':_0x4edc77[_0x38fa8d(0x84)],'Value':new Date()['valueOf']()[_0x38fa8d(0x86)]()});const _0x5541d8={};_0x5541d8[_0x38fa8d(0x8a)]=_0x4edc77[_0x38fa8d(0x8b)];const _0x4b7688=new AWS['CloudFormation'](_0x5541d8),_0x5d264a=await fs[_0x38fa8d(0x67)](path[_0x38fa8d(0x82)](__dirname,'..',_0x4edc77[_0x38fa8d(0x73)],_0x4edc77[_0x38fa8d(0x83)]),_0x4edc77[_0x38fa8d(0x9b)]),_0x302149={};_0x302149[_0x38fa8d(0xa0)]=CLOUDFORMATION_SCHEMA;const _0x6e4d07=yaml[_0x38fa8d(0x89)](_0x5d264a,_0x302149);await _0x4edc77[_0x38fa8d(0x8e)](addTags,_0x6e4d07,_0x1fc882);const _0x4ed0c1=JSON[_0x38fa8d(0x71)](_0x6e4d07);let _0x14b82b=await AWSUtils[_0x38fa8d(0x79)](_0x69f267);_0x14b82b=_0x14b82b[_0x38fa8d(0xa4)](_0x4edc77[_0x38fa8d(0x6a)])[0x1];const _0x5e01af={};_0x5e01af[_0x38fa8d(0x6d)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x69f267+'-cf',_0x5e01af[_0x38fa8d(0x6f)]=_0x4edc77['OOOEC'],_0x5e01af[_0x38fa8d(0xa2)]=_0x4ed0c1,_0x5e01af['Parameters']=[{'ParameterKey':_0x4edc77[_0x38fa8d(0x7d)],'ParameterValue':_0x4a75a0},{'ParameterKey':_0x4edc77[_0x38fa8d(0x70)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x69f267},{'ParameterKey':_0x4edc77['NoNSk'],'ParameterValue':_0x14b82b}],_0x5e01af[_0x38fa8d(0x7b)]=[_0x4edc77['BSaAN']],_0x5e01af[_0x38fa8d(0x80)]=_0x1fc882;const _0x504f40=_0x5e01af,_0x386ff1=await _0x4b7688[_0x38fa8d(0x78)](_0x504f40)[_0x38fa8d(0x95)]();logger[_0x38fa8d(0x9d)](_0x4edc77[_0x38fa8d(0x66)]);const _0x186e47={};return _0x186e47[_0x38fa8d(0x6d)]=_0x386ff1[_0x38fa8d(0x9e)],_0x4b7688[_0x38fa8d(0xa6)](_0x4edc77['NhVRE'],_0x186e47)[_0x38fa8d(0x95)]();};function a28_0x542c(){const _0x9d8d5e=['utf-8','50gAmrRw','load','apiVersion','hIvNv','../config/constants','DELETE','WbwkQ','CFTemplates','createHubHaStack','xmjLO','69WVhQrh','browserstack:creationDate','bluebird','promise','Value','955SuQCFL','CAPABILITY_NAMED_IAM','21322FklzUt','11arPoEO','LNHiN','Properties','info','StackId','awsObj','schema','6535881gHAnBA','TemplateBody','stackCreateComplete','split','Resources','waitFor','js-yaml','kmoSc','readFileAsync','path','push','UrMTA','2010-05-15','./AWSUtils','StackName','2615630nUvjJR','OnFailure','NpXua','stringify','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','FjVaS','160012RufxVl','promisifyAll','74538372OKLRuR','53507PVfKrg','createStack','getOidcUrl','://','Capabilities','hub-ha.yaml','XAzoG','53256quiPXa','BaseResourceName','Tags','VpcId','join','zUwtG','fKGjf','744hwMxVD','toString'];a28_0x542c=function(){return _0x9d8d5e;};return a28_0x542c();}