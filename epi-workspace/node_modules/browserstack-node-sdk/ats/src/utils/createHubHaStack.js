const a28_0x69d5e4=a28_0x1ded;(function(_0x491d00,_0x1e8379){const _0x3c73eb=a28_0x1ded,_0x531bd1=_0x491d00();while(!![]){try{const _0x455cb9=parseInt(_0x3c73eb(0x128))/0x1*(parseInt(_0x3c73eb(0x140))/0x2)+-parseInt(_0x3c73eb(0x12a))/0x3*(-parseInt(_0x3c73eb(0x152))/0x4)+-parseInt(_0x3c73eb(0x14e))/0x5+-parseInt(_0x3c73eb(0x11a))/0x6+-parseInt(_0x3c73eb(0x13f))/0x7+-parseInt(_0x3c73eb(0x126))/0x8+-parseInt(_0x3c73eb(0x148))/0x9*(-parseInt(_0x3c73eb(0x13a))/0xa);if(_0x455cb9===_0x1e8379)break;else _0x531bd1['push'](_0x531bd1['shift']());}catch(_0x19c585){_0x531bd1['push'](_0x531bd1['shift']());}}}(a28_0x37cf,0x5291f));const fs=require('fs'),path=require(a28_0x69d5e4(0x132)),Promise=require('bluebird'),yaml=require(a28_0x69d5e4(0x12e)),{CLOUDFORMATION_SCHEMA}=require(a28_0x69d5e4(0x12d)),AWS=require('./AWSUtils')['awsObj'],AWSUtils=require(a28_0x69d5e4(0x136)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x69d5e4(0x12c)),{logger}=require('../config/logger');function a28_0x37cf(){const _0x1eeb97=['LTuGu','-cf','TemplateBody','zIFBe','394023tTTpAz','1236316YSwZQc','stackCreateComplete','uydeX','info','hub-ha.yaml','toString','createStack','WMmJD','9PJNfoD','VpcId','createHubHaStack','split','hwICE','UqXjT','1277675HdWfBb','promise','join','schema','77696qVsgWn','TSijo','Parameters','1012998YjhjpW','Resources','DELETE','StackId','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','hQRom','BaseResourceName','Properties','Capabilities','push','waitFor','Exrrr','3361960oxbEWX','Tags','1TNWPoB','fKGIg','51RfnDns','getOidcUrl','../config/constants','js-yaml-cloudformation-schema','js-yaml','load','2010-05-15','StackName','path','BgueF','valueOf','Value','./AWSUtils','OnFailure','Key','CAPABILITY_NAMED_IAM','2907430lXLlfh'];a28_0x37cf=function(){return _0x1eeb97;};return a28_0x37cf();}Promise['promisifyAll'](fs);function a28_0x1ded(_0x49fec1,_0x48579f){const _0x37cf13=a28_0x37cf();return a28_0x1ded=function(_0x1dedd2,_0x48c862){_0x1dedd2=_0x1dedd2-0x118;let _0x2d7894=_0x37cf13[_0x1dedd2];return _0x2d7894;},a28_0x1ded(_0x49fec1,_0x48579f);}const addTags=async(_0x7158bb,_0x5bfbfa)=>{const _0x1496bd=a28_0x69d5e4;for(const _0x59a870 in _0x7158bb['Resources']){_0x7158bb['Resources'][_0x59a870][_0x1496bd(0x121)]&&_0x7158bb['Resources'][_0x59a870][_0x1496bd(0x121)][_0x1496bd(0x127)]&&_0x7158bb[_0x1496bd(0x11b)][_0x59a870][_0x1496bd(0x121)][_0x1496bd(0x127)]['push'](..._0x5bfbfa);}};exports[a28_0x69d5e4(0x14a)]=async(_0x47f5cf,_0x2b5c44=null)=>{const _0x5e7297=a28_0x69d5e4,_0x5d38a8={'fKGIg':'browserstack:cluster','qgDib':'browserstack:creationDate','uydeX':_0x5e7297(0x130),'twFOJ':'CFTemplates','hQRom':_0x5e7297(0x144),'UqXjT':'utf-8','EhAgO':function(_0x133c00,_0x3650e4,_0x1a7c87){return _0x133c00(_0x3650e4,_0x1a7c87);},'TSijo':'://','zIFBe':_0x5e7297(0x11c),'BgueF':_0x5e7297(0x149),'LTuGu':_0x5e7297(0x120),'dGoRG':'ClusterOIDCURL','Exrrr':_0x5e7297(0x139),'hwICE':_0x5e7297(0x11e),'WMmJD':_0x5e7297(0x141)},_0x3e30d6=COMMON_HST_TAGS,_0x2e8e2d={};_0x2e8e2d[_0x5e7297(0x138)]=_0x5d38a8[_0x5e7297(0x129)],_0x2e8e2d[_0x5e7297(0x135)]=_0x47f5cf,_0x3e30d6['push'](_0x2e8e2d),_0x3e30d6[_0x5e7297(0x123)]({'Key':_0x5d38a8['qgDib'],'Value':new Date()[_0x5e7297(0x134)]()[_0x5e7297(0x145)]()});const _0x5dd72a={};_0x5dd72a['apiVersion']=_0x5d38a8[_0x5e7297(0x142)];const _0x2f77c9=new AWS['CloudFormation'](_0x5dd72a),_0xf4b58e=await fs['readFileAsync'](path[_0x5e7297(0x150)](__dirname,'..',_0x5d38a8['twFOJ'],_0x5d38a8[_0x5e7297(0x11f)]),_0x5d38a8[_0x5e7297(0x14d)]),_0xb18b66={};_0xb18b66[_0x5e7297(0x151)]=CLOUDFORMATION_SCHEMA;const _0x595181=yaml[_0x5e7297(0x12f)](_0xf4b58e,_0xb18b66);await _0x5d38a8['EhAgO'](addTags,_0x595181,_0x3e30d6);const _0x283eaf=JSON['stringify'](_0x595181);let _0xdc2fe=await AWSUtils[_0x5e7297(0x12b)](_0x47f5cf);_0xdc2fe=_0xdc2fe[_0x5e7297(0x14b)](_0x5d38a8[_0x5e7297(0x118)])[0x1];const _0x474694={};_0x474694[_0x5e7297(0x131)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x47f5cf+_0x5e7297(0x13c),_0x474694[_0x5e7297(0x137)]=_0x5d38a8[_0x5e7297(0x13e)],_0x474694[_0x5e7297(0x13d)]=_0x283eaf,_0x474694[_0x5e7297(0x119)]=[{'ParameterKey':_0x5d38a8[_0x5e7297(0x133)],'ParameterValue':_0x2b5c44},{'ParameterKey':_0x5d38a8[_0x5e7297(0x13b)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x47f5cf},{'ParameterKey':_0x5d38a8['dGoRG'],'ParameterValue':_0xdc2fe}],_0x474694[_0x5e7297(0x122)]=[_0x5d38a8[_0x5e7297(0x125)]],_0x474694['Tags']=_0x3e30d6;const _0x4b6a55=_0x474694,_0x369a1=await _0x2f77c9[_0x5e7297(0x146)](_0x4b6a55)['promise']();logger[_0x5e7297(0x143)](_0x5d38a8[_0x5e7297(0x14c)]);const _0x4938de={};return _0x4938de[_0x5e7297(0x131)]=_0x369a1[_0x5e7297(0x11d)],_0x2f77c9[_0x5e7297(0x124)](_0x5d38a8[_0x5e7297(0x147)],_0x4938de)[_0x5e7297(0x14f)]();};