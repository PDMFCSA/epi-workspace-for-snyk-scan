function a28_0x23f3(_0x5f5658,_0x8ac627){const _0x1b5f84=a28_0x1b5f();return a28_0x23f3=function(_0x23f320,_0x15e87a){_0x23f320=_0x23f320-0x105;let _0x43902f=_0x1b5f84[_0x23f320];return _0x43902f;},a28_0x23f3(_0x5f5658,_0x8ac627);}const a28_0x590e2f=a28_0x23f3;(function(_0x524f6e,_0x3e9a7d){const _0x3b7abd=a28_0x23f3,_0x34c5aa=_0x524f6e();while(!![]){try{const _0x442b2e=-parseInt(_0x3b7abd(0x129))/0x1*(parseInt(_0x3b7abd(0x13f))/0x2)+-parseInt(_0x3b7abd(0x113))/0x3+-parseInt(_0x3b7abd(0x128))/0x4+parseInt(_0x3b7abd(0x13c))/0x5+-parseInt(_0x3b7abd(0x10d))/0x6+parseInt(_0x3b7abd(0x120))/0x7*(parseInt(_0x3b7abd(0x12c))/0x8)+-parseInt(_0x3b7abd(0x105))/0x9*(-parseInt(_0x3b7abd(0x13e))/0xa);if(_0x442b2e===_0x3e9a7d)break;else _0x34c5aa['push'](_0x34c5aa['shift']());}catch(_0x51a5d5){_0x34c5aa['push'](_0x34c5aa['shift']());}}}(a28_0x1b5f,0x5fe97));function a28_0x1b5f(){const _0x5004f1=['3241254rtAtmA','StackId','info','browserstack:cluster','push','CloudFormation','1897026qkdCFy','bluebird','TemplateBody','createStack','load','WYOeh','StackName','EfVfL','../config/constants','CAXgD','utf-8','promisifyAll','Value','1603dPlqbD','schema','Tags','promise','NhwdZ','stringify','ZYtIa','join','1379228XUomgY','5609yfxvTO','awsObj','VpcId','9208APBIfR','VpGnr','lIuZF','js-yaml','lWpMi','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','path','Resources','Parameters','2010-05-15','EJwNk','hub-ha.yaml','Properties','./AWSUtils','JbAaI','valueOf','3708320JGcQmP','DELETE','8395060tuAbqE','276vzHEwT','-cf','18rtvjHS','qRSwx','CFTemplates','toString','split','createHubHaStack','browserstack:creationDate','apiVersion'];a28_0x1b5f=function(){return _0x5004f1;};return a28_0x1b5f();}const fs=require('fs'),path=require(a28_0x590e2f(0x132)),Promise=require(a28_0x590e2f(0x114)),yaml=require(a28_0x590e2f(0x12f)),{CLOUDFORMATION_SCHEMA}=require('js-yaml-cloudformation-schema'),AWS=require(a28_0x590e2f(0x139))[a28_0x590e2f(0x12a)],AWSUtils=require(a28_0x590e2f(0x139)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x590e2f(0x11b)),{logger}=require('../config/logger');Promise[a28_0x590e2f(0x11e)](fs);const addTags=async(_0x493d2d,_0x51a38d)=>{const _0x102a40=a28_0x590e2f;for(const _0x1ee7b6 in _0x493d2d[_0x102a40(0x133)]){_0x493d2d[_0x102a40(0x133)][_0x1ee7b6][_0x102a40(0x138)]&&_0x493d2d['Resources'][_0x1ee7b6][_0x102a40(0x138)][_0x102a40(0x122)]&&_0x493d2d[_0x102a40(0x133)][_0x1ee7b6]['Properties'][_0x102a40(0x122)]['push'](..._0x51a38d);}};exports[a28_0x590e2f(0x10a)]=async(_0x177086,_0x3df6b1=null)=>{const _0x3d2a91=a28_0x590e2f,_0x508195={'ZYtIa':_0x3d2a91(0x110),'WAsmU':_0x3d2a91(0x10b),'VpGnr':_0x3d2a91(0x135),'lWpMi':_0x3d2a91(0x107),'lIuZF':_0x3d2a91(0x137),'qRSwx':_0x3d2a91(0x11d),'JbAaI':function(_0x48be26,_0x51bd68,_0x5cef7a){return _0x48be26(_0x51bd68,_0x5cef7a);},'ISHiI':'://','EJwNk':_0x3d2a91(0x13d),'oYXDX':_0x3d2a91(0x12b),'EfVfL':'BaseResourceName','NhwdZ':'ClusterOIDCURL','CAXgD':'CAPABILITY_NAMED_IAM','WYOeh':_0x3d2a91(0x131),'PLSbB':'stackCreateComplete'},_0x4a06ae=COMMON_HST_TAGS,_0x5b8d88={};_0x5b8d88['Key']=_0x508195[_0x3d2a91(0x126)],_0x5b8d88[_0x3d2a91(0x11f)]=_0x177086,_0x4a06ae['push'](_0x5b8d88),_0x4a06ae[_0x3d2a91(0x111)]({'Key':_0x508195['WAsmU'],'Value':new Date()[_0x3d2a91(0x13b)]()[_0x3d2a91(0x108)]()});const _0x57e883={};_0x57e883[_0x3d2a91(0x10c)]=_0x508195[_0x3d2a91(0x12d)];const _0x588fd6=new AWS[(_0x3d2a91(0x112))](_0x57e883),_0x12d7e1=await fs['readFileAsync'](path[_0x3d2a91(0x127)](__dirname,'..',_0x508195[_0x3d2a91(0x130)],_0x508195[_0x3d2a91(0x12e)]),_0x508195[_0x3d2a91(0x106)]),_0xe9cf3={};_0xe9cf3[_0x3d2a91(0x121)]=CLOUDFORMATION_SCHEMA;const _0x4f623e=yaml[_0x3d2a91(0x117)](_0x12d7e1,_0xe9cf3);await _0x508195[_0x3d2a91(0x13a)](addTags,_0x4f623e,_0x4a06ae);const _0x4c2d19=JSON[_0x3d2a91(0x125)](_0x4f623e);let _0x5322a3=await AWSUtils['getOidcUrl'](_0x177086);_0x5322a3=_0x5322a3[_0x3d2a91(0x109)](_0x508195['ISHiI'])[0x1];const _0x16a8cc={};_0x16a8cc['StackName']=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x177086+_0x3d2a91(0x140),_0x16a8cc['OnFailure']=_0x508195[_0x3d2a91(0x136)],_0x16a8cc[_0x3d2a91(0x115)]=_0x4c2d19,_0x16a8cc[_0x3d2a91(0x134)]=[{'ParameterKey':_0x508195['oYXDX'],'ParameterValue':_0x3df6b1},{'ParameterKey':_0x508195[_0x3d2a91(0x11a)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x177086},{'ParameterKey':_0x508195[_0x3d2a91(0x124)],'ParameterValue':_0x5322a3}],_0x16a8cc['Capabilities']=[_0x508195[_0x3d2a91(0x11c)]],_0x16a8cc[_0x3d2a91(0x122)]=_0x4a06ae;const _0x435ccb=_0x16a8cc,_0x3c0d1b=await _0x588fd6[_0x3d2a91(0x116)](_0x435ccb)['promise']();logger[_0x3d2a91(0x10f)](_0x508195[_0x3d2a91(0x118)]);const _0x328880={};return _0x328880[_0x3d2a91(0x119)]=_0x3c0d1b[_0x3d2a91(0x10e)],_0x588fd6['waitFor'](_0x508195['PLSbB'],_0x328880)[_0x3d2a91(0x123)]();};