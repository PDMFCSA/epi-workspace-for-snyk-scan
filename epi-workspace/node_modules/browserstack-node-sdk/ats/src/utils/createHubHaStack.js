const a28_0x5c71b0=a28_0x3774;(function(_0x14e954,_0x57606f){const _0x453375=a28_0x3774,_0x29f903=_0x14e954();while(!![]){try{const _0x3e32b9=-parseInt(_0x453375(0x126))/0x1+-parseInt(_0x453375(0x137))/0x2*(parseInt(_0x453375(0x11b))/0x3)+-parseInt(_0x453375(0x119))/0x4+parseInt(_0x453375(0x14b))/0x5+parseInt(_0x453375(0x14c))/0x6*(parseInt(_0x453375(0x128))/0x7)+-parseInt(_0x453375(0x129))/0x8+parseInt(_0x453375(0x121))/0x9;if(_0x3e32b9===_0x57606f)break;else _0x29f903['push'](_0x29f903['shift']());}catch(_0x20434d){_0x29f903['push'](_0x29f903['shift']());}}}(a28_0x5153,0xa85fe));function a28_0x5153(){const _0x393bbb=['browserstack:creationDate','readFileAsync','CFTemplates','qvEJg','BaseResourceName','cbBJM','Resources','lWKtb','OnFailure','load','DELETE','waitFor','awsObj','stringify','Value','info','VpcId','./AWSUtils','stackCreateComplete','6018885JmLHnd','839658BtEkqI','qogPc','schema','CloudFormation','Capabilities','4900804XihyJK','-cf','67929pXZsIC','valueOf','StackName','ClusterOIDCURL','MCwen','js-yaml-cloudformation-schema','29809251Lbmtrn','ZaKxg','bluebird','vjPCC','toString','961151lpblrO','push','7UJMJnP','8985584sVInHE','badeR','promisifyAll','uMoOj','TTZwF','Properties','Tags','HRvCk','../config/constants','hub-ha.yaml','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','path','getOidcUrl','://','58GYgnPN'];a28_0x5153=function(){return _0x393bbb;};return a28_0x5153();}const fs=require('fs'),path=require(a28_0x5c71b0(0x134)),Promise=require(a28_0x5c71b0(0x123)),yaml=require('js-yaml'),{CLOUDFORMATION_SCHEMA}=require(a28_0x5c71b0(0x120)),AWS=require(a28_0x5c71b0(0x149))[a28_0x5c71b0(0x144)],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x5c71b0(0x131)),{logger}=require('../config/logger');function a28_0x3774(_0x4ef8ba,_0x3f2672){const _0x51534f=a28_0x5153();return a28_0x3774=function(_0x377451,_0x3ad60c){_0x377451=_0x377451-0x117;let _0x556074=_0x51534f[_0x377451];return _0x556074;},a28_0x3774(_0x4ef8ba,_0x3f2672);}Promise[a28_0x5c71b0(0x12b)](fs);const addTags=async(_0x57badd,_0x28de4e)=>{const _0x339ee7=a28_0x5c71b0;for(const _0x449a5b in _0x57badd['Resources']){_0x57badd[_0x339ee7(0x13e)][_0x449a5b][_0x339ee7(0x12e)]&&_0x57badd[_0x339ee7(0x13e)][_0x449a5b][_0x339ee7(0x12e)][_0x339ee7(0x12f)]&&_0x57badd['Resources'][_0x449a5b][_0x339ee7(0x12e)][_0x339ee7(0x12f)][_0x339ee7(0x127)](..._0x28de4e);}};exports['createHubHaStack']=async(_0x2fdfc4,_0x1de9a4=null)=>{const _0x55d8ac=a28_0x5c71b0,_0x44fc9f={'HzWUh':'browserstack:cluster','qvEJg':_0x55d8ac(0x138),'cbBJM':'2010-05-15','tYFAp':_0x55d8ac(0x13a),'MCwen':_0x55d8ac(0x132),'TTZwF':'utf-8','Uerrw':function(_0x254a50,_0x3b107,_0x500f31){return _0x254a50(_0x3b107,_0x500f31);},'owZsy':_0x55d8ac(0x136),'lWKtb':_0x55d8ac(0x142),'HRvCk':_0x55d8ac(0x148),'qogPc':_0x55d8ac(0x13c),'vjPCC':_0x55d8ac(0x11e),'uMoOj':'CAPABILITY_NAMED_IAM','ZaKxg':_0x55d8ac(0x133),'badeR':_0x55d8ac(0x14a)},_0x51a762=COMMON_HST_TAGS,_0x480394={};_0x480394['Key']=_0x44fc9f['HzWUh'],_0x480394[_0x55d8ac(0x146)]=_0x2fdfc4,_0x51a762[_0x55d8ac(0x127)](_0x480394),_0x51a762[_0x55d8ac(0x127)]({'Key':_0x44fc9f[_0x55d8ac(0x13b)],'Value':new Date()[_0x55d8ac(0x11c)]()[_0x55d8ac(0x125)]()});const _0x2ac0da={};_0x2ac0da['apiVersion']=_0x44fc9f[_0x55d8ac(0x13d)];const _0xa449cc=new AWS[(_0x55d8ac(0x117))](_0x2ac0da),_0x57b2bf=await fs[_0x55d8ac(0x139)](path['join'](__dirname,'..',_0x44fc9f['tYFAp'],_0x44fc9f[_0x55d8ac(0x11f)]),_0x44fc9f[_0x55d8ac(0x12d)]),_0x4b6f73={};_0x4b6f73[_0x55d8ac(0x14e)]=CLOUDFORMATION_SCHEMA;const _0x6ef414=yaml[_0x55d8ac(0x141)](_0x57b2bf,_0x4b6f73);await _0x44fc9f['Uerrw'](addTags,_0x6ef414,_0x51a762);const _0x47f61b=JSON[_0x55d8ac(0x145)](_0x6ef414);let _0x3f6c4d=await AWSUtils[_0x55d8ac(0x135)](_0x2fdfc4);_0x3f6c4d=_0x3f6c4d['split'](_0x44fc9f['owZsy'])[0x1];const _0x58fade={};_0x58fade[_0x55d8ac(0x11d)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x2fdfc4+_0x55d8ac(0x11a),_0x58fade[_0x55d8ac(0x140)]=_0x44fc9f[_0x55d8ac(0x13f)],_0x58fade['TemplateBody']=_0x47f61b,_0x58fade['Parameters']=[{'ParameterKey':_0x44fc9f[_0x55d8ac(0x130)],'ParameterValue':_0x1de9a4},{'ParameterKey':_0x44fc9f[_0x55d8ac(0x14d)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x2fdfc4},{'ParameterKey':_0x44fc9f[_0x55d8ac(0x124)],'ParameterValue':_0x3f6c4d}],_0x58fade[_0x55d8ac(0x118)]=[_0x44fc9f[_0x55d8ac(0x12c)]],_0x58fade['Tags']=_0x51a762;const _0x1f8e79=_0x58fade,_0x781286=await _0xa449cc['createStack'](_0x1f8e79)['promise']();logger[_0x55d8ac(0x147)](_0x44fc9f[_0x55d8ac(0x122)]);const _0x5920d6={};return _0x5920d6[_0x55d8ac(0x11d)]=_0x781286['StackId'],_0xa449cc[_0x55d8ac(0x143)](_0x44fc9f[_0x55d8ac(0x12a)],_0x5920d6)['promise']();};