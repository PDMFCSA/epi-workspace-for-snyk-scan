const a28_0x501ab6=a28_0x5529;function a28_0x5529(_0x22f462,_0x421506){const _0x184827=a28_0x1848();return a28_0x5529=function(_0x5529d1,_0x3ae22a){_0x5529d1=_0x5529d1-0x1bd;let _0x2ef0a5=_0x184827[_0x5529d1];return _0x2ef0a5;},a28_0x5529(_0x22f462,_0x421506);}(function(_0x5c1450,_0x280478){const _0x4214b7=a28_0x5529,_0x211532=_0x5c1450();while(!![]){try{const _0x17b291=parseInt(_0x4214b7(0x1dd))/0x1+parseInt(_0x4214b7(0x1de))/0x2+parseInt(_0x4214b7(0x1f1))/0x3+-parseInt(_0x4214b7(0x1bf))/0x4+parseInt(_0x4214b7(0x1cd))/0x5*(-parseInt(_0x4214b7(0x1e1))/0x6)+-parseInt(_0x4214b7(0x1e0))/0x7*(-parseInt(_0x4214b7(0x1ca))/0x8)+-parseInt(_0x4214b7(0x1e4))/0x9*(parseInt(_0x4214b7(0x1cc))/0xa);if(_0x17b291===_0x280478)break;else _0x211532['push'](_0x211532['shift']());}catch(_0x5c1ac4){_0x211532['push'](_0x211532['shift']());}}}(a28_0x1848,0x3be00));const fs=require('fs'),path=require(a28_0x501ab6(0x1e6)),Promise=require('bluebird'),yaml=require(a28_0x501ab6(0x1c8)),{CLOUDFORMATION_SCHEMA}=require(a28_0x501ab6(0x1c7)),AWS=require(a28_0x501ab6(0x1f3))[a28_0x501ab6(0x1eb)],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require(a28_0x501ab6(0x1f6));Promise['promisifyAll'](fs);const addTags=async(_0x2f51d3,_0x59071e)=>{const _0xd37040=a28_0x501ab6;for(const _0x3f4dbb in _0x2f51d3[_0xd37040(0x1c9)]){_0x2f51d3[_0xd37040(0x1c9)][_0x3f4dbb][_0xd37040(0x1ef)]&&_0x2f51d3[_0xd37040(0x1c9)][_0x3f4dbb][_0xd37040(0x1ef)][_0xd37040(0x1d8)]&&_0x2f51d3['Resources'][_0x3f4dbb][_0xd37040(0x1ef)]['Tags']['push'](..._0x59071e);}};exports[a28_0x501ab6(0x1e8)]=async(_0x19379f,_0x2bb0d2=null)=>{const _0x1168b7=a28_0x501ab6,_0x348281={'eZmLk':'browserstack:cluster','OORpu':_0x1168b7(0x1c2),'pnqRK':_0x1168b7(0x1e9),'EssQB':'CFTemplates','bZLDt':_0x1168b7(0x1ee),'IacSl':_0x1168b7(0x1c0),'jPDrT':function(_0x310e52,_0x35a4d0,_0x4d6017){return _0x310e52(_0x35a4d0,_0x4d6017);},'hAwvJ':'://','RbXxd':'DELETE','ljtpT':'VpcId','djgMk':_0x1168b7(0x1e5),'RnrWJ':_0x1168b7(0x1bd),'FuNpG':'CAPABILITY_NAMED_IAM','xVyZS':_0x1168b7(0x1f2),'NQNSi':_0x1168b7(0x1c3)},_0x1cf670=COMMON_HST_TAGS,_0x57eb15={};_0x57eb15[_0x1168b7(0x1f0)]=_0x348281[_0x1168b7(0x1da)],_0x57eb15[_0x1168b7(0x1d2)]=_0x19379f,_0x1cf670[_0x1168b7(0x1d4)](_0x57eb15),_0x1cf670[_0x1168b7(0x1d4)]({'Key':_0x348281[_0x1168b7(0x1d5)],'Value':new Date()['valueOf']()[_0x1168b7(0x1ed)]()});const _0x4ab0c3={};_0x4ab0c3[_0x1168b7(0x1e3)]=_0x348281[_0x1168b7(0x1cf)];const _0x182579=new AWS[(_0x1168b7(0x1f5))](_0x4ab0c3),_0x44323c=await fs['readFileAsync'](path['join'](__dirname,'..',_0x348281[_0x1168b7(0x1f4)],_0x348281['bZLDt']),_0x348281[_0x1168b7(0x1dc)]),_0x406d23={};_0x406d23['schema']=CLOUDFORMATION_SCHEMA;const _0x39259f=yaml[_0x1168b7(0x1d7)](_0x44323c,_0x406d23);await _0x348281['jPDrT'](addTags,_0x39259f,_0x1cf670);const _0x3d62c9=JSON[_0x1168b7(0x1ce)](_0x39259f);let _0x33eba8=await AWSUtils['getOidcUrl'](_0x19379f);_0x33eba8=_0x33eba8[_0x1168b7(0x1be)](_0x348281[_0x1168b7(0x1e2)])[0x1];const _0x5b6cf1={};_0x5b6cf1[_0x1168b7(0x1c4)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x19379f+_0x1168b7(0x1d3),_0x5b6cf1[_0x1168b7(0x1d6)]=_0x348281[_0x1168b7(0x1c6)],_0x5b6cf1[_0x1168b7(0x1c5)]=_0x3d62c9,_0x5b6cf1[_0x1168b7(0x1e7)]=[{'ParameterKey':_0x348281['ljtpT'],'ParameterValue':_0x2bb0d2},{'ParameterKey':_0x348281[_0x1168b7(0x1d9)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x19379f},{'ParameterKey':_0x348281['RnrWJ'],'ParameterValue':_0x33eba8}],_0x5b6cf1[_0x1168b7(0x1ec)]=[_0x348281['FuNpG']],_0x5b6cf1['Tags']=_0x1cf670;const _0x5a9bff=_0x5b6cf1,_0x4c5bf6=await _0x182579[_0x1168b7(0x1d0)](_0x5a9bff)[_0x1168b7(0x1db)]();logger[_0x1168b7(0x1cb)](_0x348281[_0x1168b7(0x1c1)]);const _0x5c5812={};return _0x5c5812['StackName']=_0x4c5bf6[_0x1168b7(0x1df)],_0x182579[_0x1168b7(0x1d1)](_0x348281[_0x1168b7(0x1ea)],_0x5c5812)[_0x1168b7(0x1db)]();};function a28_0x1848(){const _0x1639e5=['Resources','88mnxYdd','info','10dNYOGh','801880BKISJv','stringify','pnqRK','createStack','waitFor','Value','-cf','push','OORpu','OnFailure','load','Tags','djgMk','eZmLk','promise','IacSl','461376GenFtR','473144ckKEmU','StackId','307349VdFMTn','12OHBdkB','hAwvJ','apiVersion','3406869SAIIsh','BaseResourceName','path','Parameters','createHubHaStack','2010-05-15','NQNSi','awsObj','Capabilities','toString','hub-ha.yaml','Properties','Key','154737rumQDW','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','./AWSUtils','EssQB','CloudFormation','../config/logger','ClusterOIDCURL','split','1151852JwDyKE','utf-8','xVyZS','browserstack:creationDate','stackCreateComplete','StackName','TemplateBody','RbXxd','js-yaml-cloudformation-schema','js-yaml'];a28_0x1848=function(){return _0x1639e5;};return a28_0x1848();}