const a28_0x11497a=a28_0x5006;(function(_0x3a36bd,_0xf78dc9){const _0x3689a7=a28_0x5006,_0x3f029d=_0x3a36bd();while(!![]){try{const _0x4ceea7=parseInt(_0x3689a7(0x8c))/0x1*(-parseInt(_0x3689a7(0xae))/0x2)+parseInt(_0x3689a7(0xa1))/0x3*(-parseInt(_0x3689a7(0x9b))/0x4)+parseInt(_0x3689a7(0x91))/0x5*(parseInt(_0x3689a7(0x7b))/0x6)+parseInt(_0x3689a7(0xab))/0x7*(parseInt(_0x3689a7(0x87))/0x8)+-parseInt(_0x3689a7(0xa7))/0x9*(parseInt(_0x3689a7(0x77))/0xa)+parseInt(_0x3689a7(0xa4))/0xb*(parseInt(_0x3689a7(0x89))/0xc)+parseInt(_0x3689a7(0x76))/0xd*(parseInt(_0x3689a7(0x70))/0xe);if(_0x4ceea7===_0xf78dc9)break;else _0x3f029d['push'](_0x3f029d['shift']());}catch(_0x548d90){_0x3f029d['push'](_0x3f029d['shift']());}}}(a28_0x2a82,0x2c31b));function a28_0x2a82(){const _0x51a9d5=['Resources','348BiAEkh','Value','VpcId','1516RYPEjq','../config/logger','lDPeD','gJeZz','StackName','60995wkbvqb','BaseResourceName','browserstack:cluster','2010-05-15','vMofl','promise','bluebird','schema','Capabilities','apiVersion','100396nwiGfJ','DlqQX','awsObj','dhalM','info','Properties','27jvwaUo','split','path','1826ysdvXl','TemplateBody','join','9zoBsii','stringify','OnFailure','hub-ha.yaml','14eGuhOk','-cf','browserstack:creationDate','146dsDKoM','zBFZy','Clwop','Parameters','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','../config/constants','10052SxxDpl','wuNVx','toString','ClusterOIDCURL','CAPABILITY_NAMED_IAM','push','5603BAsVAz','995090ttnCna','TQoyO','Tags','./AWSUtils','66DlMhYY','DELETE','StackId','waitFor','valueOf','promisifyAll','Key','YFrdc','AElCz','createHubHaStack','stackCreateComplete','://','674504XarzvI'];a28_0x2a82=function(){return _0x51a9d5;};return a28_0x2a82();}const fs=require('fs'),path=require(a28_0x11497a(0xa3)),Promise=require(a28_0x11497a(0x97)),yaml=require('js-yaml'),{CLOUDFORMATION_SCHEMA}=require('js-yaml-cloudformation-schema'),AWS=require('./AWSUtils')[a28_0x11497a(0x9d)],AWSUtils=require(a28_0x11497a(0x7a)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x11497a(0x6f)),{logger}=require(a28_0x11497a(0x8d));function a28_0x5006(_0x2be737,_0x12c87e){const _0x2a82e7=a28_0x2a82();return a28_0x5006=function(_0x500637,_0x5b078f){_0x500637=_0x500637-0x6f;let _0x458f36=_0x2a82e7[_0x500637];return _0x458f36;},a28_0x5006(_0x2be737,_0x12c87e);}Promise[a28_0x11497a(0x80)](fs);const addTags=async(_0x227a9f,_0x2a40ca)=>{const _0x2f075d=a28_0x11497a;for(const _0x12a1ba in _0x227a9f[_0x2f075d(0x88)]){_0x227a9f[_0x2f075d(0x88)][_0x12a1ba][_0x2f075d(0xa0)]&&_0x227a9f[_0x2f075d(0x88)][_0x12a1ba][_0x2f075d(0xa0)][_0x2f075d(0x79)]&&_0x227a9f[_0x2f075d(0x88)][_0x12a1ba][_0x2f075d(0xa0)][_0x2f075d(0x79)][_0x2f075d(0x75)](..._0x2a40ca);}};exports[a28_0x11497a(0x84)]=async(_0x444655,_0x14b124=null)=>{const _0x227697=a28_0x11497a,_0x31ed51={'BEdzJ':_0x227697(0x93),'zBFZy':_0x227697(0xad),'Clwop':_0x227697(0x94),'wuNVx':'CFTemplates','AElCz':_0x227697(0xaa),'YFrdc':'utf-8','DlqQX':function(_0x2e21e1,_0x262370,_0x42e805){return _0x2e21e1(_0x262370,_0x42e805);},'rqzoR':_0x227697(0x86),'gJeZz':_0x227697(0x7c),'dhalM':_0x227697(0x8b),'lDPeD':_0x227697(0x92),'BjkDc':_0x227697(0x73),'TQoyO':_0x227697(0x74),'vMofl':_0x227697(0xb2),'SUZSn':_0x227697(0x85)},_0x28cff6=COMMON_HST_TAGS,_0x4c4aab={};_0x4c4aab[_0x227697(0x81)]=_0x31ed51['BEdzJ'],_0x4c4aab[_0x227697(0x8a)]=_0x444655,_0x28cff6[_0x227697(0x75)](_0x4c4aab),_0x28cff6[_0x227697(0x75)]({'Key':_0x31ed51[_0x227697(0xaf)],'Value':new Date()[_0x227697(0x7f)]()[_0x227697(0x72)]()});const _0x5d748b={};_0x5d748b[_0x227697(0x9a)]=_0x31ed51[_0x227697(0xb0)];const _0x62b91f=new AWS['CloudFormation'](_0x5d748b),_0x3e7014=await fs['readFileAsync'](path[_0x227697(0xa6)](__dirname,'..',_0x31ed51[_0x227697(0x71)],_0x31ed51[_0x227697(0x83)]),_0x31ed51[_0x227697(0x82)]),_0x7aa43a={};_0x7aa43a[_0x227697(0x98)]=CLOUDFORMATION_SCHEMA;const _0x2a62c5=yaml['load'](_0x3e7014,_0x7aa43a);await _0x31ed51[_0x227697(0x9c)](addTags,_0x2a62c5,_0x28cff6);const _0x4f83dc=JSON[_0x227697(0xa8)](_0x2a62c5);let _0x9e64bc=await AWSUtils['getOidcUrl'](_0x444655);_0x9e64bc=_0x9e64bc[_0x227697(0xa2)](_0x31ed51['rqzoR'])[0x1];const _0x1ae769={};_0x1ae769[_0x227697(0x90)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x444655+_0x227697(0xac),_0x1ae769[_0x227697(0xa9)]=_0x31ed51[_0x227697(0x8f)],_0x1ae769[_0x227697(0xa5)]=_0x4f83dc,_0x1ae769[_0x227697(0xb1)]=[{'ParameterKey':_0x31ed51[_0x227697(0x9e)],'ParameterValue':_0x14b124},{'ParameterKey':_0x31ed51[_0x227697(0x8e)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x444655},{'ParameterKey':_0x31ed51['BjkDc'],'ParameterValue':_0x9e64bc}],_0x1ae769[_0x227697(0x99)]=[_0x31ed51[_0x227697(0x78)]],_0x1ae769[_0x227697(0x79)]=_0x28cff6;const _0x21c143=_0x1ae769,_0x39c677=await _0x62b91f['createStack'](_0x21c143)[_0x227697(0x96)]();logger[_0x227697(0x9f)](_0x31ed51[_0x227697(0x95)]);const _0x447bf0={};return _0x447bf0['StackName']=_0x39c677[_0x227697(0x7d)],_0x62b91f[_0x227697(0x7e)](_0x31ed51['SUZSn'],_0x447bf0)[_0x227697(0x96)]();};