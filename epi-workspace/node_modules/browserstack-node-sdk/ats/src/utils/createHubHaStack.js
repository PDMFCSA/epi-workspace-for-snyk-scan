const a28_0x469c5a=a28_0x5d39;(function(_0x438679,_0x306c5e){const _0x2771d3=a28_0x5d39,_0x2cd057=_0x438679();while(!![]){try{const _0xe5054e=parseInt(_0x2771d3(0x10f))/0x1*(-parseInt(_0x2771d3(0x102))/0x2)+parseInt(_0x2771d3(0x10e))/0x3*(-parseInt(_0x2771d3(0x11c))/0x4)+-parseInt(_0x2771d3(0x104))/0x5+parseInt(_0x2771d3(0xee))/0x6+-parseInt(_0x2771d3(0x127))/0x7*(parseInt(_0x2771d3(0x117))/0x8)+parseInt(_0x2771d3(0xfb))/0x9*(-parseInt(_0x2771d3(0x11f))/0xa)+-parseInt(_0x2771d3(0x119))/0xb*(-parseInt(_0x2771d3(0xf7))/0xc);if(_0xe5054e===_0x306c5e)break;else _0x2cd057['push'](_0x2cd057['shift']());}catch(_0x5c43d3){_0x2cd057['push'](_0x2cd057['shift']());}}}(a28_0x3aa9,0xba550));const fs=require('fs'),path=require('path'),Promise=require(a28_0x469c5a(0xf0)),yaml=require(a28_0x469c5a(0x10d)),{CLOUDFORMATION_SCHEMA}=require(a28_0x469c5a(0x10c)),AWS=require(a28_0x469c5a(0x118))['awsObj'],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x469c5a(0xf5)),{logger}=require('../config/logger');function a28_0x5d39(_0x123627,_0xe8fe00){const _0x3aa99c=a28_0x3aa9();return a28_0x5d39=function(_0x5d394f,_0x301b0e){_0x5d394f=_0x5d394f-0xeb;let _0x21ed0f=_0x3aa99c[_0x5d394f];return _0x21ed0f;},a28_0x5d39(_0x123627,_0xe8fe00);}Promise['promisifyAll'](fs);function a28_0x3aa9(){const _0x30ea20=['js-yaml-cloudformation-schema','js-yaml','11544Qeyojv','5srcbRa','CloudFormation','Properties','srkTm','join','Tags','CFTemplates','Capabilities','226544DoTtCL','./AWSUtils','2459006sqgfsq','Key','ncQLm','816IIuvTB','hub-ha.yaml','apiVersion','170auPbDF','wZjWO','stringify','UVAXh','VpcId','Value','tahzm','sDHTa','21ALsQar','waitFor','promise','hMiLi','lwXLf','LKEpp','5360802ZeEuFh','DELETE','bluebird','CAPABILITY_NAMED_IAM','valueOf','createHubHaStack','eKzUU','../config/constants','info','168bpldAL','2010-05-15','readFileAsync','toString','662382DLbFWd','OMrIw','FbDBi','StackId','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','Resources','zfRRJ','231706IyojXP','createStack','2797590YvllMV','push','StackName','OnFailure','BaseResourceName','://','utf-8','split'];a28_0x3aa9=function(){return _0x30ea20;};return a28_0x3aa9();}const addTags=async(_0x59a692,_0x330835)=>{const _0x4dc56f=a28_0x469c5a;for(const _0x5c5cde in _0x59a692[_0x4dc56f(0x100)]){_0x59a692[_0x4dc56f(0x100)][_0x5c5cde][_0x4dc56f(0x111)]&&_0x59a692[_0x4dc56f(0x100)][_0x5c5cde][_0x4dc56f(0x111)][_0x4dc56f(0x114)]&&_0x59a692[_0x4dc56f(0x100)][_0x5c5cde]['Properties'][_0x4dc56f(0x114)][_0x4dc56f(0x105)](..._0x330835);}};exports[a28_0x469c5a(0xf3)]=async(_0x5dc70b,_0x3b48ad=null)=>{const _0x3b69d2=a28_0x469c5a,_0x4e9f63={'ZOHMo':'browserstack:cluster','zfRRJ':'browserstack:creationDate','hMiLi':_0x3b69d2(0xf8),'srkTm':_0x3b69d2(0x115),'wZjWO':_0x3b69d2(0x11d),'OMrIw':_0x3b69d2(0x10a),'sDHTa':function(_0x2becaf,_0x394a3f,_0x146234){return _0x2becaf(_0x394a3f,_0x146234);},'LKEpp':_0x3b69d2(0x109),'tahzm':_0x3b69d2(0xef),'eKzUU':_0x3b69d2(0x123),'FbDBi':_0x3b69d2(0x108),'ncQLm':'ClusterOIDCURL','lwXLf':_0x3b69d2(0xf1),'jxLSN':_0x3b69d2(0xff),'UVAXh':'stackCreateComplete'},_0x26ddb2=COMMON_HST_TAGS,_0x22cb1e={};_0x22cb1e[_0x3b69d2(0x11a)]=_0x4e9f63['ZOHMo'],_0x22cb1e[_0x3b69d2(0x124)]=_0x5dc70b,_0x26ddb2[_0x3b69d2(0x105)](_0x22cb1e),_0x26ddb2[_0x3b69d2(0x105)]({'Key':_0x4e9f63[_0x3b69d2(0x101)],'Value':new Date()[_0x3b69d2(0xf2)]()[_0x3b69d2(0xfa)]()});const _0x522295={};_0x522295[_0x3b69d2(0x11e)]=_0x4e9f63[_0x3b69d2(0xeb)];const _0x34f177=new AWS[(_0x3b69d2(0x110))](_0x522295),_0xb635d8=await fs[_0x3b69d2(0xf9)](path[_0x3b69d2(0x113)](__dirname,'..',_0x4e9f63[_0x3b69d2(0x112)],_0x4e9f63[_0x3b69d2(0x120)]),_0x4e9f63[_0x3b69d2(0xfc)]),_0x14196a={};_0x14196a['schema']=CLOUDFORMATION_SCHEMA;const _0x5c39b1=yaml['load'](_0xb635d8,_0x14196a);await _0x4e9f63[_0x3b69d2(0x126)](addTags,_0x5c39b1,_0x26ddb2);const _0x22554a=JSON[_0x3b69d2(0x121)](_0x5c39b1);let _0x4ee014=await AWSUtils['getOidcUrl'](_0x5dc70b);_0x4ee014=_0x4ee014[_0x3b69d2(0x10b)](_0x4e9f63[_0x3b69d2(0xed)])[0x1];const _0xa1b420={};_0xa1b420[_0x3b69d2(0x106)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x5dc70b+'-cf',_0xa1b420[_0x3b69d2(0x107)]=_0x4e9f63[_0x3b69d2(0x125)],_0xa1b420['TemplateBody']=_0x22554a,_0xa1b420['Parameters']=[{'ParameterKey':_0x4e9f63[_0x3b69d2(0xf4)],'ParameterValue':_0x3b48ad},{'ParameterKey':_0x4e9f63[_0x3b69d2(0xfd)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x5dc70b},{'ParameterKey':_0x4e9f63[_0x3b69d2(0x11b)],'ParameterValue':_0x4ee014}],_0xa1b420[_0x3b69d2(0x116)]=[_0x4e9f63[_0x3b69d2(0xec)]],_0xa1b420['Tags']=_0x26ddb2;const _0x2d0c59=_0xa1b420,_0x11d35c=await _0x34f177[_0x3b69d2(0x103)](_0x2d0c59)['promise']();logger[_0x3b69d2(0xf6)](_0x4e9f63['jxLSN']);const _0x347361={};return _0x347361[_0x3b69d2(0x106)]=_0x11d35c[_0x3b69d2(0xfe)],_0x34f177[_0x3b69d2(0x128)](_0x4e9f63[_0x3b69d2(0x122)],_0x347361)[_0x3b69d2(0x129)]();};