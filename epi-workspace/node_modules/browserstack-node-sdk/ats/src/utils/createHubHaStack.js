const a28_0x3d61d0=a28_0x383d;(function(_0xcd6328,_0x2bb64a){const _0x399962=a28_0x383d,_0x5327e3=_0xcd6328();while(!![]){try{const _0x124c75=-parseInt(_0x399962(0x99))/0x1+parseInt(_0x399962(0x9c))/0x2*(-parseInt(_0x399962(0x9b))/0x3)+parseInt(_0x399962(0x8b))/0x4*(parseInt(_0x399962(0xc6))/0x5)+-parseInt(_0x399962(0xa1))/0x6*(-parseInt(_0x399962(0xad))/0x7)+parseInt(_0x399962(0x9d))/0x8*(-parseInt(_0x399962(0xa2))/0x9)+parseInt(_0x399962(0x8f))/0xa*(-parseInt(_0x399962(0xc2))/0xb)+parseInt(_0x399962(0xbf))/0xc*(parseInt(_0x399962(0x8d))/0xd);if(_0x124c75===_0x2bb64a)break;else _0x5327e3['push'](_0x5327e3['shift']());}catch(_0x3659a6){_0x5327e3['push'](_0x5327e3['shift']());}}}(a28_0x1da9,0x3f54b));const fs=require('fs'),path=require(a28_0x3d61d0(0xcb)),Promise=require(a28_0x3d61d0(0xc4)),yaml=require(a28_0x3d61d0(0x8e)),{CLOUDFORMATION_SCHEMA}=require(a28_0x3d61d0(0xaa)),AWS=require('./AWSUtils')['awsObj'],AWSUtils=require(a28_0x3d61d0(0x9a)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x3d61d0(0x96)),{logger}=require(a28_0x3d61d0(0x92));Promise[a28_0x3d61d0(0xb4)](fs);function a28_0x1da9(){const _0x3d2fa9=['promise','info','SpOeT','IKvXu','stringify','RAXxC','12zxliDL','Properties','StackId','886567wjZSdr','uLDeM','bluebird','schema','388765hursMg','://','Tags','sCkal','LSQVI','path','Resources','8uEIUpR','VpcId','14883986ZKAbYx','js-yaml','10IDpthI','boAdu','PfFCs','../config/logger','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','CloudFormation','push','../config/constants','BaseResourceName','lRPFW','216790LFWIrm','./AWSUtils','93Lqyqom','23396gpTPhV','8bFHVOw','getOidcUrl','utf-8','rLhnW','451494fheRWZ','4106241zRajOu','TemplateBody','StackName','apiVersion','split','2010-05-15','toString','join','js-yaml-cloudformation-schema','stackCreateComplete','valueOf','7zNUNPC','Key','browserstack:cluster','Value','YPlSX','createStack','QHiTX','promisifyAll','browserstack:creationDate','CFTemplates','CAPABILITY_NAMED_IAM','OnFailure'];a28_0x1da9=function(){return _0x3d2fa9;};return a28_0x1da9();}function a28_0x383d(_0x2f8615,_0x147401){const _0x1da9d4=a28_0x1da9();return a28_0x383d=function(_0x383d72,_0x131b74){_0x383d72=_0x383d72-0x8a;let _0xd9b0e1=_0x1da9d4[_0x383d72];return _0xd9b0e1;},a28_0x383d(_0x2f8615,_0x147401);}const addTags=async(_0x11379d,_0x414949)=>{const _0x34a42f=a28_0x3d61d0;for(const _0x11e088 in _0x11379d['Resources']){_0x11379d[_0x34a42f(0x8a)][_0x11e088][_0x34a42f(0xc0)]&&_0x11379d['Resources'][_0x11e088][_0x34a42f(0xc0)]['Tags']&&_0x11379d['Resources'][_0x11e088]['Properties']['Tags'][_0x34a42f(0x95)](..._0x414949);}};exports['createHubHaStack']=async(_0x10e5a7,_0x2393b9=null)=>{const _0x51c610=a28_0x3d61d0,_0x205150={'lRPFW':_0x51c610(0xaf),'IKvXu':_0x51c610(0xb5),'sCkal':_0x51c610(0xa7),'uLDeM':_0x51c610(0xb6),'sFSSp':'hub-ha.yaml','RAXxC':_0x51c610(0x9f),'PfFCs':function(_0x501987,_0x15f92d,_0x36d6aa){return _0x501987(_0x15f92d,_0x36d6aa);},'YPlSX':_0x51c610(0xc7),'rLhnW':'DELETE','IVKCp':_0x51c610(0x8c),'boAdu':_0x51c610(0x97),'fGfBM':'ClusterOIDCURL','SpOeT':_0x51c610(0xb7),'LSQVI':_0x51c610(0x93),'QHiTX':_0x51c610(0xab)},_0x1c7f39=COMMON_HST_TAGS,_0x45e82d={};_0x45e82d[_0x51c610(0xae)]=_0x205150[_0x51c610(0x98)],_0x45e82d[_0x51c610(0xb0)]=_0x10e5a7,_0x1c7f39[_0x51c610(0x95)](_0x45e82d),_0x1c7f39[_0x51c610(0x95)]({'Key':_0x205150[_0x51c610(0xbc)],'Value':new Date()[_0x51c610(0xac)]()[_0x51c610(0xa8)]()});const _0x3c7260={};_0x3c7260[_0x51c610(0xa5)]=_0x205150[_0x51c610(0xc9)];const _0x3876c7=new AWS[(_0x51c610(0x94))](_0x3c7260),_0x4aab58=await fs['readFileAsync'](path[_0x51c610(0xa9)](__dirname,'..',_0x205150[_0x51c610(0xc3)],_0x205150['sFSSp']),_0x205150[_0x51c610(0xbe)]),_0x57ea8c={};_0x57ea8c[_0x51c610(0xc5)]=CLOUDFORMATION_SCHEMA;const _0x113201=yaml['load'](_0x4aab58,_0x57ea8c);await _0x205150[_0x51c610(0x91)](addTags,_0x113201,_0x1c7f39);const _0x3a33e8=JSON[_0x51c610(0xbd)](_0x113201);let _0x229550=await AWSUtils[_0x51c610(0x9e)](_0x10e5a7);_0x229550=_0x229550[_0x51c610(0xa6)](_0x205150[_0x51c610(0xb1)])[0x1];const _0x48f6a2={};_0x48f6a2[_0x51c610(0xa4)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x10e5a7+'-cf',_0x48f6a2[_0x51c610(0xb8)]=_0x205150[_0x51c610(0xa0)],_0x48f6a2[_0x51c610(0xa3)]=_0x3a33e8,_0x48f6a2['Parameters']=[{'ParameterKey':_0x205150['IVKCp'],'ParameterValue':_0x2393b9},{'ParameterKey':_0x205150[_0x51c610(0x90)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x10e5a7},{'ParameterKey':_0x205150['fGfBM'],'ParameterValue':_0x229550}],_0x48f6a2['Capabilities']=[_0x205150[_0x51c610(0xbb)]],_0x48f6a2[_0x51c610(0xc8)]=_0x1c7f39;const _0x472993=_0x48f6a2,_0x3cc3cf=await _0x3876c7[_0x51c610(0xb2)](_0x472993)[_0x51c610(0xb9)]();logger[_0x51c610(0xba)](_0x205150[_0x51c610(0xca)]);const _0x131be0={};return _0x131be0['StackName']=_0x3cc3cf[_0x51c610(0xc1)],_0x3876c7['waitFor'](_0x205150[_0x51c610(0xb3)],_0x131be0)['promise']();};