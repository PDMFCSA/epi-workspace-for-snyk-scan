const a28_0x492dac=a28_0x461e;(function(_0x53e05c,_0x414535){const _0x1fb9f8=a28_0x461e,_0x120024=_0x53e05c();while(!![]){try{const _0x35a7ee=parseInt(_0x1fb9f8(0x181))/0x1*(parseInt(_0x1fb9f8(0x189))/0x2)+-parseInt(_0x1fb9f8(0x1a0))/0x3+-parseInt(_0x1fb9f8(0x196))/0x4*(parseInt(_0x1fb9f8(0x19b))/0x5)+parseInt(_0x1fb9f8(0x170))/0x6+-parseInt(_0x1fb9f8(0x19c))/0x7*(-parseInt(_0x1fb9f8(0x19a))/0x8)+parseInt(_0x1fb9f8(0x172))/0x9+-parseInt(_0x1fb9f8(0x184))/0xa;if(_0x35a7ee===_0x414535)break;else _0x120024['push'](_0x120024['shift']());}catch(_0x2b5822){_0x120024['push'](_0x120024['shift']());}}}(a28_0x1df2,0xa1ba1));const fs=require('fs'),path=require(a28_0x492dac(0x18b)),Promise=require(a28_0x492dac(0x180)),yaml=require(a28_0x492dac(0x18a)),{CLOUDFORMATION_SCHEMA}=require(a28_0x492dac(0x1a1)),AWS=require('./AWSUtils')[a28_0x492dac(0x179)],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require(a28_0x492dac(0x177));Promise[a28_0x492dac(0x19f)](fs);function a28_0x461e(_0x601027,_0x5f5a65){const _0x1df264=a28_0x1df2();return a28_0x461e=function(_0x461ec2,_0xc9536f){_0x461ec2=_0x461ec2-0x16b;let _0x91a249=_0x1df264[_0x461ec2];return _0x91a249;},a28_0x461e(_0x601027,_0x5f5a65);}function a28_0x1df2(){const _0x337b6a=['7syPQWd','RoWFa','Key','promisifyAll','148626NQzhVY','js-yaml-cloudformation-schema','2010-05-15','valueOf','push','stringify','OnFailure','Tags','32172Hufuea','load','3174219UKbemW','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','schema','vaRso','StackName','../config/logger','-cf','awsObj','promise','stackCreateComplete','Properties','://','PKgIT','wbKPl','bluebird','1GOazXo','QNCsL','createHubHaStack','13797520DnOGQo','PXTkj','StackId','browserstack:cluster','JYZgl','2288080pMZLTI','js-yaml','path','Value','waitFor','XdFpp','Resources','DELETE','readFileAsync','ClusterOIDCURL','info','Parameters','browserstack:creationDate','112UUEzhf','join','CAPABILITY_NAMED_IAM','getOidcUrl','7873232xUAdyo','70450ATsFrM'];a28_0x1df2=function(){return _0x337b6a;};return a28_0x1df2();}const addTags=async(_0x183d15,_0x5ceb93)=>{const _0x59861d=a28_0x492dac;for(const _0x39bea9 in _0x183d15[_0x59861d(0x18f)]){_0x183d15['Resources'][_0x39bea9][_0x59861d(0x17c)]&&_0x183d15[_0x59861d(0x18f)][_0x39bea9][_0x59861d(0x17c)][_0x59861d(0x16f)]&&_0x183d15[_0x59861d(0x18f)][_0x39bea9][_0x59861d(0x17c)]['Tags'][_0x59861d(0x16c)](..._0x5ceb93);}};exports[a28_0x492dac(0x183)]=async(_0x125a4c,_0x1d4c5a=null)=>{const _0x22d089=a28_0x492dac,_0x41a7a8={'PXTkj':_0x22d089(0x187),'JYZgl':_0x22d089(0x195),'XdFpp':_0x22d089(0x1a2),'PKgIT':'CFTemplates','Tazqd':'hub-ha.yaml','GZIsn':'utf-8','tGvQK':function(_0x3aba24,_0x371987,_0x1eae99){return _0x3aba24(_0x371987,_0x1eae99);},'tJJiG':_0x22d089(0x17d),'ufbNq':_0x22d089(0x190),'GeELU':'VpcId','wbKPl':'BaseResourceName','vaRso':_0x22d089(0x192),'RoWFa':_0x22d089(0x198),'QNCsL':_0x22d089(0x173),'UoivB':_0x22d089(0x17b)},_0x5be954=COMMON_HST_TAGS,_0x1cb551={};_0x1cb551[_0x22d089(0x19e)]=_0x41a7a8[_0x22d089(0x185)],_0x1cb551[_0x22d089(0x18c)]=_0x125a4c,_0x5be954['push'](_0x1cb551),_0x5be954[_0x22d089(0x16c)]({'Key':_0x41a7a8[_0x22d089(0x188)],'Value':new Date()[_0x22d089(0x16b)]()['toString']()});const _0x372ec8={};_0x372ec8['apiVersion']=_0x41a7a8[_0x22d089(0x18e)];const _0x216a2c=new AWS['CloudFormation'](_0x372ec8),_0x14f22c=await fs[_0x22d089(0x191)](path[_0x22d089(0x197)](__dirname,'..',_0x41a7a8[_0x22d089(0x17e)],_0x41a7a8['Tazqd']),_0x41a7a8['GZIsn']),_0x10d3fc={};_0x10d3fc[_0x22d089(0x174)]=CLOUDFORMATION_SCHEMA;const _0xfc7aff=yaml[_0x22d089(0x171)](_0x14f22c,_0x10d3fc);await _0x41a7a8['tGvQK'](addTags,_0xfc7aff,_0x5be954);const _0x20c1ae=JSON[_0x22d089(0x16d)](_0xfc7aff);let _0x237b72=await AWSUtils[_0x22d089(0x199)](_0x125a4c);_0x237b72=_0x237b72['split'](_0x41a7a8['tJJiG'])[0x1];const _0x3a2fc2={};_0x3a2fc2['StackName']=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x125a4c+_0x22d089(0x178),_0x3a2fc2[_0x22d089(0x16e)]=_0x41a7a8['ufbNq'],_0x3a2fc2['TemplateBody']=_0x20c1ae,_0x3a2fc2[_0x22d089(0x194)]=[{'ParameterKey':_0x41a7a8['GeELU'],'ParameterValue':_0x1d4c5a},{'ParameterKey':_0x41a7a8[_0x22d089(0x17f)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x125a4c},{'ParameterKey':_0x41a7a8[_0x22d089(0x175)],'ParameterValue':_0x237b72}],_0x3a2fc2['Capabilities']=[_0x41a7a8[_0x22d089(0x19d)]],_0x3a2fc2['Tags']=_0x5be954;const _0x5559fd=_0x3a2fc2,_0x1fb631=await _0x216a2c['createStack'](_0x5559fd)[_0x22d089(0x17a)]();logger[_0x22d089(0x193)](_0x41a7a8[_0x22d089(0x182)]);const _0x1f66f2={};return _0x1f66f2[_0x22d089(0x176)]=_0x1fb631[_0x22d089(0x186)],_0x216a2c[_0x22d089(0x18d)](_0x41a7a8['UoivB'],_0x1f66f2)['promise']();};