const a28_0x1df2bc=a28_0x316e;(function(_0x1dea26,_0x332729){const _0x25e1af=a28_0x316e,_0x1a6b52=_0x1dea26();while(!![]){try{const _0xc7f6b2=parseInt(_0x25e1af(0xd6))/0x1*(-parseInt(_0x25e1af(0xcf))/0x2)+-parseInt(_0x25e1af(0xb3))/0x3*(parseInt(_0x25e1af(0xc7))/0x4)+parseInt(_0x25e1af(0xcc))/0x5+-parseInt(_0x25e1af(0xb0))/0x6+-parseInt(_0x25e1af(0xbd))/0x7+-parseInt(_0x25e1af(0xb6))/0x8*(-parseInt(_0x25e1af(0xca))/0x9)+parseInt(_0x25e1af(0xae))/0xa;if(_0xc7f6b2===_0x332729)break;else _0x1a6b52['push'](_0x1a6b52['shift']());}catch(_0x2b1bb6){_0x1a6b52['push'](_0x1a6b52['shift']());}}}(a28_0x22f8,0xf0027));function a28_0x316e(_0x1aa462,_0x2eda9a){const _0x22f80e=a28_0x22f8();return a28_0x316e=function(_0x316ea1,_0x4c88e1){_0x316ea1=_0x316ea1-0xa6;let _0x4ee8af=_0x22f80e[_0x316ea1];return _0x4ee8af;},a28_0x316e(_0x1aa462,_0x2eda9a);}const fs=require('fs'),path=require('path'),Promise=require(a28_0x1df2bc(0xd3)),yaml=require('js-yaml'),{CLOUDFORMATION_SCHEMA}=require('js-yaml-cloudformation-schema'),AWS=require(a28_0x1df2bc(0xb4))[a28_0x1df2bc(0xb1)],AWSUtils=require(a28_0x1df2bc(0xb4)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x1df2bc(0xdb)),{logger}=require('../config/logger');Promise[a28_0x1df2bc(0xd0)](fs);const addTags=async(_0x3da7c4,_0x4329ef)=>{const _0x59e169=a28_0x1df2bc;for(const _0xb19ee4 in _0x3da7c4[_0x59e169(0xaa)]){_0x3da7c4['Resources'][_0xb19ee4][_0x59e169(0xc8)]&&_0x3da7c4[_0x59e169(0xaa)][_0xb19ee4]['Properties']['Tags']&&_0x3da7c4[_0x59e169(0xaa)][_0xb19ee4][_0x59e169(0xc8)][_0x59e169(0xbf)][_0x59e169(0xd1)](..._0x4329ef);}};exports[a28_0x1df2bc(0xa6)]=async(_0x303e8e,_0x516ba2=null)=>{const _0xfbb68f=a28_0x1df2bc,_0x112475={'rrXvz':_0xfbb68f(0xc2),'oXtyR':_0xfbb68f(0xbc),'rIvzI':_0xfbb68f(0xaf),'FhzBk':_0xfbb68f(0xd5),'WNwFx':_0xfbb68f(0xc4),'ebIJF':'utf-8','vFLJl':function(_0x148359,_0x79c0d8,_0x14c39a){return _0x148359(_0x79c0d8,_0x14c39a);},'vIIRT':_0xfbb68f(0xa7),'IcVfO':'DELETE','lPYTv':_0xfbb68f(0xa9),'GpONb':_0xfbb68f(0xda),'uLgqX':_0xfbb68f(0xa8),'InSDk':'CAPABILITY_NAMED_IAM','WjnRo':_0xfbb68f(0xba),'hEkbP':_0xfbb68f(0xd7)},_0x520662=COMMON_HST_TAGS,_0x2b39d3={};_0x2b39d3[_0xfbb68f(0xce)]=_0x112475[_0xfbb68f(0xc3)],_0x2b39d3['Value']=_0x303e8e,_0x520662['push'](_0x2b39d3),_0x520662['push']({'Key':_0x112475[_0xfbb68f(0xbe)],'Value':new Date()['valueOf']()['toString']()});const _0x4464d1={};_0x4464d1[_0xfbb68f(0xb2)]=_0x112475[_0xfbb68f(0xb7)];const _0x51ae60=new AWS[(_0xfbb68f(0xb9))](_0x4464d1),_0x337e11=await fs['readFileAsync'](path['join'](__dirname,'..',_0x112475[_0xfbb68f(0xb8)],_0x112475[_0xfbb68f(0xd8)]),_0x112475['ebIJF']),_0x3377b8={};_0x3377b8['schema']=CLOUDFORMATION_SCHEMA;const _0x362246=yaml[_0xfbb68f(0xd9)](_0x337e11,_0x3377b8);await _0x112475['vFLJl'](addTags,_0x362246,_0x520662);const _0xb20b19=JSON['stringify'](_0x362246);let _0x1fe7cd=await AWSUtils[_0xfbb68f(0xc9)](_0x303e8e);_0x1fe7cd=_0x1fe7cd[_0xfbb68f(0xcb)](_0x112475[_0xfbb68f(0xc6)])[0x1];const _0x3e75c1={};_0x3e75c1[_0xfbb68f(0xb5)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x303e8e+_0xfbb68f(0xad),_0x3e75c1[_0xfbb68f(0xd2)]=_0x112475[_0xfbb68f(0xc1)],_0x3e75c1[_0xfbb68f(0xc0)]=_0xb20b19,_0x3e75c1[_0xfbb68f(0xc5)]=[{'ParameterKey':_0x112475[_0xfbb68f(0xab)],'ParameterValue':_0x516ba2},{'ParameterKey':_0x112475['GpONb'],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x303e8e},{'ParameterKey':_0x112475['uLgqX'],'ParameterValue':_0x1fe7cd}],_0x3e75c1[_0xfbb68f(0xbb)]=[_0x112475[_0xfbb68f(0xdc)]],_0x3e75c1[_0xfbb68f(0xbf)]=_0x520662;const _0x375072=_0x3e75c1,_0x5699ef=await _0x51ae60['createStack'](_0x375072)[_0xfbb68f(0xd4)]();logger['info'](_0x112475[_0xfbb68f(0xac)]);const _0x42a12f={};return _0x42a12f[_0xfbb68f(0xb5)]=_0x5699ef[_0xfbb68f(0xcd)],_0x51ae60['waitFor'](_0x112475['hEkbP'],_0x42a12f)[_0xfbb68f(0xd4)]();};function a28_0x22f8(){const _0x40cc5f=['CloudFormation','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','Capabilities','browserstack:creationDate','10163951JBCuAG','oXtyR','Tags','TemplateBody','IcVfO','browserstack:cluster','rrXvz','hub-ha.yaml','Parameters','vIIRT','367300LGEGCG','Properties','getOidcUrl','41805ZPSvjQ','split','6698845OzJuOA','StackId','Key','418136QzaJHY','promisifyAll','push','OnFailure','bluebird','promise','CFTemplates','4APLzwn','stackCreateComplete','WNwFx','load','BaseResourceName','../config/constants','InSDk','createHubHaStack','://','ClusterOIDCURL','VpcId','Resources','lPYTv','WjnRo','-cf','43401260lIYfxe','2010-05-15','11059926czkpBi','awsObj','apiVersion','30RdYsNH','./AWSUtils','StackName','608oLDPek','rIvzI','FhzBk'];a28_0x22f8=function(){return _0x40cc5f;};return a28_0x22f8();}