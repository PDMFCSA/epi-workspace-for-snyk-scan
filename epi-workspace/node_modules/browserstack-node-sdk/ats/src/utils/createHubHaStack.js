const a28_0x59af4e=a28_0x3ded;function a28_0x3ded(_0x418306,_0x20e0f1){const _0x440246=a28_0x4402();return a28_0x3ded=function(_0x3ded25,_0x4d8f55){_0x3ded25=_0x3ded25-0xa2;let _0x70d50d=_0x440246[_0x3ded25];return _0x70d50d;},a28_0x3ded(_0x418306,_0x20e0f1);}(function(_0x3b6abf,_0x218ca5){const _0x3b098a=a28_0x3ded,_0x98f3af=_0x3b6abf();while(!![]){try{const _0x3e2326=-parseInt(_0x3b098a(0xb0))/0x1+-parseInt(_0x3b098a(0xbc))/0x2+parseInt(_0x3b098a(0xd2))/0x3+parseInt(_0x3b098a(0xa9))/0x4*(parseInt(_0x3b098a(0xaa))/0x5)+parseInt(_0x3b098a(0xc4))/0x6+-parseInt(_0x3b098a(0xd0))/0x7+-parseInt(_0x3b098a(0xcb))/0x8*(parseInt(_0x3b098a(0xb3))/0x9);if(_0x3e2326===_0x218ca5)break;else _0x98f3af['push'](_0x98f3af['shift']());}catch(_0x2e1b26){_0x98f3af['push'](_0x98f3af['shift']());}}}(a28_0x4402,0x55d5b));function a28_0x4402(){const _0x3222cc=['GUxnT','bluebird','HAVpW','miLNx','321335qsXwmw','split','readFileAsync','1332mHWXVy','push','TemplateBody','FArhO','schema','CFTemplates','hub-ha.yaml','info','DeOfy','438006kkuOVa','Resources','path','../config/constants','valueOf','awsObj','StackName','Capabilities','3890748ccvVmz','Key','Parameters','CloudFormation','rSxpR','./AWSUtils','XjJwD','33128tTAGsG','://','lWxTG','getOidcUrl','waitFor','1263521Jqcuhe','IPhJE','1729731Zkzquf','js-yaml','StackId','dMBnQ','apiVersion','../config/logger','utf-8','cXvlZ','createStack','BaseResourceName','-cf','DELETE','promise','JUYhA','js-yaml-cloudformation-schema','Properties','browserstack:creationDate','load','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','AvANm','Value','Tags','4hilxgI','2301265xaAAwh','2010-05-15'];a28_0x4402=function(){return _0x3222cc;};return a28_0x4402();}const fs=require('fs'),path=require(a28_0x59af4e(0xbe)),Promise=require(a28_0x59af4e(0xad)),yaml=require(a28_0x59af4e(0xd3)),{CLOUDFORMATION_SCHEMA}=require(a28_0x59af4e(0xe0)),AWS=require(a28_0x59af4e(0xc9))[a28_0x59af4e(0xc1)],AWSUtils=require(a28_0x59af4e(0xc9)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require(a28_0x59af4e(0xbf)),{logger}=require(a28_0x59af4e(0xd7));Promise['promisifyAll'](fs);const addTags=async(_0x59bac1,_0x55afcd)=>{const _0x109f31=a28_0x59af4e;for(const _0x2adacb in _0x59bac1[_0x109f31(0xbd)]){_0x59bac1['Resources'][_0x2adacb]['Properties']&&_0x59bac1[_0x109f31(0xbd)][_0x2adacb][_0x109f31(0xa2)][_0x109f31(0xa8)]&&_0x59bac1[_0x109f31(0xbd)][_0x2adacb][_0x109f31(0xa2)][_0x109f31(0xa8)]['push'](..._0x55afcd);}};exports['createHubHaStack']=async(_0x52e52b,_0x33eff2=null)=>{const _0x4b8ea9=a28_0x59af4e,_0x5ebe29={'GUxnT':'browserstack:cluster','lWxTG':_0x4b8ea9(0xa3),'AvANm':_0x4b8ea9(0xab),'HAVpW':_0x4b8ea9(0xb8),'rSxpR':_0x4b8ea9(0xb9),'cjWdr':_0x4b8ea9(0xd8),'JUYhA':function(_0x920367,_0x3618ce,_0x19bceb){return _0x920367(_0x3618ce,_0x19bceb);},'DeOfy':_0x4b8ea9(0xcc),'lFesr':_0x4b8ea9(0xdd),'cXvlZ':'VpcId','dMBnQ':_0x4b8ea9(0xdb),'XjJwD':'ClusterOIDCURL','miLNx':'CAPABILITY_NAMED_IAM','FArhO':_0x4b8ea9(0xa5),'IPhJE':'stackCreateComplete'},_0x3697bc=COMMON_HST_TAGS,_0x322574={};_0x322574[_0x4b8ea9(0xc5)]=_0x5ebe29[_0x4b8ea9(0xac)],_0x322574[_0x4b8ea9(0xa7)]=_0x52e52b,_0x3697bc[_0x4b8ea9(0xb4)](_0x322574),_0x3697bc['push']({'Key':_0x5ebe29[_0x4b8ea9(0xcd)],'Value':new Date()[_0x4b8ea9(0xc0)]()['toString']()});const _0x37b2a0={};_0x37b2a0[_0x4b8ea9(0xd6)]=_0x5ebe29[_0x4b8ea9(0xa6)];const _0x4ba346=new AWS[(_0x4b8ea9(0xc7))](_0x37b2a0),_0x55f48b=await fs[_0x4b8ea9(0xb2)](path['join'](__dirname,'..',_0x5ebe29[_0x4b8ea9(0xae)],_0x5ebe29[_0x4b8ea9(0xc8)]),_0x5ebe29['cjWdr']),_0x2c3f24={};_0x2c3f24[_0x4b8ea9(0xb7)]=CLOUDFORMATION_SCHEMA;const _0x2c373d=yaml[_0x4b8ea9(0xa4)](_0x55f48b,_0x2c3f24);await _0x5ebe29[_0x4b8ea9(0xdf)](addTags,_0x2c373d,_0x3697bc);const _0x5895d8=JSON['stringify'](_0x2c373d);let _0x58b362=await AWSUtils[_0x4b8ea9(0xce)](_0x52e52b);_0x58b362=_0x58b362[_0x4b8ea9(0xb1)](_0x5ebe29[_0x4b8ea9(0xbb)])[0x1];const _0x46b21c={};_0x46b21c[_0x4b8ea9(0xc2)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x52e52b+_0x4b8ea9(0xdc),_0x46b21c['OnFailure']=_0x5ebe29['lFesr'],_0x46b21c[_0x4b8ea9(0xb5)]=_0x5895d8,_0x46b21c[_0x4b8ea9(0xc6)]=[{'ParameterKey':_0x5ebe29[_0x4b8ea9(0xd9)],'ParameterValue':_0x33eff2},{'ParameterKey':_0x5ebe29[_0x4b8ea9(0xd5)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x52e52b},{'ParameterKey':_0x5ebe29[_0x4b8ea9(0xca)],'ParameterValue':_0x58b362}],_0x46b21c[_0x4b8ea9(0xc3)]=[_0x5ebe29[_0x4b8ea9(0xaf)]],_0x46b21c['Tags']=_0x3697bc;const _0x5838c9=_0x46b21c,_0x5f0524=await _0x4ba346[_0x4b8ea9(0xda)](_0x5838c9)[_0x4b8ea9(0xde)]();logger[_0x4b8ea9(0xba)](_0x5ebe29[_0x4b8ea9(0xb6)]);const _0xbe2a94={};return _0xbe2a94[_0x4b8ea9(0xc2)]=_0x5f0524[_0x4b8ea9(0xd4)],_0x4ba346[_0x4b8ea9(0xcf)](_0x5ebe29[_0x4b8ea9(0xd1)],_0xbe2a94)[_0x4b8ea9(0xde)]();};